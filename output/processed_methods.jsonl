{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":4,"raw_source":"def price(integer)\n    format(\"$%.2d USD\", integer / 100.0)\n  end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"price\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"integer\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$%.2d USD\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"integer\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":8,"raw_source":"def prettyprint(text)\n    text.gsub(/\\*(.*)\\*/, '<b>\\1</b>')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prettyprint\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"text\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"text\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\*(.*)\\\\*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"<b>\\\\1</b>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":12,"raw_source":"def count(array)\n    array.size\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"count\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"size\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":16,"raw_source":"def paragraph(p)\n    \"<p>#{p}</p>\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"paragraph\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<p>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]}]},{\"type\":\"str\",\"children\":[\"</p>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":22,"raw_source":"def index\n    { 'date' => Time.now }\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"index\",{\"type\":\"args\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"date\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":26,"raw_source":"def products\n    { 'products' => products_list, 'more_products' => more_products_list, 'description' => description, 'section' => 'Snowboards', 'cool_products' => true }\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"products\",{\"type\":\"args\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"send\",\"children\":[null,\"products_list\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"more_products\"]},{\"type\":\"send\",\"children\":[null,\"more_products_list\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"send\",\"children\":[null,\"description\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"section\"]},{\"type\":\"str\",\"children\":[\"Snowboards\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cool_products\"]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":32,"raw_source":"def products_list\n    [\n      { 'name' => 'Arbor Draft', 'price' => 39900, 'description' => 'the *arbor draft* is a excellent product' },\n      { 'name' => 'Arbor Element', 'price' => 40000, 'description' => 'the *arbor element* rocks for freestyling' },\n      { 'name' => 'Arbor Diamond', 'price' => 59900, 'description' => 'the *arbor diamond* is a made up product because im obsessed with arbor and have no creativity' }\n    ]\n  end","complexity_score":0.75,"ast_json":"{\"type\":\"def\",\"children\":[\"products_list\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Arbor Draft\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[39900]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"str\",\"children\":[\"the *arbor draft* is a excellent product\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Arbor Element\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[40000]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"str\",\"children\":[\"the *arbor element* rocks for freestyling\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Arbor Diamond\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[59900]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"str\",\"children\":[\"the *arbor diamond* is a made up product because im obsessed with arbor and have no creativity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":40,"raw_source":"def more_products_list\n    [\n      { 'name' => 'Arbor Catalyst', 'price' => 39900, 'description' => 'the *arbor catalyst* is an advanced drop-through for freestyle and flatground performance and versatility' },\n      { 'name' => 'Arbor Fish', 'price' => 40000, 'description' => 'the *arbor fish* is a compact pin that features an extended wheelbase and time-honored teardrop shape' }\n    ]\n  end","complexity_score":0.5,"ast_json":"{\"type\":\"def\",\"children\":[\"more_products_list\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Arbor Catalyst\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[39900]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"str\",\"children\":[\"the *arbor catalyst* is an advanced drop-through for freestyle and flatground performance and versatility\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Arbor Fish\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[40000]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"str\",\"children\":[\"the *arbor fish* is a compact pin that features an extended wheelbase and time-honored teardrop shape\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":47,"raw_source":"def description\n    \"List of Products ~ This is a list of products with price and description.\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"description\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"List of Products ~ This is a list of products with price and description.\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":4,"raw_source":"def do_GET(req, res)\n    handle(:get, req, res)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"do_GET\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"req\"]},{\"type\":\"arg\",\"children\":[\"res\"]}]},{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"sym\",\"children\":[\"get\"]},{\"type\":\"lvar\",\"children\":[\"req\"]},{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":8,"raw_source":"def do_POST(req, res)\n    handle(:post, req, res)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"do_POST\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"req\"]},{\"type\":\"arg\",\"children\":[\"res\"]}]},{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"sym\",\"children\":[\"post\"]},{\"type\":\"lvar\",\"children\":[\"req\"]},{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":14,"raw_source":"def handle(_type, req, res)\n    @request  = req\n    @response = res\n\n    @request.path_info =~ /(\\w+)\\z/\n    @action  = Regexp.last_match(1) || 'index'\n    @assigns = send(@action) if respond_to?(@action)\n\n    @response['Content-Type'] = \"text/html\"\n    @response.status = 200\n    @response.body   = Liquid::Template.parse(read_template).render(@assigns, filters: [ProductsFilter])\n  end","complexity_score":19.68,"ast_json":"{\"type\":\"def\",\"children\":[\"handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_type\"]},{\"type\":\"arg\",\"children\":[\"req\"]},{\"type\":\"arg\",\"children\":[\"res\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"lvar\",\"children\":[\"req\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"lvar\",\"children\":[\"res\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"path_info\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(\\\\w+)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@action\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"str\",\"children\":[\"index\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@assigns\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Content-Type\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"status=\",{\"type\":\"int\",\"children\":[200]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"body=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[null,\"read_template\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductsFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":27,"raw_source":"def read_template(filename = @action)\n    File.read(\"#{__dir__}/templates/#{filename}.liquid\")\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},{\"type\":\"str\",\"children\":[\"/templates/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"str\",\"children\":[\".liquid\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":7,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @blank = true\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@blank\",{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":12,"raw_source":"def parse(tokens)\n      @body = new_body\n      while parse_body(@body, tokens)\n      end\n      @body.freeze\n    end","complexity_score":5.1,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@body\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"freeze\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":20,"raw_source":"def render(context)\n      @body.render(context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":24,"raw_source":"def blank?\n      @blank\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@blank\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":28,"raw_source":"def nodelist\n      @body.nodelist\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"nodelist\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":32,"raw_source":"def unknown_tag(tag_name, _markup, _tokenizer)\n      Block.raise_unknown_tag(tag_name, block_name, block_delimiter, parse_context)\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"_markup\"]},{\"type\":\"arg\",\"children\":[\"_tokenizer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Block\"]},\"raise_unknown_tag\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"send\",\"children\":[null,\"block_name\"]},{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":37,"raw_source":"def self.raise_unknown_tag(tag, block_name, block_delimiter, parse_context)\n      if tag == 'else'\n        raise SyntaxError, parse_context.locale.t(\n          \"errors.syntax.unexpected_else\",\n          block_name: block_name,\n        )\n      elsif tag.start_with?('end')\n        raise SyntaxError, parse_context.locale.t(\n          \"errors.syntax.invalid_delimiter\",\n          tag: tag,\n          block_name: block_name,\n          block_delimiter: block_delimiter,\n        )\n      else\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unknown_tag\", tag: tag)\n      end\n    end","complexity_score":16.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"block_name\"]},{\"type\":\"arg\",\"children\":[\"block_delimiter\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unexpected_else\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"end\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.invalid_delimiter\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_delimiter\"]},{\"type\":\"lvar\",\"children\":[\"block_delimiter\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unknown_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":55,"raw_source":"def raise_tag_never_closed(block_name)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_never_closed\", block_name: block_name)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_tag_never_closed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block_name\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_never_closed\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":59,"raw_source":"def block_name\n      @tag_name\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"block_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@tag_name\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":63,"raw_source":"def block_delimiter\n      @block_delimiter ||= \"end#{block_name}\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"block_delimiter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@block_delimiter\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"end\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":70,"raw_source":"def new_body\n      parse_context.new_block_body\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"new_block_body\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":75,"raw_source":"def parse_body(body, tokens)\n      if parse_context.depth >= MAX_DEPTH\n        raise StackLevelError, \"Nesting too deep\"\n      end\n      parse_context.depth += 1\n      begin\n        body.parse(tokens, parse_context) do |end_tag_name, end_tag_params|\n          @blank &&= body.blank?\n\n          return false if end_tag_name == block_delimiter\n          raise_tag_never_closed(block_name) unless end_tag_name\n\n          # this tag is not registered with the system\n          # pass it to the current block for special handling or error reporting\n          unknown_tag(end_tag_name, end_tag_params, tokens)\n        end\n      ensure\n        parse_context.depth -= 1\n      end\n\n      true\n    end","complexity_score":22.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"MAX_DEPTH\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokens\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"end_tag_name\"]},{\"type\":\"arg\",\"children\":[\"end_tag_params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"blank?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},null,{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"unknown_tag\",{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"end_tag_params\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":17,"raw_source":"def initialize\n      @nodelist = []\n      @blank    = true\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@nodelist\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@blank\",{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":22,"raw_source":"def parse(tokenizer, parse_context, &block)\n      raise FrozenError, \"can't modify frozen Liquid::BlockBody\" if frozen?\n\n      parse_context.line_number = tokenizer.line_number\n\n      if tokenizer.for_liquid_tag\n        parse_for_liquid_tag(tokenizer, parse_context, &block)\n      else\n        parse_for_document(tokenizer, parse_context, &block)\n      end\n    end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"frozen?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FrozenError\"]},{\"type\":\"str\",\"children\":[\"can't modify frozen Liquid::BlockBody\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},{\"type\":\"send\",\"children\":[null,\"parse_for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[null,\"parse_for_document\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":34,"raw_source":"def freeze\n      @nodelist.freeze\n      super\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"freeze\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"freeze\"]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":39,"raw_source":"private def parse_for_liquid_tag(tokenizer, parse_context)\n      while (token = tokenizer.shift)\n        unless token.empty? || token.match?(WhitespaceOrNothing)\n          unless token =~ LiquidTagToken\n            # line isn't empty but didn't match tag syntax, yield and let the\n            # caller raise a syntax error\n            return yield token, token\n          end\n          tag_name = Regexp.last_match(1)\n          markup   = Regexp.last_match(2)\n\n          if tag_name == 'liquid'\n            parse_context.line_number -= 1\n            next parse_liquid_tag(markup, parse_context)\n          end\n\n          unless (tag = parse_context.environment.tag_for_name(tag_name))\n            # end parsing if we reach an unknown tag and let the caller decide\n            # determine how to proceed\n            return yield tag_name, markup\n          end\n          new_tag = tag.parse(tag_name, markup, tokenizer, parse_context)\n          @blank &&= new_tag.blank?\n          @nodelist << new_tag\n        end\n        parse_context.line_number = tokenizer.line_number\n      end\n\n      yield nil, nil\n    end","complexity_score":47.55,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_for_liquid_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[null,\"WhitespaceOrNothing\"]}]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"LiquidTagToken\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"str\",\"children\":[\"liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"next\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"environment\"]},\"tag_for_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_tag\"]},\"blank?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"new_tag\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":71,"raw_source":"def self.unknown_tag_in_liquid_tag(tag, parse_context)\n      Block.raise_unknown_tag(tag, 'liquid', '%}', parse_context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"unknown_tag_in_liquid_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Block\"]},\"raise_unknown_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"str\",\"children\":[\"liquid\"]},{\"type\":\"str\",\"children\":[\"%}\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":76,"raw_source":"def self.raise_missing_tag_terminator(token, parse_context)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_termination\", token: token, tag_end: TagEnd.inspect)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_missing_tag_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_termination\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag_end\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TagEnd\"]},\"inspect\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":81,"raw_source":"def self.raise_missing_variable_terminator(token, parse_context)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.variable_termination\", token: token, tag_end: VariableEnd.inspect)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_missing_variable_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.variable_termination\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag_end\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableEnd\"]},\"inspect\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":86,"raw_source":"def self.render_node(context, output, node)\n      node.render_to_output_buffer(context, output)\n    rescue => exc\n      blank_tag = !node.instance_of?(Variable) && node.blank?\n      rescue_render_node(context, output, node.line_number, exc, blank_tag)\n    end","complexity_score":11.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"resbody\",\"children\":[null,{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blank_tag\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Variable\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"blank?\"]}]}]},{\"type\":\"send\",\"children\":[null,\"rescue_render_node\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"blank_tag\"]}]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":94,"raw_source":"def self.rescue_render_node(context, output, line_number, exc, blank_tag)\n      case exc\n      when MemoryError\n        raise\n      when UndefinedVariable, UndefinedDropMethod, UndefinedFilter\n        context.handle_error(exc, line_number)\n      else\n        error_message = context.handle_error(exc, line_number)\n        unless blank_tag # conditional for backwards compatibility\n          output << error_message\n        end\n      end\n    end","complexity_score":10.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"rescue_render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"line_number\"]},{\"type\":\"arg\",\"children\":[\"exc\"]},{\"type\":\"arg\",\"children\":[\"blank_tag\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MemoryError\"]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"UndefinedVariable\"]},{\"type\":\"const\",\"children\":[null,\"UndefinedDropMethod\"]},{\"type\":\"const\",\"children\":[null,\"UndefinedFilter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error_message\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blank_tag\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"error_message\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":108,"raw_source":"private def parse_liquid_tag(markup, parse_context)\n      liquid_tag_tokenizer = parse_context.new_tokenizer(\n        markup, start_line_number: parse_context.line_number, for_liquid_tag: true\n      )\n      parse_for_liquid_tag(liquid_tag_tokenizer, parse_context) do |end_tag_name, _end_tag_markup|\n        if end_tag_name\n          BlockBody.unknown_tag_in_liquid_tag(end_tag_name, parse_context)\n        end\n      end\n    end","complexity_score":8.9,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_liquid_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"liquid_tag_tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"for_liquid_tag\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"liquid_tag_tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"end_tag_name\"]},{\"type\":\"arg\",\"children\":[\"_end_tag_markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"unknown_tag_in_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},null]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":119,"raw_source":"private def handle_invalid_tag_token(token, parse_context)\n      if token.end_with?('%}')\n        yield token, token\n      else\n        BlockBody.raise_missing_tag_terminator(token, parse_context)\n      end\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"handle_invalid_tag_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"%}\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_tag_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":127,"raw_source":"private def parse_for_document(tokenizer, parse_context, &block)\n      while (token = tokenizer.shift)\n        next if token.empty?\n        case\n        when token.start_with?(TAGSTART)\n          whitespace_handler(token, parse_context)\n          unless token =~ FullToken\n            return handle_invalid_tag_token(token, parse_context, &block)\n          end\n          tag_name = Regexp.last_match(2)\n          markup   = Regexp.last_match(4)\n\n          if parse_context.line_number\n            # newlines inside the tag should increase the line number,\n            # particularly important for multiline {% liquid %} tags\n            parse_context.line_number += Regexp.last_match(1).count(\"\\n\") + Regexp.last_match(3).count(\"\\n\")\n          end\n\n          if tag_name == 'liquid'\n            parse_liquid_tag(markup, parse_context)\n            next\n          end\n\n          unless (tag = parse_context.environment.tag_for_name(tag_name))\n            # end parsing if we reach an unknown tag and let the caller decide\n            # determine how to proceed\n            return yield tag_name, markup\n          end\n          new_tag = tag.parse(tag_name, markup, tokenizer, parse_context)\n          @blank &&= new_tag.blank?\n          @nodelist << new_tag\n        when token.start_with?(VARSTART)\n          whitespace_handler(token, parse_context)\n          @nodelist << create_variable(token, parse_context)\n          @blank = false\n        else\n          if parse_context.trim_whitespace\n            token.lstrip!\n          end\n          parse_context.trim_whitespace = false\n          @nodelist << token\n          @blank &&= token.match?(WhitespaceOrNothing)\n        end\n        parse_context.line_number = tokenizer.line_number\n      end\n\n      yield nil, nil\n    end","complexity_score":87.15,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_for_document\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"case\",\"children\":[null,{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"TAGSTART\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"whitespace_handler\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"FullToken\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handle_invalid_tag_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"str\",\"children\":[\"liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"next\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"environment\"]},\"tag_for_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_tag\"]},\"blank?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"new_tag\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"VARSTART\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"whitespace_handler\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@blank\",{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"lstrip!\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[null,\"WhitespaceOrNothing\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":176,"raw_source":"def whitespace_handler(token, parse_context)\n      if token[2] == WhitespaceControl\n        previous_token = @nodelist.last\n        if previous_token.is_a?(String)\n          first_byte = previous_token.getbyte(0)\n          previous_token.rstrip!\n          if previous_token.empty? && parse_context[:bug_compatible_whitespace_trimming] && first_byte\n            previous_token << first_byte\n          end\n        end\n      end\n      parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n    end","complexity_score":25.0,"ast_json":"{\"type\":\"def\",\"children\":[\"whitespace_handler\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"previous_token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"last\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"getbyte\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"rstrip!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]}]}]},{\"type\":\"lvar\",\"children\":[\"first_byte\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"first_byte\"]}]},null]}]},null]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":190,"raw_source":"def blank?\n      @blank\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@blank\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":209,"raw_source":"def remove_blank_strings\n      raise \"remove_blank_strings only support being called on a blank block body\" unless @blank\n      @nodelist.reject! { |node| node.instance_of?(String) }\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_blank_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blank\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"remove_blank_strings only support being called on a blank block body\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":214,"raw_source":"def render(context)\n      render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[null,\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":218,"raw_source":"def render_to_output_buffer(context, output)\n      freeze unless frozen?\n\n      context.resource_limits.increment_render_score(@nodelist.length)\n\n      idx = 0\n      while (node = @nodelist[idx])\n        if node.instance_of?(String)\n          output << node\n        else\n          render_node(context, output, node)\n          # If we get an Interrupt that means the block must stop processing. An\n          # Interrupt is any command that stops block execution such as {% break %}\n          # or {% continue %}. These tags may also occur through Block or Include tags.\n          break if context.interrupt? # might have happened in a for-block\n        end\n        idx += 1\n\n        context.resource_limits.increment_write_score(output)\n      end\n\n      output\n    end","complexity_score":23.95,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"frozen?\"]},null,{\"type\":\"send\",\"children\":[null,\"freeze\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_render_score\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"idx\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"idx\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"render_node\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},{\"type\":\"break\",\"children\":[]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"idx\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_write_score\",{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":244,"raw_source":"def render_node(context, output, node)\n      BlockBody.render_node(context, output, node)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"render_node\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"node\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":248,"raw_source":"def create_variable(token, parse_context)\n      if token.end_with?(\"}}\")\n        i = 2\n        i = 3 if token[i] == \"-\"\n        parse_end = token.length - 3\n        parse_end -= 1 if token[parse_end] == \"-\"\n        markup_end = parse_end - i + 1\n        markup = markup_end <= 0 ? \"\" : token.slice(i, markup_end)\n\n        return Variable.new(markup, parse_context)\n      end\n\n      BlockBody.raise_missing_variable_terminator(token, parse_context)\n    end","complexity_score":31.1,"ast_json":"{\"type\":\"def\",\"children\":[\"create_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"}}\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[3]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"parse_end\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"-\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"parse_end\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_end\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"markup_end\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_end\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup_end\"]},\"<=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"lvar\",\"children\":[\"markup_end\"]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_variable_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":264,"raw_source":"def raise_missing_tag_terminator(token, parse_context)\n      BlockBody.raise_missing_tag_terminator(token, parse_context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_missing_tag_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_tag_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":269,"raw_source":"def raise_missing_variable_terminator(token, parse_context)\n      BlockBody.raise_missing_variable_terminator(token, parse_context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_missing_variable_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_variable_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":36,"raw_source":"def initialize(method_name, to_s)\n        @method_name = method_name\n        @to_s = to_s\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]},{\"type\":\"arg\",\"children\":[\"to_s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@method_name\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@to_s\",{\"type\":\"lvar\",\"children\":[\"to_s\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":47,"raw_source":"def self.operators\n      @@operators\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"operators\",{\"type\":\"args\",\"children\":[]},{\"type\":\"cvar\",\"children\":[\"@@operators\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":51,"raw_source":"def self.parse_expression(parse_context, markup)\n      @@method_literals[markup] || parse_context.parse_expression(markup)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@method_literals\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":58,"raw_source":"def initialize(left = nil, operator = nil, right = nil)\n      @left     = left\n      @operator = operator\n      @right    = right\n\n      @child_relation  = nil\n      @child_condition = nil\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"left\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"operator\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"right\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@left\",{\"type\":\"lvar\",\"children\":[\"left\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@operator\",{\"type\":\"lvar\",\"children\":[\"operator\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@right\",{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":67,"raw_source":"def evaluate(context = deprecated_default_context)\n      condition = self\n      result = nil\n      loop do\n        result = interpret_condition(condition.left, condition.right, condition.operator, context)\n\n        case condition.child_relation\n        when :or\n          break if Liquid::Utils.to_liquid_value(result)\n        when :and\n          break unless Liquid::Utils.to_liquid_value(result)\n        else\n          break\n        end\n        condition = condition.child_condition\n      end\n      result\n    end","complexity_score":25.6,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[null,\"deprecated_default_context\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"interpret_condition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"left\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"operator\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"child_relation\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"or\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"break\",\"children\":[]},null]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"and\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},null,{\"type\":\"break\",\"children\":[]}]}]},{\"type\":\"break\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"child_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":86,"raw_source":"def or(condition)\n      @child_relation  = :or\n      @child_condition = condition\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"or\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"sym\",\"children\":[\"or\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":91,"raw_source":"def and(condition)\n      @child_relation  = :and\n      @child_condition = condition\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"and\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"sym\",\"children\":[\"and\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":96,"raw_source":"def attach(attachment)\n      @attachment = attachment\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"attach\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"attachment\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@attachment\",{\"type\":\"lvar\",\"children\":[\"attachment\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":100,"raw_source":"def else?\n      false\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"else?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":104,"raw_source":"def inspect\n      \"#<Condition #{[@left, @operator, @right].compact.join(' ')}>\"\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<Condition \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@left\"]},{\"type\":\"ivar\",\"children\":[\"@operator\"]},{\"type\":\"ivar\",\"children\":[\"@right\"]}]},\"compact\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":114,"raw_source":"def equal_variables(left, right)\n      if left.is_a?(MethodLiteral)\n        if right.respond_to?(left.method_name)\n          return right.send(left.method_name)\n        else\n          return nil\n        end\n      end\n\n      if right.is_a?(MethodLiteral)\n        if left.respond_to?(right.method_name)\n          return left.send(right.method_name)\n        else\n          return nil\n        end\n      end\n\n      left == right\n    end","complexity_score":22.0,"ast_json":"{\"type\":\"def\",\"children\":[\"equal_variables\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"MethodLiteral\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"respond_to?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"method_name\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"MethodLiteral\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"respond_to?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"method_name\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"right\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":134,"raw_source":"def interpret_condition(left, right, op, context)\n      # If the operator is empty this means that the decision statement is just\n      # a single variable. We can just poll this variable from the context and\n      # return this as the result.\n      return context.evaluate(left) if op.nil?\n\n      left  = Liquid::Utils.to_liquid_value(context.evaluate(left))\n      right = Liquid::Utils.to_liquid_value(context.evaluate(right))\n\n      operation = self.class.operators[op] || raise(Liquid::ArgumentError, \"Unknown operator #{op}\")\n\n      if operation.respond_to?(:call)\n        operation.call(self, left, right)\n      elsif left.respond_to?(operation) && right.respond_to?(operation) && !left.is_a?(Hash) && !right.is_a?(Hash)\n        begin\n          left.send(operation, right)\n        rescue ::ArgumentError => e\n          raise Liquid::ArgumentError, e.message\n        end\n      end\n    end","complexity_score":42.0,"ast_json":"{\"type\":\"def\",\"children\":[\"interpret_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"left\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"left\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"left\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"right\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"right\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"operation\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"operators\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unknown operator \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"operation\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"operation\"]},\"call\",{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"operation\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"operation\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"!\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"operation\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":156,"raw_source":"def deprecated_default_context\n      warn(\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\" \\\n        \" and will be removed from Liquid 6.0.0.\")\n      Context.new\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"deprecated_default_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\"]},{\"type\":\"str\",\"children\":[\" and will be removed from Liquid 6.0.0.\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":163,"raw_source":"def children\n        [\n          @node.left,\n          @node.right,\n          @node.child_condition,\n          @node.attachment\n        ].compact\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"left\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"child_condition\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attachment\"]}]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":175,"raw_source":"def else?\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"else?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":179,"raw_source":"def evaluate(_context)\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":21,"raw_source":"def self.build(environment: Environment.default, environments: {}, outer_scope: {}, registers: {}, rethrow_errors: false, resource_limits: nil, static_environments: {}, &block)\n      new(environments, outer_scope, registers, rethrow_errors, resource_limits, static_environments, environment, &block)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]},{\"type\":\"kwoptarg\",\"children\":[\"environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"outer_scope\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"resource_limits\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"static_environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"environments\"]},{\"type\":\"lvar\",\"children\":[\"outer_scope\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]},{\"type\":\"lvar\",\"children\":[\"rethrow_errors\"]},{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"lvar\",\"children\":[\"static_environments\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":25,"raw_source":"def initialize(environments = {}, outer_scope = {}, registers = {}, rethrow_errors = false, resource_limits = nil, static_environments = {}, environment = Environment.default)\n      @environment = environment\n      @environments = [environments]\n      @environments.flatten!\n\n      @static_environments = [static_environments].flatten(1).freeze\n      @scopes              = [outer_scope || {}]\n      @registers           = registers.is_a?(Registers) ? registers : Registers.new(registers)\n      @errors              = []\n      @partial             = false\n      @strict_variables    = false\n      @resource_limits     = resource_limits || ResourceLimits.new(environment.default_resource_limits)\n      @base_scope_depth    = 0\n      @interrupts          = []\n      @filters             = []\n      @global_filter       = nil\n      @disabled_tags       = {}\n\n      # Instead of constructing new StringScanner objects for each Expression parse,\n      # we recycle the same one.\n      @string_scanner = StringScanner.new(\"\")\n\n      @registers.static[:cached_partials] ||= {}\n      @registers.static[:file_system] ||= environment.file_system\n      @registers.static[:template_factory] ||= Liquid::TemplateFactory.new\n\n      self.exception_renderer = environment.exception_renderer\n      if rethrow_errors\n        self.exception_renderer = Liquid::RAISE_EXCEPTION_LAMBDA\n      end\n\n      yield self if block_given?\n\n      # Do this last, since it could result in this object being passed to a Proc in the environment\n      squash_instance_assigns_with_environments\n    end","complexity_score":48.25,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"outer_scope\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"resource_limits\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"static_environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@environments\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environments\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"flatten!\"]},{\"type\":\"ivasgn\",\"children\":[\"@static_environments\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_environments\"]}]},\"flatten\",{\"type\":\"int\",\"children\":[1]}]},\"freeze\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@scopes\",{\"type\":\"array\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outer_scope\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@registers\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Registers\"]}]},{\"type\":\"lvar\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@partial\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@strict_variables\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@resource_limits\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"default_resource_limits\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@base_scope_depth\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@interrupts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@global_filter\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@disabled_tags\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"file_system\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"file_system\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_factory\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TemplateFactory\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"exception_renderer\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"exception_renderer=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"RAISE_EXCEPTION_LAMBDA\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"squash_instance_assigns_with_environments\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":63,"raw_source":"def warnings\n      @warnings ||= []\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@warnings\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":67,"raw_source":"def strainer\n      @strainer ||= @environment.create_strainer(self, @filters)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strainer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@strainer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"self\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":75,"raw_source":"def add_filters(filters)\n      filters = [filters].flatten.compact\n      @filters += filters\n      @strainer = nil\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filters\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filters\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filters\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]}]},\"flatten\"]},\"compact\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"filters\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":81,"raw_source":"def apply_global_filter(obj)\n      global_filter.nil? ? obj : global_filter.call(obj)\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_global_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"global_filter\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"global_filter\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":86,"raw_source":"def interrupt?\n      !@interrupts.empty?\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"interrupt?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@interrupts\"]},\"empty?\"]},\"!\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":91,"raw_source":"def push_interrupt(e)\n      @interrupts.push(e)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"push_interrupt\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@interrupts\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":96,"raw_source":"def pop_interrupt\n      @interrupts.pop\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"pop_interrupt\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@interrupts\"]},\"pop\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":100,"raw_source":"def handle_error(e, line_number = nil)\n      e = internal_error unless e.is_a?(Liquid::Error)\n      e.template_name ||= template_name\n      e.line_number   ||= line_number\n      errors.push(e)\n      exception_renderer.call(e).to_s\n    end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"handle_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]},{\"type\":\"optarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"send\",\"children\":[null,\"internal_error\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"template_name\"]},{\"type\":\"send\",\"children\":[null,\"template_name\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"errors\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"exception_renderer\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},\"to_s\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":108,"raw_source":"def invoke(method, *args)\n      strainer.invoke(method, *args).to_liquid\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strainer\"]},\"invoke\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},\"to_liquid\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":113,"raw_source":"def push(new_scope = {})\n      @scopes.unshift(new_scope)\n      check_overflow\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"push\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"new_scope\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"unshift\",{\"type\":\"lvar\",\"children\":[\"new_scope\"]}]},{\"type\":\"send\",\"children\":[null,\"check_overflow\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":119,"raw_source":"def merge(new_scopes)\n      @scopes[0].merge!(new_scopes)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"new_scopes\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"new_scopes\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":124,"raw_source":"def pop\n      raise ContextError if @scopes.size == 1\n      @scopes.shift\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"pop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"size\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ContextError\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"shift\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":137,"raw_source":"def stack(new_scope = {})\n      push(new_scope)\n      yield\n    ensure\n      pop\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"stack\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"new_scope\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"push\",{\"type\":\"lvar\",\"children\":[\"new_scope\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"pop\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":146,"raw_source":"def new_isolated_subcontext\n      check_overflow\n\n      self.class.build(\n        environment: @environment,\n        resource_limits: resource_limits,\n        static_environments: static_environments,\n        registers: Registers.new(registers),\n      ).tap do |subcontext|\n        subcontext.base_scope_depth   = base_scope_depth + 1\n        subcontext.exception_renderer = exception_renderer\n        subcontext.filters  = @filters\n        subcontext.strainer = nil\n        subcontext.errors   = errors\n        subcontext.warnings = warnings\n        subcontext.disabled_tags = @disabled_tags\n      end\n    end","complexity_score":26.35,"ast_json":"{\"type\":\"def\",\"children\":[\"new_isolated_subcontext\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"check_overflow\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[null,\"resource_limits\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"send\",\"children\":[null,\"static_environments\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"registers\"]}]}]}]}]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subcontext\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"base_scope_depth=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_scope_depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[null,\"exception_renderer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"filters=\",{\"type\":\"ivar\",\"children\":[\"@filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"strainer=\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"errors=\",{\"type\":\"send\",\"children\":[null,\"errors\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"warnings=\",{\"type\":\"send\",\"children\":[null,\"warnings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"disabled_tags=\",{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":165,"raw_source":"def clear_instance_assigns\n      @scopes[0] = {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"clear_instance_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]=\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":170,"raw_source":"def []=(key, value)\n      @scopes[0][key] = value\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":182,"raw_source":"def [](expression)\n      evaluate(Expression.parse(expression, @string_scanner))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"expression\"]},{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":186,"raw_source":"def key?(key)\n      self[key] != nil\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!=\",{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":190,"raw_source":"def evaluate(object)\n      object.respond_to?(:evaluate) ? object.evaluate(self) : object\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"evaluate\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":195,"raw_source":"def find_variable(key, raise_on_not_found: true)\n      # This was changed from find() to find_index() because this is a very hot\n      # path and find_index() is optimized in MRI to reduce object allocation\n      index = @scopes.find_index { |s| s.key?(key) }\n\n      variable = if index\n        lookup_and_evaluate(@scopes[index], key, raise_on_not_found: raise_on_not_found)\n      else\n        try_variable_find_in_environments(key, raise_on_not_found: raise_on_not_found)\n      end\n\n      # update variable's context before invoking #to_liquid\n      variable.context = self if variable.respond_to?(:context=)\n\n      liquid_variable = variable.to_liquid\n\n      liquid_variable.context = self if variable != liquid_variable && liquid_variable.respond_to?(:context=)\n\n      liquid_variable\n    end","complexity_score":20.0,"ast_json":"{\"type\":\"def\",\"children\":[\"find_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwoptarg\",\"children\":[\"raise_on_not_found\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"index\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"find_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"index\"]},{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"try_variable_find_in_environments\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"context=\",{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"liquid_variable\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"to_liquid\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"!=\",{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]},\"context=\",{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":216,"raw_source":"def lookup_and_evaluate(obj, key, raise_on_not_found: true)\n      if @strict_variables && raise_on_not_found && obj.respond_to?(:key?) && !obj.key?(key)\n        raise Liquid::UndefinedVariable, \"undefined variable #{key}\"\n      end\n\n      value = obj[key]\n\n      if value.is_a?(Proc) && obj.respond_to?(:[]=)\n        obj[key] = value.arity == 0 ? value.call : value.call(self)\n      else\n        value\n      end\n    end","complexity_score":22.7,"ast_json":"{\"type\":\"def\",\"children\":[\"lookup_and_evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwoptarg\",\"children\":[\"raise_on_not_found\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedVariable\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined variable \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"arity\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"call\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"call\",{\"type\":\"self\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":230,"raw_source":"def with_disabled_tags(tag_names)\n      tag_names.each do |name|\n        @disabled_tags[name] = @disabled_tags.fetch(name, 0) + 1\n      end\n      yield\n    ensure\n      tag_names.each do |name|\n        @disabled_tags[name] -= 1\n      end\n    end","complexity_score":9.73,"ast_json":"{\"type\":\"def\",\"children\":[\"with_disabled_tags\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_names\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"int\",\"children\":[0]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":241,"raw_source":"def tag_disabled?(tag_name)\n      @disabled_tags.fetch(tag_name, 0) > 0\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tag_disabled?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"int\",\"children\":[0]}]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":253,"raw_source":"def try_variable_find_in_environments(key, raise_on_not_found:)\n      @environments.each do |environment|\n        found_variable = lookup_and_evaluate(environment, key, raise_on_not_found: raise_on_not_found)\n        if !found_variable.nil? || @strict_variables && raise_on_not_found\n          return found_variable\n        end\n      end\n      @static_environments.each do |environment|\n        found_variable = lookup_and_evaluate(environment, key, raise_on_not_found: raise_on_not_found)\n        if !found_variable.nil? || @strict_variables && raise_on_not_found\n          return found_variable\n        end\n      end\n      nil\n    end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"try_variable_find_in_environments\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwarg\",\"children\":[\"raise_on_not_found\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found_variable\",{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]},\"nil?\"]},\"!\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]}]},null]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static_environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found_variable\",{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]},\"nil?\"]},\"!\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]}]},null]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":269,"raw_source":"def check_overflow\n      raise StackLevelError, \"Nesting too deep\" if overflow?\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"check_overflow\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"overflow?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":273,"raw_source":"def overflow?\n      base_scope_depth + @scopes.length > Block::MAX_DEPTH\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"overflow?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_scope_depth\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"length\"]}]},\">\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Block\"]},\"MAX_DEPTH\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":277,"raw_source":"def internal_error\n      # raise and catch to set backtrace and cause on exception\n      raise Liquid::InternalError, 'internal'\n    rescue Liquid::InternalError => exc\n      exc\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"internal_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]},{\"type\":\"str\",\"children\":[\"internal\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"exc\"]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":284,"raw_source":"def squash_instance_assigns_with_environments\n      @scopes.last.each_key do |k|\n        @environments.each do |env|\n          if env.key?(k)\n            scopes.last[k] = lookup_and_evaluate(env, k)\n            break\n          end\n        end\n      end\n    end # squash_instance_assigns_with_environments","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"squash_instance_assigns_with_environments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"last\"]},\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"break\",\"children\":[]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/deprecations.rb","start_line":12,"raw_source":"def warn(name, alternative)\n        return if warned.include?(name)\n\n        warned << name\n\n        caller_location = caller_locations(2, 1).first\n        Warning.warn(\"[DEPRECATION] #{name} is deprecated. Use #{alternative} instead. Called from #{caller_location}\\n\")\n      end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"alternative\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warned\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warned\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"caller_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Warning\"]},\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[DEPRECATION] \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" is deprecated. Use \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"alternative\"]}]},{\"type\":\"str\",\"children\":[\" instead. Called from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"caller_location\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":5,"raw_source":"def self.parse(tokens, parse_context)\n      doc = new(parse_context)\n      doc.parse(tokens, parse_context)\n      doc\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc\",{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokens\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"lvar\",\"children\":[\"doc\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":13,"raw_source":"def initialize(parse_context)\n      @parse_context = parse_context\n      @body = new_body\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":18,"raw_source":"def nodelist\n      @body.nodelist\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"nodelist\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":22,"raw_source":"def parse(tokenizer, parse_context)\n      while parse_body(tokenizer)\n      end\n      @body.freeze\n    rescue SyntaxError => e\n      e.line_number ||= parse_context.line_number\n      raise\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"freeze\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":31,"raw_source":"def unknown_tag(tag, _markup, _tokenizer)\n      case tag\n      when 'else', 'end'\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unexpected_outer_tag\", tag: tag)\n      else\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unknown_tag\", tag: tag)\n      end\n    end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"_markup\"]},{\"type\":\"arg\",\"children\":[\"_tokenizer\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"end\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unexpected_outer_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unknown_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":40,"raw_source":"def render_to_output_buffer(context, output)\n      @body.render_to_output_buffer(context, output)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":44,"raw_source":"def render(context)\n      render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[null,\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":50,"raw_source":"def new_body\n      parse_context.new_block_body\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"new_block_body\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":54,"raw_source":"def parse_body(tokenizer)\n      @body.parse(tokenizer, parse_context) do |unknown_tag_name, unknown_tag_markup|\n        if unknown_tag_name\n          unknown_tag(unknown_tag_name, unknown_tag_markup, tokenizer)\n          true\n        else\n          false\n        end\n      end\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"arg\",\"children\":[\"unknown_tag_markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"unknown_tag\",{\"type\":\"lvar\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"unknown_tag_markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":28,"raw_source":"def initialize\n      @context = nil\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":33,"raw_source":"def liquid_method_missing(method)\n      return nil unless @context&.strict_variables\n      raise Liquid::UndefinedDropMethod, \"undefined method #{method}\"\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"strict_variables\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedDropMethod\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined method \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":39,"raw_source":"def invoke_drop(method_or_key)\n      if self.class.invokable?(method_or_key)\n        send(method_or_key)\n      else\n        liquid_method_missing(method_or_key)\n      end\n    end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_drop\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_or_key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"invokable?\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]},{\"type\":\"send\",\"children\":[null,\"liquid_method_missing\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":47,"raw_source":"def key?(_name)\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_name\"]}]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":51,"raw_source":"def inspect\n      self.class.to_s\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"to_s\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":55,"raw_source":"def to_liquid\n      self\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":59,"raw_source":"def to_s\n      self.class.name\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":66,"raw_source":"def self.invokable?(method_name)\n      invokable_methods.include?(method_name.to_s)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"invokable?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invokable_methods\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method_name\"]},\"to_s\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":70,"raw_source":"def self.invokable_methods\n      @invokable_methods ||= begin\n        blacklist = Liquid::Drop.public_instance_methods + [:each]\n\n        if include?(Enumerable)\n          blacklist += Enumerable.public_instance_methods\n          blacklist -= [:sort, :count, :first, :min, :max]\n        end\n\n        whitelist = [:to_liquid] + (public_instance_methods - blacklist)\n        Set.new(whitelist.map(&:to_s))\n      end\n    end","complexity_score":26.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"invokable_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@invokable_methods\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]},\"public_instance_methods\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"each\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"const\",\"children\":[null,\"Enumerable\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Enumerable\"]},\"public_instance_methods\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\"]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"sort\"]},{\"type\":\"sym\",\"children\":[\"count\"]},{\"type\":\"sym\",\"children\":[\"first\"]},{\"type\":\"sym\",\"children\":[\"min\"]},{\"type\":\"sym\",\"children\":[\"max\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"whitelist\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_liquid\"]}]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"public_instance_methods\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"blacklist\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Set\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":42,"raw_source":"def build(tags: nil, file_system: nil, error_mode: nil, exception_renderer: nil)\n        ret = new\n        ret.tags = tags if tags\n        ret.file_system = file_system if file_system\n        ret.error_mode = error_mode if error_mode\n        ret.exception_renderer = exception_renderer if exception_renderer\n        yield ret if block_given?\n        ret.freeze\n      end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"tags\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"file_system\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"exception_renderer\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ret\",{\"type\":\"send\",\"children\":[null,\"new\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"tags=\",{\"type\":\"lvar\",\"children\":[\"tags\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"file_system=\",{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"error_mode\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"exception_renderer=\",{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"freeze\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":55,"raw_source":"def default\n        @default ||= new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@default\"]},{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":65,"raw_source":"def dangerously_override(environment)\n        original_default = @default\n        @default = environment\n        yield\n      ensure\n        @default = original_default\n      end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"dangerously_override\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_default\",{\"type\":\"ivar\",\"children\":[\"@default\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"original_default\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":76,"raw_source":"def initialize\n      @tags = Tags::STANDARD_TAGS.dup\n      @error_mode = :lax\n      @strainer_template = Class.new(StrainerTemplate).tap do |klass|\n        klass.add_filter(StandardFilters)\n      end\n      @exception_renderer = ->(exception) { exception }\n      @file_system = BlankFileSystem.new\n      @default_resource_limits = Const::EMPTY_HASH\n      @strainer_template_class_cache = {}\n    end","complexity_score":14.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tags\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tags\"]},\"STANDARD_TAGS\"]},\"dup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer_template\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"StrainerTemplate\"]}]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"add_filter\",{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"exception\"]}]},{\"type\":\"lvar\",\"children\":[\"exception\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlankFileSystem\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_resource_limits\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_HASH\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer_template_class_cache\",{\"type\":\"hash\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":93,"raw_source":"def register_tag(name, klass)\n      @tags[name] = klass\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tags\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":101,"raw_source":"def register_filter(filter)\n      @strainer_template_class_cache.clear\n      @strainer_template.add_filter(filter)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"clear\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":110,"raw_source":"def register_filters(filters)\n      @strainer_template_class_cache.clear\n      filters.each { |f| @strainer_template.add_filter(f) }\n      self\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filters\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filters\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"clear\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"f\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":124,"raw_source":"def create_strainer(context, filters = Const::EMPTY_ARRAY)\n      return @strainer_template.new(context) if filters.empty?\n\n      strainer_template = @strainer_template_class_cache[filters] ||= begin\n        klass = Class.new(@strainer_template)\n        filters.each { |f| klass.add_filter(f) }\n        klass\n      end\n\n      strainer_template.new(context)\n    end","complexity_score":11.7,"ast_json":"{\"type\":\"def\",\"children\":[\"create_strainer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"optarg\",\"children\":[\"filters\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"strainer_template\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"filters\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"f\"]}]}]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer_template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":140,"raw_source":"def filter_method_names\n      @strainer_template.filter_method_names\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_method_names\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"filter_method_names\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":148,"raw_source":"def tag_for_name(name)\n      @tags[name]\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"tag_for_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tags\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":152,"raw_source":"def freeze\n      @tags.freeze\n      # TODO: freeze the tags, currently this is not possible because of liquid-c\n      # @strainer_template.freeze\n      super\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"freeze\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tags\"]},\"freeze\"]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/errors.rb","start_line":9,"raw_source":"def to_s(with_prefix = true)\n      str = +\"\"\n      str << message_prefix if with_prefix\n      str << super()\n\n      if markup_context\n        str << \" \"\n        str << markup_context\n      end\n\n      str\n    end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"with_prefix\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"with_prefix\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"message_prefix\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"super\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"markup_context\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"markup_context\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/errors.rb","start_line":24,"raw_source":"def message_prefix\n      str = +\"\"\n      str << if is_a?(SyntaxError)\n        \"Liquid syntax error\"\n      else\n        \"Liquid error\"\n      end\n\n      if line_number\n        str << \" (\"\n        str << template_name << \" \" if template_name\n        str << \"line \" << line_number.to_s << \")\"\n      end\n\n      str << \": \"\n      str\n    end","complexity_score":24.1,"ast_json":"{\"type\":\"def\",\"children\":[\"message_prefix\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"is_a?\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"str\",\"children\":[\"Liquid syntax error\"]},{\"type\":\"str\",\"children\":[\"Liquid error\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_number\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\" (\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"template_name\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"line \"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_number\"]},\"to_s\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\")\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\": \"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":31,"raw_source":"def parse(markup, ss = StringScanner.new(\"\"), cache = nil)\n        return unless markup\n\n        markup = markup.strip # markup can be a frozen string\n\n        if (markup.start_with?('\"') && markup.end_with?('\"')) ||\n          (markup.start_with?(\"'\") && markup.end_with?(\"'\"))\n          return markup[1..-2]\n        elsif LITERALS.key?(markup)\n          return LITERALS[markup]\n        end\n\n        # Cache only exists during parsing\n        if cache\n          return cache[markup] if cache.key?(markup)\n\n          cache[markup] = inner_parse(markup, ss, cache).freeze\n        else\n          inner_parse(markup, ss, nil).freeze\n        end\n      end","complexity_score":30.4,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"ss\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"'\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LITERALS\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LITERALS\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"inner_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]},\"freeze\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"inner_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"nil\",\"children\":[]}]},\"freeze\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":53,"raw_source":"def inner_parse(markup, ss, cache)\n        if (markup.start_with?(\"(\") && markup.end_with?(\")\")) && markup =~ RANGES_REGEX\n          return RangeLookup.parse(\n            Regexp.last_match(1),\n            Regexp.last_match(2),\n            ss,\n            cache,\n          )\n        end\n\n        if (num = parse_number(markup, ss))\n          num\n        else\n          VariableLookup.parse(markup, ss, cache)\n        end\n      end","complexity_score":15.15,"ast_json":"{\"type\":\"def\",\"children\":[\"inner_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"ss\"]},{\"type\":\"arg\",\"children\":[\"cache\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"(\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\")\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"RANGES_REGEX\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeLookup\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"num\",{\"type\":\"send\",\"children\":[null,\"parse_number\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"num\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":70,"raw_source":"def parse_number(markup, ss)\n        # check if the markup is simple integer or float\n        case markup\n        when INTEGER_REGEX\n          return Integer(markup, 10)\n        when FLOAT_REGEX\n          return markup.to_f\n        end\n\n        ss.string = markup\n        # the first byte must be a digit or  a dash\n        byte = ss.scan_byte\n\n        return false if byte != DASH && (byte < ZERO || byte > NINE)\n\n        if byte == DASH\n          peek_byte = ss.peek_byte\n\n          # if it starts with a dash, the next byte must be a digit\n          return false if peek_byte.nil? || !(peek_byte >= ZERO && peek_byte <= NINE)\n        end\n\n        # The markup could be a float with multiple dots\n        first_dot_pos = nil\n        num_end_pos = nil\n\n        while (byte = ss.scan_byte)\n          return false if byte != DOT && (byte < ZERO || byte > NINE)\n\n          # we found our number and now we are just scanning the rest of the string\n          next if num_end_pos\n\n          if byte == DOT\n            if first_dot_pos.nil?\n              first_dot_pos = ss.pos\n            else\n              # we found another dot, so we know that the number ends here\n              num_end_pos = ss.pos - 1\n            end\n          end\n        end\n\n        num_end_pos = markup.length if ss.eos?\n\n        if num_end_pos\n          # number ends with a number \"123.123\"\n          markup.byteslice(0, num_end_pos).to_f\n        else\n          # number ends with a dot \"123.\"\n          markup.byteslice(0, first_dot_pos).to_f\n        end\n      end","complexity_score":66.45,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_number\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"ss\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"INTEGER_REGEX\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FLOAT_REGEX\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"to_f\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"string=\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"DASH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\">\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DASH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"peek_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"first_dot_pos\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\">\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_dot_pos\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"first_dot_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]}]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"eos?\"]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"length\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"byteslice\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]}]},\"to_f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"byteslice\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"first_dot_pos\"]}]},\"to_f\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":7,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":13,"raw_source":"def to_liquid\n    to_s\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"to_s\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":19,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":25,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":31,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":37,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":43,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":49,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":55,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":61,"raw_source":"def to_liquid # :nodoc:\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":67,"raw_source":"def to_liquid # :nodoc:\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/extensions.rb","start_line":73,"raw_source":"def to_liquid # :nodoc:\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":19,"raw_source":"def read_template_file(_template_path)\n      raise FileSystemError, \"This liquid context does not allow includes.\"\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"str\",\"children\":[\"This liquid context does not allow includes.\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":49,"raw_source":"def initialize(root, pattern = \"_%s.liquid\")\n      @root    = root\n      @pattern = pattern\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"root\"]},{\"type\":\"optarg\",\"children\":[\"pattern\",{\"type\":\"str\",\"children\":[\"_%s.liquid\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@root\",{\"type\":\"lvar\",\"children\":[\"root\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pattern\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":54,"raw_source":"def read_template_file(template_path)\n      full_path = full_path(template_path)\n      raise FileSystemError, \"No such template '#{template_path}'\" unless File.exist?(full_path)\n\n      File.read(full_path)\n    end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"full_path\",{\"type\":\"send\",\"children\":[null,\"full_path\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"No such template '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":61,"raw_source":"def full_path(template_path)\n      raise FileSystemError, \"Illegal template name '#{template_path}'\" unless %r{\\A[^./][a-zA-Z0-9_/]+\\z}.match?(template_path)\n\n      full_path = if template_path.include?('/')\n        File.join(root, File.dirname(template_path), @pattern % File.basename(template_path))\n      else\n        File.join(root, @pattern % template_path)\n      end\n\n      raise FileSystemError, \"Illegal template path '#{File.expand_path(full_path)}'\" unless File.expand_path(full_path).start_with?(File.expand_path(root))\n\n      full_path\n    end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"full_path\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A[^./][a-zA-Z0-9_/]+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match?\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Illegal template name '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"full_path\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]},\"include?\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pattern\"]},\"%\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]},\"start_with?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"send\",\"children\":[null,\"root\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Illegal template path '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":10,"raw_source":"def initialize(name, length, parentloop)\n      @name       = name\n      @length     = length\n      @parentloop = parentloop\n      @index      = 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"length\"]},{\"type\":\"arg\",\"children\":[\"parentloop\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@length\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@parentloop\",{\"type\":\"lvar\",\"children\":[\"parentloop\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@index\",{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":39,"raw_source":"def index\n      @index + 1\n    end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"index\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":47,"raw_source":"def index0\n      @index\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"index0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@index\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":55,"raw_source":"def rindex\n      @length - @index\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":63,"raw_source":"def rindex0\n      @length - @index - 1\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":71,"raw_source":"def first\n      @index == 0\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":79,"raw_source":"def last\n      @index == @length - 1\n    end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":85,"raw_source":"def increment!\n      @index += 1\n    end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"increment!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":13,"raw_source":"def initialize(path = DEFAULT_LOCALE)\n      @path = path\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"const\",\"children\":[null,\"DEFAULT_LOCALE\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":17,"raw_source":"def translate(name, vars = {})\n      interpolate(deep_fetch_translation(name), vars)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"translate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"optarg\",\"children\":[\"vars\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"interpolate\",{\"type\":\"send\",\"children\":[null,\"deep_fetch_translation\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvar\",\"children\":[\"vars\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":22,"raw_source":"def locale\n      @locale ||= YAML.load_file(@path)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"locale\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@locale\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load_file\",{\"type\":\"ivar\",\"children\":[\"@path\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":28,"raw_source":"def interpolate(name, vars)\n      name.gsub(/%\\{(\\w+)\\}/) do\n        # raise TranslationError, \"Undefined key #{$1} for interpolation in translation #{name}\"  unless vars[$1.to_sym]\n        (vars[Regexp.last_match(1).to_sym]).to_s\n      end\n    end","complexity_score":8.08,"ast_json":"{\"type\":\"def\",\"children\":[\"interpolate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"vars\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%\\\\{(\\\\w+)\\\\}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"vars\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"to_sym\"]}]}]},\"to_s\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":35,"raw_source":"def deep_fetch_translation(name)\n      name.split('.').reduce(locale) do |level, cur|\n        level[cur] || raise(TranslationError, \"Translation for #{name} does not exist in locale #{path}\")\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"deep_fetch_translation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"split\",{\"type\":\"str\",\"children\":[\".\"]}]},\"reduce\",{\"type\":\"send\",\"children\":[null,\"locale\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"level\"]},{\"type\":\"arg\",\"children\":[\"cur\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"level\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cur\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"TranslationError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Translation for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" does not exist in locale \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/interrupts.rb","start_line":8,"raw_source":"def initialize(message = nil)\n      @message = message || \"interrupt\"\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"message\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@message\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"interrupt\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/lexer.rb","start_line":103,"raw_source":"def tokenize(ss)\n        output = []\n\n        until ss.eos?\n          ss.skip(WHITESPACE_OR_NOTHING)\n\n          break if ss.eos?\n\n          start_pos = ss.pos\n          peeked = ss.peek_byte\n\n          if (special = SPECIAL_TABLE[peeked])\n            ss.scan_byte\n            # Special case for \"..\"\n            if special == DOT && ss.peek_byte == DOT_ORD\n              ss.scan_byte\n              output << DOTDOT\n            elsif special == DASH\n              # Special case for negative numbers\n              if (peeked_byte = ss.peek_byte) && NUMBER_TABLE[peeked_byte]\n                ss.pos -= 1\n                output << [:number, ss.scan(NUMBER_LITERAL)]\n              else\n                output << special\n              end\n            else\n              output << special\n            end\n          elsif (sub_table = TWO_CHARS_COMPARISON_JUMP_TABLE[peeked])\n            ss.scan_byte\n            if (peeked_byte = ss.peek_byte) && (found = sub_table[peeked_byte])\n              output << found\n              ss.scan_byte\n            else\n              raise_syntax_error(start_pos, ss)\n            end\n          elsif (sub_table = COMPARISON_JUMP_TABLE[peeked])\n            ss.scan_byte\n            if (peeked_byte = ss.peek_byte) && (found = sub_table[peeked_byte])\n              output << found\n              ss.scan_byte\n            else\n              output << SINGLE_COMPARISON_TOKENS[peeked]\n            end\n          else\n            type, pattern = NEXT_MATCHER_JUMP_TABLE[peeked]\n\n            if type && (t = ss.scan(pattern))\n              # Special case for \"contains\"\n              output << if type == :id && t == \"contains\" && output.last&.first != :dot\n                COMPARISON_CONTAINS\n              else\n                [type, t]\n              end\n            else\n              raise_syntax_error(start_pos, ss)\n            end\n          end\n        end\n        # rubocop:enable Metrics/BlockNesting\n        output << EOS\n      rescue ::ArgumentError => e\n        if e.message == \"invalid byte sequence in #{ss.string.encoding}\"\n          raise SyntaxError, \"Invalid byte sequence in #{ss.string.encoding}\"\n        else\n          raise\n        end\n      end","complexity_score":152.6,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ss\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"eos?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"skip\",{\"type\":\"const\",\"children\":[null,\"WHITESPACE_OR_NOTHING\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"eos?\"]},{\"type\":\"break\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"start_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]}]},{\"type\":\"lvasgn\",\"children\":[\"peeked\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"special\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SPECIAL_TABLE\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"special\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DOT_ORD\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"DOTDOT\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"special\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DASH\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"peeked_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NUMBER_TABLE\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked_byte\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"NUMBER_LITERAL\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"special\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"special\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sub_table\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TWO_CHARS_COMPARISON_JUMP_TABLE\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"peeked_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sub_table\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked_byte\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"found\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]},{\"type\":\"send\",\"children\":[null,\"raise_syntax_error\",{\"type\":\"lvar\",\"children\":[\"start_pos\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sub_table\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"COMPARISON_JUMP_TABLE\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"peeked_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sub_table\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked_byte\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"found\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SINGLE_COMPARISON_TOKENS\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type\"]},{\"type\":\"lvasgn\",\"children\":[\"pattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NEXT_MATCHER_JUMP_TABLE\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"peeked\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"==\",{\"type\":\"sym\",\"children\":[\"id\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"==\",{\"type\":\"str\",\"children\":[\"contains\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"last\"]},\"first\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"dot\"]}]}]},{\"type\":\"const\",\"children\":[null,\"COMPARISON_CONTAINS\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_syntax_error\",{\"type\":\"lvar\",\"children\":[\"start_pos\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"EOS\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]},\"==\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/lexer.rb","start_line":172,"raw_source":"def raise_syntax_error(start_pos, ss)\n        ss.pos = start_pos\n        # the character could be a UTF-8 character, use getch to get all the bytes\n        raise SyntaxError, \"Unexpected character #{ss.getch}\"\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_pos\"]},{\"type\":\"arg\",\"children\":[\"ss\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos=\",{\"type\":\"lvar\",\"children\":[\"start_pos\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected character \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"getch\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":8,"raw_source":"def initialize(options = Const::EMPTY_HASH)\n      @environment = options.fetch(:environment, Environment.default)\n      @template_options = options ? options.dup : {}\n\n      @locale   = @template_options[:locale] ||= I18n.new\n      @warnings = []\n\n      # constructing new StringScanner in Lexer, Tokenizer, etc is expensive\n      # This StringScanner will be shared by all of them\n      @string_scanner = StringScanner.new(\"\")\n\n      @expression_cache = if options[:expression_cache].nil?\n        {}\n      elsif options[:expression_cache].respond_to?(:[]) && options[:expression_cache].respond_to?(:[]=)\n        options[:expression_cache]\n      elsif options[:expression_cache]\n        {}\n      end\n\n      self.depth   = 0\n      self.partial = false\n    end","complexity_score":29.5,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_HASH\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_options\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"dup\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@locale\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@warnings\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@expression_cache\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"nil?\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},{\"type\":\"hash\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"depth=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"partial=\",{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":31,"raw_source":"def [](option_key)\n      @options[option_key]\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"option_key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"option_key\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":35,"raw_source":"def new_block_body\n      Liquid::BlockBody.new\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_block_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"BlockBody\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":39,"raw_source":"def new_parser(input)\n      @string_scanner.string = input\n      Parser.new(@string_scanner)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]},\"string=\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Parser\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":44,"raw_source":"def new_tokenizer(source, start_line_number: nil, for_liquid_tag: false)\n      Tokenizer.new(\n        source: source,\n        string_scanner: @string_scanner,\n        line_number: start_line_number,\n        for_liquid_tag: for_liquid_tag,\n      )\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_tokenizer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"kwoptarg\",\"children\":[\"start_line_number\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"for_liquid_tag\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"start_line_number\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"for_liquid_tag\"]},{\"type\":\"lvar\",\"children\":[\"for_liquid_tag\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":53,"raw_source":"def parse_expression(markup)\n      Expression.parse(markup, @string_scanner, @expression_cache)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]},{\"type\":\"ivar\",\"children\":[\"@expression_cache\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":57,"raw_source":"def partial=(value)\n      @partial = value\n      @options = value ? partial_options : @template_options\n\n      @error_mode = @options[:error_mode] || @environment.error_mode\n    end","complexity_score":8.3,"ast_json":"{\"type\":\"def\",\"children\":[\"partial=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@partial\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[null,\"partial_options\"]},{\"type\":\"ivar\",\"children\":[\"@template_options\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@error_mode\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"error_mode\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":64,"raw_source":"def partial_options\n      @partial_options ||= begin\n        dont_pass = @template_options[:include_options_blacklist]\n        if dont_pass == true\n          { locale: locale }\n        elsif dont_pass.is_a?(Array)\n          @template_options.reject { |k, _v| dont_pass.include?(k) }\n        else\n          @template_options\n        end\n      end\n    end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"partial_options\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@partial_options\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"dont_pass\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]},{\"type\":\"send\",\"children\":[null,\"locale\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"ivar\",\"children\":[\"@template_options\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":5,"raw_source":"def self.for(node, callbacks = Hash.new(proc {}))\n      if defined?(node.class::ParseTreeVisitor)\n        node.class::ParseTreeVisitor\n      else\n        self\n      end.new(node, callbacks)\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"optarg\",\"children\":[\"callbacks\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]},\"ParseTreeVisitor\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]},\"ParseTreeVisitor\"]},{\"type\":\"self\",\"children\":[]}]},\"new\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"lvar\",\"children\":[\"callbacks\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":13,"raw_source":"def initialize(node, callbacks)\n      @node      = node\n      @callbacks = callbacks\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"arg\",\"children\":[\"callbacks\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@node\",{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@callbacks\",{\"type\":\"lvar\",\"children\":[\"callbacks\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":18,"raw_source":"def add_callback_for(*classes, &block)\n      callback = block\n      callback = ->(node, _) { yield node } if block.arity.abs == 1\n      callback = ->(_, _) { yield } if block.arity.zero?\n      classes.each { |klass| @callbacks[klass] = callback }\n      self\n    end","complexity_score":19.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_callback_for\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"classes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"abs\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"yield\",\"children\":[]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"classes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"klass\"]},{\"type\":\"lvar\",\"children\":[\"callback\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":26,"raw_source":"def visit(context = nil)\n      children.map do |node|\n        item, new_context = @callbacks[node.class].call(node, context)\n        [\n          item,\n          ParseTreeVisitor.for(node, @callbacks).visit(new_context || context),\n        ]\n      end\n    end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"context\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"item\"]},{\"type\":\"lvasgn\",\"children\":[\"new_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"ivar\",\"children\":[\"@callbacks\"]}]},\"visit\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":38,"raw_source":"def children\n      @node.respond_to?(:nodelist) ? Array(@node.nodelist) : Const::EMPTY_ARRAY\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"nodelist\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":5,"raw_source":"def initialize(input)\n      ss = input.is_a?(StringScanner) ? input : StringScanner.new(input)\n      @tokens = Lexer.tokenize(ss)\n      @p      = 0 # pointer to current location\n    end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ss\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"StringScanner\"]}]},{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Lexer\"]},\"tokenize\",{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@p\",{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":11,"raw_source":"def jump(point)\n      @p = point\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"jump\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"point\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@p\",{\"type\":\"lvar\",\"children\":[\"point\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":15,"raw_source":"def consume(type = nil)\n      token = @tokens[@p]\n      if type && token[0] != type\n        raise SyntaxError, \"Expected #{type} but found #{@tokens[@p].first}\"\n      end\n      @p += 1\n      token[1]\n    end","complexity_score":14.9,"ast_json":"{\"type\":\"def\",\"children\":[\"consume\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"type\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"!=\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\" but found \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]},\"first\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":27,"raw_source":"def consume?(type)\n      token = @tokens[@p]\n      return false unless token && token[0] == type\n      @p += 1\n      token[1]\n    end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"consume?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":35,"raw_source":"def id?(str)\n      token = @tokens[@p]\n      return false unless token && token[0] == :id\n      return false unless token[1] == str\n      @p += 1\n      token[1]\n    end","complexity_score":13.55,"ast_json":"{\"type\":\"def\",\"children\":[\"id?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"str\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":43,"raw_source":"def look(type, ahead = 0)\n      tok = @tokens[@p + ahead]\n      return false unless tok\n      tok[0] == type\n    end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"look\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"ahead\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tok\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@p\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"ahead\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tok\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tok\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":49,"raw_source":"def expression\n      token = @tokens[@p]\n      case token[0]\n      when :id\n        str = consume\n        str << variable_lookups\n      when :open_square\n        str = consume.dup\n        str << expression\n        str << consume(:close_square)\n        str << variable_lookups\n      when :string, :number\n        consume\n      when :open_round\n        consume\n        first = expression\n        consume(:dotdot)\n        last = expression\n        consume(:close_round)\n        \"(#{first}..#{last})\"\n      else\n        raise SyntaxError, \"#{token} is not a valid expression\"\n      end\n    end","complexity_score":35.7,"ast_json":"{\"type\":\"def\",\"children\":[\"expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"id\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"variable_lookups\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"open_square\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"consume\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_square\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"variable_lookups\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"string\"]},{\"type\":\"sym\",\"children\":[\"number\"]},{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"open_round\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"consume\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"dotdot\"]}]},{\"type\":\"lvasgn\",\"children\":[\"last\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_round\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]}]},{\"type\":\"str\",\"children\":[\"..\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"str\",\"children\":[\" is not a valid expression\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":74,"raw_source":"def argument\n      str = +\"\"\n      # might be a keyword argument (identifier: expression)\n      if look(:id) && look(:colon, 1)\n        str << consume << consume << ' '\n      end\n\n      str << expression\n      str\n    end","complexity_score":15.83,"ast_json":"{\"type\":\"def\",\"children\":[\"argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]},{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"colon\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":85,"raw_source":"def variable_lookups\n      str = +\"\"\n      loop do\n        if look(:open_square)\n          str << consume\n          str << expression\n          str << consume(:close_square)\n        elsif look(:dot)\n          str << consume\n          str << consume(:id)\n        else\n          break\n        end\n      end\n      str\n    end","complexity_score":23.0,"ast_json":"{\"type\":\"def\",\"children\":[\"variable_lookups\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"open_square\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_square\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"dot\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]}]},{\"type\":\"break\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":5,"raw_source":"def strict_parse_with_error_mode_fallback(markup)\n      strict_parse_with_error_context(markup)\n    rescue SyntaxError => e\n      case parse_context.error_mode\n      when :strict\n        raise\n      when :warn\n        parse_context.warnings << e\n      end\n      lax_parse(markup)\n    end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse_with_error_mode_fallback\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"error_mode\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict\"]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"warnings\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":17,"raw_source":"def parse_with_selected_parser(markup)\n      case parse_context.error_mode\n      when :strict then strict_parse_with_error_context(markup)\n      when :lax    then lax_parse(markup)\n      when :warn\n        begin\n          strict_parse_with_error_context(markup)\n        rescue SyntaxError => e\n          parse_context.warnings << e\n          lax_parse(markup)\n        end\n      end\n    end","complexity_score":18.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_with_selected_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"error_mode\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict\"]},{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"lax\"]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"warnings\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},null]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":33,"raw_source":"def strict_parse_with_error_context(markup)\n      strict_parse(markup)\n    rescue SyntaxError => e\n      e.line_number    = line_number\n      e.markup_context = markup_context(markup)\n      raise e\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse_with_error_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number=\",{\"type\":\"send\",\"children\":[null,\"line_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"markup_context=\",{\"type\":\"send\",\"children\":[null,\"markup_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":41,"raw_source":"def markup_context(markup)\n      \"in \\\"#{markup.strip}\\\"\"\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markup_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"in \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]},{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/partial_cache.rb","start_line":5,"raw_source":"def self.load(template_name, context:, parse_context:)\n      cached_partials = context.registers[:cached_partials]\n      cache_key = \"#{template_name}:#{parse_context.error_mode}\"\n      cached = cached_partials[cache_key]\n      return cached if cached\n\n      file_system = context.registers[:file_system]\n      source      = file_system.read_template_file(template_name)\n\n      parse_context.partial = true\n\n      template_factory = context.registers[:template_factory]\n      template = template_factory.for(template_name)\n\n      begin\n        partial = template.parse(source, parse_context)\n      rescue Liquid::Error => e\n        e.template_name = template&.name || template_name\n        raise e\n      end\n\n      partial.name ||= template_name\n\n      cached_partials[cache_key] = partial\n    ensure\n      parse_context.partial = false\n    end","complexity_score":33.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"load\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"kwarg\",\"children\":[\"context\"]},{\"type\":\"kwarg\",\"children\":[\"parse_context\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cached_partials\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cache_key\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"error_mode\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cached\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached_partials\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cache_key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"file_system\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"read_template_file\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_factory\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_factory\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"template_name=\",{\"type\":\"or\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached_partials\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"cache_key\"]},{\"type\":\"lvar\",\"children\":[\"partial\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"partial=\",{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":54,"raw_source":"def initialize(code: nil, template_name: nil, line_number: nil)\n        @code = code\n        @template_name = template_name\n        @line_number = line_number\n        @children = []\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"code\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"template_name\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@code\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@children\",{\"type\":\"array\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":61,"raw_source":"def self_time\n        @self_time ||= begin\n          total_children_time = 0.0\n          @children.each do |child|\n            total_children_time += child.total_time\n          end\n          @total_time - total_children_time\n        end\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"self_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@self_time\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"total_children_time\",{\"type\":\"float\",\"children\":[0.0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"total_children_time\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"total_time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@total_time\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"total_children_time\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":75,"raw_source":"def initialize\n      @root_children = []\n      @current_children = nil\n      @total_time = 0.0\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@root_children\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@total_time\",{\"type\":\"float\",\"children\":[0.0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":81,"raw_source":"def profile(template_name, &block)\n      # nested renders are done from a tag that already has a timing node\n      return yield if @current_children\n\n      root_children = @root_children\n      render_idx = root_children.length\n      begin\n        @current_children = root_children\n        profile_node(template_name, &block)\n      ensure\n        @current_children = nil\n        if (timing = root_children[render_idx])\n          @total_time += timing.total_time\n        end\n      end\n    end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"profile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_children\"]},{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"root_children\",{\"type\":\"ivar\",\"children\":[\"@root_children\"]}]},{\"type\":\"lvasgn\",\"children\":[\"render_idx\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"root_children\"]},\"length\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"lvar\",\"children\":[\"root_children\"]}]},{\"type\":\"send\",\"children\":[null,\"profile_node\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"root_children\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"render_idx\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@total_time\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"total_time\"]}]},null]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":98,"raw_source":"def children\n      children = @root_children\n      if children.length == 1\n        children.first.children\n      else\n        children\n      end\n    end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"children\",{\"type\":\"ivar\",\"children\":[\"@root_children\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"length\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"first\"]},\"children\"]},{\"type\":\"lvar\",\"children\":[\"children\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":107,"raw_source":"def each(&block)\n      children.each(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":111,"raw_source":"def [](idx)\n      children[idx]\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"idx\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"idx\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":115,"raw_source":"def length\n      children.length\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"length\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"length\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":119,"raw_source":"def profile_node(template_name, code: nil, line_number: nil)\n      timing = Timing.new(code: code, template_name: template_name, line_number: line_number)\n      parent_children = @current_children\n      start_time = monotonic_time\n      begin\n        @current_children = timing.children\n        yield\n      ensure\n        @current_children = parent_children\n        timing.total_time = monotonic_time - start_time\n        parent_children << timing\n      end\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"profile_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"kwoptarg\",\"children\":[\"code\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timing\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parent_children\",{\"type\":\"ivar\",\"children\":[\"@current_children\"]}]},{\"type\":\"lvasgn\",\"children\":[\"start_time\",{\"type\":\"send\",\"children\":[null,\"monotonic_time\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"children\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"lvar\",\"children\":[\"parent_children\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"total_time=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"monotonic_time\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start_time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parent_children\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"timing\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":135,"raw_source":"def monotonic_time\n      Process.clock_gettime(Process::CLOCK_MONOTONIC)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"monotonic_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"clock_gettime\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"CLOCK_MONOTONIC\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":5,"raw_source":"def render_node(context, output, node)\n      if (profiler = context.profiler)\n        profiler.profile_node(context.template_name, code: node.raw, line_number: node.line_number) do\n          super\n        end\n      else\n        super\n      end\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"profile_node\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"raw\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"line_number\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":18,"raw_source":"def render_to_output_buffer(context, output)\n      return super unless context.profiler\n      context.profiler.profile(context.template_name) { super }\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"profile\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":28,"raw_source":"def new_isolated_subcontext\n      new_context = super\n      new_context.profiler = profiler\n      new_context\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_isolated_subcontext\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"new_context\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_context\"]},\"profiler=\",{\"type\":\"send\",\"children\":[null,\"profiler\"]}]},{\"type\":\"lvar\",\"children\":[\"new_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":5,"raw_source":"def self.parse(start_markup, end_markup, string_scanner, cache = nil)\n      start_obj = Expression.parse(start_markup, string_scanner, cache)\n      end_obj   = Expression.parse(end_markup, string_scanner, cache)\n      if start_obj.respond_to?(:evaluate) || end_obj.respond_to?(:evaluate)\n        new(start_obj, end_obj)\n      else\n        begin\n          start_obj.to_i..end_obj.to_i\n        rescue NoMethodError\n          invalid_expr = start_markup unless start_obj.respond_to?(:to_i)\n          invalid_expr ||= end_markup unless end_obj.respond_to?(:to_i)\n          if invalid_expr\n            raise Liquid::SyntaxError, \"Invalid expression type '#{invalid_expr}' in range expression\"\n          end\n\n          raise\n        end\n      end\n    end","complexity_score":24.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_markup\"]},{\"type\":\"arg\",\"children\":[\"end_markup\"]},{\"type\":\"arg\",\"children\":[\"string_scanner\"]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start_obj\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"start_markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"end_obj\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"end_markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"start_obj\"]},{\"type\":\"lvar\",\"children\":[\"end_obj\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"to_i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"to_i\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_i\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"invalid_expr\",{\"type\":\"lvar\",\"children\":[\"start_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_i\"]}]},null,{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"invalid_expr\"]},{\"type\":\"lvar\",\"children\":[\"end_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invalid_expr\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid expression type '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invalid_expr\"]}]},{\"type\":\"str\",\"children\":[\"' in range expression\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":27,"raw_source":"def initialize(start_obj, end_obj)\n      @start_obj = start_obj\n      @end_obj   = end_obj\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_obj\"]},{\"type\":\"arg\",\"children\":[\"end_obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@start_obj\",{\"type\":\"lvar\",\"children\":[\"start_obj\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@end_obj\",{\"type\":\"lvar\",\"children\":[\"end_obj\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":32,"raw_source":"def evaluate(context)\n      start_int = to_integer(context.evaluate(@start_obj))\n      end_int   = to_integer(context.evaluate(@end_obj))\n      start_int..end_int\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start_int\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@start_obj\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"end_int\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@end_obj\"]}]}]}]},{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_int\"]},{\"type\":\"lvar\",\"children\":[\"end_int\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":40,"raw_source":"def to_integer(input)\n      case input\n      when Integer\n        input\n      when NilClass, String\n        input.to_i\n      else\n        Utils.to_integer(input)\n      end\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NilClass\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":52,"raw_source":"def children\n        [@node.start_obj, @node.end_obj]\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"start_obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"end_obj\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":7,"raw_source":"def initialize(registers = {})\n      @static = registers.is_a?(Registers) ? registers.static : registers\n      @changes = {}\n    end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@static\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Registers\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"static\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@changes\",{\"type\":\"hash\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":12,"raw_source":"def []=(key, value)\n      @changes[key] = value\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":16,"raw_source":"def [](key)\n      if @changes.key?(key)\n        @changes[key]\n      else\n        @static[key]\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":24,"raw_source":"def delete(key)\n      @changes.delete(key)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":30,"raw_source":"def fetch(key, default = UNDEFINED, &block)\n      if @changes.key?(key)\n        @changes.fetch(key)\n      elsif default != UNDEFINED\n        if block_given?\n          @static.fetch(key, &block)\n        else\n          @static.fetch(key, default)\n        end\n      else\n        @static.fetch(key, &block)\n      end\n    end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"default\",{\"type\":\"const\",\"children\":[null,\"UNDEFINED\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"default\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"UNDEFINED\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":44,"raw_source":"def key?(key)\n      @changes.key?(key) || @static.key?(key)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":8,"raw_source":"def initialize(limits)\n      @render_length_limit = limits[:render_length_limit]\n      @render_score_limit  = limits[:render_score_limit]\n      @assign_score_limit  = limits[:assign_score_limit]\n      reset\n    end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"limits\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@render_length_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"render_length_limit\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@render_score_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"render_score_limit\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@assign_score_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assign_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"reset\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":15,"raw_source":"def increment_render_score(amount)\n      @render_score += amount\n      raise_limits_reached if @render_score_limit && @render_score > @render_score_limit\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_render_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@render_score\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_score_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_score\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@render_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":20,"raw_source":"def increment_assign_score(amount)\n      @assign_score += amount\n      raise_limits_reached if @assign_score_limit && @assign_score > @assign_score_limit\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_assign_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@assign_score\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@assign_score_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@assign_score\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@assign_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":26,"raw_source":"def increment_write_score(output)\n      if (last_captured = @last_capture_length)\n        captured = output.bytesize\n        increment = captured - last_captured\n        @last_capture_length = captured\n        increment_assign_score(increment)\n      elsif @render_length_limit && output.bytesize > @render_length_limit\n        raise_limits_reached\n      end\n    end","complexity_score":15.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_write_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"last_captured\",{\"type\":\"ivar\",\"children\":[\"@last_capture_length\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"captured\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"bytesize\"]}]},{\"type\":\"lvasgn\",\"children\":[\"increment\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captured\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"last_captured\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"lvar\",\"children\":[\"captured\"]}]},{\"type\":\"send\",\"children\":[null,\"increment_assign_score\",{\"type\":\"lvar\",\"children\":[\"increment\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_length_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"bytesize\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@render_length_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":37,"raw_source":"def raise_limits_reached\n      @reached_limit = true\n      raise MemoryError, \"Memory limits exceeded\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_limits_reached\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reached_limit\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"MemoryError\"]},{\"type\":\"str\",\"children\":[\"Memory limits exceeded\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":42,"raw_source":"def reached?\n      @reached_limit\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"reached?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@reached_limit\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":46,"raw_source":"def reset\n      @reached_limit = false\n      @last_capture_length = nil\n      @render_score = @assign_score = 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"reset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reached_limit\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@render_score\",{\"type\":\"ivasgn\",\"children\":[\"@assign_score\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":52,"raw_source":"def with_capture\n      old_capture_length = @last_capture_length\n      begin\n        @last_capture_length = 0\n        yield\n      ensure\n        @last_capture_length = old_capture_length\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"with_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_capture_length\",{\"type\":\"ivar\",\"children\":[\"@last_capture_length\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"lvar\",\"children\":[\"old_capture_length\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":32,"raw_source":"def try_coerce_encoding(input, encoding:)\n        original_encoding = input.encoding\n        if input.encoding != encoding\n          input.force_encoding(encoding)\n          unless input.valid_encoding?\n            input.force_encoding(original_encoding)\n          end\n        end\n        input\n      end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"try_coerce_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"kwarg\",\"children\":[\"encoding\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]},\"!=\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"original_encoding\"]}]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":54,"raw_source":"def size(input)\n      input.respond_to?(:size) ? input.size : 0\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"size\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"size\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"size\"]},{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":65,"raw_source":"def downcase(input)\n      Utils.to_s(input).downcase\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"downcase\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"downcase\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":76,"raw_source":"def upcase(input)\n      Utils.to_s(input).upcase\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"upcase\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"upcase\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":87,"raw_source":"def capitalize(input)\n      Utils.to_s(input).capitalize\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"capitalize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"capitalize\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":98,"raw_source":"def escape(input)\n      CGI.escapeHTML(Utils.to_s(input)) unless input.nil?\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"escape\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"escapeHTML\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":110,"raw_source":"def escape_once(input)\n      Utils.to_s(input).gsub(HTML_ESCAPE_ONCE_REGEXP, HTML_ESCAPE)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_once\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"gsub\",{\"type\":\"const\",\"children\":[null,\"HTML_ESCAPE_ONCE_REGEXP\"]},{\"type\":\"const\",\"children\":[null,\"HTML_ESCAPE\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":125,"raw_source":"def url_encode(input)\n      CGI.escape(Utils.to_s(input)) unless input.nil?\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"url_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"escape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":137,"raw_source":"def url_decode(input)\n      return if input.nil?\n\n      result = CGI.unescape(Utils.to_s(input))\n      raise Liquid::ArgumentError, \"invalid byte sequence in #{result.encoding}\" unless result.valid_encoding?\n\n      result\n    end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"url_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"unescape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"encoding\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":153,"raw_source":"def base64_encode(input)\n      Base64.strict_encode64(Utils.to_s(input))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"strict_encode64\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":164,"raw_source":"def base64_decode(input)\n      input = Utils.to_s(input)\n      StandardFilters.try_coerce_encoding(Base64.strict_decode64(input), encoding: input.encoding)\n    rescue ::ArgumentError\n      raise Liquid::ArgumentError, \"invalid base64 provided to base64_decode\"\n    end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"try_coerce_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"strict_decode64\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"encoding\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid base64 provided to base64_decode\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":178,"raw_source":"def base64_url_safe_encode(input)\n      Base64.urlsafe_encode64(Utils.to_s(input))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_url_safe_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_encode64\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":189,"raw_source":"def base64_url_safe_decode(input)\n      input = Utils.to_s(input)\n      StandardFilters.try_coerce_encoding(Base64.urlsafe_decode64(input), encoding: input.encoding)\n    rescue ::ArgumentError\n      raise Liquid::ArgumentError, \"invalid base64 provided to base64_url_safe_decode\"\n    end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_url_safe_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"try_coerce_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_decode64\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"encoding\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid base64 provided to base64_url_safe_decode\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":206,"raw_source":"def slice(input, offset, length = nil)\n      offset = Utils.to_integer(offset)\n      length = length ? Utils.to_integer(length) : 1\n\n      begin\n        if input.is_a?(Array)\n          input.slice(offset, length) || []\n        else\n          Utils.to_s(input).slice(offset, length) || ''\n        end\n      rescue RangeError\n        if I64_RANGE.cover?(length) && I64_RANGE.cover?(offset)\n          raise # unexpected error\n        end\n        offset = offset.clamp(I64_RANGE)\n        length = length.clamp(I64_RANGE)\n        retry\n      end\n    end","complexity_score":26.28,"ast_json":"{\"type\":\"def\",\"children\":[\"slice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"offset\"]},{\"type\":\"optarg\",\"children\":[\"length\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"offset\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"offset\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"offset\"]},{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"slice\",{\"type\":\"lvar\",\"children\":[\"offset\"]},{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]},\"cover?\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]},\"cover?\",{\"type\":\"lvar\",\"children\":[\"offset\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]},null]},{\"type\":\"lvasgn\",\"children\":[\"offset\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offset\"]},\"clamp\",{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},\"clamp\",{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]}]}]},{\"type\":\"retry\",\"children\":[]}]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":236,"raw_source":"def truncate(input, length = 50, truncate_string = \"...\")\n      return if input.nil?\n      input_str = Utils.to_s(input)\n      length    = Utils.to_integer(length)\n\n      truncate_string_str = Utils.to_s(truncate_string)\n\n      l = length - truncate_string_str.length\n      l = 0 if l < 0\n\n      input_str.length > length ? input_str[0...l].concat(truncate_string_str) : input_str\n    end","complexity_score":22.15,"ast_json":"{\"type\":\"def\",\"children\":[\"truncate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"length\",{\"type\":\"int\",\"children\":[50]}]},{\"type\":\"optarg\",\"children\":[\"truncate_string\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"input_str\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"length\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"truncate_string_str\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"truncate_string_str\"]},\"length\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input_str\"]},\"length\"]},\">\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input_str\"]},\"[]\",{\"type\":\"erange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"l\"]}]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"truncate_string_str\"]}]},{\"type\":\"lvar\",\"children\":[\"input_str\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":263,"raw_source":"def truncatewords(input, words = 15, truncate_string = \"...\")\n      return if input.nil?\n      input = Utils.to_s(input)\n      words = Utils.to_integer(words)\n      words = 1 if words <= 0\n\n      wordlist = begin\n        input.split(\" \", words + 1)\n      rescue RangeError\n        # integer too big for String#split, but we can semantically assume no truncation is needed\n        return input if words + 1 > MAX_I32\n        raise # unexpected error\n      end\n      return input if wordlist.length <= words\n\n      wordlist.pop\n      truncate_string = Utils.to_s(truncate_string)\n      wordlist.join(\" \").concat(truncate_string)\n    end","complexity_score":29.78,"ast_json":"{\"type\":\"def\",\"children\":[\"truncatewords\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"words\",{\"type\":\"int\",\"children\":[15]}]},{\"type\":\"optarg\",\"children\":[\"truncate_string\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"words\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"words\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"<=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"words\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"wordlist\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"split\",{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},\">\",{\"type\":\"const\",\"children\":[null,\"MAX_I32\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"length\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"words\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"pop\"]},{\"type\":\"lvasgn\",\"children\":[\"truncate_string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":290,"raw_source":"def split(input, pattern)\n      pattern = Utils.to_s(pattern)\n      input = Utils.to_s(input)\n      input.split(pattern)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"split\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"split\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":303,"raw_source":"def strip(input)\n      input = Utils.to_s(input)\n      input.strip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"strip\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":315,"raw_source":"def lstrip(input)\n      input = Utils.to_s(input)\n      input.lstrip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lstrip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"lstrip\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":327,"raw_source":"def rstrip(input)\n      input = Utils.to_s(input)\n      input.rstrip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rstrip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"rstrip\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":339,"raw_source":"def strip_html(input)\n      input = Utils.to_s(input)\n      empty  = ''\n      result = input.gsub(STRIP_HTML_BLOCKS, empty)\n      result.gsub!(STRIP_HTML_TAGS, empty)\n      result\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip_html\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"empty\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"const\",\"children\":[null,\"STRIP_HTML_BLOCKS\"]},{\"type\":\"lvar\",\"children\":[\"empty\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"const\",\"children\":[null,\"STRIP_HTML_TAGS\"]},{\"type\":\"lvar\",\"children\":[\"empty\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":354,"raw_source":"def strip_newlines(input)\n      input = Utils.to_s(input)\n      input.gsub(/\\r?\\n/, '')\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip_newlines\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\r?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":366,"raw_source":"def join(input, glue = ' ')\n      glue = Utils.to_s(glue)\n      InputIterator.new(input, context).join(glue)\n    end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"join\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"glue\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"glue\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"join\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":378,"raw_source":"def sort(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      return [] if ary.empty?\n\n      if property.nil?\n        ary.sort do |a, b|\n          nil_safe_compare(a, b)\n        end\n      elsif ary.all? { |el| el.respond_to?(:[]) }\n        begin\n          ary.sort { |a, b| nil_safe_compare(a[property], b[property]) }\n        rescue TypeError\n          raise_property_error(property)\n        end\n      end\n    end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"sort\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_compare\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_compare\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":407,"raw_source":"def sort_natural(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      return [] if ary.empty?\n\n      if property.nil?\n        ary.sort do |a, b|\n          nil_safe_casecmp(a, b)\n        end\n      elsif ary.all? { |el| el.respond_to?(:[]) }\n        begin\n          ary.sort { |a, b| nil_safe_casecmp(a[property], b[property]) }\n        rescue TypeError\n          raise_property_error(property)\n        end\n      end\n    end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"sort_natural\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_casecmp\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_casecmp\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":434,"raw_source":"def where(input, property, target_value = nil)\n      filter_array(input, property, target_value) { |ary, &block| ary.select(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"where\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"select\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":447,"raw_source":"def reject(input, property, target_value = nil)\n      filter_array(input, property, target_value) { |ary, &block| ary.reject(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reject\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":460,"raw_source":"def has(input, property, target_value = nil)\n      filter_array(input, property, target_value, false) { |ary, &block| ary.any?(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"has\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"any?\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":473,"raw_source":"def find(input, property, target_value = nil)\n      filter_array(input, property, target_value, nil) { |ary, &block| ary.find(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"find\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":486,"raw_source":"def find_index(input, property, target_value = nil)\n      filter_array(input, property, target_value, nil) { |ary, &block| ary.find_index(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find_index\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"find_index\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":497,"raw_source":"def uniq(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      if property.nil?\n        ary.uniq\n      elsif ary.empty? # The next two cases assume a non-empty array.\n        []\n      else\n        ary.uniq do |item|\n          item[property]\n        rescue TypeError\n          raise_property_error(property)\n        rescue NoMethodError\n          return nil unless item.respond_to?(:[])\n          raise\n        end\n      end\n    end","complexity_score":20.2,"ast_json":"{\"type\":\"def\",\"children\":[\"uniq\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"uniq\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"uniq\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":523,"raw_source":"def reverse(input)\n      ary = InputIterator.new(input, context)\n      ary.reverse\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"reverse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reverse\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":535,"raw_source":"def map(input, property)\n      InputIterator.new(input, context).map do |e|\n        e = e.call if e.is_a?(Proc)\n\n        if property == \"to_liquid\"\n          e\n        elsif e.respond_to?(:[])\n          r = e[property]\n          r.is_a?(Proc) ? r.call : r\n        end\n      end\n    rescue TypeError\n      raise_property_error(property)\n    end","complexity_score":26.0,"ast_json":"{\"type\":\"def\",\"children\":[\"map\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"call\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"==\",{\"type\":\"str\",\"children\":[\"to_liquid\"]}]},{\"type\":\"lvar\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"call\"]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},null]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":557,"raw_source":"def compact(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      if property.nil?\n        ary.compact\n      elsif ary.empty? # The next two cases assume a non-empty array.\n        []\n      else\n        ary.reject do |item|\n          item[property].nil?\n        rescue TypeError\n          raise_property_error(property)\n        rescue NoMethodError\n          return nil unless item.respond_to?(:[])\n          raise\n        end\n      end\n    end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"compact\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},\"nil?\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":583,"raw_source":"def replace(input, string, replacement = '')\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n      input = Utils.to_s(input)\n      input.gsub(string, replacement)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"optarg\",\"children\":[\"replacement\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":597,"raw_source":"def replace_first(input, string, replacement = '')\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n      input = Utils.to_s(input)\n      input.sub(string, replacement)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace_first\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"optarg\",\"children\":[\"replacement\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"sub\",{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":611,"raw_source":"def replace_last(input, string, replacement)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n\n      start_index = input.rindex(string)\n\n      return input unless start_index\n\n      output = input.dup\n      output[start_index, string.length] = replacement\n      output\n    end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace_last\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"arg\",\"children\":[\"replacement\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"start_index\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"rindex\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_index\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"start_index\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"length\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":632,"raw_source":"def remove(input, string)\n      replace(input, string, '')\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"remove\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[null,\"replace\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":643,"raw_source":"def remove_first(input, string)\n      replace_first(input, string, '')\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_first\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[null,\"replace_first\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":654,"raw_source":"def remove_last(input, string)\n      replace_last(input, string, '')\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_last\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[null,\"replace_last\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":665,"raw_source":"def append(input, string)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      input + string\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"append\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":682,"raw_source":"def concat(input, array)\n      unless array.respond_to?(:to_ary)\n        raise ArgumentError, \"concat filter requires an array argument\"\n      end\n      InputIterator.new(input, context).concat(array)\n    end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"concat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_ary\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"concat filter requires an array argument\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":696,"raw_source":"def prepend(input, string)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      string + input\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prepend\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":709,"raw_source":"def newline_to_br(input)\n      input = Utils.to_s(input)\n      input.gsub(/\\r?\\n/, \"<br />\\n\")\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"newline_to_br\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\r?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"<br />\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":754,"raw_source":"def date(input, format)\n      str_format = Utils.to_s(format)\n      return input if str_format.empty?\n\n      return input unless (date = Utils.to_date(input))\n\n      date.strftime(str_format)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"date\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"format\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str_format\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"format\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str_format\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_date\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"date\"]},\"strftime\",{\"type\":\"lvar\",\"children\":[\"str_format\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":770,"raw_source":"def first(array)\n      array.first if array.respond_to?(:first)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"first\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"first\"]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":781,"raw_source":"def last(array)\n      array.last if array.respond_to?(:last)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"last\"]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":792,"raw_source":"def abs(input)\n      result = Utils.to_number(input).abs\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"abs\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"abs\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":804,"raw_source":"def plus(input, operand)\n      apply_operation(input, operand, :+)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"plus\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"+\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":815,"raw_source":"def minus(input, operand)\n      apply_operation(input, operand, :-)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"minus\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"-\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":826,"raw_source":"def times(input, operand)\n      apply_operation(input, operand, :*)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"times\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"*\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":837,"raw_source":"def divided_by(input, operand)\n      apply_operation(input, operand, :/)\n    rescue ::ZeroDivisionError => e\n      raise Liquid::ZeroDivisionError, e.message\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"divided_by\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"/\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ZeroDivisionError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":850,"raw_source":"def modulo(input, operand)\n      apply_operation(input, operand, :%)\n    rescue ::ZeroDivisionError => e\n      raise Liquid::ZeroDivisionError, e.message\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"modulo\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"%\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ZeroDivisionError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":863,"raw_source":"def round(input, n = 0)\n      result = Utils.to_number(input).round(Utils.to_number(n))\n      result = result.to_f if result.is_a?(BigDecimal)\n      result = result.to_i if n == 0\n      result\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"round\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"n\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"round\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_i\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":879,"raw_source":"def ceil(input)\n      Utils.to_number(input).ceil.to_i\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"ceil\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"ceil\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":892,"raw_source":"def floor(input)\n      Utils.to_number(input).floor.to_i\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"floor\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"floor\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":905,"raw_source":"def at_least(input, n)\n      min_value = Utils.to_number(n)\n\n      result = Utils.to_number(input)\n      result = min_value if min_value > result\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"at_least\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"min_value\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"min_value\"]},\">\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"lvar\",\"children\":[\"min_value\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":920,"raw_source":"def at_most(input, n)\n      max_value = Utils.to_number(n)\n\n      result = Utils.to_number(input)\n      result = max_value if max_value < result\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"at_most\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"max_value\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"max_value\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"lvar\",\"children\":[\"max_value\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":940,"raw_source":"def default(input, default_value = '', options = {})\n      options = {} unless options.is_a?(Hash)\n      false_check = options['allow_false'] ? input.nil? : !Liquid::Utils.to_liquid_value(input)\n      false_check || (input.respond_to?(:empty?) && input.empty?) ? default_value : input\n    end","complexity_score":17.1,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"default_value\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"false_check\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"str\",\"children\":[\"allow_false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"!\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"false_check\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"empty?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"empty?\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"default_value\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":953,"raw_source":"def sum(input, property = nil)\n      ary = InputIterator.new(input, context)\n      return 0 if ary.empty?\n\n      values_for_sum = ary.map do |item|\n        if property.nil?\n          item\n        elsif item.respond_to?(:[])\n          item[property]\n        else\n          0\n        end\n      rescue TypeError\n        raise_property_error(property)\n      end\n\n      result = InputIterator.new(values_for_sum, context).sum do |item|\n        Utils.to_number(item)\n      end\n\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":27.7,"ast_json":"{\"type\":\"def\",\"children\":[\"sum\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"values_for_sum\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"item\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"values_for_sum\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"sum\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":980,"raw_source":"def filter_array(input, property, target_value, default_value = [], &block)\n      ary = InputIterator.new(input, context)\n\n      return default_value if ary.empty?\n\n      block.call(ary) do |item|\n        if target_value.nil?\n          item[property]\n        else\n          item[property] == target_value\n        end\n      rescue TypeError\n        raise_property_error(property)\n      rescue NoMethodError\n        return nil unless item.respond_to?(:[])\n        raise\n      end\n    end","complexity_score":20.6,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_array\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"arg\",\"children\":[\"target_value\"]},{\"type\":\"optarg\",\"children\":[\"default_value\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"default_value\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"ary\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target_value\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"target_value\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":999,"raw_source":"def raise_property_error(property)\n      raise Liquid::ArgumentError, \"cannot select the property '#{Utils.to_s(property)}'\"\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_property_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"cannot select the property '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1003,"raw_source":"def apply_operation(input, operand, operation)\n      result = Utils.to_number(input).send(operation, Utils.to_number(operand))\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_operation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]},{\"type\":\"arg\",\"children\":[\"operation\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"send\",{\"type\":\"lvar\",\"children\":[\"operation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"operand\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1008,"raw_source":"def nil_safe_compare(a, b)\n      result = a <=> b\n\n      if result\n        result\n      elsif a.nil?\n        1\n      elsif b.nil?\n        -1\n      else\n        raise Liquid::ArgumentError, \"cannot sort values of incompatible types\"\n      end\n    end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nil_safe_compare\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"<=>\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[-1]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot sort values of incompatible types\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1022,"raw_source":"def nil_safe_casecmp(a, b)\n      if !a.nil? && !b.nil?\n        a.to_s.casecmp(b.to_s)\n      elsif a.nil? && b.nil?\n        0\n      else\n        a.nil? ? 1 : -1\n      end\n    end","complexity_score":17.83,"ast_json":"{\"type\":\"def\",\"children\":[\"nil_safe_casecmp\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_s\"]},\"casecmp\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]}]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1035,"raw_source":"def initialize(input, context)\n        @context = context\n        @input   = if input.is_a?(Array)\n          input.flatten\n        elsif input.is_a?(Hash)\n          [input]\n        elsif input.is_a?(Enumerable)\n          input\n        else\n          Array(input)\n        end\n      end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@input\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"flatten\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Enumerable\"]}]},{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1048,"raw_source":"def join(glue)\n        first = true\n        output = +\"\"\n        each do |item|\n          if first\n            first = false\n          else\n            output << glue\n          end\n\n          output << Liquid::Utils.to_s(item)\n        end\n        output\n      end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"join\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"glue\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1063,"raw_source":"def concat(args)\n        to_a.concat(args)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"concat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"concat\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1067,"raw_source":"def reverse\n        reverse_each.to_a\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"reverse\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"reverse_each\"]},\"to_a\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1071,"raw_source":"def uniq(&block)\n        to_a.uniq do |item|\n          item = Utils.to_liquid_value(item)\n          block ? yield(item) : item\n        end\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"uniq\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"uniq\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"item\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1078,"raw_source":"def compact\n        to_a.compact\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1082,"raw_source":"def empty?\n        @input.each { return false }\n        true\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"empty?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@input\"]},\"each\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1087,"raw_source":"def each\n        @input.each do |e|\n          e = e.respond_to?(:to_liquid) ? e.to_liquid : e\n          e.context = @context if e.respond_to?(:context=)\n          yield(e)\n        end\n      end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@input\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_liquid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"to_liquid\"]},{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"context=\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},null]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":12,"raw_source":"def initialize(context)\n      @context = context\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":17,"raw_source":"def add_filter(filter)\n        return if include?(filter)\n\n        invokable_non_public_methods = (filter.private_instance_methods + filter.protected_instance_methods).select { |m| invokable?(m) }\n        if invokable_non_public_methods.any?\n          raise MethodOverrideError, \"Filter overrides registered public methods as non public: #{invokable_non_public_methods.join(', ')}\"\n        end\n\n        include(filter)\n\n        filter_methods.merge(filter.public_instance_methods.map(&:to_s))\n      end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"invokable_non_public_methods\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"private_instance_methods\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"protected_instance_methods\"]}]}]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[null,\"invokable?\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invokable_non_public_methods\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"MethodOverrideError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Filter overrides registered public methods as non public: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invokable_non_public_methods\"]},\"join\",{\"type\":\"str\",\"children\":[\", \"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"merge\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"public_instance_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":30,"raw_source":"def invokable?(method)\n        filter_methods.include?(method.to_s)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"invokable?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":34,"raw_source":"def inherited(subclass)\n        super\n        subclass.instance_variable_set(:@filter_methods, @filter_methods.dup)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"instance_variable_set\",{\"type\":\"sym\",\"children\":[\"@filter_methods\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filter_methods\"]},\"dup\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":39,"raw_source":"def filter_method_names\n        filter_methods.map(&:to_s).to_a\n      end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_method_names\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]},\"to_a\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":45,"raw_source":"def filter_methods\n        @filter_methods ||= Set.new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filter_methods\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Set\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":50,"raw_source":"def invoke(method, *args)\n      if self.class.invokable?(method)\n        send(method, *args)\n      elsif @context.strict_filters\n        raise Liquid::UndefinedFilter, \"undefined filter #{method}\"\n      else\n        args.first\n      end\n    rescue ::ArgumentError => e\n      raise Liquid::ArgumentError, e.message, e.backtrace\n    end","complexity_score":17.9,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"invokable?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"strict_filters\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedFilter\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined filter \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"backtrace\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":10,"raw_source":"def initialize(length, cols)\n      @length = length\n      @row    = 1\n      @col    = 1\n      @cols   = cols\n      @index  = 0\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"length\"]},{\"type\":\"arg\",\"children\":[\"cols\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@length\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@row\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"ivasgn\",\"children\":[\"@col\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"ivasgn\",\"children\":[\"@cols\",{\"type\":\"lvar\",\"children\":[\"cols\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@index\",{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":40,"raw_source":"def index\n      @index + 1\n    end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"index\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":48,"raw_source":"def index0\n      @index\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"index0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@index\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":56,"raw_source":"def col0\n      @col - 1\n    end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"col0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@col\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":64,"raw_source":"def rindex\n      @length - @index\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":72,"raw_source":"def rindex0\n      @length - @index - 1\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":80,"raw_source":"def first\n      @index == 0\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":88,"raw_source":"def last\n      @index == @length - 1\n    end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":96,"raw_source":"def col_first\n      @col == 1\n    end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"col_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@col\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":104,"raw_source":"def col_last\n      @col == @cols\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"col_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@col\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@cols\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":110,"raw_source":"def increment!\n      @index += 1\n\n      if @col == @cols\n        @col = 1\n        @row += 1\n      else\n        @col += 1\n      end\n    end","complexity_score":11.08,"ast_json":"{\"type\":\"def\",\"children\":[\"increment!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@col\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@cols\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@col\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@row\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@col\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":13,"raw_source":"def parse(tag_name, markup, tokenizer, parse_context)\n        tag = new(tag_name, markup, parse_context)\n        tag.parse(tokenizer)\n        tag\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":19,"raw_source":"def disable_tags(*tag_names)\n        tag_names += disabled_tags\n        define_singleton_method(:disabled_tags) { tag_names }\n        prepend(Disabler)\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"disable_tags\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"tag_names\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_names\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"disabled_tags\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"disabled_tags\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"tag_names\"]}]},{\"type\":\"send\",\"children\":[null,\"prepend\",{\"type\":\"const\",\"children\":[null,\"Disabler\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":29,"raw_source":"def disabled_tags\n        []\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"disabled_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":34,"raw_source":"def initialize(tag_name, markup, parse_context)\n      @tag_name      = tag_name\n      @markup        = markup\n      @parse_context = parse_context\n      @line_number   = parse_context.line_number\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tag_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@markup\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":41,"raw_source":"def parse(_tokens)\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_tokens\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":44,"raw_source":"def raw\n      \"#{@tag_name} #{@markup}\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tag_name\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@markup\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":48,"raw_source":"def name\n      self.class.name.downcase\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]},\"downcase\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":52,"raw_source":"def render(_context)\n      ''\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":59,"raw_source":"def render_to_output_buffer(context, output)\n      render_result = render(context)\n      output << render_result if render_result\n      output\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"render_result\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"render_result\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":65,"raw_source":"def blank?\n      false\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":71,"raw_source":"def parse_expression(markup)\n      parse_context.parse_expression(markup)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disableable.rb","start_line":6,"raw_source":"def render_to_output_buffer(context, output)\n        if context.tag_disabled?(tag_name)\n          output << disabled_error(context)\n          return\n        end\n        super\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"send\",\"children\":[null,\"tag_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"disabled_error\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disableable.rb","start_line":14,"raw_source":"def disabled_error(context)\n        # raise then rescue the exception so that the Context#exception_renderer can re-raise it\n        raise DisabledError, \"#{tag_name} #{parse_context[:locale].t('errors.disabled.tag')}\"\n      rescue DisabledError => exc\n        context.handle_error(exc, line_number)\n      end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"disabled_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"DisabledError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"tag_name\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.disabled.tag\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DisabledError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"send\",\"children\":[null,\"line_number\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disabler.rb","start_line":6,"raw_source":"def render_to_output_buffer(context, output)\n        context.with_disabled_tags(self.class.disabled_tags) do\n          super\n        end\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"disabled_tags\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":24,"raw_source":"def self.raise_syntax_error(parse_context)\n      raise Liquid::SyntaxError, parse_context.locale.t('errors.syntax.assign')\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.assign\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":30,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      if markup =~ Syntax\n        @to   = Regexp.last_match(1)\n        @from = Variable.new(Regexp.last_match(2), parse_context)\n      else\n        self.class.raise_syntax_error(parse_context)\n      end\n    end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@to\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"raise_syntax_error\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":40,"raw_source":"def render_to_output_buffer(context, output)\n      val = @from.render(context)\n      context.scopes.last[@to] = val\n      context.resource_limits.increment_assign_score(assign_score_of(val))\n      output\n    end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@from\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@to\"]},{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_assign_score\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":47,"raw_source":"def blank?\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":53,"raw_source":"def assign_score_of(val)\n      if val.instance_of?(String)\n        val.bytesize\n      elsif val.instance_of?(Array)\n        sum = 1\n        # Uses #each to avoid extra allocations.\n        val.each { |child| sum += assign_score_of(child) }\n        sum\n      elsif val.instance_of?(Hash)\n        sum = 1\n        val.each do |key, entry_value|\n          sum += assign_score_of(key)\n          sum += assign_score_of(entry_value)\n        end\n        sum\n      else\n        1\n      end\n    end","complexity_score":31.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assign_score_of\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"bytesize\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"child\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"sum\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"entry_value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"entry_value\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"sum\"]}]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":74,"raw_source":"def children\n        [@node.from]\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"from\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/break.rb","start_line":24,"raw_source":"def render_to_output_buffer(context, output)\n      context.push_interrupt(INTERRUPT)\n      output\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"push_interrupt\",{\"type\":\"const\",\"children\":[null,\"INTERRUPT\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/capture.rb","start_line":25,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      if markup =~ Syntax\n        @to = Regexp.last_match(1)\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.capture\")\n      end\n    end","complexity_score":8.43,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@to\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.capture\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/capture.rb","start_line":34,"raw_source":"def render_to_output_buffer(context, output)\n      context.resource_limits.with_capture do\n        capture_output = render(context)\n        context.scopes.last[@to] = capture_output\n      end\n      output\n    end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"with_capture\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"capture_output\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@to\"]},{\"type\":\"lvar\",\"children\":[\"capture_output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/capture.rb","start_line":42,"raw_source":"def blank?\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":31,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @blocks = []\n\n      if markup =~ Syntax\n        @left = parse_expression(Regexp.last_match(1))\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.case\")\n      end\n    end","complexity_score":10.78,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@blocks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@left\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":42,"raw_source":"def parse(tokens)\n      body = case_body = new_body\n      body = @blocks.last.attachment while parse_body(body, tokens)\n      @blocks.reverse_each do |condition|\n        body = condition.attachment\n        unless body.frozen?\n          body.remove_blank_strings if blank?\n          body.freeze\n        end\n      end\n      case_body.freeze\n    end","complexity_score":22.1,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"lvasgn\",\"children\":[\"case_body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"last\"]},\"attachment\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"attachment\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"frozen?\"]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"remove_blank_strings\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"freeze\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"case_body\"]},\"freeze\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":55,"raw_source":"def nodelist\n      @blocks.map(&:attachment)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":59,"raw_source":"def unknown_tag(tag, markup, tokens)\n      case tag\n      when 'when'\n        record_when_condition(markup)\n      when 'else'\n        record_else_condition(markup)\n      else\n        super\n      end\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"when\"]},{\"type\":\"send\",\"children\":[null,\"record_when_condition\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"send\",\"children\":[null,\"record_else_condition\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":70,"raw_source":"def render_to_output_buffer(context, output)\n      execute_else_block = true\n\n      @blocks.each do |block|\n        if block.else?\n          block.attachment.render_to_output_buffer(context, output) if execute_else_block\n          next\n        end\n\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          execute_else_block = false\n          block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":19.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"execute_else_block\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"else?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"execute_else_block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},null]},{\"type\":\"next\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"execute_else_block\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":94,"raw_source":"def record_when_condition(markup)\n      body = new_body\n\n      while markup\n        unless markup =~ WhenSyntax\n          raise SyntaxError, options[:locale].t(\"errors.syntax.case_invalid_when\")\n        end\n\n        markup = Regexp.last_match(2)\n\n        block = Condition.new(@left, '==', Condition.parse_expression(parse_context, Regexp.last_match(1)))\n        block.attach(body)\n        @blocks << block\n      end\n    end","complexity_score":24.4,"ast_json":"{\"type\":\"def\",\"children\":[\"record_when_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"WhenSyntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case_invalid_when\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@left\"]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[null,\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":110,"raw_source":"def record_else_condition(markup)\n      unless markup.strip.empty?\n        raise SyntaxError, options[:locale].t(\"errors.syntax.case_invalid_else\")\n      end\n\n      block = ElseCondition.new\n      block.attach(new_body)\n      @blocks << block\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"record_else_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case_invalid_else\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ElseCondition\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":121,"raw_source":"def children\n        [@node.left] + @node.blocks\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"left\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"blocks\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":18,"raw_source":"def render_to_output_buffer(_context, output)\n      output\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":22,"raw_source":"def unknown_tag(_tag, _markup, _tokens)\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_tag\"]},{\"type\":\"arg\",\"children\":[\"_markup\"]},{\"type\":\"arg\",\"children\":[\"_tokens\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":25,"raw_source":"def blank?\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":31,"raw_source":"def parse_body(body, tokenizer)\n      if parse_context.depth >= MAX_DEPTH\n        raise StackLevelError, \"Nesting too deep\"\n      end\n\n      parse_context.depth += 1\n      comment_tag_depth = 1\n\n      begin\n        # Consume tokens without creating child nodes.\n        # The children tag doesn't require to be a valid Liquid except the comment and raw tag.\n        # The child comment and raw tag must be closed.\n        while (token = tokenizer.send(:shift))\n          tag_name = if tokenizer.for_liquid_tag\n            next if token.empty? || token.match?(BlockBody::WhitespaceOrNothing)\n\n            tag_name_match = BlockBody::LiquidTagToken.match(token)\n\n            next if tag_name_match.nil?\n\n            tag_name_match[1]\n          else\n            token =~ BlockBody::FullToken\n            Regexp.last_match(2)\n          end\n\n          case tag_name\n          when \"raw\"\n            parse_raw_tag_body(tokenizer)\n          when \"comment\"\n            comment_tag_depth += 1\n          when \"endcomment\"\n            comment_tag_depth -= 1\n          end\n\n          if comment_tag_depth.zero?\n            parse_context.trim_whitespace = (token[-3] == WhitespaceControl) unless tokenizer.for_liquid_tag\n            return false\n          end\n        end\n\n        raise_tag_never_closed(block_name)\n      ensure\n        parse_context.depth -= 1\n      end\n\n      false\n    end","complexity_score":65.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]},{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"MAX_DEPTH\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"WhitespaceOrNothing\"]}]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"tag_name_match\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"LiquidTagToken\"]},\"match\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name_match\"]},\"nil?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name_match\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullToken\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"raw\"]},{\"type\":\"send\",\"children\":[null,\"parse_raw_tag_body\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"comment\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"endcomment\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"comment_tag_depth\"]},\"zero?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},null]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"false\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":80,"raw_source":"def parse_raw_tag_body(tokenizer)\n      while (token = tokenizer.send(:shift))\n        return if token =~ BlockBody::FullTokenPossiblyInvalid && \"endraw\" == Regexp.last_match(2)\n      end\n\n      raise_tag_never_closed(\"raw\")\n    end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_raw_tag_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"endraw\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"return\",\"children\":[]},null]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"str\",\"children\":[\"raw\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/continue.rb","start_line":15,"raw_source":"def render_to_output_buffer(context, output)\n      context.push_interrupt(INTERRUPT)\n      output\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"push_interrupt\",{\"type\":\"const\",\"children\":[null,\"INTERRUPT\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":23,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      case markup\n      when NamedSyntax\n        @variables = variables_from_string(Regexp.last_match(2))\n        @name      = parse_expression(Regexp.last_match(1))\n        @is_named = true\n      when SimpleSyntax\n        @variables = variables_from_string(markup)\n        @name      = @variables.to_s\n        @is_named = !@name.match?(/\\w+:0x\\h{8}/)\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.cycle\")\n      end\n    end","complexity_score":25.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NamedSyntax\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variables\",{\"type\":\"send\",\"children\":[null,\"variables_from_string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_named\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SimpleSyntax\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variables\",{\"type\":\"send\",\"children\":[null,\"variables_from_string\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"to_s\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_named\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@name\"]},\"match?\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\w+:0x\\\\h{8}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"!\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.cycle\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":39,"raw_source":"def named?\n      @is_named\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"named?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@is_named\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":43,"raw_source":"def render_to_output_buffer(context, output)\n      context.registers[:cycle] ||= {}\n\n      key       = context.evaluate(@name)\n      iteration = context.registers[:cycle][key].to_i\n\n      val = context.evaluate(@variables[iteration])\n\n      if val.is_a?(Array)\n        val = val.join\n      elsif !val.is_a?(String)\n        val = val.to_s\n      end\n\n      output << val\n\n      iteration += 1\n      iteration = 0 if iteration >= @variables.size\n\n      context.registers[:cycle][key] = iteration\n      output\n    end","complexity_score":33.3,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"iteration\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"to_i\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"iteration\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"join\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},\"!\"]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"to_s\"]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"iteration\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"iteration\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"size\"]}]},{\"type\":\"lvasgn\",\"children\":[\"iteration\",{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"iteration\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":68,"raw_source":"def variables_from_string(markup)\n      markup.split(',').collect do |var|\n        var =~ /\\s*(#{QuotedFragment})\\s*/o\n        next unless Regexp.last_match(1)\n\n        # Expression Parser returns cached objects, and we need to dup them to\n        # start the cycle over for each new cycle call.\n        # Liquid-C does not have a cache, so we don't need to dup the object.\n        var = parse_expression(Regexp.last_match(1))\n        var.is_a?(VariableLookup) ? var.dup : var\n      end.compact\n    end","complexity_score":17.15,"ast_json":"{\"type\":\"def\",\"children\":[\"variables_from_string\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"collect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]},{\"type\":\"str\",\"children\":[\")\\\\s*\"]},{\"type\":\"regopt\",\"children\":[\"o\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"dup\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]}]}]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":82,"raw_source":"def children\n        Array(@node.variables)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variables\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/decrement.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @variable_name = markup.strip\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/decrement.rb","start_line":33,"raw_source":"def render_to_output_buffer(context, output)\n      counter_environment = context.environments.first\n      value = counter_environment[@variable_name] || 0\n      value -= 1\n      counter_environment[@variable_name] = value\n      output << value.to_s\n      output\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"counter_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environments\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"value\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":33,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      ensure_valid_markup(tag_name, markup, parse_context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"ensure_valid_markup\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":38,"raw_source":"def parse(tokens)\n      @body = +\"\"\n\n      while (token = tokens.shift)\n        tag_name = token =~ BlockBody::FullTokenPossiblyInvalid && Regexp.last_match(2)\n\n        raise_nested_doc_error if tag_name == @tag_name\n\n        if tag_name == block_delimiter\n          parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n          @body << Regexp.last_match(1) if Regexp.last_match(1) != \"\"\n          return\n        end\n        @body << token unless token.empty?\n      end\n\n      raise_tag_never_closed(block_name)\n    end","complexity_score":38.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@tag_name\"]}]},{\"type\":\"send\",\"children\":[null,\"raise_nested_doc_error\"]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":57,"raw_source":"def render_to_output_buffer(_context, output)\n      output\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":61,"raw_source":"def blank?\n      @body.empty?\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"empty?\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":65,"raw_source":"def nodelist\n      [@body]\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":71,"raw_source":"def ensure_valid_markup(tag_name, markup, parse_context)\n      unless NO_UNEXPECTED_ARGS.match?(markup)\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.block_tag_unexpected_args\", tag: tag_name)\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"ensure_valid_markup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NO_UNEXPECTED_ARGS\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.block_tag_unexpected_args\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":77,"raw_source":"def raise_nested_doc_error\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.doc_invalid_nested\")\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_nested_doc_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.doc_invalid_nested\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/echo.rb","start_line":24,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      @variable = Variable.new(markup, parse_context)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/echo.rb","start_line":29,"raw_source":"def render(context)\n      @variable.render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/echo.rb","start_line":34,"raw_source":"def children\n        [@node.variable]\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variable\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":32,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @from = @limit = nil\n      parse_with_selected_parser(markup)\n      @for_block = new_body\n      @else_block = nil\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"ivasgn\",\"children\":[\"@limit\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"parse_with_selected_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@for_block\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@else_block\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":40,"raw_source":"def parse(tokens)\n      if parse_body(@for_block, tokens)\n        parse_body(@else_block, tokens)\n      end\n      if blank?\n        @else_block&.remove_blank_strings\n        @for_block.remove_blank_strings\n      end\n      @else_block&.freeze\n      @for_block.freeze\n    end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@for_block\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@else_block\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"remove_blank_strings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"remove_blank_strings\"]}]},null]},{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"freeze\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"freeze\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":52,"raw_source":"def nodelist\n      @else_block ? [@for_block, @else_block] : [@for_block]\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},{\"type\":\"ivar\",\"children\":[\"@else_block\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":56,"raw_source":"def unknown_tag(tag, markup, tokens)\n      return super unless tag == 'else'\n      @else_block = new_body\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@else_block\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":61,"raw_source":"def render_to_output_buffer(context, output)\n      segment = collection_segment(context)\n\n      if segment.empty?\n        render_else(context, output)\n      else\n        render_segment(context, output, segment)\n      end\n\n      output\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"segment\",{\"type\":\"send\",\"children\":[null,\"collection_segment\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[null,\"render_else\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"render_segment\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"segment\"]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":75,"raw_source":"def lax_parse(markup)\n      if markup =~ Syntax\n        @variable_name   = Regexp.last_match(1)\n        collection_name  = Regexp.last_match(2)\n        @reversed        = !!Regexp.last_match(3)\n        @name            = \"#{@variable_name}-#{collection_name}\"\n        @collection_name = parse_expression(collection_name)\n        markup.scan(TagAttributes) do |key, value|\n          set_attribute(key, value)\n        end\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.for\")\n      end\n    end","complexity_score":26.25,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@reversed\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"!\"]},\"!\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[null,\"set_attribute\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":90,"raw_source":"def strict_parse(markup)\n      p = @parse_context.new_parser(markup)\n      @variable_name = p.consume(:id)\n      raise SyntaxError, options[:locale].t(\"errors.syntax.for_invalid_in\") unless p.id?('in')\n\n      collection_name  = p.expression\n      @collection_name = parse_expression(collection_name)\n\n      @name     = \"#{@variable_name}-#{collection_name}\"\n      @reversed = p.id?('reversed')\n\n      while p.look(:comma) || p.look(:id)\n        p.consume?(:comma)\n        unless (attribute = p.id?('limit') || p.id?('offset'))\n          raise SyntaxError, options[:locale].t(\"errors.syntax.for_invalid_attribute\")\n        end\n        p.consume(:colon)\n        set_attribute(attribute, p.expression)\n      end\n      p.consume(:end_of_string)\n    end","complexity_score":41.7,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"in\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for_invalid_in\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@reversed\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"reversed\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"attribute\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"limit\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"offset\"]}]}]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for_invalid_attribute\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]},{\"type\":\"send\",\"children\":[null,\"set_attribute\",{\"type\":\"lvar\",\"children\":[\"attribute\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":114,"raw_source":"def collection_segment(context)\n      offsets = context.registers[:for] ||= {}\n\n      from = if @from == :continue\n        offsets[@name].to_i\n      else\n        from_value = context.evaluate(@from)\n        if from_value.nil?\n          0\n        else\n          Utils.to_integer(from_value)\n        end\n      end\n\n      collection = context.evaluate(@collection_name)\n      collection = collection.to_a if collection.is_a?(Range)\n\n      limit_value = context.evaluate(@limit)\n      to = if limit_value.nil?\n        nil\n      else\n        Utils.to_integer(limit_value) + from\n      end\n\n      segment = Utils.slice_collection(collection, from, to)\n      segment.reverse! if @reversed\n\n      offsets[@name] = from + segment.length\n\n      segment\n    end","complexity_score":34.4,"ast_json":"{\"type\":\"def\",\"children\":[\"collection_segment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"offsets\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@from\"]},\"==\",{\"type\":\"sym\",\"children\":[\"continue\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offsets\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]},\"to_i\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"from_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@from\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from_value\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"from_value\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Range\"]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"to_a\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"limit_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@limit\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"to\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limit_value\"]},\"nil?\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"limit_value\"]}]},\"+\",{\"type\":\"lvar\",\"children\":[\"from\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"segment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"slice_collection\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reversed\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"reverse!\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offsets\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"length\"]}]}]},{\"type\":\"lvar\",\"children\":[\"segment\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":146,"raw_source":"def render_segment(context, output, segment)\n      for_stack = context.registers[:for_stack] ||= []\n      length    = segment.length\n\n      context.stack do\n        loop_vars = Liquid::ForloopDrop.new(@name, length, for_stack[-1])\n\n        for_stack.push(loop_vars)\n\n        begin\n          context['forloop'] = loop_vars\n\n          segment.each do |item|\n            context[@variable_name] = item\n            @for_block.render_to_output_buffer(context, output)\n            loop_vars.send(:increment!)\n\n            # Handle any interrupts if they exist.\n            next unless context.interrupt?\n            interrupt = context.pop_interrupt\n            break if interrupt.is_a?(BreakInterrupt)\n            next if interrupt.is_a?(ContinueInterrupt)\n          end\n        ensure\n          for_stack.pop\n        end\n      end\n\n      output\n    end","complexity_score":35.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_segment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"segment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"for_stack\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for_stack\"]}]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"length\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loop_vars\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ForloopDrop\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@name\"]},{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"[]\",{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"loop_vars\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"forloop\"]},{\"type\":\"lvar\",\"children\":[\"loop_vars\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loop_vars\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"interrupt\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"pop_interrupt\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BreakInterrupt\"]}]},{\"type\":\"break\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"ContinueInterrupt\"]}]},{\"type\":\"next\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"pop\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":177,"raw_source":"def set_attribute(key, expr)\n      case key\n      when 'offset'\n        @from = if expr == 'continue'\n          :continue\n        else\n          parse_expression(expr)\n        end\n      when 'limit'\n        @limit = parse_expression(expr)\n      end\n    end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"set_attribute\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"offset\"]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expr\"]},\"==\",{\"type\":\"str\",\"children\":[\"continue\"]}]},{\"type\":\"sym\",\"children\":[\"continue\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"limit\"]},{\"type\":\"ivasgn\",\"children\":[\"@limit\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":190,"raw_source":"def render_else(context, output)\n      if @else_block\n        @else_block.render_to_output_buffer(context, output)\n      else\n        output\n      end\n    end","complexity_score":2.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_else\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":199,"raw_source":"def children\n        (super + [@node.limit, @node.from, @node.collection_name]).compact\n      end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"from\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"collection_name\"]}]}]}]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":23,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @blocks = []\n      push_block('if', markup)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@blocks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"push_block\",{\"type\":\"str\",\"children\":[\"if\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":29,"raw_source":"def nodelist\n      @blocks.map(&:attachment)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":33,"raw_source":"def parse(tokens)\n      while parse_body(@blocks.last.attachment, tokens)\n      end\n      @blocks.reverse_each do |block|\n        block.attachment.remove_blank_strings if blank?\n        block.attachment.freeze\n      end\n    end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"last\"]},\"attachment\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"remove_blank_strings\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"freeze\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":45,"raw_source":"def unknown_tag(tag, markup, tokens)\n      if ELSE_TAG_NAMES.include?(tag)\n        push_block(tag, markup)\n      else\n        super\n      end\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ELSE_TAG_NAMES\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"send\",\"children\":[null,\"push_block\",{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":53,"raw_source":"def render_to_output_buffer(context, output)\n      @blocks.each do |block|\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          return block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":69,"raw_source":"def push_block(tag, markup)\n      block = if tag == 'else'\n        ElseCondition.new\n      else\n        parse_with_selected_parser(markup)\n      end\n\n      @blocks.push(block)\n      block.attach(new_body)\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"push_block\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ElseCondition\"]},\"new\"]},{\"type\":\"send\",\"children\":[null,\"parse_with_selected_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":80,"raw_source":"def parse_expression(markup)\n      Condition.parse_expression(parse_context, markup)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[null,\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":84,"raw_source":"def lax_parse(markup)\n      expressions = markup.scan(ExpressionsAndOperators)\n      raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless expressions.pop =~ Syntax\n\n      condition = Condition.new(parse_expression(Regexp.last_match(1)), Regexp.last_match(2), parse_expression(Regexp.last_match(3)))\n\n      until expressions.empty?\n        operator = expressions.pop.to_s.strip\n\n        raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless expressions.pop.to_s =~ Syntax\n\n        new_condition = Condition.new(parse_expression(Regexp.last_match(1)), Regexp.last_match(2), parse_expression(Regexp.last_match(3)))\n        raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless BOOLEAN_OPERATORS.include?(operator)\n        new_condition.send(operator, condition)\n        condition = new_condition\n      end\n\n      condition\n    end","complexity_score":64.35,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expressions\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"ExpressionsAndOperators\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"empty?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"operator\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"to_s\"]},\"strip\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"to_s\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BOOLEAN_OPERATORS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"operator\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_condition\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"operator\"]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"lvar\",\"children\":[\"new_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":104,"raw_source":"def strict_parse(markup)\n      p = @parse_context.new_parser(markup)\n      condition = parse_binary_comparisons(p)\n      p.consume(:end_of_string)\n      condition\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[null,\"parse_binary_comparisons\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":111,"raw_source":"def parse_binary_comparisons(p)\n      condition = parse_comparison(p)\n      first_condition = condition\n      while (op = p.id?('and') || p.id?('or'))\n        child_condition = parse_comparison(p)\n        condition.send(op, child_condition)\n        condition = child_condition\n      end\n      first_condition\n    end","complexity_score":15.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_binary_comparisons\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[null,\"parse_comparison\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"first_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"op\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"and\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"or\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"child_condition\",{\"type\":\"send\",\"children\":[null,\"parse_comparison\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"child_condition\"]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"lvar\",\"children\":[\"child_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"first_condition\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":122,"raw_source":"def parse_comparison(p)\n      a = parse_expression(p.expression)\n      if (op = p.consume?(:comparison))\n        b = parse_expression(p.expression)\n        Condition.new(a, op, b)\n      else\n        Condition.new(a)\n      end\n    end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_comparison\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"op\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comparison\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"b\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":133,"raw_source":"def children\n        @node.blocks\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"blocks\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/ifchanged.rb","start_line":5,"raw_source":"def render_to_output_buffer(context, output)\n      block_output = +''\n      super(context, block_output)\n\n      if block_output != context.registers[:ifchanged]\n        context.registers[:ifchanged] = block_output\n        output << block_output\n      end\n\n      output\n    end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block_output\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"block_output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_output\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"ifchanged\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"ifchanged\"]},{\"type\":\"lvar\",\"children\":[\"block_output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block_output\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      if markup =~ SYNTAX\n\n        template_name = Regexp.last_match(1)\n        variable_name = Regexp.last_match(3)\n\n        @alias_name         = Regexp.last_match(5)\n        @variable_name_expr = variable_name ? parse_expression(variable_name) : nil\n        @template_name_expr = parse_expression(template_name)\n        @attributes         = {}\n\n        markup.scan(TagAttributes) do |key, value|\n          @attributes[key] = parse_expression(value)\n        end\n\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.include\")\n      end\n    end","complexity_score":26.45,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"SYNTAX\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@alias_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name_expr\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable_name\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"variable_name\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name_expr\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.include\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":50,"raw_source":"def parse(_tokens)\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_tokens\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":53,"raw_source":"def render_to_output_buffer(context, output)\n      template_name = context.evaluate(@template_name_expr)\n      raise ArgumentError, options[:locale].t(\"errors.argument.include\") unless template_name.is_a?(String)\n\n      partial = PartialCache.load(\n        template_name,\n        context: context,\n        parse_context: parse_context,\n      )\n\n      context_variable_name = @alias_name || template_name.split('/').last\n\n      variable = if @variable_name_expr\n        context.evaluate(@variable_name_expr)\n      else\n        context.find_variable(template_name, raise_on_not_found: false)\n      end\n\n      old_template_name = context.template_name\n      old_partial       = context.partial\n\n      begin\n        context.template_name = partial.name\n        context.partial = true\n\n        context.stack do\n          @attributes.each do |key, value|\n            context[key] = context.evaluate(value)\n          end\n\n          if variable.is_a?(Array)\n            variable.each do |var|\n              context[context_variable_name] = var\n              partial.render_to_output_buffer(context, output)\n            end\n          else\n            context[context_variable_name] = variable\n            partial.render_to_output_buffer(context, output)\n          end\n        end\n      ensure\n        context.template_name = old_template_name\n        context.partial       = old_partial\n      end\n\n      output\n    end","complexity_score":50.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@template_name_expr\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.argument.include\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PartialCache\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_variable_name\",{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@alias_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"split\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"last\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"find_variable\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"old_template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"old_partial\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"variable\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"lvar\",\"children\":[\"old_template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial=\",{\"type\":\"lvar\",\"children\":[\"old_partial\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":105,"raw_source":"def children\n        [\n          @node.template_name_expr,\n          @node.variable_name_expr,\n        ] + @node.attributes.values\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"template_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variable_name_expr\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/increment.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @variable_name = markup.strip\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/increment.rb","start_line":33,"raw_source":"def render_to_output_buffer(context, output)\n      counter_environment = context.environments.first\n      value = counter_environment[@variable_name] || 0\n      counter_environment[@variable_name] = value + 1\n\n      output << value.to_s\n      output\n    end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"counter_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environments\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/inline_comment.rb","start_line":5,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      # Semantically, a comment should only ignore everything after it on the line.\n      # Currently, this implementation doesn't support mixing a comment with another tag\n      # but we need to reserve future support for this and prevent the introduction\n      # of inline comments from being backward incompatible change.\n      #\n      # As such, we're forcing users to put a # symbol on every line otherwise this\n      # tag will throw an error.\n      if markup.match?(/\\n\\s*[^#\\s]/)\n        raise SyntaxError, options[:locale].t(\"errors.syntax.inline_comment_invalid\")\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"match?\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\n\\\\s*[^#\\\\s]\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.inline_comment_invalid\"]}]}]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/inline_comment.rb","start_line":20,"raw_source":"def render_to_output_buffer(_context, output)\n      output\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/inline_comment.rb","start_line":24,"raw_source":"def blank?\n      true\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":18,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n\n      ensure_valid_markup(tag_name, markup, parse_context)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"ensure_valid_markup\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":24,"raw_source":"def parse(tokens)\n      @body = +''\n      while (token = tokens.shift)\n        if token =~ BlockBody::FullTokenPossiblyInvalid && block_delimiter == Regexp.last_match(2)\n          parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n          @body << Regexp.last_match(1) if Regexp.last_match(1) != \"\"\n          return\n        end\n        @body << token unless token.empty?\n      end\n\n      raise_tag_never_closed(block_name)\n    end","complexity_score":34.3,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":38,"raw_source":"def render_to_output_buffer(_context, output)\n      output << @body\n      output\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"ivar\",\"children\":[\"@body\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":43,"raw_source":"def nodelist\n      [@body]\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":47,"raw_source":"def blank?\n      @body.empty?\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"blank?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"empty?\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":53,"raw_source":"def ensure_valid_markup(tag_name, markup, parse_context)\n      unless Syntax.match?(markup)\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_unexpected_args\", tag: tag_name)\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"ensure_valid_markup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Syntax\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_unexpected_args\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":36,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      raise SyntaxError, options[:locale].t(\"errors.syntax.render\") unless markup =~ SYNTAX\n\n      template_name = Regexp.last_match(1)\n      with_or_for = Regexp.last_match(3)\n      variable_name = Regexp.last_match(4)\n\n      @alias_name = Regexp.last_match(6)\n      @variable_name_expr = variable_name ? parse_expression(variable_name) : nil\n      @template_name_expr = parse_expression(template_name)\n      @is_for_loop = (with_or_for == FOR)\n\n      @attributes = {}\n      markup.scan(TagAttributes) do |key, value|\n        @attributes[key] = parse_expression(value)\n      end\n    end","complexity_score":27.4,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"SYNTAX\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.render\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"with_or_for\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@alias_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name_expr\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable_name\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"variable_name\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name_expr\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_for_loop\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"with_or_for\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"FOR\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":56,"raw_source":"def for_loop?\n      @is_for_loop\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"for_loop?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@is_for_loop\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":60,"raw_source":"def render_to_output_buffer(context, output)\n      render_tag(context, output)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"render_tag\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":64,"raw_source":"def render_tag(context, output)\n      # The expression should be a String literal, which parses to a String object\n      template_name = @template_name_expr\n      raise ::ArgumentError unless template_name.is_a?(String)\n\n      partial = PartialCache.load(\n        template_name,\n        context: context,\n        parse_context: parse_context,\n      )\n\n      context_variable_name = @alias_name || template_name.split('/').last\n\n      render_partial_func = ->(var, forloop) {\n        inner_context               = context.new_isolated_subcontext\n        inner_context.template_name = partial.name\n        inner_context.partial       = true\n        inner_context['forloop']    = forloop if forloop\n\n        @attributes.each do |key, value|\n          inner_context[key] = context.evaluate(value)\n        end\n        inner_context[context_variable_name] = var unless var.nil?\n        partial.render_to_output_buffer(inner_context, output)\n        forloop&.send(:increment!)\n      }\n\n      variable = @variable_name_expr ? context.evaluate(@variable_name_expr) : nil\n      if @is_for_loop && variable.respond_to?(:each) && variable.respond_to?(:count)\n        forloop = Liquid::ForloopDrop.new(template_name, variable.count, nil)\n        variable.each { |var| render_partial_func.call(var, forloop) }\n      else\n        render_partial_func.call(variable, nil)\n      end\n\n      output\n    end","complexity_score":52.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"ivar\",\"children\":[\"@template_name_expr\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PartialCache\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_variable_name\",{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@alias_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"split\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"last\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"render_partial_func\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]},{\"type\":\"arg\",\"children\":[\"forloop\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner_context\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"template_name=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forloop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"forloop\"]},{\"type\":\"lvar\",\"children\":[\"forloop\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"inner_context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forloop\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@is_for_loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"count\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"forloop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ForloopDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"count\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_partial_func\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"var\"]},{\"type\":\"lvar\",\"children\":[\"forloop\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_partial_func\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"variable\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":103,"raw_source":"def children\n        [\n          @node.template_name_expr,\n          @node.variable_name_expr,\n        ] + @node.attributes.values\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"template_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variable_name_expr\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":31,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      if markup =~ Syntax\n        @variable_name   = Regexp.last_match(1)\n        @collection_name = parse_expression(Regexp.last_match(2))\n        @attributes      = {}\n        markup.scan(TagAttributes) do |key, value|\n          @attributes[key] = parse_expression(value)\n        end\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.table_row\")\n      end\n    end","complexity_score":19.05,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.table_row\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":45,"raw_source":"def render_to_output_buffer(context, output)\n      (collection = context.evaluate(@collection_name)) || (return '')\n\n      from = @attributes.key?('offset') ? to_integer(context.evaluate(@attributes['offset'])) : 0\n      to = @attributes.key?('limit') ? from + to_integer(context.evaluate(@attributes['limit'])) : nil\n\n      collection = Utils.slice_collection(collection, from, to)\n      length     = collection.length\n\n      cols = @attributes.key?('cols') ? to_integer(context.evaluate(@attributes['cols'])) : length\n\n      output << \"<tr class=\\\"row1\\\">\\n\"\n      context.stack do\n        tablerowloop = Liquid::TablerowloopDrop.new(length, cols)\n        context['tablerowloop'] = tablerowloop\n\n        collection.each do |item|\n          context[@variable_name] = item\n\n          output << \"<td class=\\\"col#{tablerowloop.col}\\\">\"\n          super\n          output << '</td>'\n\n          # Handle any interrupts if they exist.\n          if context.interrupt?\n            interrupt = context.pop_interrupt\n            break if interrupt.is_a?(BreakInterrupt)\n          end\n\n          if tablerowloop.col_last && !tablerowloop.last\n            output << \"</tr>\\n<tr class=\\\"row#{tablerowloop.row + 1}\\\">\"\n          end\n\n          tablerowloop.send(:increment!)\n        end\n      end\n\n      output << \"</tr>\\n\"\n      output\n    end","complexity_score":71.88,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"offset\"]}]},{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"offset\"]}]}]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"to\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"limit\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"limit\"]}]}]}]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"slice_collection\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"cols\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"cols\"]}]},{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cols\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"length\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tablerowloop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TablerowloopDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"lvar\",\"children\":[\"cols\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"tablerowloop\"]},{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<td class=\\\"col\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"col\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]}]}]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"</td>\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"interrupt\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"pop_interrupt\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BreakInterrupt\"]}]},{\"type\":\"break\",\"children\":[]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"col_last\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"last\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"</tr>\\n<tr class=\\\"row\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"row\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":87,"raw_source":"def children\n        super + @node.attributes.values + [@node.collection_name]\n      end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"collection_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":94,"raw_source":"def to_integer(value)\n      value.to_i\n    rescue NoMethodError\n      raise Liquid::ArgumentError, \"invalid integer\"\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/unless.rb","start_line":22,"raw_source":"def render_to_output_buffer(context, output)\n      # First condition is interpreted backwards ( if not )\n      first_block = @blocks.first\n      result = Liquid::Utils.to_liquid_value(\n        first_block.evaluate(context),\n      )\n\n      unless result\n        return first_block.attachment.render_to_output_buffer(context, output)\n      end\n\n      # After the first condition unless works just like if\n      @blocks[1..-1].each do |block|\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          return block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_block\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":28,"raw_source":"def error_mode=(mode)\n        Deprecations.warn(\"Template.error_mode=\", \"Environment#error_mode=\")\n        Environment.default.error_mode = mode\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"error_mode=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mode\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.error_mode=\"]},{\"type\":\"str\",\"children\":[\"Environment#error_mode=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"mode\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":33,"raw_source":"def error_mode\n        Environment.default.error_mode\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"error_mode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"error_mode\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":37,"raw_source":"def default_exception_renderer=(renderer)\n        Deprecations.warn(\"Template.default_exception_renderer=\", \"Environment#exception_renderer=\")\n        Environment.default.exception_renderer = renderer\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default_exception_renderer=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"renderer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.default_exception_renderer=\"]},{\"type\":\"str\",\"children\":[\"Environment#exception_renderer=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"exception_renderer=\",{\"type\":\"lvar\",\"children\":[\"renderer\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":42,"raw_source":"def default_exception_renderer\n        Environment.default.exception_renderer\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"default_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"exception_renderer\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":46,"raw_source":"def file_system=(file_system)\n        Deprecations.warn(\"Template.file_system=\", \"Environment#file_system=\")\n        Environment.default.file_system = file_system\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"file_system=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file_system\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.file_system=\"]},{\"type\":\"str\",\"children\":[\"Environment#file_system=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"file_system=\",{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":51,"raw_source":"def file_system\n        Environment.default.file_system\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"file_system\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"file_system\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":55,"raw_source":"def tags\n        Environment.default.tags\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"tags\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":59,"raw_source":"def register_tag(name, klass)\n        Deprecations.warn(\"Template.register_tag\", \"Environment#register_tag\")\n        Environment.default.register_tag(name, klass)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"register_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.register_tag\"]},{\"type\":\"str\",\"children\":[\"Environment#register_tag\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"register_tag\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":66,"raw_source":"def register_filter(mod)\n        Deprecations.warn(\"Template.register_filter\", \"Environment#register_filter\")\n        Environment.default.register_filter(mod)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mod\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.register_filter\"]},{\"type\":\"str\",\"children\":[\"Environment#register_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"register_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":71,"raw_source":"private def default_resource_limits=(limits)\n        Deprecations.warn(\"Template.default_resource_limits=\", \"Environment#default_resource_limits=\")\n        Environment.default.default_resource_limits = limits\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"default_resource_limits=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"limits\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.default_resource_limits=\"]},{\"type\":\"str\",\"children\":[\"Environment#default_resource_limits=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"default_resource_limits=\",{\"type\":\"lvar\",\"children\":[\"limits\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":76,"raw_source":"def default_resource_limits\n        Environment.default.default_resource_limits\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"default_resource_limits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"default_resource_limits\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":83,"raw_source":"def parse(source, options = {})\n        environment = options[:environment] || Environment.default\n        new(environment: environment).parse(source, options)\n      end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"environment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":89,"raw_source":"def initialize(environment: Environment.default)\n      @environment = environment\n      @rethrow_errors  = false\n      @resource_limits = ResourceLimits.new(environment.default_resource_limits)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@resource_limits\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"default_resource_limits\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":97,"raw_source":"def parse(source, options = {})\n      parse_context = configure_options(options)\n      source = source.to_s.to_str\n\n      unless source.valid_encoding?\n        raise TemplateEncodingError, parse_context.locale.t(\"errors.syntax.invalid_template_encoding\")\n      end\n\n      tokenizer     = parse_context.new_tokenizer(source, start_line_number: @line_numbers && 1)\n      @root         = Document.parse(tokenizer, parse_context)\n      self\n    end","complexity_score":17.63,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[null,\"configure_options\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"to_s\"]},\"to_str\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"TemplateEncodingError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.invalid_template_encoding\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@line_numbers\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@root\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Document\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":110,"raw_source":"def registers\n      @registers ||= {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@registers\"]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":114,"raw_source":"def assigns\n      @assigns ||= {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":118,"raw_source":"def instance_assigns\n      @instance_assigns ||= {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"instance_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@instance_assigns\"]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":122,"raw_source":"def errors\n      @errors ||= []\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@errors\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":140,"raw_source":"def render(*args)\n      return '' if @root.nil?\n\n      context = case args.first\n      when Liquid::Context\n        c = args.shift\n\n        if @rethrow_errors\n          c.exception_renderer = Liquid::RAISE_EXCEPTION_LAMBDA\n        end\n\n        c\n      when Liquid::Drop\n        drop         = args.shift\n        drop.context = Context.new([drop, assigns], instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      when Hash\n        Context.new([args.shift, assigns], instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      when nil\n        Context.new(assigns, instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      else\n        raise ArgumentError, \"Expected Hash or Liquid::Context as parameter\"\n      end\n\n      output = nil\n\n      case args.last\n      when Hash\n        options = args.pop\n        output  = options[:output] if options[:output]\n        static_registers = context.registers.static\n\n        options[:registers]&.each do |key, register|\n          static_registers[key] = register\n        end\n\n        apply_options_to_context(context, options)\n      when Module, Array\n        context.add_filters(args.pop)\n      end\n\n      # Retrying a render resets resource usage\n      context.resource_limits.reset\n\n      if @profiling && context.profiler.nil?\n        @profiler = context.profiler = Liquid::Profiler.new\n      end\n\n      context.template_name ||= name\n\n      begin\n        # render the nodelist.\n        @root.render_to_output_buffer(context, output || +'')\n      rescue Liquid::MemoryError => e\n        context.handle_error(e)\n      ensure\n        @errors = context.errors\n      end\n    end","complexity_score":81.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@root\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"exception_renderer=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"RAISE_EXCEPTION_LAMBDA\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[null,\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]},{\"type\":\"send\",\"children\":[null,\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"assigns\"]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"Expected Hash or Liquid::Context as parameter\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"output\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"static_registers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"static\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"registers\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"register\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_registers\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"register\"]}]}]},{\"type\":\"send\",\"children\":[null,\"apply_options_to_context\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"reset\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@profiling\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"nil?\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Profiler\"]},\"new\"]}]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]},{\"type\":\"send\",\"children\":[null,\"name\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@root\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MemoryError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"errors\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":199,"raw_source":"def render!(*args)\n      @rethrow_errors = true\n      render(*args)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@rethrow_errors\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":204,"raw_source":"def render_to_output_buffer(context, output)\n      render(context, output: output)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":210,"raw_source":"def configure_options(options)\n      if (profiling = options[:profile])\n        raise \"Profiler not loaded, require 'liquid/profiler' first\" unless defined?(Liquid::Profiler)\n      end\n\n      @options      = options\n      @profiling    = profiling\n      @line_numbers = options[:line_numbers] || @profiling\n      parse_context = if options.is_a?(ParseContext)\n        options\n      else\n        opts = options.key?(:environment) ? options : options.merge(environment: @environment)\n        ParseContext.new(opts)\n      end\n\n      @warnings = parse_context.warnings\n      parse_context\n    end","complexity_score":21.5,"ast_json":"{\"type\":\"def\",\"children\":[\"configure_options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"profiling\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"profile\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Profiler\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"Profiler not loaded, require 'liquid/profiler' first\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@profiling\",{\"type\":\"lvar\",\"children\":[\"profiling\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_numbers\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"line_numbers\"]}]},{\"type\":\"ivar\",\"children\":[\"@profiling\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"ParseContext\"]}]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"environment\"]}]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"opts\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@warnings\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"warnings\"]}]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":229,"raw_source":"def apply_options_to_context(context, options)\n      context.add_filters(options[:filters]) if options[:filters]\n      context.global_filter      = options[:global_filter] if options[:global_filter]\n      context.exception_renderer = options[:exception_renderer] if options[:exception_renderer]\n      context.strict_variables   = options[:strict_variables] if options[:strict_variables]\n      context.strict_filters     = options[:strict_filters] if options[:strict_filters]\n    end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_options_to_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"global_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"global_filter=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"global_filter\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"exception_renderer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"exception_renderer\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_variables\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_variables=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_variables\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_filters=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_filters\"]}]}]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template_factory.rb","start_line":5,"raw_source":"def for(_template_name)\n      Liquid::Template.new\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":17,"raw_source":"def initialize(\n      source:,\n      string_scanner:,\n      line_numbers: false,\n      line_number: nil,\n      for_liquid_tag: false\n    )\n      @line_number = line_number || (line_numbers ? 1 : nil)\n      @for_liquid_tag = for_liquid_tag\n      @source = source.to_s.to_str\n      @offset = 0\n      @tokens = []\n\n      if @source\n        @ss = string_scanner\n        @ss.string = @source\n        tokenize\n      end\n    end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"source\"]},{\"type\":\"kwarg\",\"children\":[\"string_scanner\"]},{\"type\":\"kwoptarg\",\"children\":[\"line_numbers\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"for_liquid_tag\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_number\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_numbers\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"nil\",\"children\":[]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"for_liquid_tag\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"to_s\"]},\"to_str\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@offset\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@ss\",{\"type\":\"lvar\",\"children\":[\"string_scanner\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string=\",{\"type\":\"ivar\",\"children\":[\"@source\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\"]}]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":37,"raw_source":"def shift\n      token = @tokens[@offset]\n\n      return unless token\n\n      @offset += 1\n\n      if @line_number\n        @line_number += @for_liquid_tag ? 1 : token.count(\"\\n\")\n      end\n\n      token\n    end","complexity_score":11.55,"ast_json":"{\"type\":\"def\",\"children\":[\"shift\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@offset\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@offset\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@line_number\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@line_number\"]},\"+\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_liquid_tag\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":53,"raw_source":"def tokenize\n      if @for_liquid_tag\n        @tokens = @source.split(\"\\n\")\n      else\n        @tokens << shift_normal until @ss.eos?\n      end\n\n      @source = nil\n      @ss = nil\n    end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_liquid_tag\"]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"split\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"eos?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"shift_normal\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@source\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@ss\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":64,"raw_source":"def shift_normal\n      token = next_token\n\n      return unless token\n\n      token\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"shift_normal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"next_token\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":72,"raw_source":"def next_token\n      # possible states: :text, :tag, :variable\n      byte_a = @ss.peek_byte\n\n      if byte_a == OPEN_CURLEY\n        @ss.scan_byte\n\n        byte_b = @ss.peek_byte\n\n        if byte_b == PERCENTAGE\n          @ss.scan_byte\n          return next_tag_token\n        elsif byte_b == OPEN_CURLEY\n          @ss.scan_byte\n          return next_variable_token\n        end\n\n        @ss.pos -= 1\n      end\n\n      next_text_token\n    end","complexity_score":19.7,"ast_json":"{\"type\":\"def\",\"children\":[\"next_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"PERCENTAGE\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_tag_token\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_variable_token\"]}]}]},null]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"next_text_token\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":95,"raw_source":"def next_text_token\n      start = @ss.pos\n\n      unless @ss.skip_until(TAG_OR_VARIABLE_START)\n        token = @ss.rest\n        @ss.terminate\n        return token\n      end\n\n      pos = @ss.pos -= 2\n      @source.byteslice(start, pos - start)\n    rescue ::ArgumentError => e\n      if e.message == \"invalid byte sequence in #{@ss.string.encoding}\"\n        raise SyntaxError, \"Invalid byte sequence in #{@ss.string.encoding}\"\n      else\n        raise\n      end\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"next_text_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_OR_VARIABLE_START\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"rest\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"terminate\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pos\",{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]},\"==\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":114,"raw_source":"def next_variable_token\n      start = @ss.pos - 2\n\n      byte_a = byte_b = @ss.scan_byte\n\n      while byte_b\n        byte_a = @ss.scan_byte while byte_a && (byte_a != CLOSE_CURLEY && byte_a != OPEN_CURLEY)\n\n        break unless byte_a\n\n        if @ss.eos?\n          return byte_a == CLOSE_CURLEY ? @source.byteslice(start, @ss.pos - start) : \"{{\"\n        end\n\n        byte_b = @ss.scan_byte\n\n        if byte_a == CLOSE_CURLEY\n          if byte_b == CLOSE_CURLEY\n            return @source.byteslice(start, @ss.pos - start)\n          elsif byte_b != CLOSE_CURLEY\n            @ss.pos -= 1\n            return @source.byteslice(start, @ss.pos - start)\n          end\n        elsif byte_a == OPEN_CURLEY && byte_b == PERCENTAGE\n          return next_tag_token_with_start(start)\n        end\n\n        byte_a = byte_b\n      end\n\n      \"{{\"\n    end","complexity_score":56.8,"ast_json":"{\"type\":\"def\",\"children\":[\"next_variable_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},null,{\"type\":\"break\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"eos?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]},{\"type\":\"str\",\"children\":[\"{{\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"PERCENTAGE\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_tag_token_with_start\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]},null]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"lvar\",\"children\":[\"byte_b\"]}]}]}]},{\"type\":\"str\",\"children\":[\"{{\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":147,"raw_source":"def next_tag_token\n      start = @ss.pos - 2\n      if (len = @ss.skip_until(TAG_END))\n        @source.byteslice(start, len + 2)\n      else\n        \"{%\"\n      end\n    end","complexity_score":9.28,"ast_json":"{\"type\":\"def\",\"children\":[\"next_tag_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"len\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_END\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"len\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"str\",\"children\":[\"{%\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":156,"raw_source":"def next_tag_token_with_start(start)\n      @ss.skip_until(TAG_END)\n      @source.byteslice(start, @ss.pos - start)\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"next_tag_token_with_start\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_END\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/usage.rb","start_line":5,"raw_source":"def self.increment(name)\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"increment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":5,"raw_source":"def self.slice_collection(collection, from, to)\n      if (from != 0 || !to.nil?) && collection.respond_to?(:load_slice)\n        collection.load_slice(from, to)\n      else\n        slice_collection_using_each(collection, from, to)\n      end\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"slice_collection\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]},{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"!=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"nil?\"]},\"!\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"load_slice\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"load_slice\",{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]},{\"type\":\"send\",\"children\":[null,\"slice_collection_using_each\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":13,"raw_source":"def self.slice_collection_using_each(collection, from, to)\n      segments = []\n      index    = 0\n\n      # Maintains Ruby 1.8.7 String#each behaviour on 1.9\n      if collection.is_a?(String)\n        return collection.empty? ? [] : [collection]\n      end\n      return [] unless collection.respond_to?(:each)\n\n      collection.each do |item|\n        if to && to <= index\n          break\n        end\n\n        if from <= index\n          segments << item\n        end\n\n        index += 1\n      end\n\n      segments\n    end","complexity_score":20.35,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"slice_collection_using_each\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]},{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"segments\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"index\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"index\"]}]}]},{\"type\":\"break\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segments\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"item\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvar\",\"children\":[\"segments\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":38,"raw_source":"def self.to_integer(num)\n      return num if num.is_a?(Integer)\n      num = num.to_s\n      begin\n        Integer(num)\n      rescue ::ArgumentError\n        raise Liquid::ArgumentError, \"invalid integer\"\n      end\n    end","complexity_score":7.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"num\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"num\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]},\"to_s\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"num\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]},null]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":48,"raw_source":"def self.to_number(obj)\n      case obj\n      when Float\n        BigDecimal(obj.to_s)\n      when Numeric\n        obj\n      when String\n        /\\A-?\\d+\\.\\d+\\z/.match?(obj.strip) ? BigDecimal(obj) : obj.to_i\n      else\n        if obj.respond_to?(:to_number)\n          obj.to_number\n        else\n          0\n        end\n      end\n    end","complexity_score":16.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_number\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Float\"]},{\"type\":\"send\",\"children\":[null,\"BigDecimal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Numeric\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A-?\\\\d+\\\\.\\\\d+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"strip\"]}]},{\"type\":\"send\",\"children\":[null,\"BigDecimal\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_i\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_number\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":65,"raw_source":"def self.to_date(obj)\n      return obj if obj.respond_to?(:strftime)\n\n      if obj.is_a?(String)\n        return nil if obj.empty?\n        obj = obj.downcase\n      end\n\n      case obj\n      when 'now', 'today'\n        Time.now\n      when /\\A\\d+\\z/, Integer\n        Time.at(obj.to_i)\n      when String\n        Time.parse(obj)\n      end\n    rescue ::ArgumentError\n      nil\n    end","complexity_score":22.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_date\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"strftime\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"downcase\"]}]}]},null]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"now\"]},{\"type\":\"str\",\"children\":[\"today\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A\\\\d+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_i\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]},null]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":85,"raw_source":"def self.to_liquid_value(obj)\n      # Enable \"obj\" to represent itself as a primitive value like integer, string, or boolean\n      return obj.to_liquid_value if obj.respond_to?(:to_liquid_value)\n\n      # Otherwise return the object itself\n      obj\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_liquid_value\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_liquid_value\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_liquid_value\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":93,"raw_source":"def self.to_s(obj, seen = {})\n      case obj\n      when Hash\n        # If the custom hash implementation overrides `#to_s`, use their\n        # custom implementation. Otherwise we use Liquid's default\n        # implementation.\n        if obj.class.instance_method(:to_s) == HASH_TO_S_METHOD\n          hash_inspect(obj, seen)\n        else\n          obj.to_s\n        end\n      when Array\n        array_inspect(obj, seen)\n      else\n        obj.to_s\n      end\n    end","complexity_score":15.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"class\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"to_s\"]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"HASH_TO_S_METHOD\"]}]},{\"type\":\"send\",\"children\":[null,\"hash_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"array_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":111,"raw_source":"def self.inspect(obj, seen = {})\n      case obj\n      when Hash\n        # If the custom hash implementation overrides `#inspect`, use their\n        # custom implementation. Otherwise we use Liquid's default\n        # implementation.\n        if obj.class.instance_method(:inspect) == HASH_INSPECT_METHOD\n          hash_inspect(obj, seen)\n        else\n          obj.inspect\n        end\n      when Array\n        array_inspect(obj, seen)\n      else\n        obj.inspect\n      end\n    end","complexity_score":15.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"class\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"inspect\"]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"HASH_INSPECT_METHOD\"]}]},{\"type\":\"send\",\"children\":[null,\"hash_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"array_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":129,"raw_source":"def self.array_inspect(arr, seen = {})\n      if seen[arr.object_id]\n        return \"[...]\"\n      end\n\n      seen[arr.object_id] = true\n      str = +\"[\"\n      cursor = 0\n      len = arr.length\n\n      while cursor < len\n        if cursor > 0\n          str << \", \"\n        end\n\n        item_str = inspect(arr[cursor], seen)\n        str << item_str\n        cursor += 1\n      end\n\n      str << \"]\"\n      str\n    ensure\n      seen.delete(arr.object_id)\n    end","complexity_score":30.18,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"array_inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arr\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"[...]\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"cursor\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"len\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"length\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cursor\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"len\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cursor\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\", \"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"item_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cursor\"]}]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"item_str\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cursor\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":155,"raw_source":"def self.hash_inspect(hash, seen = {})\n      if seen[hash.object_id]\n        return \"{...}\"\n      end\n      seen[hash.object_id] = true\n\n      str = +\"{\"\n      first = true\n      hash.each do |key, value|\n        if first\n          first = false\n        else\n          str << \", \"\n        end\n\n        key_str = inspect(key, seen)\n        str << key_str\n        str << \"=>\"\n\n        value_str = inspect(value, seen)\n        str << value_str\n      end\n      str << \"}\"\n      str\n    ensure\n      seen.delete(hash.object_id)\n    end","complexity_score":28.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"hash_inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"{...}\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\", \"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"key_str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"=>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"value_str\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":27,"raw_source":"def initialize(markup, parse_context)\n      @markup        = markup\n      @name          = nil\n      @parse_context = parse_context\n      @line_number   = parse_context.line_number\n\n      strict_parse_with_error_mode_fallback(markup)\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@markup\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_mode_fallback\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":36,"raw_source":"def raw\n      @markup\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@markup\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":40,"raw_source":"def markup_context(markup)\n      \"in \\\"{{#{markup}}}\\\"\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markup_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"in \\\"{{\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\"}}\\\"\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":44,"raw_source":"def lax_parse(markup)\n      @filters = []\n      return unless markup =~ MarkupWithQuotedFragment\n\n      name_markup   = Regexp.last_match(1)\n      filter_markup = Regexp.last_match(2)\n      @name         = parse_context.parse_expression(name_markup)\n      if filter_markup =~ FilterMarkupRegex\n        filters = Regexp.last_match(1).scan(FilterParser)\n        filters.each do |f|\n          next unless f =~ /\\w+/\n          filtername = Regexp.last_match(0)\n          filterargs = f.scan(FilterArgsRegex).flatten\n          @filters << parse_filter_expressions(filtername, filterargs)\n        end\n      end\n    end","complexity_score":31.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"MarkupWithQuotedFragment\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"name_markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filter_markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"name_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"FilterMarkupRegex\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filters\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"FilterParser\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\w+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"filtername\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"FilterArgsRegex\"]}]},\"flatten\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"parse_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"filtername\"]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}]}]}]},null]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":62,"raw_source":"def strict_parse(markup)\n      @filters = []\n      p = @parse_context.new_parser(markup)\n\n      return if p.look(:end_of_string)\n\n      @name = parse_context.parse_expression(p.expression)\n      while p.consume?(:pipe)\n        filtername = p.consume(:id)\n        filterargs = p.consume?(:colon) ? parse_filterargs(p) : Const::EMPTY_ARRAY\n        @filters << parse_filter_expressions(filtername, filterargs)\n      end\n      p.consume(:end_of_string)\n    end","complexity_score":22.4,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"pipe\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filtername\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"colon\"]}]},{\"type\":\"send\",\"children\":[null,\"parse_filterargs\",{\"type\":\"lvar\",\"children\":[\"p\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"parse_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"filtername\"]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":77,"raw_source":"def parse_filterargs(p)\n      # first argument\n      filterargs = [p.argument]\n      # followed by comma separated others\n      filterargs << p.argument while p.consume?(:comma)\n      filterargs\n    end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_filterargs\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filterargs\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":85,"raw_source":"def render(context)\n      obj = context.evaluate(@name)\n\n      @filters.each do |filter_name, filter_args, filter_kwargs|\n        filter_args = evaluate_filter_expressions(context, filter_args, filter_kwargs)\n        obj = context.invoke(filter_name, obj, *filter_args)\n      end\n\n      context.apply_global_filter(obj)\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter_name\"]},{\"type\":\"arg\",\"children\":[\"filter_args\"]},{\"type\":\"arg\",\"children\":[\"filter_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter_args\",{\"type\":\"send\",\"children\":[null,\"evaluate_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"filter_args\"]},{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"lvar\",\"children\":[\"filter_name\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":96,"raw_source":"def render_to_output_buffer(context, output)\n      obj = render(context)\n      render_obj_to_output(obj, output)\n      output\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"render_obj_to_output\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":102,"raw_source":"def render_obj_to_output(obj, output)\n      case obj\n      when NilClass\n        # Do nothing\n      when Array\n        obj.each do |o|\n          render_obj_to_output(o, output)\n        end\n      else\n        output << Liquid::Utils.to_s(obj)\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"render_obj_to_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NilClass\"]},null]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"render_obj_to_output\",{\"type\":\"lvar\",\"children\":[\"o\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":115,"raw_source":"def disabled?(_context)\n      false\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"disabled?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},{\"type\":\"false\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":119,"raw_source":"def disabled_tags\n      []\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"disabled_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":125,"raw_source":"def parse_filter_expressions(filter_name, unparsed_args)\n      filter_args  = []\n      keyword_args = nil\n      unparsed_args.each do |a|\n        if (matches = a.match(JustTagAttributes))\n          keyword_args           ||= {}\n          keyword_args[matches[1]] = parse_context.parse_expression(matches[2])\n        else\n          filter_args << parse_context.parse_expression(a)\n        end\n      end\n      result = [filter_name, filter_args]\n      result << keyword_args if keyword_args\n      result\n    end","complexity_score":23.6,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_filter_expressions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter_name\"]},{\"type\":\"arg\",\"children\":[\"unparsed_args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter_args\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"keyword_args\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unparsed_args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"matches\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"match\",{\"type\":\"const\",\"children\":[null,\"JustTagAttributes\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"keyword_args\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keyword_args\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matches\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matches\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_name\"]},{\"type\":\"lvar\",\"children\":[\"filter_args\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keyword_args\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"keyword_args\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":141,"raw_source":"def evaluate_filter_expressions(context, filter_args, filter_kwargs)\n      parsed_args = filter_args.map { |expr| context.evaluate(expr) }\n      if filter_kwargs\n        parsed_kwargs = {}\n        filter_kwargs.each do |key, expr|\n          parsed_kwargs[key] = context.evaluate(expr)\n        end\n        parsed_args << parsed_kwargs\n      end\n      parsed_args\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate_filter_expressions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"filter_args\"]},{\"type\":\"arg\",\"children\":[\"filter_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_args\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_kwargs\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parsed_kwargs\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parsed_args\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"parsed_kwargs\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"parsed_args\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":154,"raw_source":"def children\n        [@node.name] + @node.filters.flatten\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"name\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"filters\"]},\"flatten\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":9,"raw_source":"def self.parse(markup, string_scanner = StringScanner.new(\"\"), cache = nil)\n      new(markup, string_scanner, cache)\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":13,"raw_source":"def initialize(markup, string_scanner = StringScanner.new(\"\"), cache = nil)\n      lookups = markup.scan(VariableParser)\n\n      name = lookups.shift\n      if name&.start_with?('[') && name&.end_with?(']')\n        name = Expression.parse(\n          name[1..-2],\n          string_scanner,\n          cache,\n        )\n      end\n      @name = name\n\n      @lookups       = lookups\n      @command_flags = 0\n\n      @lookups.each_index do |i|\n        lookup = lookups[i]\n        if lookup&.start_with?('[') && lookup&.end_with?(']')\n          lookups[i] = Expression.parse(\n            lookup[1..-2],\n            string_scanner,\n            cache,\n          )\n        elsif COMMAND_METHODS.include?(lookup)\n          @command_flags |= 1 << i\n        end\n      end\n    end","complexity_score":38.65,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookups\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"shift\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"[\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@lookups\",{\"type\":\"lvar\",\"children\":[\"lookups\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@command_flags\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"each_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"i\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookup\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"[\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"COMMAND_METHODS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"lookup\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@command_flags\"]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]},null]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":43,"raw_source":"def lookup_command?(lookup_index)\n      @command_flags & (1 << lookup_index) != 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lookup_command?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"lookup_index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@command_flags\"]},\"&\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"lvar\",\"children\":[\"lookup_index\"]}]}]}]},\"!=\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":47,"raw_source":"def evaluate(context)\n      name   = context.evaluate(@name)\n      object = context.find_variable(name)\n\n      @lookups.each_index do |i|\n        key = context.evaluate(@lookups[i])\n\n        # Cast \"key\" to its liquid value to enable it to act as a primitive value\n        key = Liquid::Utils.to_liquid_value(key)\n\n        # If object is a hash- or array-like object we look for the\n        # presence of the key and if its available we return it\n        if object.respond_to?(:[]) &&\n            ((object.respond_to?(:key?) && object.key?(key)) ||\n             (object.respond_to?(:fetch) && key.is_a?(Integer)))\n\n          # if its a proc we will replace the entry with the proc\n          res    = context.lookup_and_evaluate(object, key)\n          object = res.to_liquid\n\n          # Some special cases. If the part wasn't in square brackets and\n          # no key with the same name was found we interpret following calls\n          # as commands and call them on the current object\n        elsif lookup_command?(i) && object.respond_to?(key)\n          object = object.send(key).to_liquid\n\n          # No key was present with the desired value and it wasn't one of the directly supported\n          # keywords either. The only thing we got left is to return nil or\n          # raise an exception if `strict_variables` option is set to true\n        else\n          return nil unless context.strict_variables\n          raise Liquid::UndefinedVariable, \"undefined variable #{key}\"\n        end\n\n        # If we are dealing with a drop here we have to\n        object.context = context if object.respond_to?(:context=)\n      end\n\n      object\n    end","complexity_score":52.8,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"find_variable\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"each_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"i\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"fetch\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]}]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"to_liquid\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lookup_command?\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"to_liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_variables\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedVariable\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined variable \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"context=\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":88,"raw_source":"def ==(other)\n      self.class == other.class && state == other.state\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"==\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"class\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"state\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"state\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":94,"raw_source":"def state\n      [@name, @lookups, @command_flags]\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"state\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@name\"]},{\"type\":\"ivar\",\"children\":[\"@lookups\"]},{\"type\":\"ivar\",\"children\":[\"@command_flags\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":99,"raw_source":"def children\n        @node.lookups\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"lookups\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":12,"raw_source":"def self.run\n    puts\n    yield new\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"puts\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":17,"raw_source":"def initialize\n    @allocated = []\n    @retained  = []\n    @headings  = []\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@allocated\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@retained\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@headings\",{\"type\":\"array\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":23,"raw_source":"def profile(phase, &block)\n    print(LOG_LABEL)\n    print(\"#{phase}.. \".ljust(10))\n    report = MemoryProfiler.report(&block)\n    puts 'Done.'\n    @headings  << phase.capitalize\n    @allocated << \"#{report.scale_bytes(report.total_allocated_memsize)} (#{report.total_allocated} objects)\"\n    @retained  << \"#{report.scale_bytes(report.total_retained_memsize)} (#{report.total_retained} objects)\"\n\n    return if ENV['CI']\n\n    require 'fileutils'\n    report_file = File.join(REPORTS_DIR, \"#{sanitize(phase)}.txt\")\n    FileUtils.mkdir_p(REPORTS_DIR)\n    report.pretty_print(to_file: report_file, scale_bytes: true)\n  end","complexity_score":27.75,"ast_json":"{\"type\":\"def\",\"children\":[\"profile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"phase\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"const\",\"children\":[null,\"LOG_LABEL\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"phase\"]}]},{\"type\":\"str\",\"children\":[\".. \"]}]},\"ljust\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"report\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MemoryProfiler\"]},\"report\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"str\",\"children\":[\"Done.\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@headings\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"phase\"]},\"capitalize\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@allocated\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"scale_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_allocated_memsize\"]}]}]},{\"type\":\"str\",\"children\":[\" (\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_allocated\"]}]},{\"type\":\"str\",\"children\":[\" objects)\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@retained\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"scale_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_retained_memsize\"]}]}]},{\"type\":\"str\",\"children\":[\" (\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_retained\"]}]},{\"type\":\"str\",\"children\":[\" objects)\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"CI\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"str\",\"children\":[\"fileutils\"]}]},{\"type\":\"lvasgn\",\"children\":[\"report_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize\",{\"type\":\"lvar\",\"children\":[\"phase\"]}]}]},{\"type\":\"str\",\"children\":[\".txt\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FileUtils\"]},\"mkdir_p\",{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"pretty_print\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_file\"]},{\"type\":\"lvar\",\"children\":[\"report_file\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"scale_bytes\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":40,"raw_source":"def tabulate\n    table = Terminal::Table.new(headings: @headings.unshift('Phase')) do |t|\n      t << @allocated.unshift('Total allocated')\n      t << @retained.unshift('Total retained')\n    end\n\n    puts\n    puts table\n    puts \"\\nDetailed report(s) saved to #{REPORTS_DIR}/\" unless ENV['CI']\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"tabulate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"table\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Terminal\"]},\"Table\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"headings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@headings\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Phase\"]}]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@allocated\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Total allocated\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@retained\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Total retained\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"puts\"]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"lvar\",\"children\":[\"table\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"CI\"]}]},null,{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\nDetailed report(s) saved to \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]}]},{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":51,"raw_source":"def sanitize(string)\n    string.downcase.gsub(/[\\W]/, '-').squeeze('-')\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"sanitize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"downcase\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\\W]\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]},\"squeeze\",{\"type\":\"str\",\"children\":[\"-\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/comment_form.rb","start_line":6,"raw_source":"def initialize(tag_name, markup, options)\n    super\n\n    if markup =~ Syntax\n      @variable_name = Regexp.last_match(1)\n      @attributes    = {}\n    else\n      raise SyntaxError, \"Syntax Error in 'comment_form' - Valid syntax: comment_form [article]\"\n    end\n  end","complexity_score":7.05,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"str\",\"children\":[\"Syntax Error in 'comment_form' - Valid syntax: comment_form [article]\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/comment_form.rb","start_line":17,"raw_source":"def render_to_output_buffer(context, output)\n    article = context[@variable_name]\n\n    context.stack do\n      context['form'] = {\n        'posted_successfully?' => context.registers[:posted_successfully],\n        'errors' => context['comment.errors'],\n        'author' => context['comment.author'],\n        'email' => context['comment.email'],\n        'body' => context['comment.body'],\n      }\n\n      output << wrap_in_form(article, render_all(@nodelist, context, output))\n      output\n    end\n  end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"article\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"form\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"posted_successfully?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"posted_successfully\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.errors\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"author\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.author\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"email\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.email\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.body\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"wrap_in_form\",{\"type\":\"lvar\",\"children\":[\"article\"]},{\"type\":\"send\",\"children\":[null,\"render_all\",{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/comment_form.rb","start_line":34,"raw_source":"def wrap_in_form(article, input)\n    %(<form id=\"article-#{article.id}-comment-form\" class=\"comment-form\" method=\"post\" action=\"\">\\n#{input}\\n</form>)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"wrap_in_form\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"article\"]},{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<form id=\\\"article-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"article\"]},\"id\"]}]},{\"type\":\"str\",\"children\":[\"-comment-form\\\" class=\\\"comment-form\\\" method=\\\"post\\\" action=\\\"\\\">\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\"\\n</form>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/database.rb","start_line":10,"raw_source":"def self.tables\n    @tables ||= begin\n      db =\n        if YAML.respond_to?(:unsafe_load_file) # Only Psych 4+ can use unsafe_load_file\n          # unsafe_load_file is needed for YAML references\n          YAML.unsafe_load_file(DATABASE_FILE_PATH)\n        else\n          YAML.load_file(DATABASE_FILE_PATH)\n        end\n\n      # From vision source\n      db['products'].each do |product|\n        collections = db['collections'].find_all do |collection|\n          collection['products'].any? { |p| p['id'].to_i == product['id'].to_i }\n        end\n        product['collections'] = collections\n      end\n\n      # key the tables by handles, as this is how liquid expects it.\n      db = db.each_with_object({}) do |(key, values), assigns|\n        assigns[key] = values.each_with_object({}) do |v, h|\n          h[v['handle']] = v\n        end\n      end\n\n      # Some standard direct accessors so that the specialized templates\n      # render correctly\n      db['collection'] = db['collections'].values.first\n      db['product']    = db['products'].values.first\n      db['blog']       = db['blogs'].values.first\n      db['article']    = db['blog']['articles'].first\n\n      db['cart']       = {\n        'total_price' => db['line_items'].values.inject(0) { |sum, item| sum + item['line_price'] * item['quantity'] },\n        'item_count' => db['line_items'].values.inject(0) { |sum, item| sum + item['quantity'] },\n        'items' => db['line_items'].values,\n      }\n\n      db\n    end\n  end","complexity_score":87.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"tables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tables\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"db\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"unsafe_load_file\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"unsafe_load_file\",{\"type\":\"const\",\"children\":[null,\"DATABASE_FILE_PATH\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load_file\",{\"type\":\"const\",\"children\":[null,\"DATABASE_FILE_PATH\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"product\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"collections\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"collections\"]}]},\"find_all\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"[]\",{\"type\":\"str\",\"children\":[\"id\"]}]},\"to_i\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"product\"]},\"[]\",{\"type\":\"str\",\"children\":[\"id\"]}]},\"to_i\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"product\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"lvar\",\"children\":[\"collections\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"db\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"each_with_object\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"values\"]}]},{\"type\":\"arg\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"each_with_object\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]},{\"type\":\"arg\",\"children\":[\"h\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"collections\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"blog\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"blogs\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"article\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"blog\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"articles\"]}]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"cart\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"total_price\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]},\"inject\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"sum\"]},{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_price\"]}]},\"*\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"item_count\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]},\"inject\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"sum\"]},{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"db\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/json_filter.rb","start_line":6,"raw_source":"def json(object)\n    JSON.dump(object.reject { |k, _v| k == \"collections\" })\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"json\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"JSON\"]},\"dump\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"==\",{\"type\":\"str\",\"children\":[\"collections\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":4,"raw_source":"def money_with_currency(money)\n    return '' if money.nil?\n    format(\"$ %.2f USD\", money / 100.0)\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"money_with_currency\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"money\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$ %.2f USD\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":9,"raw_source":"def money(money)\n    return '' if money.nil?\n    format(\"$ %.2f\", money / 100.0)\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"money\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$ %.2f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":16,"raw_source":"def currency\n    ShopDrop.new.currency\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"currency\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ShopDrop\"]},\"new\"]},\"currency\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":6,"raw_source":"def initialize(tag_name, markup, options)\n    super\n\n    if markup =~ Syntax\n      @collection_name = Regexp.last_match(1)\n      @page_size       = if Regexp.last_match(2)\n        Regexp.last_match(3).to_i\n      else\n        20\n      end\n\n      @attributes = { 'window_size' => 3 }\n      markup.scan(Liquid::TagAttributes) do |key, value|\n        @attributes[key] = value\n      end\n    else\n      raise SyntaxError, \"Syntax Error in tag 'paginate' - Valid syntax: paginate [collection] by number\"\n    end\n  end","complexity_score":18.55,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@page_size\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"to_i\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"window_size\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"str\",\"children\":[\"Syntax Error in tag 'paginate' - Valid syntax: paginate [collection] by number\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":26,"raw_source":"def render_to_output_buffer(context, output)\n    @context = context\n\n    context.stack do\n      current_page = context['current_page'].to_i\n\n      pagination = {\n        'page_size' => @page_size,\n        'current_page' => 5,\n        'current_offset' => @page_size * 5,\n      }\n\n      context['paginate'] = pagination\n\n      collection_size = context[@collection_name].size\n\n      raise ArgumentError, \"Cannot paginate array '#{@collection_name}'. Not found.\" if collection_size.nil?\n\n      page_count = (collection_size.to_f / @page_size.to_f).to_f.ceil + 1\n\n      pagination['items']      = collection_size\n      pagination['pages']      = page_count - 1\n      pagination['previous']   = link('&laquo; Previous', current_page - 1)  if 1 < current_page\n      pagination['next']       = link('Next &raquo;', current_page + 1)      if page_count > current_page + 1\n      pagination['parts']      = []\n\n      hellip_break = false\n\n      if page_count > 2\n        1.upto(page_count - 1) do |page|\n          if current_page == page\n            pagination['parts'] << no_link(page)\n          elsif page == 1\n            pagination['parts'] << link(page, page)\n          elsif page == page_count - 1\n            pagination['parts'] << link(page, page)\n          elsif page <= current_page - @attributes['window_size'] || page >= current_page + @attributes['window_size']\n            next if hellip_break\n            pagination['parts'] << no_link('&hellip;')\n            hellip_break = true\n            next\n          else\n            pagination['parts'] << link(page, page)\n          end\n\n          hellip_break = false\n        end\n      end\n\n      super\n    end\n  end","complexity_score":123.28,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"current_page\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_page\"]}]},\"to_i\"]}]},{\"type\":\"lvasgn\",\"children\":[\"pagination\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"page_size\"]},{\"type\":\"ivar\",\"children\":[\"@page_size\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"current_page\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"current_offset\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@page_size\"]},\"*\",{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"paginate\"]},{\"type\":\"lvar\",\"children\":[\"pagination\"]}]},{\"type\":\"lvasgn\",\"children\":[\"collection_size\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]},\"size\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_size\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Cannot paginate array '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]},{\"type\":\"str\",\"children\":[\"'. Not found.\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"page_count\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_size\"]},\"to_f\"]},\"/\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@page_size\"]},\"to_f\"]}]}]},\"to_f\"]},\"ceil\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"collection_size\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"pages\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page_count\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<\",{\"type\":\"lvar\",\"children\":[\"current_page\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"previous\"]},{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"str\",\"children\":[\"&laquo; Previous\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page_count\"]},\">\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"next\"]},{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"str\",\"children\":[\"Next &raquo;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"parts\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"hellip_break\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page_count\"]},\">\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"upto\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page_count\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"page\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"page\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"no_link\",{\"type\":\"lvar\",\"children\":[\"page\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"lvar\",\"children\":[\"page\"]},{\"type\":\"lvar\",\"children\":[\"page\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page_count\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"lvar\",\"children\":[\"page\"]},{\"type\":\"lvar\",\"children\":[\"page\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]},\"<=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"window_size\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"current_page\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"window_size\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hellip_break\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"no_link\",{\"type\":\"str\",\"children\":[\"&hellip;\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hellip_break\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"next\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pagination\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"lvar\",\"children\":[\"page\"]},{\"type\":\"lvar\",\"children\":[\"page\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hellip_break\",{\"type\":\"false\",\"children\":[]}]}]}]},null]},{\"type\":\"zsuper\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":81,"raw_source":"def no_link(title)\n    { 'title' => title, 'is_link' => false }\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"no_link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"title\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"lvar\",\"children\":[\"title\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"is_link\"]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":85,"raw_source":"def link(title, page)\n    { 'title' => title, 'url' => current_url + \"?page=#{page}\", 'is_link' => true }\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"title\"]},{\"type\":\"arg\",\"children\":[\"page\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"lvar\",\"children\":[\"title\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"url\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_url\"]},\"+\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"?page=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"is_link\"]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":89,"raw_source":"def current_url\n    \"/collections/frontpage\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"current_url\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"/collections/frontpage\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":4,"raw_source":"def asset_url(input)\n    \"/files/1/[shop_id]/[shop_id]/assets/#{input}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"asset_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/files/1/[shop_id]/[shop_id]/assets/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":8,"raw_source":"def global_asset_url(input)\n    \"/global/#{input}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"global_asset_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/global/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":12,"raw_source":"def shopify_asset_url(input)\n    \"/shopify/#{input}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"shopify_asset_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/shopify/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":16,"raw_source":"def script_tag(url)\n    %(<script src=\"#{url}\" type=\"text/javascript\"></script>)\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"script_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<script src=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]},{\"type\":\"str\",\"children\":[\"\\\" type=\\\"text/javascript\\\"></script>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":20,"raw_source":"def stylesheet_tag(url, media = \"all\")\n    %(<link href=\"#{url}\" rel=\"stylesheet\" type=\"text/css\"  media=\"#{media}\"  />)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"stylesheet_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]},{\"type\":\"optarg\",\"children\":[\"media\",{\"type\":\"str\",\"children\":[\"all\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<link href=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]},{\"type\":\"str\",\"children\":[\"\\\" rel=\\\"stylesheet\\\" type=\\\"text/css\\\"  media=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"media\"]}]},{\"type\":\"str\",\"children\":[\"\\\"  />\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":24,"raw_source":"def link_to(link, url, title = \"\")\n    %(<a href=\"#{url}\" title=\"#{title}\">#{link}</a>)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"link\"]},{\"type\":\"arg\",\"children\":[\"url\"]},{\"type\":\"optarg\",\"children\":[\"title\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a href=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]},{\"type\":\"str\",\"children\":[\"\\\" title=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"title\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":28,"raw_source":"def img_tag(url, alt = \"\")\n    %(<img src=\"#{url}\" alt=\"#{alt}\" />)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"img_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]},{\"type\":\"optarg\",\"children\":[\"alt\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<img src=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]},{\"type\":\"str\",\"children\":[\"\\\" alt=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"alt\"]}]},{\"type\":\"str\",\"children\":[\"\\\" />\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":32,"raw_source":"def link_to_vendor(vendor)\n    if vendor\n      link_to(vendor, url_for_vendor(vendor), vendor)\n    else\n      'Unknown Vendor'\n    end\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_vendor\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"vendor\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"vendor\"]},{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"lvar\",\"children\":[\"vendor\"]},{\"type\":\"send\",\"children\":[null,\"url_for_vendor\",{\"type\":\"lvar\",\"children\":[\"vendor\"]}]},{\"type\":\"lvar\",\"children\":[\"vendor\"]}]},{\"type\":\"str\",\"children\":[\"Unknown Vendor\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":40,"raw_source":"def link_to_type(type)\n    if type\n      link_to(type, url_for_type(type), type)\n    else\n      'Unknown Vendor'\n    end\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[null,\"url_for_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\"Unknown Vendor\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":48,"raw_source":"def url_for_vendor(vendor_title)\n    \"/collections/#{to_handle(vendor_title)}\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"url_for_vendor\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"vendor_title\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_handle\",{\"type\":\"lvar\",\"children\":[\"vendor_title\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":52,"raw_source":"def url_for_type(type_title)\n    \"/collections/#{to_handle(type_title)}\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"url_for_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type_title\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_handle\",{\"type\":\"lvar\",\"children\":[\"type_title\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":56,"raw_source":"def product_img_url(url, style = 'small')\n    unless url =~ %r{\\Aproducts/([\\w\\-\\_]+)\\.(\\w{2,4})}\n      raise ArgumentError, 'filter \"size\" can only be called on product images'\n    end\n\n    case style\n    when 'original'\n      '/files/shops/random_number/' + url\n    when 'grande', 'large', 'medium', 'compact', 'small', 'thumb', 'icon'\n      \"/files/shops/random_number/products/#{Regexp.last_match(1)}_#{style}.#{Regexp.last_match(2)}\"\n    else\n      raise ArgumentError, 'valid parameters for filter \"size\" are: original, grande, large, medium, compact, small, thumb and icon '\n    end\n  end","complexity_score":11.7,"ast_json":"{\"type\":\"def\",\"children\":[\"product_img_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]},{\"type\":\"optarg\",\"children\":[\"style\",{\"type\":\"str\",\"children\":[\"small\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\Aproducts/([\\\\w\\\\-\\\\_]+)\\\\.(\\\\w{2,4})\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"filter \\\"size\\\" can only be called on product images\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"style\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"original\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"/files/shops/random_number/\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"grande\"]},{\"type\":\"str\",\"children\":[\"large\"]},{\"type\":\"str\",\"children\":[\"medium\"]},{\"type\":\"str\",\"children\":[\"compact\"]},{\"type\":\"str\",\"children\":[\"small\"]},{\"type\":\"str\",\"children\":[\"thumb\"]},{\"type\":\"str\",\"children\":[\"icon\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/files/shops/random_number/products/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"style\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"valid parameters for filter \\\"size\\\" are: original, grande, large, medium, compact, small, thumb and icon \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":71,"raw_source":"def default_pagination(paginate)\n    html = []\n    html << %(<span class=\"prev\">#{link_to(paginate['previous']['title'], paginate['previous']['url'])}</span>) if paginate['previous']\n\n    paginate['parts'].each do |part|\n      html << if part['is_link']\n        %(<span class=\"page\">#{link_to(part['title'], part['url'])}</span>)\n      elsif part['title'].to_i == paginate['current_page'].to_i\n        %(<span class=\"page current\">#{part['title']}</span>)\n      else\n        %(<span class=\"deco\">#{part['title']}</span>)\n      end\n    end\n\n    html << %(<span class=\"next\">#{link_to(paginate['next']['title'], paginate['next']['url'])}</span>) if paginate['next']\n    html.join(' ')\n  end","complexity_score":47.7,"ast_json":"{\"type\":\"def\",\"children\":[\"default_pagination\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"paginate\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"html\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"prev\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"part\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"is_link\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"page\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},\"to_i\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_page\"]}]},\"to_i\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"page current\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"deco\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"next\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":91,"raw_source":"def pluralize(input, singular, plural)\n    input == 1 ? singular : plural\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"pluralize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"singular\"]},{\"type\":\"arg\",\"children\":[\"plural\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvar\",\"children\":[\"singular\"]},{\"type\":\"lvar\",\"children\":[\"plural\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":97,"raw_source":"def to_handle(str)\n    result = str.dup\n    result.downcase!\n    result.delete!(\"'\\\"()[]\")\n    result.gsub!(/\\W+/, '-')\n    result.gsub!(/-+\\z/, '') if result[-1] == '-'\n    result.gsub!(/\\A-+/, '') if result[0] == '-'\n    result\n  end","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"to_handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"downcase!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"delete!\",{\"type\":\"str\",\"children\":[\"'\\\"()[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\W+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[-1]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"-+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A-+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":4,"raw_source":"def link_to_tag(label, tag)\n    \"<a title=\\\"Show tag #{tag}\\\" href=\\\"/collections/#{@context['handle']}/#{tag}\\\">#{label}</a>\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"label\"]},{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a title=\\\"Show tag \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\" href=\\\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"label\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":8,"raw_source":"def highlight_active_tag(tag, css_class = 'active')\n    if @context['current_tags'].include?(tag)\n      \"<span class=\\\"#{css_class}\\\">#{tag}</span>\"\n    else\n      tag\n    end\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"highlight_active_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"optarg\",\"children\":[\"css_class\",{\"type\":\"str\",\"children\":[\"active\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"css_class\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":16,"raw_source":"def link_to_add_tag(label, tag)\n    tags = (@context['current_tags'] + [tag]).uniq\n    \"<a title=\\\"Show tag #{tag}\\\" href=\\\"/collections/#{@context['handle']}/#{tags.join('+')}\\\">#{label}</a>\"\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_add_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"label\"]},{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tags\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]},\"uniq\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a title=\\\"Show tag \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\" href=\\\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},\"join\",{\"type\":\"str\",\"children\":[\"+\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"label\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":21,"raw_source":"def link_to_remove_tag(label, tag)\n    tags = (@context['current_tags'] - [tag]).uniq\n    \"<a title=\\\"Show tag #{tag}\\\" href=\\\"/collections/#{@context['handle']}/#{tags.join('+')}\\\">#{label}</a>\"\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_remove_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"label\"]},{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tags\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]},\"uniq\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a title=\\\"Show tag \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\" href=\\\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},\"join\",{\"type\":\"str\",\"children\":[\"+\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"label\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/weight_filter.rb","start_line":4,"raw_source":"def weight(grams)\n    format(\"%.2f\", grams / 1000)\n  end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"weight\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"grams\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"%.2f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"grams\"]},\"/\",{\"type\":\"int\",\"children\":[1000]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/weight_filter.rb","start_line":8,"raw_source":"def weight_with_unit(grams)\n    \"#{weight(grams)} kg\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"weight_with_unit\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"grams\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"weight\",{\"type\":\"lvar\",\"children\":[\"grams\"]}]}]},{\"type\":\"str\",\"children\":[\" kg\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":16,"raw_source":"def initialize(path)\n      @path = path\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":21,"raw_source":"def read_template_file(template_path)\n      File.read(@path + '/' + template_path + '.liquid')\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@path\"]},\"+\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"+\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},\"+\",{\"type\":\"str\",\"children\":[\".liquid\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":28,"raw_source":"def initialize\n    @tests = Dir[__dir__ + '/tests/**/*.liquid'].collect do |test|\n      next if File.basename(test) == 'theme.liquid'\n\n      theme_path = File.dirname(test) + '/theme.liquid'\n      {\n        liquid: File.read(test),\n        layout: (File.file?(theme_path) ? File.read(theme_path) : nil),\n        template_name: test,\n      }\n    end.compact\n\n    compile_all_tests\n  end","complexity_score":24.7,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tests\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/tests/**/*.liquid\"]}]}]},\"collect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"theme.liquid\"]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"theme_path\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"/theme.liquid\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"test\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"file?\",{\"type\":\"lvar\",\"children\":[\"theme_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"theme_path\"]}]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]},{\"type\":\"lvar\",\"children\":[\"test\"]}]}]}]}]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"compile_all_tests\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":44,"raw_source":"def compile\n    @tests.each do |test_hash|\n      Liquid::Template.new.parse(test_hash[:liquid])\n      Liquid::Template.new.parse(test_hash[:layout])\n    end\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":52,"raw_source":"def tokenize\n    ss = StringScanner.new(\"\")\n    @tests.each do |test_hash|\n      tokenizer = Liquid::Tokenizer.new(\n        source: test_hash[:liquid],\n        string_scanner: ss,\n        line_numbers: true,\n      )\n      while tokenizer.shift; end\n    end\n  end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ss\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]},null]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":65,"raw_source":"def run\n    each_test do |liquid, layout, assigns, page_template, template_name|\n      compile_and_render(liquid, layout, assigns, page_template, template_name)\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_test\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"liquid\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[null,\"compile_and_render\",{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":72,"raw_source":"def render\n    @compiled_tests.each do |test|\n      tmpl    = test[:tmpl]\n      assigns = test[:assigns]\n      layout  = test[:layout]\n\n      if layout\n        assigns['content_for_layout'] = tmpl.render!(assigns)\n        layout.render!(assigns)\n      else\n        tmpl.render!(assigns)\n      end\n    end\n  end","complexity_score":15.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tmpl\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assigns\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content_for_layout\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":89,"raw_source":"def render_layout(template, layout, assigns)\n    assigns['content_for_layout'] = template.render!(assigns)\n    layout&.render!(assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_layout\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content_for_layout\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":94,"raw_source":"def compile_and_render(template, layout, assigns, page_template, template_file)\n    compiled_test = compile_test(template, layout, assigns, page_template, template_file)\n    render_layout(compiled_test[:tmpl], compiled_test[:layout], compiled_test[:assigns])\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_and_render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled_test\",{\"type\":\"send\",\"children\":[null,\"compile_test\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]},{\"type\":\"send\",\"children\":[null,\"render_layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tmpl\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assigns\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":99,"raw_source":"def compile_all_tests\n    @compiled_tests = []\n    each_test do |liquid, layout, assigns, page_template, template_name|\n      @compiled_tests << compile_test(liquid, layout, assigns, page_template, template_name)\n    end\n    @compiled_tests\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_all_tests\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@compiled_tests\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_test\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"liquid\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"compile_test\",{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":107,"raw_source":"def compile_test(template, layout, assigns, page_template, template_file)\n    tmpl            = init_template(page_template, template_file)\n    parsed_template = tmpl.parse(template).dup\n\n    if layout\n      parsed_layout = tmpl.parse(layout)\n      { tmpl: parsed_template, assigns: assigns, layout: parsed_layout }\n    else\n      { tmpl: parsed_template, assigns: assigns }\n    end\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[null,\"init_template\",{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parsed_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"layout\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tmpl\"]},{\"type\":\"lvar\",\"children\":[\"parsed_template\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"parsed_layout\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tmpl\"]},{\"type\":\"lvar\",\"children\":[\"parsed_template\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":120,"raw_source":"def each_test\n    # Dup assigns because will make some changes to them\n    assigns = Database.tables.dup\n\n    @tests.each do |test_hash|\n      # Compute page_template outside of profiler run, uninteresting to profiler\n      page_template = File.basename(test_hash[:template_name], File.extname(test_hash[:template_name]))\n      yield(test_hash[:liquid], test_hash[:layout], assigns, page_template, test_hash[:template_name])\n    end\n  end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_test\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Database\"]},\"tables\"]},\"dup\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"page_template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":132,"raw_source":"def init_template(page_template, template_file)\n    tmpl                         = Liquid::Template.new\n    tmpl.assigns['page_title']   = 'Page title'\n    tmpl.assigns['template']     = page_template\n    tmpl.registers[:file_system] = ThemeRunner::FileSystem.new(File.dirname(template_file))\n    tmpl\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"init_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"page_title\"]},{\"type\":\"str\",\"children\":[\"Page title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThemeRunner\"]},\"FileSystem\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"tmpl\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":8,"raw_source":"def test_assign_with_hyphen_in_variable_name\n    template_source = <<~END_TEMPLATE\n      {% assign this-thing = 'Print this-thing' -%}\n      {{ this-thing -}}\n    END_TEMPLATE\n    assert_template_result(\"Print this-thing\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_with_hyphen_in_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign this-thing = 'Print this-thing' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ this-thing -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Print this-thing\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":16,"raw_source":"def test_assigned_variable\n    assert_template_result(\n      '.foo.',\n      '{% assign foo = values %}.{{ foo[0] }}.',\n      { 'values' => %w(foo bar baz) },\n    )\n\n    assert_template_result(\n      '.bar.',\n      '{% assign foo = values %}.{{ foo[1] }}.',\n      { 'values' => %w(foo bar baz) },\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigned_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".foo.\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = values %}.{{ foo[0] }}.\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"values\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".bar.\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = values %}.{{ foo[1] }}.\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"values\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":30,"raw_source":"def test_assign_with_filter\n    assert_template_result(\n      '.bar.',\n      '{% assign foo = values | split: \",\" %}.{{ foo[1] }}.',\n      { 'values' => \"foo,bar,baz\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_with_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".bar.\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = values | split: \\\",\\\" %}.{{ foo[1] }}.\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"values\"]},{\"type\":\"str\",\"children\":[\"foo,bar,baz\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":38,"raw_source":"def test_assign_syntax_error\n    assert_match_syntax_error(/assign/, '{% assign foo not values %}.')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_syntax_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"assign\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% assign foo not values %}.\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":42,"raw_source":"def test_assign_uses_error_mode\n    assert_match_syntax_error(\n      \"Expected dotdot but found pipe in \",\n      \"{% assign foo = ('X' | downcase) %}\",\n      error_mode: :strict,\n    )\n    assert_template_result(\"\", \"{% assign foo = ('X' | downcase) %}\", error_mode: :lax)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_uses_error_mode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Expected dotdot but found pipe in \"]},{\"type\":\"str\",\"children\":[\"{% assign foo = ('X' | downcase) %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = ('X' | downcase) %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":51,"raw_source":"def test_expression_with_whitespace_in_square_brackets\n    source = \"{% assign r = a[ 'b' ] %}{{ r }}\"\n    assert_template_result('result', source, { 'a' => { 'b' => 'result' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_with_whitespace_in_square_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% assign r = a[ 'b' ] %}{{ r }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":56,"raw_source":"def test_assign_score_exceeding_resource_limit\n    t = Template.parse(\"{% assign foo = 42 %}{% assign bar = 23 %}\")\n    t.resource_limits.assign_score_limit = 1\n    assert_equal(\"Liquid error: Memory limits exceeded\", t.render)\n    assert(t.resource_limits.reached?)\n\n    t.resource_limits.assign_score_limit = 2\n    assert_equal(\"\", t.render!)\n    refute_nil(t.resource_limits.assign_score)\n  end","complexity_score":18.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_exceeding_resource_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign foo = 42 %}{% assign bar = 23 %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Memory limits exceeded\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"reached?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":67,"raw_source":"def test_assign_score_exceeding_limit_from_composite_object\n    t = Template.parse(\"{% assign foo = 'aaaa' | reverse %}\")\n\n    t.resource_limits.assign_score_limit = 3\n    assert_equal(\"Liquid error: Memory limits exceeded\", t.render)\n    assert(t.resource_limits.reached?)\n\n    t.resource_limits.assign_score_limit = 5\n    assert_equal(\"\", t.render!)\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_exceeding_limit_from_composite_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign foo = 'aaaa' | reverse %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Memory limits exceeded\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"reached?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":78,"raw_source":"def test_assign_score_of_int\n    assert_equal(1, assign_score_of(123))\n  end","complexity_score":2.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_int\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"int\",\"children\":[123]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":82,"raw_source":"def test_assign_score_of_string_counts_bytes\n    assert_equal(3, assign_score_of('123'))\n    assert_equal(5, assign_score_of('12345'))\n    assert_equal(9, assign_score_of(''))\n  end","complexity_score":7.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_string_counts_bytes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"123\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"12345\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":88,"raw_source":"def test_assign_score_of_array\n    assert_equal(1, assign_score_of([]))\n    assert_equal(2, assign_score_of([123]))\n    assert_equal(6, assign_score_of([123, 'abcd']))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[123]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[6]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[123]},{\"type\":\"str\",\"children\":[\"abcd\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":94,"raw_source":"def test_assign_score_of_hash\n    assert_equal(1, assign_score_of({}))\n    assert_equal(5, assign_score_of('int' => 123))\n    assert_equal(12, assign_score_of('int' => 123, 'str' => 'abcd'))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"int\"]},{\"type\":\"int\",\"children\":[123]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[12]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"int\"]},{\"type\":\"int\",\"children\":[123]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"str\"]},{\"type\":\"str\",\"children\":[\"abcd\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":103,"raw_source":"def initialize(obj)\n      @obj = obj\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@obj\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":107,"raw_source":"def value\n      @obj\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@obj\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":112,"raw_source":"def assign_score_of(obj)\n    context = Liquid::Context.new('drop' => ObjectWrapperDrop.new(obj))\n    Liquid::Template.parse('{% assign obj = drop.value %}').render!(context)\n    context.resource_limits.assign_score\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assign_score_of\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ObjectWrapperDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign obj = drop.value %}\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"assign_score\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":6,"raw_source":"def render_to_output_buffer(_context, output)\n    output << ' '\n    output\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":16,"raw_source":"def wrap_in_for(body)\n    \"{% for i in (1..#{N}) %}#{body}{% endfor %}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"wrap_in_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for i in (1..\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]}]},{\"type\":\"str\",\"children\":[\") %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":20,"raw_source":"def wrap_in_if(body)\n    \"{% if true %}#{body}{% endif %}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"wrap_in_if\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"str\",\"children\":[\"{% endif %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":24,"raw_source":"def wrap(body)\n    wrap_in_for(body) + wrap_in_if(body)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"wrap\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},\"+\",{\"type\":\"send\",\"children\":[null,\"wrap_in_if\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":28,"raw_source":"def test_new_tags_are_not_blank_by_default\n    with_custom_tag('foobar', FoobarTag) do\n      assert_equal(\" \" * N, Liquid::Template.parse(wrap_in_for(\"{% foobar %}\")).render!)\n    end\n  end","complexity_score":8.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_tags_are_not_blank_by_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"const\",\"children\":[null,\"FoobarTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},\"*\",{\"type\":\"const\",\"children\":[null,\"N\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"str\",\"children\":[\"{% foobar %}\"]}]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":34,"raw_source":"def test_loops_are_blank\n    assert_template_result(\"\", wrap_in_for(\" \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_loops_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":38,"raw_source":"def test_if_else_are_blank\n    assert_template_result(\"\", \"{% if true %} {% elsif false %} {% else %} {% endif %}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_else_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true %} {% elsif false %} {% else %} {% endif %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":42,"raw_source":"def test_unless_is_blank\n    assert_template_result(\"\", wrap(\"{% unless true %} {% endunless %}\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% unless true %} {% endunless %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":46,"raw_source":"def test_mark_as_blank_only_during_parsing\n    assert_template_result(\" \" * (N + 1), wrap(\" {% if false %} this never happens, but still, this block is not blank {% endif %}\"))\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_mark_as_blank_only_during_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% if false %} this never happens, but still, this block is not blank {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":50,"raw_source":"def test_comments_are_blank\n    assert_template_result(\"\", wrap(\" {% comment %} whatever {% endcomment %} \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comments_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% comment %} whatever {% endcomment %} \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":54,"raw_source":"def test_captures_are_blank\n    assert_template_result(\"\", wrap(\" {% capture foo %} whatever {% endcapture %} \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_captures_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% capture foo %} whatever {% endcapture %} \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":58,"raw_source":"def test_nested_blocks_are_blank_but_only_if_all_children_are\n    assert_template_result(\"\", wrap(wrap(\" \")))\n    assert_template_result(\n      \"\\n       but this is not \" * (N + 1),\n      wrap('{% if true %} {% comment %} this is blank {% endcomment %} {% endif %}\n      {% if true %} but this is not {% endif %}'),\n    )\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_blocks_are_blank_but_only_if_all_children_are\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n       but this is not \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %} {% comment %} this is blank {% endcomment %} {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% if true %} but this is not {% endif %}\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":67,"raw_source":"def test_assigns_are_blank\n    assert_template_result(\"\", wrap(' {% assign foo = \"bar\" %} '))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigns_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = \\\"bar\\\" %} \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":71,"raw_source":"def test_whitespace_is_blank\n    assert_template_result(\"\", wrap(\" \"))\n    assert_template_result(\"\", wrap(\"\\t\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"\\t\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":76,"raw_source":"def test_whitespace_is_not_blank_if_other_stuff_is_present\n    body = \"     x \"\n    assert_template_result(body * (N + 1), wrap(body))\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_is_not_blank_if_other_stuff_is_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"str\",\"children\":[\"     x \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":81,"raw_source":"def test_increment_is_not_blank\n    assert_template_result(\" 0\" * 2 * (N + 1), wrap(\"{% assign foo = 0 %} {% increment foo %} {% decrement foo %}\"))\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_increment_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" 0\"]},\"*\",{\"type\":\"int\",\"children\":[2]}]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% assign foo = 0 %} {% increment foo %} {% decrement foo %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":85,"raw_source":"def test_cycle_is_not_blank\n    assert_template_result(\"  \" * ((N + 1) / 2) + \" \", wrap(\"{% cycle ' ', ' ' %}\"))\n  end","complexity_score":9.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},\"/\",{\"type\":\"int\",\"children\":[2]}]}]}]},\"+\",{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% cycle ' ', ' ' %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":89,"raw_source":"def test_raw_is_not_blank\n    assert_template_result(\"  \" * (N + 1), wrap(\" {% raw %} {% endraw %}\"))\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raw_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% raw %} {% endraw %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":93,"raw_source":"def test_include_is_blank\n    assert_template_result(\n      \"foobar\" * (N + 1),\n      wrap(\"{% include 'foobar' %}\"),\n      partials: { 'foobar' => 'foobar' },\n    )\n    assert_template_result(\n      \" foobar \" * (N + 1),\n      wrap(\"{% include ' foobar ' %}\"),\n      partials: { ' foobar ' => ' foobar ' },\n    )\n    assert_template_result(\n      \"   \" * (N + 1),\n      wrap(\" {% include ' ' %} \"),\n      partials: { ' ' => ' ' },\n    )\n  end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% include 'foobar' %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foobar\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" foobar \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% include ' foobar ' %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\" foobar \"]},{\"type\":\"str\",\"children\":[\" foobar \"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"   \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% include ' ' %} \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\" \"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":111,"raw_source":"def test_case_is_blank\n    assert_template_result(\"\", wrap(\" {% assign foo = 'bar' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"))\n    assert_template_result(\"\", wrap(\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"))\n    assert_template_result(\"   x  \" * (N + 1), wrap(\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} x {% endcase %} \"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'bar' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"   x  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} x {% endcase %} \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":8,"raw_source":"def test_unexpected_end_tag\n    source = '{% if true %}{% endunless %}'\n    assert_match_syntax_error(\"Liquid syntax error (line 1): 'endunless' is not a valid delimiter for if tags. use endif\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_end_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% if true %}{% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): 'endunless' is not a valid delimiter for if tags. use endif\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":13,"raw_source":"def test_with_custom_tag\n    with_custom_tag('testtag', Block) do\n      assert(Liquid::Template.parse(\"{% testtag %} {% endtesttag %}\"))\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_custom_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"testtag\"]},{\"type\":\"const\",\"children\":[null,\"Block\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% testtag %} {% endtesttag %}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":19,"raw_source":"def test_custom_block_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\n    klass1 = Class.new(Block) do\n      def render(*)\n        'hello'\n      end\n    end\n\n    with_custom_tag('blabla', klass1) do\n      template = Liquid::Template.parse(\"{% blabla %} bla {% endblabla %}\")\n\n      assert_equal('hello', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('hello', output)\n      assert_equal('hello', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n\n    klass2 = Class.new(klass1) do\n      def render(*)\n        'foo' + super + 'bar'\n      end\n    end\n\n    with_custom_tag('blabla', klass2) do\n      template = Liquid::Template.parse(\"{% blabla %} foo {% endblabla %}\")\n\n      assert_equal('foohellobar', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('foohellobar', output)\n      assert_equal('foohellobar', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n  end","complexity_score":42.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_block_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass1\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Block\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %} bla {% endblabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"klass2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %} foo {% endblabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":21,"raw_source":"def render(*)\n        'hello'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":39,"raw_source":"def render(*)\n        'foo' + super + 'bar'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":8,"raw_source":"def test_captures_block_content_in_variable\n    assert_template_result(\"test string\", \"{% capture 'var' %}test string{% endcapture %}{{var}}\", {})\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_captures_block_content_in_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test string\"]},{\"type\":\"str\",\"children\":[\"{% capture 'var' %}test string{% endcapture %}{{var}}\"]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":12,"raw_source":"def test_capture_with_hyphen_in_variable_name\n    template_source = <<~END_TEMPLATE\n      {% capture this-thing %}Print this-thing{% endcapture -%}\n      {{ this-thing -}}\n    END_TEMPLATE\n    assert_template_result(\"Print this-thing\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_with_hyphen_in_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% capture this-thing %}Print this-thing{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ this-thing -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Print this-thing\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":20,"raw_source":"def test_capture_to_variable_from_outer_scope_if_existing\n    template_source = <<~END_TEMPLATE\n      {% assign var = '' -%}\n      {% if true -%}\n        {% capture var %}first-block-string{% endcapture -%}\n      {% endif -%}\n      {% if true -%}\n        {% capture var %}test-string{% endcapture -%}\n      {% endif -%}\n      {{var-}}\n    END_TEMPLATE\n    assert_template_result(\"test-string\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_to_variable_from_outer_scope_if_existing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign var = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture var %}first-block-string{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture var %}test-string{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{var-}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test-string\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":34,"raw_source":"def test_assigning_from_capture\n    template_source = <<~END_TEMPLATE\n      {% assign first = '' -%}\n      {% assign second = '' -%}\n      {% for number in (1..3) -%}\n        {% capture first %}{{number}}{% endcapture -%}\n        {% assign second = first -%}\n      {% endfor -%}\n      {{ first }}-{{ second -}}\n    END_TEMPLATE\n    assert_template_result(\"3-3\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigning_from_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign first = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign second = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% for number in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture first %}{{number}}{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign second = first -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ first }}-{{ second -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3-3\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":47,"raw_source":"def test_increment_assign_score_by_bytes_not_characters\n    t = Template.parse(\"{% capture foo %}{% endcapture %}\")\n    t.render!\n    assert_equal(9, t.resource_limits.assign_score)\n  end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_increment_assign_score_by_bytes_not_characters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% capture foo %}{% endcapture %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":6,"raw_source":"def to_liquid\n    100\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[100]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":12,"raw_source":"def amount\n    HundredCentes.new\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"amount\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":16,"raw_source":"def non_zero?\n    true\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"non_zero?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":22,"raw_source":"def test\n    @context['test']\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":30,"raw_source":"def initialize(name)\n    @name = name\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":34,"raw_source":"def to_liquid\n    CategoryDrop.new(self)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CategoryDrop\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":40,"raw_source":"def initialize(products)\n    @products = products\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"products\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@products\",{\"type\":\"lvar\",\"children\":[\"products\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":44,"raw_source":"def size\n    @products.size\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@products\"]},\"size\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":48,"raw_source":"def to_liquid\n    if @context[\"forloop\"]\n      @products.first(@context[\"forloop\"].length)\n    else\n      @products\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"forloop\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@products\"]},\"first\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"forloop\"]}]},\"length\"]}]},{\"type\":\"ivar\",\"children\":[\"@products\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":60,"raw_source":"def initialize(category)\n    @category = category\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"category\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@category\",{\"type\":\"lvar\",\"children\":[\"category\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":66,"raw_source":"def count\n    @count ||= 0\n    @count  += 1\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"count\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":73,"raw_source":"def fetch(index)\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"index\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":76,"raw_source":"def [](index)\n    @counts        ||= []\n    @counts[index] ||= 0\n    @counts[index]  += 1\n  end","complexity_score":1.25,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"index\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@counts\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@counts\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@counts\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":82,"raw_source":"def to_liquid\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":90,"raw_source":"def setup\n    @context = Liquid::Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":94,"raw_source":"def test_variables\n    @context['string'] = 'string'\n    assert_equal('string', @context['string'])\n\n    @context['num'] = 5\n    assert_equal(5, @context['num'])\n\n    @context['time'] = Time.parse('2006-06-06 12:00:00')\n    assert_equal(Time.parse('2006-06-06 12:00:00'), @context['time'])\n\n    @context['date'] = Date.today\n    assert_equal(Date.today, @context['date'])\n\n    now = Time.now\n    @context['datetime'] = now\n    assert_equal(now, @context['datetime'])\n\n    @context['bool'] = true\n    assert_equal(true, @context['bool'])\n\n    @context['bool'] = false\n    assert_equal(false, @context['bool'])\n\n    @context['nil'] = nil\n    assert_nil(@context['nil'])\n    assert_nil(@context['nil'])\n  end","complexity_score":34.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"num\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"num\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"time\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-06 12:00:00\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-06 12:00:00\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"date\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"date\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"now\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"datetime\"]},{\"type\":\"lvar\",\"children\":[\"now\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"now\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"datetime\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"bool\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"bool\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"bool\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"bool\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"nil\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nil\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nil\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":122,"raw_source":"def test_variables_not_existing\n    assert_template_result(\"true\", \"{% if does_not_exist == nil %}true{% endif %}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variables_not_existing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if does_not_exist == nil %}true{% endif %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":126,"raw_source":"def test_scoping\n    @context.push\n    @context.pop\n\n    assert_raises(Liquid::ContextError) do\n      @context.pop\n    end\n\n    assert_raises(Liquid::ContextError) do\n      @context.push\n      @context.pop\n      @context.pop\n    end\n  end","complexity_score":10.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scoping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ContextError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ContextError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":141,"raw_source":"def test_length_query\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 4 %}true{% endif %}\",\n      { \"numbers\" => [1, 2, 3, 4] },\n    )\n\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 4 %}true{% endif %}\",\n      { \"numbers\" => { 1 => 1, 2 => 2, 3 => 3, 4 => 4 } },\n    )\n\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 1000 %}true{% endif %}\",\n      { \"numbers\" => { 1 => 1, 2 => 2, 3 => 3, 4 => 4, 'size' => 1000 } },\n    )\n  end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_length_query\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 4 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 4 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 1000 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"int\",\"children\":[1000]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":161,"raw_source":"def test_hyphenated_variable\n    assert_template_result(\"godz\", \"{{ oh-my }}\", { \"oh-my\" => 'godz' })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hyphenated_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"godz\"]},{\"type\":\"str\",\"children\":[\"{{ oh-my }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"oh-my\"]},{\"type\":\"str\",\"children\":[\"godz\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":165,"raw_source":"def test_add_filter\n    filter = Module.new do\n      def hi(output)\n        output + ' hi!'\n      end\n    end\n\n    context = Context.new\n    context.add_filters(filter)\n    assert_equal('hi? hi!', context.invoke(:hi, 'hi?'))\n\n    context = Context.new\n    assert_equal('hi?', context.invoke(:hi, 'hi?'))\n\n    context.add_filters(filter)\n    assert_equal('hi? hi!', context.invoke(:hi, 'hi?'))\n  end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi? hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi? hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":167,"raw_source":"def hi(output)\n        output + ' hi!'\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":183,"raw_source":"def test_only_intended_filters_make_it_there\n    filter = Module.new do\n      def hi(output)\n        output + ' hi!'\n      end\n    end\n\n    context = Context.new\n    assert_equal(\"Wookie\", context.invoke(\"hi\", \"Wookie\"))\n\n    context.add_filters(filter)\n    assert_equal(\"Wookie hi!\", context.invoke(\"hi\", \"Wookie\"))\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_only_intended_filters_make_it_there\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Wookie\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"Wookie\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Wookie hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"Wookie\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":185,"raw_source":"def hi(output)\n        output + ' hi!'\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":197,"raw_source":"def test_add_item_in_outer_scope\n    @context['test'] = 'test'\n    @context.push\n    assert_equal('test', @context['test'])\n    @context.pop\n    assert_equal('test', @context['test'])\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_item_in_outer_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":205,"raw_source":"def test_add_item_in_inner_scope\n    @context.push\n    @context['test'] = 'test'\n    assert_equal('test', @context['test'])\n    @context.pop\n    assert_nil(@context['test'])\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_item_in_inner_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":213,"raw_source":"def test_hierachical_data\n    assigns = { 'hash' => { \"name\" => 'tobi' } }\n    assert_template_result(\"tobi\", \"{{ hash.name }}\", assigns)\n    assert_template_result(\"tobi\", '{{ hash[\"name\"] }}', assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hierachical_data\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"tobi\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"tobi\"]},{\"type\":\"str\",\"children\":[\"{{ hash.name }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"tobi\"]},{\"type\":\"str\",\"children\":[\"{{ hash[\\\"name\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":219,"raw_source":"def test_keywords\n    assert_template_result(\"pass\", \"{% if true == expect %}pass{% endif %}\", { \"expect\" => true })\n    assert_template_result(\"pass\", \"{% if false == expect %}pass{% endif %}\", { \"expect\" => false })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_keywords\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if true == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if false == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":224,"raw_source":"def test_digits\n    assert_template_result(\"pass\", \"{% if 100 == expect %}pass{% endif %}\", { \"expect\" => 100 })\n    assert_template_result(\"pass\", \"{% if 100.00 == expect %}pass{% endif %}\", { \"expect\" => 100.00 })\n  end","complexity_score":2.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_digits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if 100 == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if 100.00 == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":229,"raw_source":"def test_strings\n    assert_template_result(\"hello!\", '{{ \"hello!\" }}')\n    assert_template_result(\"hello!\", \"{{ 'hello!' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hello!\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"hello!\\\" }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hello!\"]},{\"type\":\"str\",\"children\":[\"{{ 'hello!' }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":234,"raw_source":"def test_merge\n    @context.merge(\"test\" => \"test\")\n    assert_equal('test', @context['test'])\n    @context.merge(\"test\" => \"newvalue\", \"foo\" => \"bar\")\n    assert_equal('newvalue', @context['test'])\n    assert_equal('bar', @context['foo'])\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"newvalue\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"newvalue\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":242,"raw_source":"def test_array_notation\n    assigns = { \"test\" => [\"a\", \"b\"] }\n    assert_template_result(\"a\", \"{{ test[0] }}\", assigns)\n    assert_template_result(\"b\", \"{{ test[1] }}\", assigns)\n    assert_template_result(\"pass\", \"{% if test[2] == nil %}pass{% endif %}\", assigns)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_array_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"{{ test[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"{{ test[1] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if test[2] == nil %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":249,"raw_source":"def test_recoursive_array_notation\n    assigns = { \"test\" => { 'test' => [1, 2, 3, 4, 5] } }\n    assert_template_result(\"1\", \"{{ test.test[0] }}\", assigns)\n\n    assigns = { \"test\" => [{ 'test' => 'worked' }] }\n    assert_template_result(\"worked\", \"{{ test[0].test }}\", assigns)\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recoursive_array_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.test[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test[0].test }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":257,"raw_source":"def test_hash_to_array_transition\n    assigns = {\n      'colors' => {\n        'Blue' => ['003366', '336699', '6699CC', '99CCFF'],\n        'Green' => ['003300', '336633', '669966', '99CC99'],\n        'Yellow' => ['CC9900', 'FFCC00', 'FFFF99', 'FFFFCC'],\n        'Red' => ['660000', '993333', 'CC6666', 'FF9999'],\n      },\n    }\n\n    assert_template_result(\"003366\", \"{{ colors.Blue[0] }}\", assigns)\n    assert_template_result(\"FF9999\", \"{{ colors.Red[3] }}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_to_array_transition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"colors\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Blue\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"003366\"]},{\"type\":\"str\",\"children\":[\"336699\"]},{\"type\":\"str\",\"children\":[\"6699CC\"]},{\"type\":\"str\",\"children\":[\"99CCFF\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Green\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"003300\"]},{\"type\":\"str\",\"children\":[\"336633\"]},{\"type\":\"str\",\"children\":[\"669966\"]},{\"type\":\"str\",\"children\":[\"99CC99\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Yellow\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"CC9900\"]},{\"type\":\"str\",\"children\":[\"FFCC00\"]},{\"type\":\"str\",\"children\":[\"FFFF99\"]},{\"type\":\"str\",\"children\":[\"FFFFCC\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Red\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"660000\"]},{\"type\":\"str\",\"children\":[\"993333\"]},{\"type\":\"str\",\"children\":[\"CC6666\"]},{\"type\":\"str\",\"children\":[\"FF9999\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"003366\"]},{\"type\":\"str\",\"children\":[\"{{ colors.Blue[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"FF9999\"]},{\"type\":\"str\",\"children\":[\"{{ colors.Red[3] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":271,"raw_source":"def test_try_first\n    assigns = { 'test' => [1, 2, 3, 4, 5] }\n    assert_template_result(\"1\", \"{{ test.first }}\", assigns)\n    assert_template_result(\"pass\", \"{% if test.last == 5 %}pass{% endif %}\", assigns)\n\n    assigns = { \"test\" => { \"test\" => [1, 2, 3, 4, 5] } }\n    assert_template_result(\"1\", \"{{ test.test.first }}\", assigns)\n    assert_template_result(\"5\", \"{{ test.test.last }}\", assigns)\n\n    assigns = { \"test\" => [1] }\n    assert_template_result(\"1\", \"{{ test.first }}\", assigns)\n    assert_template_result(\"1\", \"{{ test.last }}\", assigns)\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_try_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if test.last == 5 %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ test.test.last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":285,"raw_source":"def test_access_hashes_with_hash_notation\n    assigns = { 'products' => { 'count' => 5, 'tags' => ['deepsnow', 'freestyle'] } }\n    assert_template_result(\"5\", '{{ products[\"count\"] }}', assigns)\n    assert_template_result(\"deepsnow\", '{{ products[\"tags\"][0] }}', assigns)\n    assert_template_result(\"deepsnow\", '{{ products[\"tags\"].first }}', assigns)\n\n    assigns = { 'product' => { 'variants' => [{ 'title' => 'draft151cm' }, { 'title' => 'element151cm' }] } }\n    assert_template_result(\"draft151cm\", '{{ product[\"variants\"][0][\"title\"] }}', assigns)\n    assert_template_result(\"element151cm\", '{{ product[\"variants\"][1][\"title\"] }}', assigns)\n    assert_template_result(\"draft151cm\", '{{ product[\"variants\"].first[\"title\"] }}', assigns)\n    assert_template_result(\"element151cm\", '{{ product[\"variants\"].last[\"title\"] }}', assigns)\n  end","complexity_score":9.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_hashes_with_hash_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"tags\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"freestyle\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"count\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"tags\\\"][0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"tags\\\"].first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"variants\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"draft151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"element151cm\"]}]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"][0][\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"][1][\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"].first[\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"].last[\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":298,"raw_source":"def test_access_variable_with_hash_notation\n    assert_template_result('baz', '{{ [\"foo\"] }}', { \"foo\" => \"baz\" })\n    assert_template_result('baz', '{{ [bar] }}', { 'foo' => 'baz', 'bar' => 'foo' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_variable_with_hash_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"baz\"]},{\"type\":\"str\",\"children\":[\"{{ [\\\"foo\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"baz\"]},{\"type\":\"str\",\"children\":[\"{{ [bar] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":303,"raw_source":"def test_access_hashes_with_hash_access_variables\n    assigns = {\n      'var' => 'tags',\n      'nested' => { 'var' => 'tags' },\n      'products' => { 'count' => 5, 'tags' => ['deepsnow', 'freestyle'] },\n    }\n\n    assert_template_result('deepsnow', '{{ products[var].first }}', assigns)\n    assert_template_result('freestyle', '{{ products[nested.var].last }}', assigns)\n  end","complexity_score":3.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_hashes_with_hash_access_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"tags\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"tags\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"tags\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"freestyle\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[var].first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"freestyle\"]},{\"type\":\"str\",\"children\":[\"{{ products[nested.var].last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":314,"raw_source":"def test_hash_notation_only_for_hash_access\n    assigns = { \"array\" => [1, 2, 3, 4, 5] }\n    assert_template_result(\"1\", \"{{ array.first }}\", assigns)\n    assert_template_result(\"pass\", '{% if array[\"first\"] == nil %}pass{% endif %}', assigns)\n\n    assert_template_result(\"Hello\", '{{ hash[\"first\"] }}', { \"hash\" => { \"first\" => \"Hello\" } })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_notation_only_for_hash_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ array.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if array[\\\"first\\\"] == nil %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"str\",\"children\":[\"{{ hash[\\\"first\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"first\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":322,"raw_source":"def test_first_can_appear_in_middle_of_callchain\n    assigns = { \"product\" => { 'variants' => [{ 'title' => 'draft151cm' }, { 'title' => 'element151cm' }] } }\n\n    assert_template_result('draft151cm', '{{ product.variants[0].title }}', assigns)\n    assert_template_result('element151cm', '{{ product.variants[1].title }}', assigns)\n    assert_template_result('draft151cm', '{{ product.variants.first.title }}', assigns)\n    assert_template_result('element151cm', '{{ product.variants.last.title }}', assigns)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_can_appear_in_middle_of_callchain\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"variants\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"draft151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"element151cm\"]}]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants[0].title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants[1].title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants.first.title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants.last.title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":331,"raw_source":"def test_cents\n    @context.merge(\"cents\" => HundredCentes.new)\n    assert_equal(100, @context['cents'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":336,"raw_source":"def test_nested_cents\n    @context.merge(\"cents\" => { 'amount' => HundredCentes.new })\n    assert_equal(100, @context['cents.amount'])\n\n    @context.merge(\"cents\" => { 'cents' => { 'amount' => HundredCentes.new } })\n    assert_equal(100, @context['cents.cents.amount'])\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_cents\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"amount\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.amount\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"amount\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.amount\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":344,"raw_source":"def test_cents_through_drop\n    @context.merge(\"cents\" => CentsDrop.new)\n    assert_equal(100, @context['cents.amount'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents_through_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.amount\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":349,"raw_source":"def test_nested_cents_through_drop\n    @context.merge(\"vars\" => { \"cents\" => CentsDrop.new })\n    assert_equal(100, @context['vars.cents.amount'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_cents_through_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.cents.amount\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":354,"raw_source":"def test_drop_methods_with_question_marks\n    @context.merge(\"cents\" => CentsDrop.new)\n    assert(@context['cents.non_zero?'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_methods_with_question_marks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.non_zero?\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":359,"raw_source":"def test_context_from_within_drop\n    @context.merge(\"test\" => '123', \"vars\" => ContextSensitiveDrop.new)\n    assert_equal('123', @context['vars.test'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_from_within_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextSensitiveDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.test\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":364,"raw_source":"def test_nested_context_from_within_drop\n    @context.merge(\"test\" => '123', \"vars\" => { \"local\" => ContextSensitiveDrop.new })\n    assert_equal('123', @context['vars.local.test'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_context_from_within_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"local\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextSensitiveDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.local.test\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":369,"raw_source":"def test_ranges\n    assert_template_result(\"1..5\", '{{ (1..5) }}')\n    assert_template_result(\"pass\", '{% if (1..5) == expect %}pass{% endif %}', { \"expect\" => (1..5) })\n\n    assigns = { \"test\" => '5' }\n    assert_template_result(\"1..5\", \"{{ (1..test) }}\", assigns)\n    assert_template_result(\"5..5\", \"{{ (test..test) }}\", assigns)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1..5\"]},{\"type\":\"str\",\"children\":[\"{{ (1..5) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if (1..5) == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"5\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1..5\"]},{\"type\":\"str\",\"children\":[\"{{ (1..test) }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5..5\"]},{\"type\":\"str\",\"children\":[\"{{ (test..test) }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":378,"raw_source":"def test_cents_through_drop_nestedly\n    @context.merge(\"cents\" => { \"cents\" => CentsDrop.new })\n    assert_equal(100, @context['cents.cents.amount'])\n\n    @context.merge(\"cents\" => { \"cents\" => { \"cents\" => CentsDrop.new } })\n    assert_equal(100, @context['cents.cents.cents.amount'])\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents_through_drop_nestedly\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.amount\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.cents.amount\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":386,"raw_source":"def test_drop_with_variable_called_only_once\n    @context['counter'] = CounterDrop.new\n\n    assert_equal(1, @context['counter.count'])\n    assert_equal(2, @context['counter.count'])\n    assert_equal(3, @context['counter.count'])\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_with_variable_called_only_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"counter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CounterDrop\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":394,"raw_source":"def test_drop_with_key_called_only_once\n    @context['counter'] = CounterDrop.new\n\n    assert_equal(1, @context['counter[\"count\"]'])\n    assert_equal(2, @context['counter[\"count\"]'])\n    assert_equal(3, @context['counter[\"count\"]'])\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_with_key_called_only_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"counter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CounterDrop\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":402,"raw_source":"def test_proc_as_variable\n    @context['dynamic'] = proc { 'Hello' }\n\n    assert_equal('Hello', @context['dynamic'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_proc_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":408,"raw_source":"def test_lambda_as_variable\n    @context['dynamic'] = proc { 'Hello' }\n\n    assert_equal('Hello', @context['dynamic'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":414,"raw_source":"def test_nested_lambda_as_variable\n    @context['dynamic'] = { \"lambda\" => proc { 'Hello' } }\n\n    assert_equal('Hello', @context['dynamic.lambda'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lambda\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic.lambda\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":420,"raw_source":"def test_array_containing_lambda_as_variable\n    @context['dynamic'] = [1, 2, proc { 'Hello' }, 4, 5]\n\n    assert_equal('Hello', @context['dynamic[2]'])\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_array_containing_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic[2]\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":426,"raw_source":"def test_lambda_is_called_once\n    @global = 0\n\n    @context['callcount'] = proc {\n      @global += 1\n      @global.to_s\n    }\n\n    assert_equal('1', @context['callcount'])\n    assert_equal('1', @context['callcount'])\n    assert_equal('1', @context['callcount'])\n  end","complexity_score":14.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":439,"raw_source":"def test_nested_lambda_is_called_once\n    @global = 0\n\n    @context['callcount'] = {\n      \"lambda\" => proc {\n                    @global += 1\n                    @global.to_s\n                  },\n    }\n\n    assert_equal('1', @context['callcount.lambda'])\n    assert_equal('1', @context['callcount.lambda'])\n    assert_equal('1', @context['callcount.lambda'])\n  end","complexity_score":14.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_lambda_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lambda\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":454,"raw_source":"def test_lambda_in_array_is_called_once\n    @global = 0\n\n    p = proc {\n      @global += 1\n      @global.to_s\n    }\n    @context['callcount'] = [1, 2, p, 4, 5]\n\n    assert_equal('1', @context['callcount[2]'])\n    assert_equal('1', @context['callcount[2]'])\n    assert_equal('1', @context['callcount[2]'])\n  end","complexity_score":16.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_in_array_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":468,"raw_source":"def test_access_to_context_from_proc\n    @context.registers[:magic] = 345392\n\n    @context['magic'] = proc { @context.registers[:magic] }\n\n    assert_equal(345392, @context['magic'])\n  end","complexity_score":10.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_to_context_from_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"magic\"]},{\"type\":\"int\",\"children\":[345392]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"magic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"magic\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[345392]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"magic\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":476,"raw_source":"def test_to_liquid_and_context_at_first_level\n    @context['category'] = Category.new(\"foobar\")\n    assert_kind_of(CategoryDrop, @context['category'])\n    assert_equal(@context, @context['category'].context)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_to_liquid_and_context_at_first_level\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"category\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Category\"]},\"new\",{\"type\":\"str\",\"children\":[\"foobar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[null,\"CategoryDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"category\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"category\"]}]},\"context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":482,"raw_source":"def test_interrupt_avoids_object_allocations\n    @context.interrupt? # ruby 3.0.0 allocates on the first call\n    assert_no_object_allocations do\n      @context.interrupt?\n    end\n  end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_interrupt_avoids_object_allocations\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"interrupt?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_no_object_allocations\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"interrupt?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":489,"raw_source":"def test_context_initialization_with_a_proc_in_environment\n    contx = Context.new([test: ->(c) { c['poutine'] }], test: :foo)\n\n    assert(contx)\n    assert_nil(contx['poutine'])\n  end","complexity_score":7.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_initialization_with_a_proc_in_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"contx\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"poutine\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"sym\",\"children\":[\"foo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"lvar\",\"children\":[\"contx\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"contx\"]},\"[]\",{\"type\":\"str\",\"children\":[\"poutine\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":496,"raw_source":"def test_apply_global_filter\n    global_filter_proc = ->(output) { \"#{output} filtered\" }\n\n    context = Context.new\n    context.global_filter = global_filter_proc\n\n    assert_equal('hi filtered', context.apply_global_filter('hi'))\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_apply_global_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_filter_proc\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"str\",\"children\":[\" filtered\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"global_filter=\",{\"type\":\"lvar\",\"children\":[\"global_filter_proc\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi filtered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":505,"raw_source":"def test_static_environments_are_read_with_lower_priority_than_environments\n    context = Context.build(\n      static_environments: { 'shadowed' => 'static', 'unshadowed' => 'static' },\n      environments: { 'shadowed' => 'dynamic' },\n    )\n\n    assert_equal('dynamic', context['shadowed'])\n    assert_equal('static', context['unshadowed'])\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_static_environments_are_read_with_lower_priority_than_environments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"shadowed\"]},{\"type\":\"str\",\"children\":[\"static\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"unshadowed\"]},{\"type\":\"str\",\"children\":[\"static\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"shadowed\"]},{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"shadowed\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"static\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"unshadowed\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":515,"raw_source":"def test_apply_global_filter_when_no_global_filter_exist\n    context = Context.new\n    assert_equal('hi', context.apply_global_filter('hi'))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_apply_global_filter_when_no_global_filter_exist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":520,"raw_source":"def test_new_isolated_subcontext_does_not_inherit_variables\n    super_context = Context.new\n    super_context['my_variable'] = 'some value'\n    subcontext = super_context.new_isolated_subcontext\n\n    assert_nil(subcontext['my_variable'])\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_does_not_inherit_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"my_variable\"]},{\"type\":\"str\",\"children\":[\"some value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"[]\",{\"type\":\"str\",\"children\":[\"my_variable\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":528,"raw_source":"def test_new_isolated_subcontext_inherits_static_environment\n    super_context = Context.build(static_environments: { 'my_environment_value' => 'my value' })\n    subcontext    = super_context.new_isolated_subcontext\n\n    assert_equal('my value', subcontext['my_environment_value'])\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_static_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_environment_value\"]},{\"type\":\"str\",\"children\":[\"my value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"[]\",{\"type\":\"str\",\"children\":[\"my_environment_value\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":535,"raw_source":"def test_new_isolated_subcontext_inherits_resource_limits\n    resource_limits = ResourceLimits.new({})\n    super_context   = Context.new({}, {}, {}, false, resource_limits)\n    subcontext      = super_context.new_isolated_subcontext\n    assert_equal(resource_limits, subcontext.resource_limits)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_resource_limits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"resource_limits\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"resource_limits\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"resource_limits\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":542,"raw_source":"def test_new_isolated_subcontext_inherits_exception_renderer\n    super_context = Context.new\n    super_context.exception_renderer = ->(_e) { 'my exception message' }\n    subcontext = super_context.new_isolated_subcontext\n    assert_equal('my exception message', subcontext.handle_error(Liquid::Error.new))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"exception_renderer=\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_e\"]}]},{\"type\":\"str\",\"children\":[\"my exception message\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my exception message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"handle_error\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":549,"raw_source":"def test_new_isolated_subcontext_does_not_inherit_non_static_registers\n    registers = {\n      my_register: :my_value,\n    }\n    super_context = Context.new({}, {}, Registers.new(registers))\n    super_context.registers[:my_register] = :my_alt_value\n    subcontext                            = super_context.new_isolated_subcontext\n    assert_equal(:my_value, subcontext.registers[:my_register])\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_does_not_inherit_non_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_alt_value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":559,"raw_source":"def test_new_isolated_subcontext_inherits_static_registers\n    super_context = Context.build(registers: { my_register: :my_value })\n    subcontext    = super_context.new_isolated_subcontext\n    assert_equal(:my_value, subcontext.registers[:my_register])\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":565,"raw_source":"def test_new_isolated_subcontext_registers_do_not_pollute_context\n    super_context                      = Context.build(registers: { my_register: :my_value })\n    subcontext                         = super_context.new_isolated_subcontext\n    subcontext.registers[:my_register] = :my_alt_value\n    assert_equal(:my_value, super_context.registers[:my_register])\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_registers_do_not_pollute_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_alt_value\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":572,"raw_source":"def test_new_isolated_subcontext_inherits_filters\n    my_filter = Module.new do\n      def my_filter(*)\n        'my filter result'\n      end\n    end\n\n    super_context = Context.new\n    super_context.add_filters([my_filter])\n    subcontext    = super_context.new_isolated_subcontext\n    template      = Template.parse('{{ 123 | my_filter }}')\n    assert_equal('my filter result', template.render(subcontext))\n  end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"my_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"my filter result\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"add_filters\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"my_filter\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 123 | my_filter }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my filter result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"subcontext\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":574,"raw_source":"def my_filter(*)\n        'my filter result'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"my_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"my filter result\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":586,"raw_source":"def test_disables_tag_specified\n    context = Context.new\n    context.with_disabled_tags(%w(foo bar)) do\n      assert_equal(true, context.tag_disabled?(\"foo\"))\n      assert_equal(true, context.tag_disabled?(\"bar\"))\n      assert_equal(false, context.tag_disabled?(\"unknown\"))\n    end\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disables_tag_specified\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"unknown\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":595,"raw_source":"def test_disables_nested_tags\n    context = Context.new\n    context.with_disabled_tags([\"foo\"]) do\n      context.with_disabled_tags([\"foo\"]) do\n        assert_equal(true, context.tag_disabled?(\"foo\"))\n        assert_equal(false, context.tag_disabled?(\"bar\"))\n      end\n      context.with_disabled_tags([\"bar\"]) do\n        assert_equal(true, context.tag_disabled?(\"foo\"))\n        assert_equal(true, context.tag_disabled?(\"bar\"))\n        context.with_disabled_tags([\"foo\"]) do\n          assert_equal(true, context.tag_disabled?(\"foo\"))\n          assert_equal(true, context.tag_disabled?(\"bar\"))\n        end\n      end\n      assert_equal(true, context.tag_disabled?(\"foo\"))\n      assert_equal(false, context.tag_disabled?(\"bar\"))\n    end\n  end","complexity_score":35.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disables_nested_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":615,"raw_source":"def test_override_global_filter\n    global = Module.new do\n      def notice(output)\n        \"Global #{output}\"\n      end\n    end\n\n    local = Module.new do\n      def notice(output)\n        \"Local #{output}\"\n      end\n    end\n\n    with_global_filter(global) do\n      assert_equal('Global test', Template.parse(\"{{'test' | notice }}\").render!)\n      assert_equal('Local test', Template.parse(\"{{'test' | notice }}\").render!({}, filters: [local]))\n    end\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_override_global_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Global \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"local\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Local \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"lvar\",\"children\":[\"global\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Global test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{'test' | notice }}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Local test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{'test' | notice }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"local\"]}]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":617,"raw_source":"def notice(output)\n        \"Global #{output}\"\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Global \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":623,"raw_source":"def notice(output)\n        \"Local #{output}\"\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Local \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":634,"raw_source":"def test_has_key_will_not_add_an_error_for_missing_keys\n    with_error_mode(:strict) do\n      context = Context.new\n      context.key?('unknown')\n      assert_empty(context.errors)\n    end\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_key_will_not_add_an_error_for_missing_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"key?\",{\"type\":\"str\",\"children\":[\"unknown\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_empty\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"errors\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":642,"raw_source":"def test_context_always_uses_static_registers\n    registers = {\n      my_register: :my_value,\n    }\n    c = Context.new({}, {}, registers)\n    assert_instance_of(Registers, c.registers)\n    assert_equal(:my_value, c.registers[:my_register])\n\n    r = Registers.new(registers)\n    c = Context.new({}, {}, r)\n    assert_instance_of(Registers, c.registers)\n    assert_equal(:my_value, c.registers[:my_register])\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_always_uses_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":656,"raw_source":"def test_variable_to_liquid_returns_contextual_drop\n    context = {\n      \"products\" => ProductsDrop.new([\"A\", \"B\", \"C\", \"D\", \"E\"]),\n    }\n\n    template = Liquid::Template.parse(<<~LIQUID)\n      {%- for i in (1..3) -%}\n        for_loop_products_count: {{ products | size }}\n      {% endfor %}\n\n      unscoped_products_count: {{ products | size }}\n    LIQUID\n\n    result = template.render(context)\n\n    assert_includes(result, \"for_loop_products_count: 3\")\n    assert_includes(result, \"unscoped_products_count: 5\")\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_to_liquid_returns_contextual_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductsDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"C\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"E\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  for_loop_products_count: {{ products | size }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"unscoped_products_count: {{ products | size }}\\n\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"for_loop_products_count: 3\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"unscoped_products_count: 5\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":675,"raw_source":"def test_new_isolated_context_inherits_parent_environment\n    global_environment = Liquid::Environment.build(tags: {})\n    context = Context.build(environment: global_environment)\n\n    subcontext = context.new_isolated_subcontext\n    assert_equal(global_environment, subcontext.environment)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_context_inherits_parent_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tags\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"global_environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"global_environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"environment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":683,"raw_source":"def test_newly_built_context_inherits_parent_environment\n    global_environment = Liquid::Environment.build(tags: {})\n    context = Context.build(environment: global_environment)\n    assert_equal(global_environment, context.environment)\n    assert(context.environment.tags.each.to_a.empty?)\n  end","complexity_score":15.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_newly_built_context_inherits_parent_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tags\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"global_environment\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"global_environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environment\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environment\"]},\"tags\"]},\"each\"]},\"to_a\"]},\"empty?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":692,"raw_source":"def assert_no_object_allocations\n    unless RUBY_ENGINE == 'ruby'\n      skip(\"stackprof needed to count object allocations\")\n    end\n    require 'stackprof'\n\n    profile = StackProf.run(mode: :object) do\n      yield\n    end\n    assert_equal(0, profile[:samples])\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_no_object_allocations\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},\"==\",{\"type\":\"str\",\"children\":[\"ruby\"]}]},null,{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"stackprof needed to count object allocations\"]}]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"str\",\"children\":[\"stackprof\"]}]},{\"type\":\"lvasgn\",\"children\":[\"profile\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StackProf\"]},\"run\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"mode\"]},{\"type\":\"sym\",\"children\":[\"object\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profile\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"samples\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/document_test.rb","start_line":8,"raw_source":"def test_unexpected_outer_tag\n    source = \"{% else %}\"\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Unexpected outer 'else' tag\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_outer_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% else %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unexpected outer 'else' tag\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/document_test.rb","start_line":13,"raw_source":"def test_unknown_tag\n    source = \"{% foo %}\"\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Unknown tag 'foo'\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unknown_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% foo %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unknown tag 'foo'\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":6,"raw_source":"def scopes\n    @context.scopes.size\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"scopes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"scopes\"]},\"size\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":10,"raw_source":"def scopes_as_array\n    (1..@context.scopes.size).to_a\n  end","complexity_score":3.9,"ast_json":"{\"type\":\"def\",\"children\":[\"scopes_as_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"scopes\"]},\"size\"]}]}]},\"to_a\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":14,"raw_source":"def loop_pos\n    @context['forloop.index']\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"loop_pos\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"forloop.index\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":18,"raw_source":"def liquid_method_missing(method)\n    @context[method]\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":25,"raw_source":"def array\n      ['text1', 'text2']\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"text1\"]},{\"type\":\"str\",\"children\":[\"text2\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":29,"raw_source":"def text\n      'text1'\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"text\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"text1\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":35,"raw_source":"def liquid_method_missing(method)\n      \"catchall_method: #{method}\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"catchall_method: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":40,"raw_source":"def texts\n    TextDrop.new\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"texts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TextDrop\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":44,"raw_source":"def catchall\n    CatchallDrop.new\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"catchall\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CatchallDrop\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":48,"raw_source":"def context\n    ContextDrop.new\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":54,"raw_source":"def callmenot\n    \"protected\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"callmenot\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"protected\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":60,"raw_source":"def liquid_method_missing(method)\n    method\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":64,"raw_source":"def size\n    3\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[3]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":68,"raw_source":"def first\n    1\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[1]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":72,"raw_source":"def count\n    3\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"count\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[3]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":76,"raw_source":"def min\n    1\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"min\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[1]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":80,"raw_source":"def max\n    3\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"max\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[3]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":84,"raw_source":"def each\n    yield 1\n    yield 2\n    yield 3\n  end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":94,"raw_source":"def liquid_method_missing(method)\n    method\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":98,"raw_source":"def each\n    yield 1\n    yield 2\n    yield 3\n  end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":108,"raw_source":"def test_product_drop\n    tpl = Liquid::Template.parse('  ')\n    assert_equal('  ', tpl.render!('product' => ProductDrop.new))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_product_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tpl\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tpl\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":113,"raw_source":"def test_drop_does_only_respond_to_whitelisted_methods\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.inspect }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.pretty_inspect }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.whatever }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"inspect\" }}').render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"pretty_inspect\" }}').render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"whatever\" }}').render!('product' => ProductDrop.new))\n  end","complexity_score":30.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_does_only_respond_to_whitelisted_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.inspect }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.pretty_inspect }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.whatever }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"inspect\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"pretty_inspect\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"whatever\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":122,"raw_source":"def test_drops_respond_to_to_liquid\n    assert_equal(\"text1\", Liquid::Template.parse(\"{{ product.to_liquid.texts.text }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"text1\", Liquid::Template.parse('{{ product | map: \"to_liquid\" | map: \"texts\" | map: \"text\" }}').render!('product' => ProductDrop.new))\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drops_respond_to_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"text1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.to_liquid.texts.text }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"text1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"to_liquid\\\" | map: \\\"texts\\\" | map: \\\"text\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":127,"raw_source":"def test_text_drop\n    output = Liquid::Template.parse(' {{ product.texts.text }} ').render!('product' => ProductDrop.new)\n    assert_equal(' text1 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_text_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.texts.text }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" text1 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":132,"raw_source":"def test_catchall_unknown_method\n    output = Liquid::Template.parse(' {{ product.catchall.unknown }} ').render!('product' => ProductDrop.new)\n    assert_equal(' catchall_method: unknown ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_catchall_unknown_method\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.catchall.unknown }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" catchall_method: unknown \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":137,"raw_source":"def test_catchall_integer_argument_drop\n    output = Liquid::Template.parse(' {{ product.catchall[8] }} ').render!('product' => ProductDrop.new)\n    assert_equal(' catchall_method: 8 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_catchall_integer_argument_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.catchall[8] }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" catchall_method: 8 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":142,"raw_source":"def test_text_array_drop\n    output = Liquid::Template.parse('{% for text in product.texts.array %} {{text}} {% endfor %}').render!('product' => ProductDrop.new)\n    assert_equal(' text1  text2 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_text_array_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for text in product.texts.array %} {{text}} {% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" text1  text2 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":147,"raw_source":"def test_context_drop\n    output = Liquid::Template.parse(' {{ context.bar }} ').render!('context' => ContextDrop.new, 'bar' => \"carrot\")\n    assert_equal(' carrot ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ context.bar }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"carrot\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" carrot \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":152,"raw_source":"def test_context_drop_array_with_map\n    output = Liquid::Template.parse(' {{ contexts | map: \"bar\" }} ').render!('contexts' => [ContextDrop.new, ContextDrop.new], 'bar' => \"carrot\")\n    assert_equal(' carrotcarrot ', output)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_drop_array_with_map\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ contexts | map: \\\"bar\\\" }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"contexts\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"carrot\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" carrotcarrot \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":157,"raw_source":"def test_nested_context_drop\n    output = Liquid::Template.parse(' {{ product.context.foo }} ').render!('product' => ProductDrop.new, 'foo' => \"monkey\")\n    assert_equal(' monkey ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_context_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.context.foo }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"monkey\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" monkey \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":162,"raw_source":"def test_protected\n    output = Liquid::Template.parse(' {{ product.callmenot }} ').render!('product' => ProductDrop.new)\n    assert_equal('  ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_protected\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.callmenot }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":167,"raw_source":"def test_object_methods_not_allowed\n    [:dup, :clone, :singleton_class, :eval, :class_eval, :inspect].each do |method|\n      output = Liquid::Template.parse(\" {{ product.#{method} }} \").render!('product' => ProductDrop.new)\n      assert_equal('  ', output)\n    end\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_object_methods_not_allowed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"dup\"]},{\"type\":\"sym\",\"children\":[\"clone\"]},{\"type\":\"sym\",\"children\":[\"singleton_class\"]},{\"type\":\"sym\",\"children\":[\"eval\"]},{\"type\":\"sym\",\"children\":[\"class_eval\"]},{\"type\":\"sym\",\"children\":[\"inspect\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\" {{ product.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\" }} \"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":174,"raw_source":"def test_scope\n    assert_equal('1', Liquid::Template.parse('{{ context.scopes }}').render!('context' => ContextDrop.new))\n    assert_equal('2', Liquid::Template.parse('{%for i in dummy%}{{ context.scopes }}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('3', Liquid::Template.parse('{%for i in dummy%}{%for i in dummy%}{{ context.scopes }}{%endfor%}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n  end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ context.scopes }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{{ context.scopes }}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{%for i in dummy%}{{ context.scopes }}{%endfor%}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":180,"raw_source":"def test_scope_though_proc\n    assert_equal('1', Liquid::Template.parse('{{ s }}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }))\n    assert_equal('2', Liquid::Template.parse('{%for i in dummy%}{{ s }}{%endfor%}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }, 'dummy' => [1]))\n    assert_equal('3', Liquid::Template.parse('{%for i in dummy%}{%for i in dummy%}{{ s }}{%endfor%}{%endfor%}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }, 'dummy' => [1]))\n  end","complexity_score":28.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_though_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ s }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{{ s }}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{%for i in dummy%}{{ s }}{%endfor%}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":186,"raw_source":"def test_scope_with_assigns\n    assert_equal('variable', Liquid::Template.parse('{% assign a = \"variable\"%}{{a}}').render!('context' => ContextDrop.new))\n    assert_equal('variable', Liquid::Template.parse('{% assign a = \"variable\"%}{%for i in dummy%}{{a}}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('test', Liquid::Template.parse('{% assign header_gif = \"test\"%}{{header_gif}}').render!('context' => ContextDrop.new))\n    assert_equal('test', Liquid::Template.parse(\"{% assign header_gif = 'test'%}{{header_gif}}\").render!('context' => ContextDrop.new))\n  end","complexity_score":20.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_with_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign a = \\\"variable\\\"%}{{a}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign a = \\\"variable\\\"%}{%for i in dummy%}{{a}}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign header_gif = \\\"test\\\"%}{{header_gif}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign header_gif = 'test'%}{{header_gif}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":193,"raw_source":"def test_scope_from_tags\n    assert_equal('1', Liquid::Template.parse('{% for i in context.scopes_as_array %}{{i}}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('12', Liquid::Template.parse('{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('123', Liquid::Template.parse('{%for a in dummy%}{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n  end","complexity_score":16.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_from_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in context.scopes_as_array %}{{i}}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":199,"raw_source":"def test_access_context_from_drop\n    assert_equal('123', Liquid::Template.parse('{%for a in dummy%}{{ context.loop_pos }}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1, 2, 3]))\n  end","complexity_score":6.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_context_from_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{{ context.loop_pos }}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":203,"raw_source":"def test_enumerable_drop\n    assert_equal('123', Liquid::Template.parse('{% for c in collection %}{{c}}{% endfor %}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for c in collection %}{{c}}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":207,"raw_source":"def test_enumerable_drop_size\n    assert_equal('3', Liquid::Template.parse('{{collection.size}}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{collection.size}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":211,"raw_source":"def test_enumerable_drop_will_invoke_liquid_method_missing_for_clashing_method_names\n    [\"select\", \"each\", \"map\", \"cycle\"].each do |method|\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n    end\n  end","complexity_score":30.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop_will_invoke_liquid_method_missing_for_clashing_method_names\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"select\"]},{\"type\":\"str\",\"children\":[\"each\"]},{\"type\":\"str\",\"children\":[\"map\"]},{\"type\":\"str\",\"children\":[\"cycle\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":220,"raw_source":"def test_some_enumerable_methods_still_get_invoked\n    [:count, :max].each do |method|\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n    end\n\n    assert_equal(\"yes\", Liquid::Template.parse(\"{% if collection contains 3 %}yes{% endif %}\").render!('collection' => RealEnumerableDrop.new))\n\n    [:min, :first].each do |method|\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n    end\n  end","complexity_score":55.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_some_enumerable_methods_still_get_invoked\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"count\"]},{\"type\":\"sym\",\"children\":[\"max\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if collection contains 3 %}yes{% endif %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"min\"]},{\"type\":\"sym\",\"children\":[\"first\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":238,"raw_source":"def test_empty_string_value_access\n    assert_equal('', Liquid::Template.parse('{{ product[value] }}').render!('product' => ProductDrop.new, 'value' => ''))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_empty_string_value_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product[value] }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":242,"raw_source":"def test_nil_value_access\n    assert_equal('', Liquid::Template.parse('{{ product[value] }}').render!('product' => ProductDrop.new, 'value' => nil))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_value_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product[value] }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":246,"raw_source":"def test_default_to_s_on_drops\n    assert_equal('ProductDrop', Liquid::Template.parse(\"{{ product }}\").render!('product' => ProductDrop.new))\n    assert_equal('EnumerableDrop', Liquid::Template.parse('{{ collection }}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_to_s_on_drops\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ProductDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"EnumerableDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ collection }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":251,"raw_source":"def test_invokable_methods\n    assert_equal(%w(to_liquid catchall context texts).to_set, ProductDrop.invokable_methods)\n    assert_equal(%w(to_liquid scopes_as_array loop_pos scopes).to_set, ContextDrop.invokable_methods)\n    assert_equal(%w(to_liquid size max min first count).to_set, EnumerableDrop.invokable_methods)\n    assert_equal(%w(to_liquid max min sort count first).to_set, RealEnumerableDrop.invokable_methods)\n  end","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invokable_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"catchall\"]},{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"str\",\"children\":[\"texts\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"scopes_as_array\"]},{\"type\":\"str\",\"children\":[\"loop_pos\"]},{\"type\":\"str\",\"children\":[\"scopes\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"str\",\"children\":[\"max\"]},{\"type\":\"str\",\"children\":[\"min\"]},{\"type\":\"str\",\"children\":[\"first\"]},{\"type\":\"str\",\"children\":[\"count\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"max\"]},{\"type\":\"str\",\"children\":[\"min\"]},{\"type\":\"str\",\"children\":[\"sort\"]},{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"str\",\"children\":[\"first\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"invokable_methods\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":8,"raw_source":"def test_templates_parsed_with_line_numbers_renders_them_in_errors\n    template = <<-LIQUID\n      Hello,\n\n      {{ errors.standard_error }} will raise a standard error.\n\n      Bla bla test.\n\n      {{ errors.syntax_error }} will raise a syntax error.\n\n      This is an argument error: {{ errors.argument_error }}\n\n      Bla.\n    LIQUID\n\n    expected = <<-TEXT\n      Hello,\n\n      Liquid error (line 3): standard error will raise a standard error.\n\n      Bla bla test.\n\n      Liquid syntax error (line 7): syntax error will raise a syntax error.\n\n      This is an argument error: Liquid error (line 9): argument error\n\n      Bla.\n    TEXT\n\n    output = Liquid::Template.parse(template, line_numbers: true).render('errors' => ErrorDrop.new)\n    assert_equal(expected, output)\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_templates_parsed_with_line_numbers_renders_them_in_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      Hello,\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      {{ errors.standard_error }} will raise a standard error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla bla test.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      {{ errors.syntax_error }} will raise a syntax error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      This is an argument error: {{ errors.argument_error }}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla.\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      Hello,\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Liquid error (line 3): standard error will raise a standard error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla bla test.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Liquid syntax error (line 7): syntax error will raise a syntax error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      This is an argument error: Liquid error (line 9): argument error\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla.\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":41,"raw_source":"def test_standard_error\n    template = Liquid::Template.parse(' {{ errors.standard_error }} ')\n    assert_equal(' Liquid error: standard error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(StandardError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.standard_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: standard error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"StandardError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":49,"raw_source":"def test_syntax\n    template = Liquid::Template.parse(' {{ errors.syntax_error }} ')\n    assert_equal(' Liquid syntax error: syntax error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(SyntaxError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.syntax_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid syntax error: syntax error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":57,"raw_source":"def test_argument\n    template = Liquid::Template.parse(' {{ errors.argument_error }} ')\n    assert_equal(' Liquid error: argument error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(ArgumentError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.argument_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: argument error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":65,"raw_source":"def test_missing_endtag_parse_time_error\n    assert_match_syntax_error(/: 'for' tag was never closed\\z/, ' {% for a in b %} ... ')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_missing_endtag_parse_time_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\": 'for' tag was never closed\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\" {% for a in b %} ... \"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":69,"raw_source":"def test_unrecognized_operator\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ')\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unrecognized_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":77,"raw_source":"def test_lax_unrecognized_operator\n    template = Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ', error_mode: :lax)\n    assert_equal(' Liquid error: Unknown operator =! ', template.render)\n    assert_equal(1, template.errors.size)\n    assert_equal(Liquid::ArgumentError, template.errors.first.class)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lax_unrecognized_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: Unknown operator =! \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":84,"raw_source":"def test_with_line_numbers_adds_numbers_to_parser_errors\n    source = <<~LIQUID\n      foobar\n\n      {% \"cat\" | foobar %}\n\n      bla\n    LIQUID\n    assert_match_syntax_error(/Liquid syntax error \\(line 3\\)/, source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_line_numbers_adds_numbers_to_parser_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% \\\"cat\\\" | foobar %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error \\\\(line 3\\\\)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":95,"raw_source":"def test_with_line_numbers_adds_numbers_to_parser_errors_with_whitespace_trim\n    source = <<~LIQUID\n      foobar\n\n      {%- \"cat\" | foobar -%}\n\n      bla\n    LIQUID\n\n    assert_match_syntax_error(/Liquid syntax error \\(line 3\\)/, source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_line_numbers_adds_numbers_to_parser_errors_with_whitespace_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{%- \\\"cat\\\" | foobar -%}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error \\\\(line 3\\\\)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":107,"raw_source":"def test_parsing_warn_with_line_numbers_adds_numbers_to_lexer_errors\n    template = Liquid::Template.parse(\n      '\n        foobar\n\n        {% if 1 =! 2 %}ok{% endif %}\n\n        bla\n            ',\n      error_mode: :warn,\n      line_numbers: true,\n    )\n\n    assert_equal(\n      ['Liquid syntax error (line 4): Unexpected character = in \"1 =! 2\"'],\n      template.warnings.map(&:message),\n    )\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_warn_with_line_numbers_adds_numbers_to_lexer_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        {% if 1 =! 2 %}ok{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        bla\\n\"]},{\"type\":\"str\",\"children\":[\"            \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unexpected character = in \\\"1 =! 2\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"message\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":126,"raw_source":"def test_parsing_strict_with_line_numbers_adds_numbers_to_lexer_errors\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse(\n        '\n          foobar\n\n          {% if 1 =! 2 %}ok{% endif %}\n\n          bla\n                ',\n        error_mode: :strict,\n        line_numbers: true,\n      )\n    end\n\n    assert_equal('Liquid syntax error (line 4): Unexpected character = in \"1 =! 2\"', err.message)\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_strict_with_line_numbers_adds_numbers_to_lexer_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if 1 =! 2 %}ok{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          bla\\n\"]},{\"type\":\"str\",\"children\":[\"                \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unexpected character = in \\\"1 =! 2\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":144,"raw_source":"def test_syntax_errors_in_nested_blocks_have_correct_line_number\n    source = <<~LIQUID\n      foobar\n\n      {% if 1 != 2 %}\n        {% foo %}\n      {% endif %}\n\n      bla\n    LIQUID\n\n    assert_match_syntax_error(\"Liquid syntax error (line 4): Unknown tag 'foo'\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_errors_in_nested_blocks_have_correct_line_number\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% if 1 != 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% foo %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unknown tag 'foo'\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":158,"raw_source":"def test_strict_error_messages\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ', error_mode: :strict)\n    end\n    assert_equal('Liquid syntax error: Unexpected character = in \"1 =! 2\"', err.message)\n\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse('{{%%%}}', error_mode: :strict)\n    end\n    assert_equal('Liquid syntax error: Unexpected character % in \"{{%%%}}\"', err.message)\n  end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strict_error_messages\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Unexpected character = in \\\"1 =! 2\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{%%%}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":170,"raw_source":"def test_warnings\n    template = Liquid::Template.parse('{% if ~~~ %}{{%%%}}{% else %}{{ hello. }}{% endif %}', error_mode: :warn)\n    assert_equal(3, template.warnings.size)\n    assert_equal('Unexpected character ~ in \"~~~\"', template.warnings[0].to_s(false))\n    assert_equal('Unexpected character % in \"{{%%%}}\"', template.warnings[1].to_s(false))\n    assert_equal('Expected id but found end_of_string in \"{{ hello. }}\"', template.warnings[2].to_s(false))\n    assert_equal('', template.render)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if ~~~ %}{{%%%}}{% else %}{{ hello. }}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unexpected character ~ in \\\"~~~\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Expected id but found end_of_string in \\\"{{ hello. }}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":179,"raw_source":"def test_warning_line_numbers\n    template = Liquid::Template.parse(\"{% if ~~~ %}\\n{{%%%}}{% else %}\\n{{ hello. }}{% endif %}\", error_mode: :warn, line_numbers: true)\n    assert_equal('Liquid syntax error (line 1): Unexpected character ~ in \"~~~\"', template.warnings[0].message)\n    assert_equal('Liquid syntax error (line 2): Unexpected character % in \"{{%%%}}\"', template.warnings[1].message)\n    assert_equal('Liquid syntax error (line 3): Expected id but found end_of_string in \"{{ hello. }}\"', template.warnings[2].message)\n    assert_equal(3, template.warnings.size)\n    assert_equal([1, 2, 3], template.warnings.map(&:line_number))\n  end","complexity_score":28.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_warning_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if ~~~ %}\\n{{%%%}}{% else %}\\n{{ hello. }}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unexpected character ~ in \\\"~~~\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 2): Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 3): Expected id but found end_of_string in \\\"{{ hello. }}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":189,"raw_source":"def test_exceptions_propagate\n    assert_raises(Exception) do\n      template = Liquid::Template.parse('{{ errors.exception }}')\n      template.render('errors' => ErrorDrop.new)\n    end\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_exceptions_propagate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ errors.exception }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":196,"raw_source":"def test_default_exception_renderer_with_internal_error\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.runtime_error }}', line_numbers: true)\n\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: Liquid error (line 1): internal', output)\n    assert_equal([Liquid::InternalError], template.errors.map(&:class))\n  end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_exception_renderer_with_internal_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.runtime_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: Liquid error (line 1): internal\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":205,"raw_source":"def test_setting_default_exception_renderer\n    exceptions = []\n    default_exception_renderer = ->(e) {\n      exceptions << e\n      ''\n    }\n\n    env = Liquid::Environment.build(exception_renderer: default_exception_renderer)\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.argument_error }}', environment: env)\n\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: ', output)\n    assert_equal([Liquid::ArgumentError], template.errors.map(&:class))\n  end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_setting_default_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"default_exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"default_exception_renderer\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.argument_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":221,"raw_source":"def test_setting_exception_renderer_on_environment\n    exceptions = []\n    exception_renderer = ->(e) do\n      exceptions << e\n      ''\n    end\n\n    environment = Liquid::Environment.build(exception_renderer: exception_renderer)\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.argument_error }}', environment: environment)\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: ', output)\n    assert_equal([Liquid::ArgumentError], template.errors.map(&:class))\n  end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_setting_exception_renderer_on_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.argument_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":236,"raw_source":"def test_exception_renderer_exposing_non_liquid_error\n    template   = Liquid::Template.parse('This is a runtime error: {{ errors.runtime_error }}', line_numbers: true)\n    exceptions = []\n    handler    = ->(e) {\n      exceptions << e\n      e.cause\n    }\n\n    output = template.render({ 'errors' => ErrorDrop.new }, exception_renderer: handler)\n\n    assert_equal('This is a runtime error: runtime error', output)\n    assert_equal([Liquid::InternalError], exceptions.map(&:class))\n    assert_equal(exceptions, template.errors)\n    assert_equal('#<RuntimeError: runtime error>', exceptions.first.cause.inspect)\n  end","complexity_score":22.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_exception_renderer_exposing_non_liquid_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.runtime_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"cause\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"handler\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: runtime error\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exceptions\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"#<RuntimeError: runtime error>\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"first\"]},\"cause\"]},\"inspect\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":253,"raw_source":"def read_template_file(_template_path)\n      \"{{ errors.argument_error }}\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"str\",\"children\":[\"{{ errors.argument_error }}\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":258,"raw_source":"def test_included_template_name_with_line_numbers\n    environment = Liquid::Environment.build(file_system: TestFileSystem.new)\n    template = Liquid::Template.parse(\"Argument error:\\n{% include 'product' %}\", line_numbers: true, environment: environment)\n    page     = template.render('errors' => ErrorDrop.new)\n\n    assert_equal(\"Argument error:\\nLiquid error (product line 1): argument error\", page)\n    assert_equal(\"product\", template.errors.first.template_name)\n  end","complexity_score":14.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_included_template_name_with_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"Argument error:\\n{% include 'product' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"page\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Argument error:\\nLiquid error (product line 1): argument error\"]},{\"type\":\"lvar\",\"children\":[\"page\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"template_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":267,"raw_source":"def test_bug_compatible_silencing_of_errors_in_blank_nodes\n    output = Liquid::Template.parse(\"{% assign x = 0 %}{% if 1 < '2' %}not blank{% assign x = 3 %}{% endif %}{{ x }}\").render\n    assert_equal(\"Liquid error: comparison of Integer with String failed0\", output)\n\n    output = Liquid::Template.parse(\"{% assign x = 0 %}{% if 1 < '2' %}{% assign x = 3 %}{% endif %}{{ x }}\").render\n    assert_equal(\"0\", output)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bug_compatible_silencing_of_errors_in_blank_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign x = 0 %}{% if 1 < '2' %}not blank{% assign x = 3 %}{% endif %}{{ x }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: comparison of Integer with String failed0\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign x = 0 %}{% if 1 < '2' %}{% assign x = 3 %}{% endif %}{{ x }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":275,"raw_source":"def test_syntax_error_is_raised_with_template_name\n    file_system = StubFileSystem.new(\"snippet\" => \"1\\n2\\n{{ 1\")\n\n    context = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    template = Template.parse(\n      '{% render \"snippet\" %}',\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    assert_equal(\n      \"Liquid syntax error (snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\",\n      template.render(context),\n    )\n  end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_is_raised_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"1\\n2\\n{{ 1\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":294,"raw_source":"def test_syntax_error_is_raised_with_template_name_from_template_factory\n    file_system = StubFileSystem.new(\"snippet\" => \"1\\n2\\n{{ 1\")\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: file_system,\n        template_factory: StubTemplateFactory.new,\n      },\n    )\n\n    template = Template.parse(\n      '{% render \"snippet\" %}',\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    assert_equal(\n      \"Liquid syntax error (some/path/snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\",\n      template.render(context),\n    )\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_is_raised_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"1\\n2\\n{{ 1\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (some/path/snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":316,"raw_source":"def test_error_is_raised_during_parse_with_template_name\n    depth = Liquid::Block::MAX_DEPTH + 1\n    code = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n\n    template = Template.parse(\"{% render 'snippet' %}\", line_numbers: true)\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new(\"snippet\" => code),\n        template_factory: StubTemplateFactory.new,\n      },\n    )\n\n    assert_equal(\"Liquid error (some/path/snippet line 1): Nesting too deep\", template.render(context))\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_is_raised_during_parse_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'snippet' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"lvar\",\"children\":[\"code\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/snippet line 1): Nesting too deep\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":332,"raw_source":"def test_internal_error_is_raised_with_template_name\n    template = Template.new\n    template.parse(\n      \"{% render 'snippet' %}\",\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new({}),\n      },\n    )\n\n    assert_equal(\n      \"Liquid error (template/index line 1): internal\",\n      template.render(context),\n    )\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_internal_error_is_raised_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'snippet' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error (template/index line 1): internal\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":7,"raw_source":"def test_keyword_literals\n    assert_template_result(\"true\", \"{{ true }}\")\n    assert_expression_result(true, \"true\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_keyword_literals\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{{ true }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"true\",\"children\":[]},{\"type\":\"str\",\"children\":[\"true\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":12,"raw_source":"def test_string\n    assert_template_result(\"single quoted\", \"{{'single quoted'}}\")\n    assert_template_result(\"double quoted\", '{{\"double quoted\"}}')\n    assert_template_result(\"spaced\", \"{{ 'spaced' }}\")\n    assert_template_result(\"spaced2\", \"{{ 'spaced2' }}\")\n    assert_template_result(\"emoji\", \"{{ 'emoji' }}\")\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"single quoted\"]},{\"type\":\"str\",\"children\":[\"{{'single quoted'}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"double quoted\"]},{\"type\":\"str\",\"children\":[\"{{\\\"double quoted\\\"}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"spaced\"]},{\"type\":\"str\",\"children\":[\"{{ 'spaced' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"spaced2\"]},{\"type\":\"str\",\"children\":[\"{{ 'spaced2' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"emoji\"]},{\"type\":\"str\",\"children\":[\"{{ 'emoji' }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":20,"raw_source":"def test_int\n    assert_template_result(\"456\", \"{{ 456 }}\")\n    assert_expression_result(123, \"123\")\n    assert_expression_result(12, \"012\")\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_int\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"456\"]},{\"type\":\"str\",\"children\":[\"{{ 456 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"int\",\"children\":[123]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"int\",\"children\":[12]},{\"type\":\"str\",\"children\":[\"012\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":26,"raw_source":"def test_float\n    assert_template_result(\"-17.42\", \"{{ -17.42 }}\")\n    assert_template_result(\"2.5\", \"{{ 2.5 }}\")\n    assert_expression_result(0.0, \"0.....5\")\n    assert_expression_result(0.0, \"-0..1\")\n    assert_expression_result(1.5, \"1.5\")\n\n    # this is a unfortunate quirky behavior of Liquid\n    result = Expression.parse(\".5\")\n    assert_kind_of(Liquid::VariableLookup, result)\n\n    result = Expression.parse(\"-.5\")\n    assert_kind_of(Liquid::VariableLookup, result)\n  end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-17.42\"]},{\"type\":\"str\",\"children\":[\"{{ -17.42 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.5\"]},{\"type\":\"str\",\"children\":[\"{{ 2.5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"str\",\"children\":[\"0.....5\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"str\",\"children\":[\"-0..1\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[1.5]},{\"type\":\"str\",\"children\":[\"1.5\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\".5\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VariableLookup\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\"-.5\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VariableLookup\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":41,"raw_source":"def test_range\n    assert_template_result(\"3..4\", \"{{ ( 3 .. 4 ) }}\")\n    assert_expression_result(1..2, \"(1..2)\")\n\n    assert_match_syntax_error(\n      \"Liquid syntax error (line 1): Invalid expression type 'false' in range expression\",\n      \"{{ (false..true) }}\",\n    )\n    assert_match_syntax_error(\n      \"Liquid syntax error (line 1): Invalid expression type '(1..2)' in range expression\",\n      \"{{ ((1..2)..3) }}\",\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3..4\"]},{\"type\":\"str\",\"children\":[\"{{ ( 3 .. 4 ) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"str\",\"children\":[\"(1..2)\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Invalid expression type 'false' in range expression\"]},{\"type\":\"str\",\"children\":[\"{{ (false..true) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Invalid expression type '(1..2)' in range expression\"]},{\"type\":\"str\",\"children\":[\"{{ ((1..2)..3) }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":55,"raw_source":"def test_quirky_negative_sign_expression_markup\n    result = Expression.parse(\"-\", nil)\n    assert(result.is_a?(VariableLookup))\n    assert_equal(\"-\", result.name)\n\n    # for this template, the expression markup is \"-\"\n    assert_template_result(\n      \"\",\n      \"{{ - 'theme.css' - }}\",\n    )\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quirky_negative_sign_expression_markup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ - 'theme.css' - }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":67,"raw_source":"def test_expression_cache\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    cache = {}\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    Liquid::Template.parse(template, expression_cache: cache).render\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":18.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":88,"raw_source":"def test_expression_cache_with_true_boolean\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    parse_context = ParseContext.new(expression_cache: true)\n\n    Liquid::Template.parse(template, parse_context).render\n\n    cache = parse_context.instance_variable_get(:@expression_cache)\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache_with_true_boolean\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},\"render\"]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"instance_variable_get\",{\"type\":\"sym\",\"children\":[\"@expression_cache\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":112,"raw_source":"def test_expression_cache_with_lru_redux\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    cache = LruRedux::Cache.new(10)\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    Liquid::Template.parse(template, expression_cache: cache).render\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":19.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache_with_lru_redux\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LruRedux\"]},\"Cache\"]},\"new\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":133,"raw_source":"def test_disable_expression_cache\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    parse_context = Liquid::ParseContext.new(expression_cache: false)\n    Liquid::Template.parse(template, parse_context).render\n    assert(parse_context.instance_variable_get(:@expression_cache).nil?)\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disable_expression_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"instance_variable_get\",{\"type\":\"sym\",\"children\":[\"@expression_cache\"]}]},\"nil?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":152,"raw_source":"def assert_expression_result(expect, markup, **assigns)\n    liquid = \"{% if expect == #{markup} %}pass{% else %}got {{ #{markup} }}{% endif %}\"\n    assert_template_result(\"pass\", liquid, { \"expect\" => expect, **assigns })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_expression_result\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expect\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"kwrestarg\",\"children\":[\"assigns\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"liquid\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if expect == \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %}pass{% else %}got {{ \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" }}{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"lvar\",\"children\":[\"expect\"]}]},{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_kwarg_test.rb","start_line":7,"raw_source":"def html_tag(_tag, attributes)\n      attributes\n        .map { |key, value| \"#{key}='#{value}'\" }\n        .join(' ')\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"html_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_tag\"]},{\"type\":\"arg\",\"children\":[\"attributes\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"attributes\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"='\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_kwarg_test.rb","start_line":16,"raw_source":"def test_can_parse_data_kwargs\n    with_global_filter(KwargFilter) do\n      assert_equal(\n        \"data-src='src' data-widths='100, 200'\",\n        Template.parse(\"{{ 'img' | html_tag: data-src: 'src', data-widths: '100, 200' }}\").render(nil, nil),\n      )\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_can_parse_data_kwargs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"KwargFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"data-src='src' data-widths='100, 200'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'img' | html_tag: data-src: 'src', data-widths: '100, 200' }}\"]}]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":6,"raw_source":"def money(input)\n    format(' %d$ ', input)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\" %d$ \"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":10,"raw_source":"def money_with_underscore(input)\n    format(' %d$ ', input)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"money_with_underscore\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\" %d$ \"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":16,"raw_source":"def money(input)\n    format(' %d$ CAD ', input)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\" %d$ CAD \"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":22,"raw_source":"def substitute(input, params = {})\n    input.gsub(/%\\{(\\w+)\\}/) { |_match| params[Regexp.last_match(1)] }\n  end","complexity_score":5.78,"ast_json":"{\"type\":\"def\",\"children\":[\"substitute\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%\\\\{(\\\\w+)\\\\}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_match\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":31,"raw_source":"def tap(_input)\n      \"tap overridden\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"tap\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_input\"]}]},{\"type\":\"str\",\"children\":[\"tap overridden\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":36,"raw_source":"def setup\n    @context = Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":40,"raw_source":"def test_local_filter\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n\n    assert_equal(' 1000$ ', Template.parse(\"{{var | money}}\").render(@context))\n  end","complexity_score":5.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":47,"raw_source":"def test_underscore_in_filter_name\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n    assert_equal(' 1000$ ', Template.parse(\"{{var | money_with_underscore}}\").render(@context))\n  end","complexity_score":5.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_underscore_in_filter_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money_with_underscore}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":53,"raw_source":"def test_second_filter_overwrites_first\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n    @context.add_filters(CanadianMoneyFilter)\n\n    assert_equal(' 1000$ CAD ', Template.parse(\"{{var | money}}\").render(@context))\n  end","complexity_score":6.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_second_filter_overwrites_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":61,"raw_source":"def test_size\n    assert_template_result(\"4\", \"{{var | size}}\", { \"var\" => 'abcd' })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{var | size}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"abcd\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":65,"raw_source":"def test_join\n    assert_template_result(\"1 2 3 4\", \"{{var | join}}\", { \"var\" => [1, 2, 3, 4] })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"str\",\"children\":[\"{{var | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":69,"raw_source":"def test_sort\n    assert_template_result(\"1 2 3 4\", \"{{numbers | sort | join}}\", { \"numbers\" => [2, 1, 4, 3] })\n    assert_template_result(\n      \"alphabetic as expected\",\n      \"{{words | sort | join}}\",\n      { \"words\" => ['expected', 'as', 'alphabetic'] },\n    )\n    assert_template_result(\"3\", \"{{value | sort}}\", { \"value\" => 3 })\n    assert_template_result('are flower', \"{{arrays | sort | join}}\", { 'arrays' => ['flower', 'are'] })\n    assert_template_result(\n      \"Expected case sensitive\",\n      \"{{case_sensitive | sort | join}}\",\n      { \"case_sensitive\" => [\"sensitive\", \"Expected\", \"case\"] },\n    )\n  end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"str\",\"children\":[\"{{numbers | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"alphabetic as expected\"]},{\"type\":\"str\",\"children\":[\"{{words | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"expected\"]},{\"type\":\"str\",\"children\":[\"as\"]},{\"type\":\"str\",\"children\":[\"alphabetic\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"str\",\"children\":[\"{{value | sort}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"are flower\"]},{\"type\":\"str\",\"children\":[\"{{arrays | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"arrays\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"flower\"]},{\"type\":\"str\",\"children\":[\"are\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Expected case sensitive\"]},{\"type\":\"str\",\"children\":[\"{{case_sensitive | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"case_sensitive\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"sensitive\"]},{\"type\":\"str\",\"children\":[\"Expected\"]},{\"type\":\"str\",\"children\":[\"case\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":85,"raw_source":"def test_sort_natural\n    # Test strings\n    assert_template_result(\n      \"Assert case Insensitive\",\n      \"{{words | sort_natural | join}}\",\n      { \"words\" => [\"case\", \"Assert\", \"Insensitive\"] },\n    )\n\n    # Test hashes\n    assert_template_result(\n      \"A b C\",\n      \"{{hashes | sort_natural: 'a' | map: 'a' | join}}\",\n      { \"hashes\" => [{ \"a\" => \"A\" }, { \"a\" => \"b\" }, { \"a\" => \"C\" }] },\n    )\n\n    # Test objects\n    @context['objects'] = [TestObject.new('A'), TestObject.new('b'), TestObject.new('C')]\n    assert_equal('A b C', Template.parse(\"{{objects | sort_natural: 'a' | map: 'a' | join}}\").render(@context))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Assert case Insensitive\"]},{\"type\":\"str\",\"children\":[\"{{words | sort_natural | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"case\"]},{\"type\":\"str\",\"children\":[\"Assert\"]},{\"type\":\"str\",\"children\":[\"Insensitive\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A b C\"]},{\"type\":\"str\",\"children\":[\"{{hashes | sort_natural: 'a' | map: 'a' | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hashes\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"objects\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"C\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A b C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{objects | sort_natural: 'a' | map: 'a' | join}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":105,"raw_source":"def test_compact\n    # Test strings\n    assert_template_result(\n      \"a b c\",\n      \"{{words | compact | join}}\",\n      { \"words\" => ['a', nil, 'b', nil, 'c'] },\n    )\n\n    # Test hashes\n    assert_template_result(\n      \"A C\",\n      \"{{hashes | compact: 'a' | map: 'a' | join}}\",\n      { \"hashes\" => [{ \"a\" => \"A\" }, { \"a\" => nil }, { \"a\" => \"C\" }] },\n    )\n\n    # Test objects\n    @context['objects'] = [TestObject.new('A'), TestObject.new(nil), TestObject.new('C')]\n    assert_equal('A C', Template.parse(\"{{objects | compact: 'a' | map: 'a' | join}}\").render(@context))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a b c\"]},{\"type\":\"str\",\"children\":[\"{{words | compact | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A C\"]},{\"type\":\"str\",\"children\":[\"{{hashes | compact: 'a' | map: 'a' | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hashes\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"objects\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"C\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{objects | compact: 'a' | map: 'a' | join}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":125,"raw_source":"def test_strip_html\n    assert_template_result(\"bla blub\", \"{{ var | strip_html }}\", { \"var\" => \"<b>bla blub</a>\" })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_html\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bla blub\"]},{\"type\":\"str\",\"children\":[\"{{ var | strip_html }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"<b>bla blub</a>\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":129,"raw_source":"def test_strip_html_ignore_comments_with_html\n    assert_template_result(\n      \"bla blub\",\n      \"{{ var | strip_html }}\",\n      { \"var\" => \"<!-- split and some <ul> tag --><b>bla blub</a>\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_html_ignore_comments_with_html\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bla blub\"]},{\"type\":\"str\",\"children\":[\"{{ var | strip_html }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"<!-- split and some <ul> tag --><b>bla blub</a>\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":137,"raw_source":"def test_capitalize\n    assert_template_result(\"Blub\", \"{{ var | capitalize }}\", { \"var\" => \"blub\" })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capitalize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Blub\"]},{\"type\":\"str\",\"children\":[\"{{ var | capitalize }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"blub\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":141,"raw_source":"def test_nonexistent_filter_is_ignored\n    assert_template_result(\"1000\", \"{{ var | xyzzy }}\", { \"var\" => 1000 })\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nonexistent_filter_is_ignored\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1000\"]},{\"type\":\"str\",\"children\":[\"{{ var | xyzzy }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":145,"raw_source":"def test_filter_with_keyword_arguments\n    @context['surname'] = 'john'\n    @context['input']   = 'hello %{first_name}, %{last_name}'\n    @context.add_filters(SubstituteFilter)\n    output              = Template.parse(%({{ input | substitute: first_name: surname, last_name: 'doe' }})).render(@context)\n    assert_equal('hello john, doe', output)\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_keyword_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"surname\"]},{\"type\":\"str\",\"children\":[\"john\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"hello %{first_name}, %{last_name}\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"SubstituteFilter\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ input | substitute: first_name: surname, last_name: 'doe' }}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello john, doe\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":153,"raw_source":"def test_override_object_method_in_filter\n    assert_equal(\"tap overridden\", Template.parse(\"{{var | tap}}\").render!({ 'var' => 1000 }, filters: [OverrideObjectMethodFilter]))\n\n    # tap still treated as a non-existent filter\n    assert_equal(\"1000\", Template.parse(\"{{var | tap}}\").render!('var' => 1000))\n  end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_override_object_method_in_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"tap overridden\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | tap}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OverrideObjectMethodFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1000\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | tap}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":160,"raw_source":"def test_liquid_argument_error\n    source = \"{{ '' | size: 'too many args' }}\"\n    exc = assert_raises(Liquid::ArgumentError) do\n      Template.parse(source).render!\n    end\n    assert_match(/\\ALiquid error: wrong number of arguments /, exc.message)\n    assert_equal(exc.message, Template.parse(source).render)\n  end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_argument_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{{ '' | size: 'too many args' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]}]},\"render!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\ALiquid error: wrong number of arguments \"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]}]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":173,"raw_source":"def test_local_global\n    with_global_filter(MoneyFilter) do\n      assert_equal(\" 1000$ \", Template.parse(\"{{1000 | money}}\").render!(nil, nil))\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, filters: CanadianMoneyFilter))\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, filters: [CanadianMoneyFilter]))\n    end\n  end","complexity_score":14.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_global\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":181,"raw_source":"def test_local_filter_with_deprecated_syntax\n    assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, CanadianMoneyFilter))\n    assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, [CanadianMoneyFilter]))\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_filter_with_deprecated_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":189,"raw_source":"def initialize(a)\n    @a = a\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@a\",{\"type\":\"lvar\",\"children\":[\"a\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_ordering_test.rb","start_line":7,"raw_source":"def money(input)\n      format(' %d$ ', input)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\" %d$ \"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_ordering_test.rb","start_line":13,"raw_source":"def money(input)\n      format(' %d$ CAD ', input)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\" %d$ CAD \"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_ordering_test.rb","start_line":20,"raw_source":"def test_global_register_order\n    with_global_filter(MoneyFilter, CanadianMoneyFilter) do\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render(nil, nil))\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_global_register_order\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":6,"raw_source":"def test_render_empty_hash\n    assert_template_result(\"{}\", \"{{ my_hash }}\", { \"my_hash\" => {} })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_empty_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":10,"raw_source":"def test_render_hash_with_string_keys_and_values\n    assert_template_result(\"{\\\"key1\\\"=>\\\"value1\\\", \\\"key2\\\"=>\\\"value2\\\"}\", \"{{ my_hash }}\", { \"my_hash\" => { \"key1\" => \"value1\", \"key2\" => \"value2\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_string_keys_and_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"key1\\\"=>\\\"value1\\\", \\\"key2\\\"=>\\\"value2\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key1\"]},{\"type\":\"str\",\"children\":[\"value1\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key2\"]},{\"type\":\"str\",\"children\":[\"value2\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":14,"raw_source":"def test_render_hash_with_symbol_keys_and_integer_values\n    assert_template_result(\"{:key1=>1, :key2=>2}\", \"{{ my_hash }}\", { \"my_hash\" => { key1: 1, key2: 2 } })\n  end","complexity_score":1.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_symbol_keys_and_integer_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{:key1=>1, :key2=>2}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"key1\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"key2\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":18,"raw_source":"def test_render_nested_hash\n    assert_template_result(\"{\\\"outer\\\"=>{\\\"inner\\\"=>\\\"value\\\"}}\", \"{{ my_hash }}\", { \"my_hash\" => { \"outer\" => { \"inner\" => \"value\" } } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_nested_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"outer\\\"=>{\\\"inner\\\"=>\\\"value\\\"}}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"inner\"]},{\"type\":\"str\",\"children\":[\"value\"]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":22,"raw_source":"def test_render_hash_with_array_values\n    assert_template_result(\"{\\\"numbers\\\"=>[1, 2, 3]}\", \"{{ my_hash }}\", { \"my_hash\" => { \"numbers\" => [1, 2, 3] } })\n  end","complexity_score":1.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_array_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"numbers\\\"=>[1, 2, 3]}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":26,"raw_source":"def test_render_recursive_hash\n    recursive_hash = { \"self\" => {} }\n    recursive_hash[\"self\"][\"self\"] = recursive_hash\n    assert_template_result(\"{\\\"self\\\"=>{\\\"self\\\"=>{...}}}\", \"{{ my_hash }}\", { \"my_hash\" => recursive_hash })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_recursive_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"recursive_hash\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"self\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"self\"]}]},\"[]=\",{\"type\":\"str\",\"children\":[\"self\"]},{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"self\\\"=>{\\\"self\\\"=>{...}}}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":32,"raw_source":"def test_hash_with_downcase_filter\n    assert_template_result(\"{\\\"key\\\"=>\\\"value\\\", \\\"anotherkey\\\"=>\\\"anothervalue\\\"}\", \"{{ my_hash | downcase }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_downcase_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"key\\\"=>\\\"value\\\", \\\"anotherkey\\\"=>\\\"anothervalue\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | downcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":36,"raw_source":"def test_hash_with_upcase_filter\n    assert_template_result(\"{\\\"KEY\\\"=>\\\"VALUE\\\", \\\"ANOTHERKEY\\\"=>\\\"ANOTHERVALUE\\\"}\", \"{{ my_hash | upcase }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_upcase_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"KEY\\\"=>\\\"VALUE\\\", \\\"ANOTHERKEY\\\"=>\\\"ANOTHERVALUE\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | upcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":40,"raw_source":"def test_hash_with_strip_filter\n    assert_template_result(\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\", \"{{ my_hash | strip }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_strip_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | strip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":44,"raw_source":"def test_hash_with_escape_filter\n    assert_template_result(\"{&quot;Key&quot;=&gt;&quot;Value&quot;, &quot;AnotherKey&quot;=&gt;&quot;AnotherValue&quot;}\", \"{{ my_hash | escape }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_escape_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{&quot;Key&quot;=&gt;&quot;Value&quot;, &quot;AnotherKey&quot;=&gt;&quot;AnotherValue&quot;}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | escape }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":48,"raw_source":"def test_hash_with_url_encode_filter\n    assert_template_result(\"%7B%22Key%22%3D%3E%22Value%22%2C+%22AnotherKey%22%3D%3E%22AnotherValue%22%7D\", \"{{ my_hash | url_encode }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_url_encode_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"%7B%22Key%22%3D%3E%22Value%22%2C+%22AnotherKey%22%3D%3E%22AnotherValue%22%7D\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | url_encode }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":52,"raw_source":"def test_hash_with_strip_html_filter\n    assert_template_result(\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\", \"{{ my_hash | strip_html }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_strip_html_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | strip_html }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":56,"raw_source":"def test_hash_with_truncate__20_filter\n    assert_template_result(\"{\\\"Key\\\"=>\\\"Value\\\", ...\", \"{{ my_hash | truncate: 20 }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_truncate__20_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"Key\\\"=>\\\"Value\\\", ...\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | truncate: 20 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":60,"raw_source":"def test_hash_with_replace___key____replaced_key__filter\n    assert_template_result(\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\", \"{{ my_hash | replace: 'key', 'replaced_key' }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_replace___key____replaced_key__filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | replace: 'key', 'replaced_key' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":64,"raw_source":"def test_hash_with_append____appended_text__filter\n    assert_template_result(\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"} appended text\", \"{{ my_hash | append: ' appended text' }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_append____appended_text__filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"} appended text\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | append: ' appended text' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":68,"raw_source":"def test_hash_with_prepend___prepended_text___filter\n    assert_template_result(\"prepended text {\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\", \"{{ my_hash | prepend: 'prepended text ' }}\", { \"my_hash\" => { \"Key\" => \"Value\", \"AnotherKey\" => \"AnotherValue\" } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_prepend___prepended_text___filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"prepended text {\\\"Key\\\"=>\\\"Value\\\", \\\"AnotherKey\\\"=>\\\"AnotherValue\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash | prepend: 'prepended text ' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Key\"]},{\"type\":\"str\",\"children\":[\"Value\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"AnotherKey\"]},{\"type\":\"str\",\"children\":[\"AnotherValue\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":72,"raw_source":"def test_render_hash_with_array_values_empty\n    assert_template_result(\"{\\\"numbers\\\"=>[]}\", \"{{ my_hash }}\", { \"my_hash\" => { \"numbers\" => [] } })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_array_values_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"numbers\\\"=>[]}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":76,"raw_source":"def test_render_hash_with_array_values_hash\n    assert_template_result(\"{\\\"numbers\\\"=>[{:foo=>42}]}\", \"{{ my_hash }}\", { \"my_hash\" => { \"numbers\" => [{ foo: 42 }] } })\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_array_values_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"numbers\\\"=>[{:foo=>42}]}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[42]}]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":80,"raw_source":"def test_join_filter_with_hash\n    array = [{ \"key1\" => \"value1\" }, { \"key2\" => \"value2\" }]\n    glue = { \"lol\" => \"wut\" }\n    assert_template_result(\"{\\\"key1\\\"=>\\\"value1\\\"}{\\\"lol\\\"=>\\\"wut\\\"}{\\\"key2\\\"=>\\\"value2\\\"}\", \"{{ my_array | join: glue }}\", { \"my_array\" => array, \"glue\" => glue })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join_filter_with_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key1\"]},{\"type\":\"str\",\"children\":[\"value1\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key2\"]},{\"type\":\"str\",\"children\":[\"value2\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"glue\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lol\"]},{\"type\":\"str\",\"children\":[\"wut\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"key1\\\"=>\\\"value1\\\"}{\\\"lol\\\"=>\\\"wut\\\"}{\\\"key2\\\"=>\\\"value2\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_array | join: glue }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"glue\"]},{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":86,"raw_source":"def test_render_hash_with_hash_key\n    assert_template_result(\"{{\\\"foo\\\"=>\\\"bar\\\"}=>42}\", \"{{ my_hash }}\", { \"my_hash\" => { Hash[\"foo\" => \"bar\"] => 42 } })\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_hash_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{{\\\"foo\\\"=>\\\"bar\\\"}=>42}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"int\",\"children\":[42]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":90,"raw_source":"def test_rendering_hash_with_custom_to_s_method_uses_custom_to_s\n    my_hash = Class.new(Hash) do\n      def to_s\n        \"kewl\"\n      end\n    end.new\n\n    assert_template_result(\"kewl\", \"{{ my_hash }}\", { \"my_hash\" => my_hash })\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rendering_hash_with_custom_to_s_method_uses_custom_to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"kewl\"]}]}]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"kewl\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"my_hash\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":92,"raw_source":"def to_s\n        \"kewl\"\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"kewl\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":100,"raw_source":"def test_rendering_hash_without_custom_to_s_uses_default_inspect\n    my_hash = Class.new(Hash).new\n    my_hash[:foo] = :bar\n\n    assert_template_result(\"{:foo=>:bar}\", \"{{ my_hash }}\", { \"my_hash\" => my_hash })\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rendering_hash_without_custom_to_s_uses_default_inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"my_hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"sym\",\"children\":[\"bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{:foo=>:bar}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"my_hash\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":6,"raw_source":"def make_funny(_input)\n    'LOL'\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"make_funny\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_input\"]}]},{\"type\":\"str\",\"children\":[\"LOL\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":10,"raw_source":"def cite_funny(input)\n    \"LOL: #{input}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"cite_funny\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"LOL: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":14,"raw_source":"def add_smiley(input, smiley = \":-)\")\n    \"#{input} #{smiley}\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_smiley\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"smiley\",{\"type\":\"str\",\"children\":[\":-)\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"smiley\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":18,"raw_source":"def add_tag(input, tag = \"p\", id = \"foo\")\n    %(<#{tag} id=\"#{id}\">#{input}</#{tag}>)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"tag\",{\"type\":\"str\",\"children\":[\"p\"]}]},{\"type\":\"optarg\",\"children\":[\"id\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\" id=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"id\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\"</\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":22,"raw_source":"def paragraph(input)\n    \"<p>#{input}</p>\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"paragraph\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<p>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\"</p>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":26,"raw_source":"def link_to(name, url)\n    %(<a href=\"#{url}\">#{name}</a>)\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a href=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":34,"raw_source":"def setup\n    @assigns = {\n      'car' => { 'bmw' => 'good', 'gm' => 'bad' },\n    }\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"car\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bmw\"]},{\"type\":\"str\",\"children\":[\"good\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"gm\"]},{\"type\":\"str\",\"children\":[\"bad\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":40,"raw_source":"def test_variable\n    assert_template_result(\" bmw \", \" {{best_cars}} \", { \"best_cars\" => \"bmw\" })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" bmw \"]},{\"type\":\"str\",\"children\":[\" {{best_cars}} \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"best_cars\"]},{\"type\":\"str\",\"children\":[\"bmw\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":44,"raw_source":"def test_variable_traversing_with_two_brackets\n    source = \"{{ site.data.menu[include.menu][include.locale] }}\"\n    assert_template_result(\"it works!\", source, {\n      \"site\" => { \"data\" => { \"menu\" => { \"foo\" => { \"bar\" => \"it works!\" } } } },\n      \"include\" => { \"menu\" => \"foo\", \"locale\" => \"bar\" },\n    })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_traversing_with_two_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{{ site.data.menu[include.menu][include.locale] }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"it works!\"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"site\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"data\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"menu\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"it works!\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"menu\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"locale\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":52,"raw_source":"def test_variable_traversing\n    source = \" {{car.bmw}} {{car.gm}} {{car.bmw}} \"\n    assert_template_result(\" good bad good \", source, @assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_traversing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\" {{car.bmw}} {{car.gm}} {{car.bmw}} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" good bad good \"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":57,"raw_source":"def test_variable_piping\n    text     = %( {{ car.gm | make_funny }} )\n    expected = %( LOL )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | make_funny }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" LOL \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":64,"raw_source":"def test_variable_piping_with_input\n    text     = %( {{ car.gm | cite_funny }} )\n    expected = %( LOL: bad )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | cite_funny }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" LOL: bad \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":71,"raw_source":"def test_variable_piping_with_args\n    text     = %! {{ car.gm | add_smiley : ':-(' }} !\n    expected = %| bad :-( |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley : ':-(' }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-( \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":78,"raw_source":"def test_variable_piping_with_no_args\n    text     = %( {{ car.gm | add_smiley }} )\n    expected = %| bad :-) |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_no_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-) \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":85,"raw_source":"def test_multiple_variable_piping_with_args\n    text     = %! {{ car.gm | add_smiley : ':-(' | add_smiley : ':-('}} !\n    expected = %| bad :-( :-( |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_variable_piping_with_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley : ':-(' | add_smiley : ':-('}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-( :-( \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":92,"raw_source":"def test_variable_piping_with_multiple_args\n    text     = %( {{ car.gm | add_tag : 'span', 'bar'}} )\n    expected = %( <span id=\"bar\">bad</span> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_multiple_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_tag : 'span', 'bar'}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <span id=\\\"bar\\\">bad</span> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":99,"raw_source":"def test_variable_piping_with_variable_args\n    text     = %( {{ car.gm | add_tag : 'span', car.bmw}} )\n    expected = %( <span id=\"good\">bad</span> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_variable_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_tag : 'span', car.bmw}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <span id=\\\"good\\\">bad</span> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":106,"raw_source":"def test_multiple_pipings\n    assigns = { 'best_cars' => 'bmw' }\n    text     = %( {{ best_cars | cite_funny | paragraph }} )\n    expected = %( <p>LOL: bmw</p> )\n\n    assert_equal(expected, Template.parse(text).render!(assigns, filters: [FunnyFilter]))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_pipings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"best_cars\"]},{\"type\":\"str\",\"children\":[\"bmw\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ best_cars | cite_funny | paragraph }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <p>LOL: bmw</p> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":114,"raw_source":"def test_link_to\n    text     = %( {{ 'Typo' | link_to: 'http://typo.leetsoft.com' }} )\n    expected = %( <a href=\"http://typo.leetsoft.com\">Typo</a> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_link_to\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ 'Typo' | link_to: 'http://typo.leetsoft.com' }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <a href=\\\"http://typo.leetsoft.com\\\">Typo</a> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":8,"raw_source":"def test_parsing_css\n    text = \" div { font-weight: bold; } \"\n    assert_equal(text, Template.parse(text).render!)\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_css\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" div { font-weight: bold; } \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":13,"raw_source":"def test_raise_on_single_close_bracet\n    assert_raises(SyntaxError) do\n      Template.parse(\"text {{method} oh nos!\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_single_close_bracet\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"text {{method} oh nos!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":19,"raw_source":"def test_raise_on_label_and_no_close_bracets\n    assert_raises(SyntaxError) do\n      Template.parse(\"TEST {{ \")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_label_and_no_close_bracets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"TEST {{ \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":25,"raw_source":"def test_raise_on_label_and_no_close_bracets_percent\n    assert_raises(SyntaxError) do\n      Template.parse(\"TEST {% \")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_label_and_no_close_bracets_percent\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"TEST {% \"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":31,"raw_source":"def test_error_on_empty_filter\n    assert(Template.parse(\"{{test}}\"))\n\n    with_error_mode(:lax) do\n      assert(Template.parse(\"{{|test}}\"))\n    end\n\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) { Template.parse(\"{{|test}}\") }\n      assert_raises(SyntaxError) { Template.parse(\"{{test |a|b|}}\") }\n    end\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_on_empty_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test}}\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test}}\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test}}\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test |a|b|}}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":44,"raw_source":"def test_meaningless_parens_error\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        markup = \"a == 'foo' or (b == 'bar' and c == 'baz') or false\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_meaningless_parens_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"a == 'foo' or (b == 'bar' and c == 'baz') or false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":53,"raw_source":"def test_unexpected_characters_syntax_error\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        markup = \"true && false\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n      assert_raises(SyntaxError) do\n        markup = \"false || true\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n    end\n  end","complexity_score":12.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_characters_syntax_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"true && false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"false || true\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":66,"raw_source":"def test_no_error_on_lax_empty_filter\n    assert(Template.parse(\"{{test |a|b|}}\", error_mode: :lax))\n    assert(Template.parse(\"{{test}}\", error_mode: :lax))\n    assert(Template.parse(\"{{|test|}}\", error_mode: :lax))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_error_on_lax_empty_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test |a|b|}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test|}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":72,"raw_source":"def test_meaningless_parens_lax\n    with_error_mode(:lax) do\n      assigns = { 'b' => 'bar', 'c' => 'baz' }\n      markup  = \"a == 'foo' or (b == 'bar' and c == 'baz') or false\"\n      assert_template_result(' YES ', \"{% if #{markup} %} YES {% endif %}\", assigns)\n    end\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_meaningless_parens_lax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"a == 'foo' or (b == 'bar' and c == 'baz') or false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":80,"raw_source":"def test_unexpected_characters_silently_eat_logic_lax\n    with_error_mode(:lax) do\n      markup = \"true && false\"\n      assert_template_result(' YES ', \"{% if #{markup} %} YES {% endif %}\")\n      markup = \"false || true\"\n      assert_template_result('', \"{% if #{markup} %} YES {% endif %}\")\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_characters_silently_eat_logic_lax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"true && false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"false || true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":89,"raw_source":"def test_raise_on_invalid_tag_delimiter\n    assert_raises(Liquid::SyntaxError) do\n      Template.new.parse('{% end %}')\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_invalid_tag_delimiter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% end %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":95,"raw_source":"def test_unanchored_filter_arguments\n    with_error_mode(:lax) do\n      assert_template_result('hi', \"{{ 'hi there' | split$$$:' ' | first }}\")\n\n      assert_template_result('x', \"{{ 'X' | downcase) }}\")\n\n      # After the messed up quotes a filter without parameters (reverse) should work\n      # but one with parameters (remove) shouldn't be detected.\n      assert_template_result('here',  \"{{ 'hi there' | split:\\\"t\\\"\\\" | reverse | first}}\")\n      assert_template_result('hi ', \"{{ 'hi there' | split:\\\"t\\\"\\\" | remove:\\\"i\\\" | first}}\")\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unanchored_filter_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split$$$:' ' | first }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"{{ 'X' | downcase) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"here\"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split:\\\"t\\\"\\\" | reverse | first}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hi \"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split:\\\"t\\\"\\\" | remove:\\\"i\\\" | first}}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":108,"raw_source":"def test_invalid_variables_work\n    with_error_mode(:lax) do\n      assert_template_result('bar', \"{% assign 123foo = 'bar' %}{{ 123foo }}\")\n      assert_template_result('123', \"{% assign 123 = 'bar' %}{{ 123 }}\")\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_variables_work\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{% assign 123foo = 'bar' %}{{ 123foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% assign 123 = 'bar' %}{{ 123 }}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":115,"raw_source":"def test_extra_dots_in_ranges\n    with_error_mode(:lax) do\n      assert_template_result('12345', \"{% for i in (1...5) %}{{ i }}{% endfor %}\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_extra_dots_in_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12345\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1...5) %}{{ i }}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":121,"raw_source":"def test_blank_variable_markup\n    assert_template_result('', \"{{}}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_blank_variable_markup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{}}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":125,"raw_source":"def test_lookup_on_var_with_literal_name\n    assigns = { \"blank\" => { \"x\" => \"result\" } }\n    assert_template_result('result', \"{{ blank.x }}\", assigns)\n    assert_template_result('result', \"{{ blank['x'] }}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lookup_on_var_with_literal_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"blank\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ blank.x }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ blank['x'] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":131,"raw_source":"def test_contains_in_id\n    assert_template_result(' YES ', '{% if containsallshipments == true %} YES {% endif %}', { 'containsallshipments' => true })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_in_id\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if containsallshipments == true %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"containsallshipments\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":135,"raw_source":"def test_incomplete_expression\n    with_error_mode(:lax) do\n      assert_template_result(\"false\", \"{{ false - }}\")\n      assert_template_result(\"false\", \"{{ false > }}\")\n      assert_template_result(\"false\", \"{{ false < }}\")\n      assert_template_result(\"false\", \"{{ false = }}\")\n      assert_template_result(\"false\", \"{{ false ! }}\")\n      assert_template_result(\"false\", \"{{ false 1 }}\")\n      assert_template_result(\"false\", \"{{ false a }}\")\n\n      assert_template_result(\"false\", \"{% liquid assign foo = false -\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false >\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false <\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false =\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false !\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false 1\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false a\\n%}{{ foo }}\")\n    end\n  end","complexity_score":18.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_incomplete_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false - }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false > }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false < }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false = }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false ! }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false a }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false -\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false >\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false <\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false =\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false !\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false 1\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false a\\n%}{{ foo }}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":7,"raw_source":"def initialize(value)\n      super()\n      @value = value\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":12,"raw_source":"def to_s\n      artificial_execution_time\n\n      @value\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"artificial_execution_time\"]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":22,"raw_source":"def artificial_execution_time\n      sleep(Process.clock_getres(Process::CLOCK_MONOTONIC))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"artificial_execution_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"sleep\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"clock_getres\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"CLOCK_MONOTONIC\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":30,"raw_source":"def read_template_file(template_path)\n      \"Rendering template {% assign template_name = '#{template_path}'%}\\n{{ template_name }}\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Rendering template {% assign template_name = '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"str\",\"children\":[\"'%}\\n{{ template_name }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":35,"raw_source":"def setup\n    Liquid::Environment.default.file_system = ProfilingFileSystem.new\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"file_system=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProfilingFileSystem\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":39,"raw_source":"def test_template_allows_flagging_profiling\n    t = Template.parse(\"{{ 'a string' | upcase }}\")\n    t.render!\n\n    assert_nil(t.profiler)\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_template_allows_flagging_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":46,"raw_source":"def test_parse_makes_available_simple_profiling\n    t = Template.parse(\"{{ 'a string' | upcase }}\", profile: true)\n    t.render!\n\n    assert_equal(1, t.profiler.length)\n\n    node = t.profiler[0]\n    assert_equal(\" 'a string' | upcase \", node.code)\n  end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parse_makes_available_simple_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 'a string' | upcase \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"code\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":56,"raw_source":"def test_render_ignores_raw_strings_when_profiling\n    t = Template.parse(\"This is raw string\\nstuff\\nNewline\", profile: true)\n    t.render!\n\n    assert_equal(0, t.profiler.length)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_ignores_raw_strings_when_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is raw string\\nstuff\\nNewline\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":63,"raw_source":"def test_profiling_includes_line_numbers_of_liquid_nodes\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% increment test %}\", profile: true)\n    t.render!\n    assert_equal(2, t.profiler.length)\n\n    # {{ 'a string' | upcase }}\n    assert_equal(1, t.profiler[0].line_number)\n    # {{ increment test }}\n    assert_equal(2, t.profiler[1].line_number)\n  end","complexity_score":18.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_includes_line_numbers_of_liquid_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% increment test %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"line_number\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":74,"raw_source":"def test_profiling_includes_line_numbers_of_included_partials\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    included_children = t.profiler[0].children\n\n    # {% assign template_name = 'a_template' %}\n    assert_equal(1, included_children[0].line_number)\n    # {{ template_name }}\n    assert_equal(2, included_children[1].line_number)\n  end","complexity_score":15.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_includes_line_numbers_of_included_partials\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"included_children\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"included_children\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"included_children\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"line_number\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":86,"raw_source":"def test_profiling_render_tag\n    t = Template.parse(\"{% render 'a_template' %}\", profile: true)\n    t.render!\n\n    render_children = t.profiler[0].children\n    render_children.each do |timing|\n      assert_equal('a_template', timing.partial)\n    end\n    assert_equal([1, 2], render_children.map(&:line_number))\n  end","complexity_score":16.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_render_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"render_children\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"timing\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"partial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":97,"raw_source":"def test_profiling_times_the_rendering_of_tokens\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    node = t.profiler[0]\n    refute_nil(node.render_time)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_times_the_rendering_of_tokens\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"render_time\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":105,"raw_source":"def test_profiling_times_the_entire_render\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    assert(t.profiler.total_render_time >= 0, \"Total render time was not calculated\")\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_times_the_entire_render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"total_render_time\"]},\">=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"str\",\"children\":[\"Total render time was not calculated\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":113,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      @duration = Float(markup)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@duration\",{\"type\":\"send\",\"children\":[null,\"Float\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":118,"raw_source":"def render_to_output_buffer(_context, _output)\n      sleep(@duration)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"_output\"]}]},{\"type\":\"send\",\"children\":[null,\"sleep\",{\"type\":\"ivar\",\"children\":[\"@duration\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":123,"raw_source":"def test_profiling_multiple_renders\n    with_custom_tag('sleep', SleepTag) do\n      context = Liquid::Context.new\n      t = Liquid::Template.parse(\"{% sleep 0.001 %}\", profile: true)\n      context.template_name = 'index'\n      t.render!(context)\n      context.template_name = 'layout'\n      first_render_time = context.profiler.total_time\n      t.render!(context)\n\n      profiler = context.profiler\n      children = profiler.children\n      assert_operator(first_render_time, :>=, 0.001)\n      assert_operator(profiler.total_time, :>=, 0.001 + first_render_time)\n      assert_equal([\"index\", \"layout\"], children.map(&:template_name))\n      assert_equal([nil, nil], children.map(&:code))\n      assert_equal(profiler.total_time, children.map(&:total_time).reduce(&:+))\n    end\n  end","complexity_score":43.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_multiple_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"sleep\"]},{\"type\":\"const\",\"children\":[null,\"SleepTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% sleep 0.001 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"str\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"str\",\"children\":[\"layout\"]}]},{\"type\":\"lvasgn\",\"children\":[\"first_render_time\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"total_time\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"lvasgn\",\"children\":[\"profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]}]},{\"type\":\"lvasgn\",\"children\":[\"children\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"children\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"lvar\",\"children\":[\"first_render_time\"]},{\"type\":\"sym\",\"children\":[\">=\"]},{\"type\":\"float\",\"children\":[0.001]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"total_time\"]},{\"type\":\"sym\",\"children\":[\">=\"]},{\"type\":\"send\",\"children\":[{\"type\":\"float\",\"children\":[0.001]},\"+\",{\"type\":\"lvar\",\"children\":[\"first_render_time\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"index\"]},{\"type\":\"str\",\"children\":[\"layout\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"total_time\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"total_time\"]}]}]},\"reduce\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"+\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":143,"raw_source":"def test_profiling_uses_include_to_mark_children\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    include_node = t.profiler[1]\n    assert_equal(2, include_node.children.length)\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_uses_include_to_mark_children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"include_node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"include_node\"]},\"children\"]},\"length\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":151,"raw_source":"def test_profiling_marks_children_with_the_name_of_included_partial\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    include_node = t.profiler[1]\n    include_node.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n  end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_with_the_name_of_included_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"include_node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"include_node\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":161,"raw_source":"def test_profiling_supports_multiple_templates\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'b_template' %}\", profile: true)\n    t.render!\n\n    a_template = t.profiler[1]\n    a_template.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n\n    b_template = t.profiler[2]\n    b_template.children.each do |child|\n      assert_equal(\"b_template\", child.partial)\n    end\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_multiple_templates\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'b_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"a_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"b_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b_template\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":176,"raw_source":"def test_profiling_supports_rendering_the_same_partial_multiple_times\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    a_template1 = t.profiler[1]\n    a_template1.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n\n    a_template2 = t.profiler[2]\n    a_template2.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_rendering_the_same_partial_multiple_times\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"a_template1\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template1\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"a_template2\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template2\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":191,"raw_source":"def test_can_iterate_over_each_profiling_entry\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% increment test %}\", profile: true)\n    t.render!\n\n    timing_count = 0\n    t.profiler.each do |_timing|\n      timing_count += 1\n    end\n\n    assert_equal(2, timing_count)\n  end","complexity_score":11.03,"ast_json":"{\"type\":\"def\",\"children\":[\"test_can_iterate_over_each_profiling_entry\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% increment test %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"timing_count\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_timing\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"lvar\",\"children\":[\"timing_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":203,"raw_source":"def test_profiling_marks_children_of_if_blocks\n    t = Template.parse(\"{% if true %} {% increment test %} {{ test }} {% endif %}\", profile: true)\n    t.render!\n\n    assert_equal(1, t.profiler.length)\n    assert_equal(2, t.profiler[0].children.length)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_of_if_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %} {% increment test %} {{ test }} {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"length\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":211,"raw_source":"def test_profiling_marks_children_of_for_blocks\n    t = Template.parse(\"{% for item in collection %} {{ item }} {% endfor %}\", profile: true)\n    t.render!(\"collection\" => [\"one\", \"two\"])\n\n    assert_equal(1, t.profiler.length)\n    # Will profile each invocation of the for block\n    assert_equal(2, t.profiler[0].children.length)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_of_for_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in collection %} {{ item }} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"two\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"length\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":220,"raw_source":"def test_profiling_supports_self_time\n    t = Template.parse(\"{% for item in collection %} {{ item }} {% endfor %}\", profile: true)\n    collection = [\n      TestDrop.new(\"one\"),\n      TestDrop.new(\"two\"),\n    ]\n    output = t.render!(\"collection\" => collection)\n    assert_equal(\" one  two \", output)\n\n    leaf = t.profiler[0].children[0]\n    assert_operator(leaf.self_time, :>, 0.0)\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_self_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in collection %} {{ item }} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"two\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"collection\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" one  two \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"leaf\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"leaf\"]},\"self_time\"]},{\"type\":\"sym\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[0.0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":233,"raw_source":"def test_profiling_supports_total_time\n    t = Template.parse(\"{% if true %} {{ test }} {% endif %}\", profile: true)\n    output = t.render!(\"test\" => TestDrop.new(\"one\"))\n    assert_equal(\" one \", output)\n\n    assert_operator(t.profiler[0].total_time, :>, 0.0)\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_total_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %} {{ test }} {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" one \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"total_time\"]},{\"type\":\"sym\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[0.0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":6,"raw_source":"def add_one(input)\n    \"#{input} + 1\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_one\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\" + 1\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":14,"raw_source":"def setup\n    @assigns = {}\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@assigns\",{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":18,"raw_source":"def test_no_instance_eval\n    text     = %( {{ '1+1' | instance_eval }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":25,"raw_source":"def test_no_existing_instance_eval\n    text     = %( {{ '1+1' | __instance_eval__ }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_existing_instance_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | __instance_eval__ }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":32,"raw_source":"def test_no_instance_eval_after_mixing_in_new_filter\n    text     = %( {{ '1+1' | instance_eval }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval_after_mixing_in_new_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":39,"raw_source":"def test_no_instance_eval_later_in_chain\n    text     = %( {{ '1+1' | add_one | instance_eval }} )\n    expected = %( 1+1 + 1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: SecurityFilter))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval_later_in_chain\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | add_one | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 + 1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"const\",\"children\":[null,\"SecurityFilter\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":46,"raw_source":"def test_does_not_permanently_add_filters_to_symbol_table\n    current_symbols = Symbol.all_symbols\n\n    # MRI imprecisely marks objects found on the C stack, which can result\n    # in uninitialized memory being marked. This can even result in the test failing\n    # deterministically for a given compilation of ruby. Using a separate thread will\n    # keep these writes of the symbol pointer on a separate stack that will be garbage\n    # collected after Thread#join.\n    Thread.new do\n      test = %( {{ \"some_string\" | a_bad_filter }} )\n      Template.parse(test).render!\n      nil\n    end.join\n\n    GC.start\n\n    assert_equal([], (Symbol.all_symbols - current_symbols))\n  end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_permanently_add_filters_to_symbol_table\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"current_symbols\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"test\",{\"type\":\"str\",\"children\":[\" {{ \\\"some_string\\\" | a_bad_filter }} \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"render!\"]},{\"type\":\"nil\",\"children\":[]}]}]},\"join\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"GC\"]},\"start\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"current_symbols\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":65,"raw_source":"def test_does_not_add_drop_methods_to_symbol_table\n    current_symbols = Symbol.all_symbols\n\n    assigns = { 'drop' => Drop.new }\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_1 }}\", assigns).render!)\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_2 }}\", assigns).render!)\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_3 }}\", assigns).render!)\n\n    assert_equal([], (Symbol.all_symbols - current_symbols))\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_add_drop_methods_to_symbol_table\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"current_symbols\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Drop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_1 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_2 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_3 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"current_symbols\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":76,"raw_source":"def test_max_depth_nested_blocks_does_not_raise_exception\n    depth = Liquid::Block::MAX_DEPTH\n    code  = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n    assert_equal(\"rendered\", Template.parse(code).render!)\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_max_depth_nested_blocks_does_not_raise_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"rendered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":82,"raw_source":"def test_more_than_max_depth_nested_blocks_raises_exception\n    depth = Liquid::Block::MAX_DEPTH + 1\n    code  = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse(code).render!\n    end\n  end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_more_than_max_depth_nested_blocks_raises_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":9,"raw_source":"def initialize\n    @foo = 0\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@foo\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":13,"raw_source":"def to_s\n    \"woot: #{@foo}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"woot: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@foo\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":17,"raw_source":"def [](_whatever)\n    to_s\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_whatever\"]}]},{\"type\":\"send\",\"children\":[null,\"to_s\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":21,"raw_source":"def to_liquid\n    @foo += 1\n    self\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@foo\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":28,"raw_source":"def initialize(value:)\n    @value = value\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"value\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":34,"raw_source":"def registers\n    \"{#{@value.inspect}=>#{@context.registers[@value].inspect}}\"\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@value\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"=>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@value\"]}]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":40,"raw_source":"def initialize(value:)\n    @value = value\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"value\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":44,"raw_source":"def to_liquid\n    TestDrop.new(value: @value)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":52,"raw_source":"def each(&block)\n    [{ \"foo\" => 1, \"bar\" => 2 }, { \"foo\" => 2, \"bar\" => 1 }, { \"foo\" => 3, \"bar\" => 3 }].each(&block)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":58,"raw_source":"def initialize(amount)\n    @amount = amount\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@amount\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":62,"raw_source":"def to_number\n    @amount\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_number\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@amount\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":73,"raw_source":"def setup\n    @filters = Filters.new(Context.new)\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Filters\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":77,"raw_source":"def test_size\n    assert_equal(3, @filters.size([1, 2, 3]))\n    assert_equal(0, @filters.size([]))\n    assert_equal(0, @filters.size(nil))\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":83,"raw_source":"def test_downcase\n    assert_equal('testing', @filters.downcase(\"Testing\"))\n    assert_equal('', @filters.downcase(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_downcase\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"testing\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"downcase\",{\"type\":\"str\",\"children\":[\"Testing\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"downcase\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":88,"raw_source":"def test_upcase\n    assert_equal('TESTING', @filters.upcase(\"Testing\"))\n    assert_equal('', @filters.upcase(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_upcase\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"TESTING\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"upcase\",{\"type\":\"str\",\"children\":[\"Testing\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"upcase\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":93,"raw_source":"def test_slice\n    assert_equal('oob', @filters.slice('foobar', 1, 3))\n    assert_equal('oobar', @filters.slice('foobar', 1, 1000))\n    assert_equal('', @filters.slice('foobar', 1, 0))\n    assert_equal('o', @filters.slice('foobar', 1, 1))\n    assert_equal('bar', @filters.slice('foobar', 3, 3))\n    assert_equal('ar', @filters.slice('foobar', -2, 2))\n    assert_equal('ar', @filters.slice('foobar', -2, 1000))\n    assert_equal('r', @filters.slice('foobar', -1))\n    assert_equal('', @filters.slice(nil, 0))\n    assert_equal('', @filters.slice('foobar', 100, 10))\n    assert_equal('', @filters.slice('foobar', -100, 10))\n    assert_equal('oob', @filters.slice('foobar', '1', '3'))\n    assert_raises(Liquid::ArgumentError) do\n      @filters.slice('foobar', nil)\n    end\n    assert_raises(Liquid::ArgumentError) do\n      @filters.slice('foobar', 0, \"\")\n    end\n    assert_equal(\"\", @filters.slice(\"foobar\", 0, -(1 << 64)))\n    assert_equal(\"foobar\", @filters.slice(\"foobar\", 0, 1 << 63))\n    assert_equal(\"\", @filters.slice(\"foobar\", 1 << 63, 6))\n    assert_equal(\"\", @filters.slice(\"foobar\", -(1 << 63), 6))\n  end","complexity_score":60.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"r\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"3\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[64]}]}]},\"-@\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]},{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":118,"raw_source":"def test_slice_on_arrays\n    input = 'foobar'.split(//)\n    assert_equal(%w(o o b), @filters.slice(input, 1, 3))\n    assert_equal(%w(o o b a r), @filters.slice(input, 1, 1000))\n    assert_equal(%w(), @filters.slice(input, 1, 0))\n    assert_equal(%w(o), @filters.slice(input, 1, 1))\n    assert_equal(%w(b a r), @filters.slice(input, 3, 3))\n    assert_equal(%w(a r), @filters.slice(input, -2, 2))\n    assert_equal(%w(a r), @filters.slice(input, -2, 1000))\n    assert_equal(%w(r), @filters.slice(input, -1))\n    assert_equal(%w(), @filters.slice(input, 100, 10))\n    assert_equal(%w(), @filters.slice(input, -100, 10))\n    assert_equal([], @filters.slice(input, 0, -(1 << 64)))\n    assert_equal(input, @filters.slice(input, 0, 1 << 63))\n    assert_equal([], @filters.slice(input, 1 << 63, 6))\n    assert_equal([], @filters.slice(input, -(1 << 63), 6))\n  end","complexity_score":51.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice_on_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[64]}]}]},\"-@\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]},{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":136,"raw_source":"def test_find_on_empty_array\n    assert_nil(@filters.find([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"find\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":140,"raw_source":"def test_find_index_on_empty_array\n    assert_nil(@filters.find_index([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"find_index\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":144,"raw_source":"def test_has_on_empty_array\n    refute(@filters.has([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"refute\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"has\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":148,"raw_source":"def test_truncate\n    assert_equal('1234...', @filters.truncate('1234567890', 7))\n    assert_equal('1234567890', @filters.truncate('1234567890', 20))\n    assert_equal('...', @filters.truncate('1234567890', 0))\n    assert_equal('1234567890', @filters.truncate('1234567890'))\n    assert_equal(\"...\", @filters.truncate(\"\", 5))\n    assert_equal('12341', @filters.truncate(\"1234567890\", 5, 1))\n    assert_equal(\"foobar\", @filters.truncate(\"foobar\", 1 << 63))\n    assert_equal(\"...\", @filters.truncate(\"foobar\", -(1 << 63)))\n  end","complexity_score":25.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"12341\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":159,"raw_source":"def test_split\n    assert_equal(['12', '34'], @filters.split('12~34', '~'))\n    assert_equal(['A? ', ' ,Z'], @filters.split('A? ~ ~ ~ ,Z', '~ ~ ~'))\n    assert_equal(['A?Z'], @filters.split('A?Z', '~'))\n    assert_equal([], @filters.split(nil, ' '))\n    assert_equal(['A', 'Z'], @filters.split('A1Z', 1))\n  end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_split\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"12~34\"]},{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A? \"]},{\"type\":\"str\",\"children\":[\" ,Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A? ~ ~ ~ ,Z\"]},{\"type\":\"str\",\"children\":[\"~ ~ ~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A?Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A?Z\"]},{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A1Z\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":167,"raw_source":"def test_escape\n    assert_equal('&lt;strong&gt;', @filters.escape('<strong>'))\n    assert_equal('1', @filters.escape(1))\n    assert_equal('2001-02-03', @filters.escape(Date.new(2001, 2, 3)))\n    assert_nil(@filters.escape(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_escape\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"str\",\"children\":[\"<strong>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":174,"raw_source":"def test_h\n    assert_equal('&lt;strong&gt;', @filters.h('<strong>'))\n    assert_equal('1', @filters.h(1))\n    assert_equal('2001-02-03', @filters.h(Date.new(2001, 2, 3)))\n    assert_nil(@filters.h(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_h\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"str\",\"children\":[\"<strong>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":181,"raw_source":"def test_escape_once\n    assert_equal('&lt;strong&gt;Hulk&lt;/strong&gt;', @filters.escape_once('&lt;strong&gt;Hulk</strong>'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_escape_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;Hulk&lt;/strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape_once\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;Hulk</strong>\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":185,"raw_source":"def test_base64_encode\n    assert_equal('b25lIHR3byB0aHJlZQ==', @filters.base64_encode('one two three'))\n    assert_equal('', @filters.base64_encode(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b25lIHR3byB0aHJlZQ==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_encode\",{\"type\":\"str\",\"children\":[\"one two three\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":190,"raw_source":"def test_base64_decode\n    decoded = @filters.base64_decode('b25lIHR3byB0aHJlZQ==')\n    assert_equal('one two three', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_decode('4pyF')\n    assert_equal('', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_decode(\"/w==\")\n    assert_equal(Encoding::ASCII_8BIT, decoded.encoding)\n    assert_equal((+\"\\xFF\").force_encoding(Encoding::ASCII_8BIT), decoded)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.base64_decode(\"invalidbase64\")\n    end\n\n    assert_equal('Liquid error: invalid base64 provided to base64_decode', exception.message)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_decode\",{\"type\":\"str\",\"children\":[\"invalidbase64\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid base64 provided to base64_decode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":210,"raw_source":"def test_base64_url_safe_encode\n    assert_equal(\n      'YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8',\n      @filters.base64_url_safe_encode('abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\|'),\n    )\n    assert_equal('', @filters.base64_url_safe_encode(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_url_safe_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_encode\",{\"type\":\"str\",\"children\":[\"abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\\\|\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":218,"raw_source":"def test_base64_url_safe_decode\n    decoded = @filters.base64_url_safe_decode('YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8')\n    assert_equal(\n      'abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\|',\n      decoded,\n    )\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_url_safe_decode('4pyF')\n    assert_equal('', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_url_safe_decode(\"_w==\")\n    assert_equal(Encoding::ASCII_8BIT, decoded.encoding)\n    assert_equal((+\"\\xFF\").force_encoding(Encoding::ASCII_8BIT), decoded)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.base64_url_safe_decode(\"invalidbase64\")\n    end\n    assert_equal('Liquid error: invalid base64 provided to base64_url_safe_decode', exception.message)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_url_safe_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_decode\",{\"type\":\"str\",\"children\":[\"invalidbase64\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid base64 provided to base64_url_safe_decode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":240,"raw_source":"def test_url_encode\n    assert_equal('foo%2B1%40example.com', @filters.url_encode('foo+1@example.com'))\n    assert_equal('1', @filters.url_encode(1))\n    assert_equal('2001-02-03', @filters.url_encode(Date.new(2001, 2, 3)))\n    assert_nil(@filters.url_encode(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_url_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo%2B1%40example.com\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"str\",\"children\":[\"foo+1@example.com\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":247,"raw_source":"def test_url_decode\n    assert_equal('foo bar', @filters.url_decode('foo+bar'))\n    assert_equal('foo bar', @filters.url_decode('foo%20bar'))\n    assert_equal('foo+1@example.com', @filters.url_decode('foo%2B1%40example.com'))\n    assert_equal('1', @filters.url_decode(1))\n    assert_equal('2001-02-03', @filters.url_decode(Date.new(2001, 2, 3)))\n    assert_nil(@filters.url_decode(nil))\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.url_decode('%ff')\n    end\n    assert_equal('Liquid error: invalid byte sequence in UTF-8', exception.message)\n  end","complexity_score":22.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_url_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo+bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo%20bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo+1@example.com\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo%2B1%40example.com\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"%ff\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid byte sequence in UTF-8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":260,"raw_source":"def test_truncatewords\n    assert_equal('one two three', @filters.truncatewords('one two three', 4))\n    assert_equal('one two...', @filters.truncatewords('one two three', 2))\n    assert_equal('one two three', @filters.truncatewords('one two three'))\n    assert_equal(\n      'Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221;...',\n      @filters.truncatewords('Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221; x 16&#8221; x 10.5&#8221; high) with cover.', 15),\n    )\n    assert_equal(\"\", @filters.truncatewords('', 5))\n    assert_equal('one two1', @filters.truncatewords(\"one two three\", 2, 1))\n    assert_equal('one two three...', @filters.truncatewords(\"one  two\\tthree\\nfour\", 3))\n    assert_equal('one two...', @filters.truncatewords(\"one two three four\", 2))\n    assert_equal('one...', @filters.truncatewords(\"one two three four\", 0))\n    assert_equal('one two three four', @filters.truncatewords(\"one two three four\", 1 << 31))\n    assert_equal('one...', @filters.truncatewords(\"one two three four\", -(1 << 32)))\n  end","complexity_score":33.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncatewords\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221;...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221; x 16&#8221; x 10.5&#8221; high) with cover.\"]},{\"type\":\"int\",\"children\":[15]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one  two\\tthree\\nfour\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[31]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[32]}]}]},\"-@\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":277,"raw_source":"def test_strip_html\n    assert_equal('test', @filters.strip_html(\"<div>test</div>\"))\n    assert_equal('test', @filters.strip_html(\"<div id='test'>test</div>\"))\n    assert_equal('', @filters.strip_html(\"<script type='text/javascript'>document.write('some stuff');</script>\"))\n    assert_equal('', @filters.strip_html(\"<style type='text/css'>foo bar</style>\"))\n    assert_equal('test', @filters.strip_html(\"<div\\nclass='multiline'>test</div>\"))\n    assert_equal('test', @filters.strip_html(\"<!-- foo bar \\n test -->test\"))\n    assert_equal('', @filters.strip_html(nil))\n\n    # Quirk of the existing implementation\n    assert_equal('foo;', @filters.strip_html(\"<<<script </script>script>foo;</script>\"))\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_html\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div id='test'>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<script type='text/javascript'>document.write('some stuff');</script>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<style type='text/css'>foo bar</style>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div\\nclass='multiline'>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<!-- foo bar \\n test -->test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<<<script </script>script>foo;</script>\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":290,"raw_source":"def test_join\n    assert_equal('1 2 3 4', @filters.join([1, 2, 3, 4]))\n    assert_equal('1 - 2 - 3 - 4', @filters.join([1, 2, 3, 4], ' - '))\n    assert_equal('1121314', @filters.join([1, 2, 3, 4], 1))\n  end","complexity_score":11.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 - 2 - 3 - 4\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"str\",\"children\":[\" - \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1121314\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":296,"raw_source":"def test_join_calls_to_liquid_on_each_element\n    drop = Class.new(Liquid::Drop) do\n      def to_liquid\n        'i did it'\n      end\n    end\n\n    assert_equal('i did it, i did it', @filters.join([drop.new, drop.new], \", \"))\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join_calls_to_liquid_on_each_element\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"i did it\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"i did it, i did it\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"new\"]}]},{\"type\":\"str\",\"children\":[\", \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":298,"raw_source":"def to_liquid\n        'i did it'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"i did it\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":306,"raw_source":"def test_sort\n    assert_equal([1, 2, 3, 4], @filters.sort([4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }], @filters.sort([{ \"a\" => 4 }, { \"a\" => 3 }, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":311,"raw_source":"def test_sort_with_nils\n    assert_equal([1, 2, 3, 4, nil], @filters.sort([nil, 4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }, {}], @filters.sort([{ \"a\" => 4 }, { \"a\" => 3 }, {}, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_with_nils\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":316,"raw_source":"def test_sort_when_property_is_sometimes_missing_puts_nils_last\n    input       = [\n      { \"price\" => 4, \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"price\" => 1, \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n    ]\n    expectation = [\n      { \"price\" => 1, \"handle\" => \"gamma\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n      { \"price\" => 4, \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"delta\" },\n    ]\n    assert_equal(expectation, @filters.sort(input, \"price\"))\n  end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_when_property_is_sometimes_missing_puts_nils_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"price\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":334,"raw_source":"def test_sort_natural\n    assert_equal([\"a\", \"B\", \"c\", \"D\"], @filters.sort_natural([\"c\", \"D\", \"a\", \"B\"]))\n    assert_equal([{ \"a\" => \"a\" }, { \"a\" => \"B\" }, { \"a\" => \"c\" }, { \"a\" => \"D\" }], @filters.sort_natural([{ \"a\" => \"D\" }, { \"a\" => \"c\" }, { \"a\" => \"a\" }, { \"a\" => \"B\" }], \"a\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":339,"raw_source":"def test_sort_natural_with_nils\n    assert_equal([\"a\", \"B\", \"c\", \"D\", nil], @filters.sort_natural([nil, \"c\", \"D\", \"a\", \"B\"]))\n    assert_equal([{ \"a\" => \"a\" }, { \"a\" => \"B\" }, { \"a\" => \"c\" }, { \"a\" => \"D\" }, {}], @filters.sort_natural([{ \"a\" => \"D\" }, { \"a\" => \"c\" }, {}, { \"a\" => \"a\" }, { \"a\" => \"B\" }], \"a\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_with_nils\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":344,"raw_source":"def test_sort_natural_when_property_is_sometimes_missing_puts_nils_last\n    input       = [\n      { \"price\" => \"4\", \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"price\" => \"1\", \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n    ]\n    expectation = [\n      { \"price\" => \"1\", \"handle\" => \"gamma\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n      { \"price\" => \"4\", \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"delta\" },\n    ]\n    assert_equal(expectation, @filters.sort_natural(input, \"price\"))\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_when_property_is_sometimes_missing_puts_nils_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"4\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"4\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"price\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":362,"raw_source":"def test_sort_natural_case_check\n    input = [\n      { \"key\" => \"X\" },\n      { \"key\" => \"Y\" },\n      { \"key\" => \"Z\" },\n      { \"fake\" => \"t\" },\n      { \"key\" => \"a\" },\n      { \"key\" => \"b\" },\n      { \"key\" => \"c\" },\n    ]\n    expectation = [\n      { \"key\" => \"a\" },\n      { \"key\" => \"b\" },\n      { \"key\" => \"c\" },\n      { \"key\" => \"X\" },\n      { \"key\" => \"Y\" },\n      { \"key\" => \"Z\" },\n      { \"fake\" => \"t\" },\n    ]\n    assert_equal(expectation, @filters.sort_natural(input, \"key\"))\n    assert_equal([\"a\", \"b\", \"c\", \"X\", \"Y\", \"Z\"], @filters.sort_natural([\"X\", \"Y\", \"Z\", \"a\", \"b\", \"c\"]))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_case_check\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"X\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Y\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"str\",\"children\":[\"t\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"X\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Y\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"str\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"X\"]},{\"type\":\"str\",\"children\":[\"Y\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"X\"]},{\"type\":\"str\",\"children\":[\"Y\"]},{\"type\":\"str\",\"children\":[\"Z\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":385,"raw_source":"def test_sort_empty_array\n    assert_equal([], @filters.sort([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":389,"raw_source":"def test_sort_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.sort(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":401,"raw_source":"def test_sort_natural_empty_array\n    assert_equal([], @filters.sort_natural([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":405,"raw_source":"def test_sort_natural_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.sort_natural(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":417,"raw_source":"def test_legacy_sort_hash\n    assert_equal([{ a: 1, b: 2 }], @filters.sort(a: 1, b: 2))\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_sort_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":421,"raw_source":"def test_numerical_vs_lexicographical_sort\n    assert_equal([2, 10], @filters.sort([10, 2]))\n    assert_equal([{ \"a\" => 2 }, { \"a\" => 10 }], @filters.sort([{ \"a\" => 10 }, { \"a\" => 2 }], \"a\"))\n    assert_equal([\"10\", \"2\"], @filters.sort([\"10\", \"2\"]))\n    assert_equal([{ \"a\" => \"10\" }, { \"a\" => \"2\" }], @filters.sort([{ \"a\" => \"10\" }, { \"a\" => \"2\" }], \"a\"))\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_numerical_vs_lexicographical_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[10]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"10\"]},{\"type\":\"str\",\"children\":[\"2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"10\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"10\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"10\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":428,"raw_source":"def test_uniq\n    assert_equal([\"foo\"], @filters.uniq(\"foo\"))\n    assert_equal([1, 3, 2, 4], @filters.uniq([1, 1, 3, 2, 3, 1, 4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 3 }, { \"a\" => 2 }], @filters.uniq([{ \"a\" => 1 }, { \"a\" => 3 }, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n    test_drop = TestDrop.new(value: \"test\")\n    test_drop_alternate = TestDrop.new(value: \"test\")\n    assert_equal([test_drop], @filters.uniq([test_drop, test_drop_alternate], 'value'))\n  end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"test_drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"test_drop_alternate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]},{\"type\":\"lvar\",\"children\":[\"test_drop_alternate\"]}]},{\"type\":\"str\",\"children\":[\"value\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":437,"raw_source":"def test_uniq_empty_array\n    assert_equal([], @filters.uniq([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":441,"raw_source":"def test_uniq_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.uniq(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":453,"raw_source":"def test_compact_empty_array\n    assert_equal([], @filters.compact([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"compact\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":457,"raw_source":"def test_compact_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.compact(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"compact\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":469,"raw_source":"def test_reverse\n    assert_equal([4, 3, 2, 1], @filters.reverse([1, 2, 3, 4]))\n  end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reverse\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"reverse\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":473,"raw_source":"def test_legacy_reverse_hash\n    assert_equal([{ a: 1, b: 2 }], @filters.reverse(a: 1, b: 2))\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_reverse_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"reverse\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":477,"raw_source":"def test_map\n    assert_equal([1, 2, 3, 4], @filters.map([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }], 'a'))\n    assert_template_result(\n      'abc',\n      \"{{ ary | map:'foo' | map:'bar' }}\",\n      { 'ary' => [{ 'foo' => { 'bar' => 'a' } }, { 'foo' => { 'bar' => 'b' } }, { 'foo' => { 'bar' => 'c' } }] },\n    )\n  end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ ary | map:'foo' | map:'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ary\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":486,"raw_source":"def test_map_doesnt_call_arbitrary_stuff\n    assert_template_result(\"\", '{{ \"foo\" | map: \"__id__\" }}')\n    assert_template_result(\"\", '{{ \"foo\" | map: \"inspect\" }}')\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_doesnt_call_arbitrary_stuff\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"foo\\\" | map: \\\"__id__\\\" }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"foo\\\" | map: \\\"inspect\\\" }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":491,"raw_source":"def test_map_calls_to_liquid\n    t = TestThing.new\n    assert_template_result(\"woot: 1\", '{{ foo | map: \"whatever\" }}', { \"foo\" => [t] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"woot: 1\"]},{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"whatever\\\" }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":496,"raw_source":"def test_map_calls_context=\n    model = TestModel.new(value: :test)\n\n    template = Template.parse('{{ foo | map: \"registers\" }}')\n    template.registers[:test] = 1234\n    template.assigns['foo'] = [model]\n\n    assert_template_result(\"{:test=>1234}\", template.render!)\n  end","complexity_score":10.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_calls_context=\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"model\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestModel\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"sym\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"registers\\\" }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"int\",\"children\":[1234]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"model\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{:test=>1234}\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":506,"raw_source":"def test_map_on_hashes\n    assert_template_result(\n      \"4217\",\n      '{{ thing | map: \"foo\" | map: \"bar\" }}',\n      { \"thing\" => { \"foo\" => [{ \"bar\" => 42 }, { \"bar\" => 17 }] } },\n    )\n  end","complexity_score":1.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_on_hashes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4217\"]},{\"type\":\"str\",\"children\":[\"{{ thing | map: \\\"foo\\\" | map: \\\"bar\\\" }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"thing\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[42]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[17]}]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":514,"raw_source":"def test_legacy_map_on_hashes_with_dynamic_key\n    template = \"{% assign key = 'foo' %}{{ thing | map: key | map: 'bar' }}\"\n    hash     = { \"foo\" => { \"bar\" => 42 } }\n    assert_template_result(\"42\", template, { \"thing\" => hash })\n  end","complexity_score":3.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_map_on_hashes_with_dynamic_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% assign key = 'foo' %}{{ thing | map: key | map: 'bar' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[42]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"42\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"thing\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":520,"raw_source":"def test_sort_calls_to_liquid\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sort: \"whatever\" }}').render(\"foo\" => [t])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sort: \\\"whatever\\\" }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":526,"raw_source":"def test_map_over_proc\n    drop  = TestDrop.new(value: \"testfoo\")\n    p     = proc { drop }\n    output = Liquid::Template.parse('{{ procs | map: \"value\" }}').render!({ \"procs\" => [p] })\n    assert_equal(\"testfoo\", output)\n  end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_over_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"testfoo\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"drop\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ procs | map: \\\"value\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"procs\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"testfoo\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":533,"raw_source":"def test_map_over_drops_returning_procs\n    drops = [\n      {\n        \"proc\" => -> { \"foo\" },\n      },\n      {\n        \"proc\" => -> { \"bar\" },\n      },\n    ]\n    output = Liquid::Template.parse('{{ drops | map: \"proc\" }}').render!({ \"drops\" => drops })\n    assert_equal(\"foobar\", output)\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_over_drops_returning_procs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drops\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"proc\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"proc\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drops | map: \\\"proc\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drops\"]},{\"type\":\"lvar\",\"children\":[\"drops\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":546,"raw_source":"def test_map_works_on_enumerables\n    output = Liquid::Template.parse('{{ foo | map: \"foo\" }}').render!({ \"foo\" => TestEnumerable.new })\n    assert_equal(\"123\", output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_works_on_enumerables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"foo\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":551,"raw_source":"def test_map_returns_empty_on_2d_input_array\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.map(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_returns_empty_on_2d_input_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":563,"raw_source":"def test_map_with_value_property\n    array = [\n      { \"handle\" => \"alpha\", \"value\" => \"A\" },\n      { \"handle\" => \"beta\", \"value\" => \"B\" },\n      { \"handle\" => \"gamma\", \"value\" => \"C\" }\n    ]\n\n    assert_template_result(\"A B C\", \"{{ array | map: 'value' | join: ' ' }}\", { \"array\" => array })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_with_value_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A B C\"]},{\"type\":\"str\",\"children\":[\"{{ array | map: 'value' | join: ' ' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":573,"raw_source":"def test_map_returns_input_with_no_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.map(foo, nil)\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_returns_input_with_no_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":585,"raw_source":"def test_sort_works_on_enumerables\n    assert_template_result(\"213\", '{{ foo | sort: \"bar\" | map: \"foo\" }}', { \"foo\" => TestEnumerable.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_works_on_enumerables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"213\"]},{\"type\":\"str\",\"children\":[\"{{ foo | sort: \\\"bar\\\" | map: \\\"foo\\\" }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":589,"raw_source":"def test_first_and_last_call_to_liquid\n    assert_template_result('foobar', '{{ foo | first }}', { 'foo' => [ThingWithToLiquid.new] })\n    assert_template_result('foobar', '{{ foo | last }}', { 'foo' => [ThingWithToLiquid.new] })\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_and_last_call_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo | first }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo | last }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":594,"raw_source":"def test_truncate_calls_to_liquid\n    assert_template_result(\"wo...\", '{{ foo | truncate: 5 }}', { \"foo\" => TestThing.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncate_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"wo...\"]},{\"type\":\"str\",\"children\":[\"{{ foo | truncate: 5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":598,"raw_source":"def test_date\n    assert_equal('May', @filters.date(Time.parse(\"2006-05-05 10:00:00\"), \"%B\"))\n    assert_equal('June', @filters.date(Time.parse(\"2006-06-05 10:00:00\"), \"%B\"))\n    assert_equal('July', @filters.date(Time.parse(\"2006-07-05 10:00:00\"), \"%B\"))\n\n    assert_equal('May', @filters.date(\"2006-05-05 10:00:00\", \"%B\"))\n    assert_equal('June', @filters.date(\"2006-06-05 10:00:00\", \"%B\"))\n    assert_equal('July', @filters.date(\"2006-07-05 10:00:00\", \"%B\"))\n\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", nil))\n\n    assert_equal('07/05/2006', @filters.date(\"2006-07-05 10:00:00\", \"%m/%d/%Y\"))\n\n    assert_equal(\"07/16/2004\", @filters.date(\"Fri Jul 16 01:00:00 2004\", \"%m/%d/%Y\"))\n    assert_equal(Date.today.year.to_s, @filters.date('now', '%Y'))\n    assert_equal(Date.today.year.to_s, @filters.date('today', '%Y'))\n    assert_equal(Date.today.year.to_s, @filters.date('Today', '%Y'))\n\n    assert_nil(@filters.date(nil, \"%B\"))\n\n    assert_equal('', @filters.date('', \"%B\"))\n\n    with_timezone(\"UTC\") do\n      assert_equal(\"07/05/2006\", @filters.date(1152098955, \"%m/%d/%Y\"))\n      assert_equal(\"07/05/2006\", @filters.date(\"1152098955\", \"%m/%d/%Y\"))\n    end\n  end","complexity_score":61.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_date\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"May\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-05-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"June\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"July\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"May\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-05-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"June\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-06-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"July\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/16/2004\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"Fri Jul 16 01:00:00 2004\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"now\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"today\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"Today\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_timezone\",{\"type\":\"str\",\"children\":[\"UTC\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"int\",\"children\":[1152098955]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"1152098955\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":629,"raw_source":"def test_first_last\n    assert_equal(1, @filters.first([1, 2, 3]))\n    assert_equal(3, @filters.last([1, 2, 3]))\n    assert_nil(@filters.first([]))\n    assert_nil(@filters.last([]))\n  end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"first\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"last\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"first\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"last\",{\"type\":\"array\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":636,"raw_source":"def test_replace\n    assert_equal('b b b b', @filters.replace('a a a a', 'a', 'b'))\n    assert_equal('2 2 2 2', @filters.replace('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace('1 1 1 1', 2, 3))\n    assert_template_result('2 2 2 2', \"{{ '1 1 1 1' | replace: '1', 2 }}\")\n\n    assert_equal('b a a a', @filters.replace_first('a a a a', 'a', 'b'))\n    assert_equal('2 1 1 1', @filters.replace_first('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace_first('1 1 1 1', 2, 3))\n    assert_template_result('2 1 1 1', \"{{ '1 1 1 1' | replace_first: '1', 2 }}\")\n\n    assert_equal('a a a b', @filters.replace_last('a a a a', 'a', 'b'))\n    assert_equal('1 1 1 2', @filters.replace_last('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace_last('1 1 1 1', 2, 3))\n    assert_template_result('1 1 1 2', \"{{ '1 1 1 1' | replace_last: '1', 2 }}\")\n  end","complexity_score":27.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_replace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b b b b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2 2 2 2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2 2 2 2\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace: '1', 2 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b a a a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2 1 1 1\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace_first: '1', 2 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a a a b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 1 1 2\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace_last: '1', 2 }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":653,"raw_source":"def test_remove\n    assert_equal('   ', @filters.remove(\"a a a a\", 'a'))\n    assert_template_result('   ', \"{{ '1 1 1 1' | remove: 1 }}\")\n\n    assert_equal('b a a', @filters.remove_first(\"a b a a\", 'a '))\n    assert_template_result(' 1 1 1', \"{{ '1 1 1 1' | remove_first: 1 }}\")\n\n    assert_equal('a a b', @filters.remove_last(\"a a b a\", ' a'))\n    assert_template_result('1 1 1 ', \"{{ '1 1 1 1' | remove_last: 1 }}\")\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_remove\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"   \"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"   \"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove: 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b a a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove_first\",{\"type\":\"str\",\"children\":[\"a b a a\"]},{\"type\":\"str\",\"children\":[\"a \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1 1 1\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove_first: 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a a b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove_last\",{\"type\":\"str\",\"children\":[\"a a b a\"]},{\"type\":\"str\",\"children\":[\" a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 1 1 \"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove_last: 1 }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":664,"raw_source":"def test_pipes_in_string_arguments\n    assert_template_result('foobar', \"{{ 'foo|bar' | remove: '|' }}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pipes_in_string_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ 'foo|bar' | remove: '|' }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":668,"raw_source":"def test_strip\n    assert_template_result('ab c', \"{{ source | strip }}\", { 'source' => \" ab c  \" })\n    assert_template_result('ab c', \"{{ source | strip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":673,"raw_source":"def test_lstrip\n    assert_template_result('ab c  ', \"{{ source | lstrip }}\", { 'source' => \" ab c  \" })\n    assert_template_result(\"ab c  \\n \\t\", \"{{ source | lstrip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lstrip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c  \"]},{\"type\":\"str\",\"children\":[\"{{ source | lstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c  \\n \\t\"]},{\"type\":\"str\",\"children\":[\"{{ source | lstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":678,"raw_source":"def test_rstrip\n    assert_template_result(\" ab c\", \"{{ source | rstrip }}\", { 'source' => \" ab c  \" })\n    assert_template_result(\" \\tab c\", \"{{ source | rstrip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rstrip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | rstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" \\tab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | rstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":683,"raw_source":"def test_strip_newlines\n    assert_template_result('abc', \"{{ source | strip_newlines }}\", { 'source' => \"a\\nb\\nc\" })\n    assert_template_result('abc', \"{{ source | strip_newlines }}\", { 'source' => \"a\\r\\nb\\nc\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_newlines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip_newlines }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\nb\\nc\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip_newlines }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\r\\nb\\nc\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":688,"raw_source":"def test_newlines_to_br\n    assert_template_result(\"a<br />\\nb<br />\\nc\", \"{{ source | newline_to_br }}\", { 'source' => \"a\\nb\\nc\" })\n    assert_template_result(\"a<br />\\nb<br />\\nc\", \"{{ source | newline_to_br }}\", { 'source' => \"a\\r\\nb\\nc\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_newlines_to_br\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a<br />\\nb<br />\\nc\"]},{\"type\":\"str\",\"children\":[\"{{ source | newline_to_br }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\nb\\nc\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a<br />\\nb<br />\\nc\"]},{\"type\":\"str\",\"children\":[\"{{ source | newline_to_br }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\r\\nb\\nc\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":693,"raw_source":"def test_plus\n    assert_template_result(\"2\", \"{{ 1 | plus:1 }}\")\n    assert_template_result(\"2.0\", \"{{ '1' | plus:'1.0' }}\")\n\n    assert_template_result(\"5\", \"{{ price | plus:'2' }}\", { 'price' => NumberLikeThing.new(3) })\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_plus\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | plus:1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.0\"]},{\"type\":\"str\",\"children\":[\"{{ '1' | plus:'1.0' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | plus:'2' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":700,"raw_source":"def test_minus\n    assert_template_result(\"4\", \"{{ input | minus:operand }}\", { 'input' => 5, 'operand' => 1 })\n    assert_template_result(\"2.3\", \"{{ '4.3' | minus:'2' }}\")\n\n    assert_template_result(\"5\", \"{{ price | minus:'2' }}\", { 'price' => NumberLikeThing.new(7) })\n  end","complexity_score":5.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_minus\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ input | minus:operand }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"operand\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.3\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | minus:'2' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | minus:'2' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":707,"raw_source":"def test_abs\n    assert_template_result(\"17\", \"{{ 17 | abs }}\")\n    assert_template_result(\"17\", \"{{ -17 | abs }}\")\n    assert_template_result(\"17\", \"{{ '17' | abs }}\")\n    assert_template_result(\"17\", \"{{ '-17' | abs }}\")\n    assert_template_result(\"0\", \"{{ 0 | abs }}\")\n    assert_template_result(\"0\", \"{{ '0' | abs }}\")\n    assert_template_result(\"17.42\", \"{{ 17.42 | abs }}\")\n    assert_template_result(\"17.42\", \"{{ -17.42 | abs }}\")\n    assert_template_result(\"17.42\", \"{{ '17.42' | abs }}\")\n    assert_template_result(\"17.42\", \"{{ '-17.42' | abs }}\")\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_abs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ 17 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ -17 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ '17' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ '-17' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ 0 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ '0' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ 17.42 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ -17.42 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ '17.42' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ '-17.42' | abs }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":720,"raw_source":"def test_times\n    assert_template_result(\"12\", \"{{ 3 | times:4 }}\")\n    assert_template_result(\"0\", \"{{ 'foo' | times:4 }}\")\n    assert_template_result(\"6\", \"{{ '2.1' | times:3 | replace: '.','-' | plus:0}}\")\n    assert_template_result(\"7.25\", \"{{ 0.0725 | times:100 }}\")\n    assert_template_result(\"-7.25\", '{{ \"-0.0725\" | times:100 }}')\n    assert_template_result(\"7.25\", '{{ \"-0.0725\" | times: -100 }}')\n    assert_template_result(\"4\", \"{{ price | times:2 }}\", { 'price' => NumberLikeThing.new(2) })\n  end","complexity_score":8.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_times\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"{{ 3 | times:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ 'foo' | times:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ '2.1' | times:3 | replace: '.','-' | plus:0}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"7.25\"]},{\"type\":\"str\",\"children\":[\"{{ 0.0725 | times:100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-7.25\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"-0.0725\\\" | times:100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"7.25\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"-0.0725\\\" | times: -100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ price | times:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":730,"raw_source":"def test_divided_by\n    assert_template_result(\"4\", \"{{ 12 | divided_by:3 }}\")\n    assert_template_result(\"4\", \"{{ 14 | divided_by:3 }}\")\n\n    assert_template_result(\"5\", \"{{ 15 | divided_by:3 }}\")\n    assert_equal(\"Liquid error: divided by 0\", Template.parse(\"{{ 5 | divided_by:0 }}\").render)\n\n    assert_template_result(\"0.5\", \"{{ 2.0 | divided_by:4 }}\")\n    assert_raises(Liquid::ZeroDivisionError) do\n      assert_template_result(\"4\", \"{{ 1 | modulo: 0 }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | divided_by:2 }}\", { 'price' => NumberLikeThing.new(10) })\n  end","complexity_score":13.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_divided_by\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 12 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 14 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 15 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: divided by 0\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 5 | divided_by:0 }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.5\"]},{\"type\":\"str\",\"children\":[\"{{ 2.0 | divided_by:4 }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | modulo: 0 }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | divided_by:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[10]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":745,"raw_source":"def test_modulo\n    assert_template_result(\"1\", \"{{ 3 | modulo:2 }}\")\n    assert_raises(Liquid::ZeroDivisionError) do\n      assert_template_result(\"4\", \"{{ 1 | modulo: 0 }}\")\n    end\n\n    assert_template_result(\"1\", \"{{ price | modulo:2 }}\", { 'price' => NumberLikeThing.new(3) })\n  end","complexity_score":6.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_modulo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ 3 | modulo:2 }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | modulo: 0 }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ price | modulo:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":754,"raw_source":"def test_round\n    assert_template_result(\"5\", \"{{ input | round }}\", { 'input' => 4.6 })\n    assert_template_result(\"4\", \"{{ '4.3' | round }}\")\n    assert_template_result(\"4.56\", \"{{ input | round: 2 }}\", { 'input' => 4.5612 })\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | round }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | round }}\", { 'price' => NumberLikeThing.new(4.6) })\n    assert_template_result(\"4\", \"{{ price | round }}\", { 'price' => NumberLikeThing.new(4.3) })\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_round\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ input | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | round }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4.56\"]},{\"type\":\"str\",\"children\":[\"{{ input | round: 2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.5612]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | round }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ price | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":766,"raw_source":"def test_ceil\n    assert_template_result(\"5\", \"{{ input | ceil }}\", { 'input' => 4.6 })\n    assert_template_result(\"5\", \"{{ '4.3' | ceil }}\")\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | ceil }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | ceil }}\", { 'price' => NumberLikeThing.new(4.6) })\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ceil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ input | ceil }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | ceil }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | ceil }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | ceil }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.6]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":776,"raw_source":"def test_floor\n    assert_template_result(\"4\", \"{{ input | floor }}\", { 'input' => 4.6 })\n    assert_template_result(\"4\", \"{{ '4.3' | floor }}\")\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | floor }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | floor }}\", { 'price' => NumberLikeThing.new(5.4) })\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_floor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ input | floor }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | floor }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | floor }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | floor }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[5.4]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":786,"raw_source":"def test_at_most\n    assert_template_result(\"4\", \"{{ 5 | at_most:4 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_most:5 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_most:6 }}\")\n\n    assert_template_result(\"4.5\", \"{{ 4.5 | at_most:5 }}\")\n    assert_template_result(\"5\", \"{{ width | at_most:5 }}\", { 'width' => NumberLikeThing.new(6) })\n    assert_template_result(\"4\", \"{{ width | at_most:5 }}\", { 'width' => NumberLikeThing.new(4) })\n    assert_template_result(\"4\", \"{{ 5 | at_most: width }}\", { 'width' => NumberLikeThing.new(4) })\n  end","complexity_score":11.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_at_most\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:6 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4.5\"]},{\"type\":\"str\",\"children\":[\"{{ 4.5 | at_most:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_most:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_most:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most: width }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":797,"raw_source":"def test_at_least\n    assert_template_result(\"5\", \"{{ 5 | at_least:4 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_least:5 }}\")\n    assert_template_result(\"6\", \"{{ 5 | at_least:6 }}\")\n\n    assert_template_result(\"5\", \"{{ 4.5 | at_least:5 }}\")\n    assert_template_result(\"6\", \"{{ width | at_least:5 }}\", { 'width' => NumberLikeThing.new(6) })\n    assert_template_result(\"5\", \"{{ width | at_least:5 }}\", { 'width' => NumberLikeThing.new(4) })\n    assert_template_result(\"6\", \"{{ 5 | at_least: width }}\", { 'width' => NumberLikeThing.new(6) })\n  end","complexity_score":11.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_at_least\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:6 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 4.5 | at_least:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_least:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_least:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least: width }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":808,"raw_source":"def test_append\n    assigns = { 'a' => 'bc', 'b' => 'd' }\n    assert_template_result('bcd', \"{{ a | append: 'd'}}\", assigns)\n    assert_template_result('bcd', \"{{ a | append: b}}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_append\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"bc\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"d\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bcd\"]},{\"type\":\"str\",\"children\":[\"{{ a | append: 'd'}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bcd\"]},{\"type\":\"str\",\"children\":[\"{{ a | append: b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":814,"raw_source":"def test_concat\n    assert_equal([1, 2, 3, 4], @filters.concat([1, 2], [3, 4]))\n    assert_equal([1, 2, 'a'],  @filters.concat([1, 2], ['a']))\n    assert_equal([1, 2, 10],   @filters.concat([1, 2], [10]))\n\n    assert_raises(Liquid::ArgumentError, \"concat filter requires an array argument\") do\n      @filters.concat([1, 2], 10)\n    end\n  end","complexity_score":16.53,"ast_json":"{\"type\":\"def\",\"children\":[\"test_concat\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"concat filter requires an array argument\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"int\",\"children\":[10]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":824,"raw_source":"def test_prepend\n    assigns = { 'a' => 'bc', 'b' => 'a' }\n    assert_template_result('abc', \"{{ a | prepend: 'a'}}\", assigns)\n    assert_template_result('abc', \"{{ a | prepend: b}}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_prepend\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"bc\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ a | prepend: 'a'}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ a | prepend: b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":830,"raw_source":"def test_default\n    assert_equal(\"foo\", @filters.default(\"foo\", \"bar\"))\n    assert_equal(\"bar\", @filters.default(nil, \"bar\"))\n    assert_equal(\"bar\", @filters.default(\"\", \"bar\"))\n    assert_equal(\"bar\", @filters.default(false, \"bar\"))\n    assert_equal(\"bar\", @filters.default([], \"bar\"))\n    assert_equal(\"bar\", @filters.default({}, \"bar\"))\n    assert_template_result('bar', \"{{ false | default: 'bar' }}\")\n    assert_template_result('bar', \"{{ drop | default: 'bar' }}\", { 'drop' => BooleanDrop.new(false) })\n    assert_template_result('Yay', \"{{ drop | default: 'bar' }}\", { 'drop' => BooleanDrop.new(true) })\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ false | default: 'bar' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":842,"raw_source":"def test_default_handle_false\n    assert_equal(\"foo\", @filters.default(\"foo\", \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default(nil, \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default(\"\", \"bar\", \"allow_false\" => true))\n    assert_equal(false, @filters.default(false, \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default([], \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default({}, \"bar\", \"allow_false\" => true))\n    assert_template_result('false', \"{{ false | default: 'bar', allow_false: true }}\")\n    assert_template_result('Nay', \"{{ drop | default: 'bar', allow_false: true }}\", { 'drop' => BooleanDrop.new(false) })\n    assert_template_result('Yay', \"{{ drop | default: 'bar', allow_false: true }}\", { 'drop' => BooleanDrop.new(true) })\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_handle_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false | default: 'bar', allow_false: true }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Nay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar', allow_false: true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar', allow_false: true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":854,"raw_source":"def test_cannot_access_private_methods\n    assert_template_result('a', \"{{ 'a' | to_number }}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cannot_access_private_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"{{ 'a' | to_number }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":858,"raw_source":"def test_date_raises_nothing\n    assert_template_result('', \"{{ '' | date: '%D' }}\")\n    assert_template_result('abc', \"{{ 'abc' | date: '%D' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_date_raises_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ '' | date: '%D' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ 'abc' | date: '%D' }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":863,"raw_source":"def test_reject\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok' | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok' | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":877,"raw_source":"def test_reject_with_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok', true | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok', true | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":891,"raw_source":"def test_reject_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok', false | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok', false | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":905,"raw_source":"def test_has\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => false },\n    ]\n\n    expected_output = \"true\"\n\n    assert_template_result(expected_output, \"{{ array | has: 'ok' }}\", { \"array\" => array })\n    assert_template_result(expected_output, \"{{ array | has: 'ok', true }}\", { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":919,"raw_source":"def test_has_when_does_not_have_it\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => false },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => false },\n    ]\n\n    expected_output = \"false\"\n\n    assert_template_result(expected_output, \"{{ array | has: 'ok' }}\", { \"array\" => array })\n    assert_template_result(expected_output, \"{{ array | has: 'ok', true }}\", { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_when_does_not_have_it\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":933,"raw_source":"def test_has_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign has_product = products | has: 'title.content', 'Not found' -%}\n      {%- unless has_product -%}\n        Product not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Product not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign has_product = products | has: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless has_product -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Product not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Product not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":945,"raw_source":"def test_has_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | has: 'ok', false }}\"\n    expected_output = \"true\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', false }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":959,"raw_source":"def test_has_with_false_value_when_does_not_have_it\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => true },\n      { \"handle\" => \"gamma\", \"ok\" => true },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | has: 'ok', false }}\"\n    expected_output = \"false\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_false_value_when_does_not_have_it\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', false }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":973,"raw_source":"def test_find_with_value\n    products = [\n      { \"title\" => \"Pro goggles\",    \"price\" => 1299 },\n      { \"title\" => \"Thermal gloves\", \"price\" => 1499 },\n      { \"title\" => \"Alpine jacket\",  \"price\" => 3999 },\n      { \"title\" => \"Mountain boots\", \"price\" => 3899 },\n      { \"title\" => \"Safety helmet\",  \"price\" => 1999 }\n    ]\n\n    template = <<~LIQUID\n      {%- assign product = products | find: 'price', 3999 -%}\n      {{- product.title -}}\n    LIQUID\n    expected_output = \"Alpine jacket\"\n\n    assert_template_result(expected_output, template, { \"products\" => products })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"products\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Pro goggles\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1299]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Thermal gloves\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1499]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3999]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Mountain boots\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3899]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Safety helmet\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1999]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign product = products | find: 'price', 3999 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{- product.title -}}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"lvar\",\"children\":[\"products\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":991,"raw_source":"def test_find_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign product = products | find: 'title.content', 'Not found' -%}\n      {%- unless product -%}\n        Product not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Product not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign product = products | find: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless product -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Product not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Product not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1003,"raw_source":"def test_find_index_with_value\n    products = [\n      { \"title\" => \"Pro goggles\",    \"price\" => 1299 },\n      { \"title\" => \"Thermal gloves\", \"price\" => 1499 },\n      { \"title\" => \"Alpine jacket\",  \"price\" => 3999 },\n      { \"title\" => \"Mountain boots\", \"price\" => 3899 },\n      { \"title\" => \"Safety helmet\",  \"price\" => 1999 }\n    ]\n\n    template = <<~LIQUID\n      {%- assign index = products | find_index: 'price', 3999 -%}\n      {{- index -}}\n    LIQUID\n    expected_output = \"2\"\n\n    assert_template_result(expected_output, template, { \"products\" => products })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"products\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Pro goggles\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1299]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Thermal gloves\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1499]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3999]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Mountain boots\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3899]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Safety helmet\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1999]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign index = products | find_index: 'price', 3999 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{- index -}}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"lvar\",\"children\":[\"products\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1021,"raw_source":"def test_find_index_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign index = products | find_index: 'title.content', 'Not found' -%}\n      {%- unless index -%}\n        Index not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Index not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign index = products | find_index: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless index -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Index not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Index not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1033,"raw_source":"def test_where\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok' | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok' | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1047,"raw_source":"def test_where_with_empty_string_is_a_no_op\n    environment = { \"array\" => [\"alpha\", \"beta\", \"gamma\"] }\n    expected_output = \"alpha beta gamma\"\n    template = \"{{ array | where: '' | join: ' ' }}\"\n\n    assert_template_result(expected_output, template, environment)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_empty_string_is_a_no_op\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha beta gamma\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: '' | join: ' ' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1055,"raw_source":"def test_where_with_nil_is_a_no_op\n    environment = { \"array\" => [\"alpha\", \"beta\", \"gamma\"] }\n    template = \"{{ array | where: nil | join: ' ' }}\"\n\n    assert_raises(Liquid::ArgumentError) do\n      assert_template_result(\"alpha beta gamma\", template, environment)\n    end\n  end","complexity_score":5.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_nil_is_a_no_op\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: nil | join: ' ' }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"alpha beta gamma\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1064,"raw_source":"def test_where_with_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok', true | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok', true | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1078,"raw_source":"def test_where_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok', false | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok', false | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1092,"raw_source":"def test_where_string_keys\n    input = [\n      \"alpha\", \"beta\", \"gamma\", \"delta\"\n    ]\n\n    expectation = [\n      \"beta\",\n    ]\n\n    assert_equal(expectation, @filters.where(input, \"be\"))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_string_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"be\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1104,"raw_source":"def test_where_no_key_set\n    input = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    expectation = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    assert_equal(expectation, @filters.where(input, \"ok\", true))\n    assert_equal(expectation, @filters.where(input, \"ok\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_no_key_set\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1121,"raw_source":"def test_where_non_array_map_input\n    assert_equal([{ \"a\" => \"ok\" }], @filters.where({ \"a\" => \"ok\" }, \"a\", \"ok\"))\n    assert_equal([], @filters.where({ \"a\" => \"not ok\" }, \"a\", \"ok\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_non_array_map_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"not ok\"]}]}]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1126,"raw_source":"def test_where_indexable_but_non_map_value\n    assert_raises(Liquid::ArgumentError) { @filters.where(1, \"ok\", true) }\n    assert_raises(Liquid::ArgumentError) { @filters.where(1, \"ok\") }\n  end","complexity_score":6.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_indexable_but_non_map_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1131,"raw_source":"def test_where_non_boolean_value\n    input = [\n      { \"message\" => \"Bonjour!\", \"language\" => \"French\" },\n      { \"message\" => \"Hello!\", \"language\" => \"English\" },\n      { \"message\" => \"Hallo!\", \"language\" => \"German\" },\n    ]\n\n    assert_equal([{ \"message\" => \"Bonjour!\", \"language\" => \"French\" }], @filters.where(input, \"language\", \"French\"))\n    assert_equal([{ \"message\" => \"Hallo!\", \"language\" => \"German\" }], @filters.where(input, \"language\", \"German\"))\n    assert_equal([{ \"message\" => \"Hello!\", \"language\" => \"English\" }], @filters.where(input, \"language\", \"English\"))\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_non_boolean_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Bonjour!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hello!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hallo!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Bonjour!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hallo!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hello!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1143,"raw_source":"def test_where_array_of_only_unindexable_values\n    assert_nil(@filters.where([nil], \"ok\", true))\n    assert_nil(@filters.where([nil], \"ok\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_array_of_only_unindexable_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1148,"raw_source":"def test_all_filters_never_raise_non_liquid_exception\n    test_drop = TestDrop.new(value: \"test\")\n    test_drop.context = Context.new\n    test_enum = TestEnumerable.new\n    test_enum.context = Context.new\n    test_types = [\n      \"foo\",\n      123,\n      0,\n      0.0,\n      -1234.003030303,\n      -99999999,\n      1234.38383000383830003838300,\n      nil,\n      true,\n      false,\n      TestThing.new,\n      test_drop,\n      test_enum,\n      [\"foo\", \"bar\"],\n      { \"foo\" => \"bar\" },\n      { foo: \"bar\" },\n      [{ \"foo\" => \"bar\" }, { \"foo\" => 123 }, { \"foo\" => nil }, { \"foo\" => true }, { \"foo\" => [\"foo\", \"bar\"] }],\n      { 1 => \"bar\" },\n      [\"foo\", 123, nil, true, false, Drop, [\"foo\"], { foo: \"bar\" }],\n    ]\n    StandardFilters.public_instance_methods(false).each do |method|\n      arg_count = @filters.method(method).arity\n      arg_count *= -1 if arg_count < 0\n\n      test_types.repeated_permutation(arg_count) do |args|\n        @filters.send(method, *args)\n      rescue Liquid::Error\n        nil\n      end\n    end\n  end","complexity_score":32.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_all_filters_never_raise_non_liquid_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"test_drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"test_enum\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_enum\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"test_types\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"float\",\"children\":[-1234.003030303]},{\"type\":\"int\",\"children\":[-99999999]},{\"type\":\"float\",\"children\":[1234.3838300038383]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"test_drop\"]},{\"type\":\"lvar\",\"children\":[\"test_enum\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"Drop\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"public_instance_methods\",{\"type\":\"false\",\"children\":[]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"arg_count\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"method\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"arity\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arg_count\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"arg_count\"]},\"*\",{\"type\":\"int\",\"children\":[-1]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_types\"]},\"repeated_permutation\",{\"type\":\"lvar\",\"children\":[\"arg_count\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1186,"raw_source":"def test_where_no_target_value\n    input = [\n      { \"foo\" => false },\n      { \"foo\" => true },\n      { \"foo\" => \"for sure\" },\n      { \"bar\" => true },\n    ]\n\n    assert_equal([{ \"foo\" => true }, { \"foo\" => \"for sure\" }], @filters.where(input, \"foo\"))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_no_target_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"for sure\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"for sure\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1197,"raw_source":"def test_sum_with_all_numbers\n    input = [1, 2]\n\n    assert_equal(3, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_all_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1206,"raw_source":"def test_sum_with_numeric_strings\n    input = [1, 2, \"3\", \"4\"]\n\n    assert_equal(10, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_numeric_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"str\",\"children\":[\"4\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1215,"raw_source":"def test_sum_with_nested_arrays\n    input = [1, [2, [3, 4]]]\n\n    assert_equal(10, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_nested_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1224,"raw_source":"def test_sum_with_indexable_map_values\n    input = [{ \"quantity\" => 1 }, { \"quantity\" => 2, \"weight\" => 3 }, { \"weight\" => 4 }]\n\n    assert_equal(0, @filters.sum(input))\n    assert_equal(3, @filters.sum(input, \"quantity\"))\n    assert_equal(7, @filters.sum(input, \"weight\"))\n    assert_equal(0, @filters.sum(input, \"subtotal\"))\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_indexable_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"weight\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"subtotal\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1233,"raw_source":"def test_sum_with_indexable_non_map_values\n    input = [1, [2], \"foo\", { \"quantity\" => 3 }]\n\n    assert_equal(3, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_indexable_non_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1242,"raw_source":"def test_sum_with_unindexable_values\n    input = [1, true, nil, { \"quantity\" => 2 }]\n\n    assert_equal(1, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_unindexable_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"true\",\"children\":[]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1251,"raw_source":"def test_sum_without_property_calls_to_liquid\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sum }}').render(\"foo\" => [t])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_without_property_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sum }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1257,"raw_source":"def test_sum_with_property_calls_to_liquid_on_property_values\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sum: \"quantity\" }}').render(\"foo\" => [{ \"quantity\" => t }])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_property_calls_to_liquid_on_property_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sum: \\\"quantity\\\" }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1263,"raw_source":"def test_sum_of_floats\n    input = [0.1, 0.2, 0.3]\n    assert_equal(0.6, @filters.sum(input))\n    assert_template_result(\"0.6\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_of_floats\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"float\",\"children\":[0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.6]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.6\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1269,"raw_source":"def test_sum_of_negative_floats\n    input = [0.1, 0.2, -0.3]\n    assert_equal(0.0, @filters.sum(input))\n    assert_template_result(\"0.0\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":4.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_of_negative_floats\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1275,"raw_source":"def test_sum_with_float_strings\n    input = [0.1, \"0.2\", \"0.3\"]\n    assert_equal(0.6, @filters.sum(input))\n    assert_template_result(\"0.6\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":4.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_float_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"str\",\"children\":[\"0.2\"]},{\"type\":\"str\",\"children\":[\"0.3\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.6]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.6\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1281,"raw_source":"def test_sum_resulting_in_negative_float\n    input = [0.1, -0.2, -0.3]\n    assert_equal(-0.4, @filters.sum(input))\n    assert_template_result(\"-0.4\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_resulting_in_negative_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[-0.2]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[-0.4]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-0.4\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1287,"raw_source":"def test_sum_with_floats_and_indexable_map_values\n    input = [{ \"quantity\" => 1 }, { \"quantity\" => 0.2, \"weight\" => -0.3 }, { \"weight\" => 0.4 }]\n    assert_equal(0.0, @filters.sum(input))\n    assert_equal(1.2, @filters.sum(input, \"quantity\"))\n    assert_equal(0.1, @filters.sum(input, \"weight\"))\n    assert_equal(0.0, @filters.sum(input, \"subtotal\"))\n    assert_template_result(\"0\", \"{{ input | sum }}\", { \"input\" => input })\n    assert_template_result(\"1.2\", \"{{ input | sum: 'quantity' }}\", { \"input\" => input })\n    assert_template_result(\"0.1\", \"{{ input | sum: 'weight' }}\", { \"input\" => input })\n    assert_template_result(\"0\", \"{{ input | sum: 'subtotal' }}\", { \"input\" => input })\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_floats_and_indexable_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"float\",\"children\":[0.2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"float\",\"children\":[0.4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[1.2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"weight\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"subtotal\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1.2\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'quantity' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.1\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'weight' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'subtotal' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1299,"raw_source":"def test_sum_with_non_string_property\n    input = [{ true => 1 }, { 1.0 => 0.2, 1 => -0.3 }, { 1..5 => 0.4 }]\n\n    assert_equal(1, @filters.sum(input, true))\n    assert_equal(0.2, @filters.sum(input, 1.0))\n    assert_equal(-0.3, @filters.sum(input, 1))\n    assert_equal(0.4, @filters.sum(input, (1..5)))\n    assert_equal(0, @filters.sum(input, nil))\n    assert_equal(0, @filters.sum(input, \"\"))\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_non_string_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"float\",\"children\":[1.0]},{\"type\":\"float\",\"children\":[0.2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"float\",\"children\":[0.4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[1.0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[-0.3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.4]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1310,"raw_source":"def test_uniq_with_to_liquid_value\n    input = [StringDrop.new(\"foo\"), StringDrop.new(\"bar\"), \"foo\"]\n    expected = [StringDrop.new(\"foo\"), StringDrop.new(\"bar\")]\n    result = @filters.uniq(input)\n\n    assert_equal(expected, result)\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_with_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1318,"raw_source":"def test_uniq_with_to_liquid_value_pick_correct_classes\n    input = [\"foo\", StringDrop.new(\"foo\"), StringDrop.new(\"bar\")]\n    expected = [String, StringDrop]\n    result = @filters.uniq(input).map(&:class)\n\n    assert_equal(expected, result)\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_with_to_liquid_value_pick_correct_classes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"StringDrop\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1328,"raw_source":"def with_timezone(tz)\n    old_tz    = ENV['TZ']\n    ENV['TZ'] = tz\n    yield\n  ensure\n    ENV['TZ'] = old_tz\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_timezone\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tz\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_tz\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"TZ\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"TZ\"]},{\"type\":\"lvar\",\"children\":[\"tz\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"TZ\"]},{\"type\":\"lvar\",\"children\":[\"old_tz\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":9,"raw_source":"def render(_context)\n      tag_name\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},{\"type\":\"send\",\"children\":[null,\"tag_name\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":32,"raw_source":"def test_block_tag_disabling_nested_tag\n    with_disableable_tags do\n      with_custom_tag('disable', DisableCustom) do\n        output = Template.parse('{% disable %}{% custom %};{% custom2 %}{% enddisable %}').render\n        assert_equal('Liquid error: custom usage is not allowed in this context;custom2', output)\n      end\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_block_tag_disabling_nested_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_disableable_tags\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"disable\"]},{\"type\":\"const\",\"children\":[null,\"DisableCustom\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% disable %}{% custom %};{% custom2 %}{% enddisable %}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: custom usage is not allowed in this context;custom2\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":41,"raw_source":"def test_block_tag_disabling_multiple_nested_tags\n    with_disableable_tags do\n      with_custom_tag('disable', DisableBoth) do\n        output = Template.parse('{% disable %}{% custom %};{% custom2 %}{% enddisable %}').render\n        assert_equal('Liquid error: custom usage is not allowed in this context;Liquid error: custom2 usage is not allowed in this context', output)\n      end\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_block_tag_disabling_multiple_nested_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_disableable_tags\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"disable\"]},{\"type\":\"const\",\"children\":[null,\"DisableBoth\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% disable %}{% custom %};{% custom2 %}{% enddisable %}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: custom usage is not allowed in this context;Liquid error: custom2 usage is not allowed in this context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":52,"raw_source":"def with_disableable_tags\n    with_custom_tag('custom', Custom) do\n      with_custom_tag('custom2', Custom2) do\n        yield\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_disableable_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"custom\"]},{\"type\":\"const\",\"children\":[null,\"Custom\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"custom2\"]},{\"type\":\"const\",\"children\":[null,\"Custom2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag_test.rb","start_line":8,"raw_source":"def test_custom_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\n    klass1 = Class.new(Tag) do\n      def render(*)\n        'hello'\n      end\n    end\n\n    with_custom_tag('blabla', klass1) do\n      template = Liquid::Template.parse(\"{% blabla %}\")\n\n      assert_equal('hello', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('hello', output)\n      assert_equal('hello', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n\n    klass2 = Class.new(klass1) do\n      def render(*)\n        'foo' + super + 'bar'\n      end\n    end\n\n    with_custom_tag('blabla', klass2) do\n      template = Liquid::Template.parse(\"{% blabla %}\")\n\n      assert_equal('foohellobar', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('foohellobar', output)\n      assert_equal('foohellobar', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n  end","complexity_score":42.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass1\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Tag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"klass2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag_test.rb","start_line":10,"raw_source":"def render(*)\n        'hello'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag_test.rb","start_line":28,"raw_source":"def render(*)\n        'foo' + super + 'bar'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/break_tag_test.rb","start_line":10,"raw_source":"def test_break_with_no_block\n    assigns  = { 'i' => 1 }\n    markup   = 'before{% break %}after'\n    expected = 'before'\n\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":4.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_with_no_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"i\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"before{% break %}after\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"before\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/continue_tag_test.rb","start_line":10,"raw_source":"def test_continue_with_no_block\n    assigns  = {}\n    markup   = '{% continue %}'\n    expected = ''\n\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_continue_with_no_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% continue %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":6,"raw_source":"def test_simple_cycle\n    template = <<~LIQUID\n      {%- cycle '1', '2', '3' -%}\n      {%- cycle '1', '2', '3' -%}\n      {%- cycle '1', '2', '3' -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":16,"raw_source":"def test_simple_cycle_inside_for_loop\n    template = <<~LIQUID\n      {%- for i in (1..3) -%}\n        {% cycle '1', '2', '3' %}\n      {%- endfor -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_cycle_inside_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% cycle '1', '2', '3' %}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endfor -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":26,"raw_source":"def test_cycle_with_variables_inside_for_loop\n    template = <<~LIQUID\n      {%- assign a = 1 -%}\n      {%- assign b = 2 -%}\n      {%- assign c = 3 -%}\n      {%- for i in (1..3) -%}\n        {% cycle a, b, c %}\n      {%- endfor -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_with_variables_inside_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign a = 1 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- assign b = 2 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- assign c = 3 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% cycle a, b, c %}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endfor -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":39,"raw_source":"def test_cycle_tag_always_resets_cycle\n    template = <<~LIQUID\n      {%- assign a = \"1\" -%}\n      {%- cycle a, \"2\" -%}\n      {%- cycle a, \"2\" -%}\n    LIQUID\n\n    assert_template_result(\"11\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_tag_always_resets_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign a = \\\"1\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle a, \\\"2\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle a, \\\"2\\\" -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"11\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/echo_test.rb","start_line":8,"raw_source":"def test_echo_outputs_its_input\n    assert_template_result('BAR', <<~LIQUID, { 'variable-name' => 'bar' })\n      {%- echo variable-name | upcase -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_echo_outputs_its_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"BAR\"]},{\"type\":\"str\",\"children\":[\"{%- echo variable-name | upcase -%}\\n\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"variable-name\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":6,"raw_source":"def value\n    3\n  end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[3]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":14,"raw_source":"def test_for\n    assert_template_result(' yo  yo  yo  yo ', '{%for item in array%} yo {%endfor%}', { 'array' => [1, 2, 3, 4] })\n    assert_template_result('yoyo', '{%for item in array%}yo{%endfor%}', { 'array' => [1, 2] })\n    assert_template_result(' yo ', '{%for item in array%} yo {%endfor%}', { 'array' => [1] })\n    assert_template_result('', '{%for item in array%}{%endfor%}', { 'array' => [1, 2] })\n    expected = <<HERE\n\n  yo\n\n  yo\n\n  yo\n\nHERE\n    template = <<~HERE\n      {%for item in array%}\n        yo\n      {%endfor%}\n    HERE\n    assert_template_result(expected, template, { 'array' => [1, 2, 3] })\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" yo  yo  yo  yo \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} yo {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yoyo\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}yo{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" yo \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} yo {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for item in array%}\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"{%endfor%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":36,"raw_source":"def test_for_reversed\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result('321', '{%for item in array reversed %}{{item}}{%endfor%}', assigns)\n  end","complexity_score":2.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_reversed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"321\"]},{\"type\":\"str\",\"children\":[\"{%for item in array reversed %}{{item}}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":41,"raw_source":"def test_for_with_range\n    assert_template_result(' 1  2  3 ', '{%for item in (1..3) %} {{item}} {%endfor%}')\n\n    assert_raises(Liquid::ArgumentError) do\n      Template.parse('{% for i in (a..2) %}{% endfor %}').render!(\"a\" => [1, 2])\n    end\n\n    assert_template_result(' 0  1  2  3 ', '{% for item in (a..3) %} {{item}} {% endfor %}', { \"a\" => \"invalid integer\" })\n  end","complexity_score":7.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..3) %} {{item}} {%endfor%}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in (a..2) %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0  1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{% for item in (a..3) %} {{item}} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":51,"raw_source":"def test_for_with_variable_range\n    assert_template_result(' 1  2  3 ', '{%for item in (1..foobar) %} {{item}} {%endfor%}', { \"foobar\" => 3 })\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_variable_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..foobar) %} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":55,"raw_source":"def test_for_with_hash_value_range\n    foobar = { \"value\" => 3 }\n    assert_template_result(' 1  2  3 ', '{%for item in (1..foobar.value) %} {{item}} {%endfor%}', { \"foobar\" => foobar })\n  end","complexity_score":2.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_hash_value_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foobar\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..foobar.value) %} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"foobar\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":60,"raw_source":"def test_for_with_drop_value_range\n    foobar = ThingWithValue.new\n    assert_template_result(' 1  2  3 ', '{%for item in (1..foobar.value) %} {{item}} {%endfor%}', { \"foobar\" => foobar })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_drop_value_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foobar\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithValue\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..foobar.value) %} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"foobar\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":65,"raw_source":"def test_for_with_variable\n    assert_template_result(' 1  2  3 ', '{%for item in array%} {{item}} {%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('123', '{%for item in array%}{{item}}{%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('123', '{% for item in array %}{{item}}{% endfor %}', { 'array' => [1, 2, 3] })\n    assert_template_result('abcd', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', 'b', 'c', 'd'] })\n    assert_template_result('a b c', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', ' ', 'b', ' ', 'c'] })\n    assert_template_result('abc', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', '', 'b', '', 'c'] })\n  end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% for item in array %}{{item}}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abcd\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a b c\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":74,"raw_source":"def test_for_helpers\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result(\n      ' 1/3  2/3  3/3 ',\n      '{%for item in array%} {{forloop.index}}/{{forloop.length}} {%endfor%}',\n      assigns,\n    )\n    assert_template_result(' 1  2  3 ', '{%for item in array%} {{forloop.index}} {%endfor%}', assigns)\n    assert_template_result(' 0  1  2 ', '{%for item in array%} {{forloop.index0}} {%endfor%}', assigns)\n    assert_template_result(' 2  1  0 ', '{%for item in array%} {{forloop.rindex0}} {%endfor%}', assigns)\n    assert_template_result(' 3  2  1 ', '{%for item in array%} {{forloop.rindex}} {%endfor%}', assigns)\n    assert_template_result(' true  false  false ', '{%for item in array%} {{forloop.first}} {%endfor%}', assigns)\n    assert_template_result(' false  false  true ', '{%for item in array%} {{forloop.last}} {%endfor%}', assigns)\n  end","complexity_score":8.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_helpers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1/3  2/3  3/3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index}}/{{forloop.length}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0  1  2 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index0}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 2  1  0 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.rindex0}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 3  2  1 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.rindex}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" true  false  false \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.first}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" false  false  true \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.last}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":89,"raw_source":"def test_for_and_if\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result(\n      '+--',\n      '{%for item in array%}{% if forloop.first %}+{% else %}-{% endif %}{%endfor%}',\n      assigns,\n    )\n  end","complexity_score":2.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_and_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"+--\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{% if forloop.first %}+{% else %}-{% endif %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":98,"raw_source":"def test_for_else\n    assert_template_result('+++', '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('-',   '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => [] })\n    assert_template_result('-',   '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => nil })\n  end","complexity_score":3.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"+++\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":104,"raw_source":"def test_limiting\n    assigns = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assert_template_result('12', '{%for i in array limit:2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('1234', '{%for i in array limit:4 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array limit:4 offset:2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array limit: 4 offset: 2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array, limit: 4, offset: 2 %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":8.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1234\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:4 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:4 offset:2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit: 4 offset: 2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array, limit: 4, offset: 2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":113,"raw_source":"def test_limiting_with_invalid_limit\n    assigns  = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    template = <<-MKUP\n      {% for i in array limit: true offset: 1 %}\n        {{ i }}\n      {% endfor %}\n    MKUP\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      Template.parse(template).render!(assigns)\n    end\n    assert_equal(\"Liquid error: invalid integer\", exception.message)\n  end","complexity_score":11.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting_with_invalid_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {% for i in array limit: true offset: 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"        {{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% endfor %}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":127,"raw_source":"def test_limiting_with_invalid_offset\n    assigns  = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    template = <<-MKUP\n      {% for i in array limit: 1 offset: true %}\n        {{ i }}\n      {% endfor %}\n    MKUP\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      Template.parse(template).render!(assigns)\n    end\n    assert_equal(\"Liquid error: invalid integer\", exception.message)\n  end","complexity_score":11.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting_with_invalid_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {% for i in array limit: 1 offset: true %}\\n\"]},{\"type\":\"str\",\"children\":[\"        {{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% endfor %}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":141,"raw_source":"def test_dynamic_variable_limiting\n    assigns           = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assigns['limit']  = 2\n    assigns['offset'] = 2\n\n    assert_template_result('34', '{%for i in array limit: limit offset: offset %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":6.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_variable_limiting\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"limit\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"offset\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"34\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit: limit offset: offset %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":149,"raw_source":"def test_nested_for\n    assigns = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    assert_template_result('123456', '{%for item in array%}{%for i in item%}{{ i }}{%endfor%}{%endfor%}', assigns)\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123456\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%for i in item%}{{ i }}{%endfor%}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":154,"raw_source":"def test_offset_only\n    assigns = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assert_template_result('890', '{%for i in array offset:7 %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":4.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_offset_only\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"890\"]},{\"type\":\"str\",\"children\":[\"{%for i in array offset:7 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":159,"raw_source":"def test_pause_resume\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit: 3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      789\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit: 3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      789\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":178,"raw_source":"def test_pause_resume_limit\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:1 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      7\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:1 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      7\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":197,"raw_source":"def test_pause_resume_big_limit\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:1000 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      7890\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_big_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:1000 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      7890\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":216,"raw_source":"def test_pause_resume_big_offset\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = '{%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 offset:1000 %}{{i}}{%endfor%}'\n    expected = '123\n      next\n      456\n      next\n      '\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_big_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 offset:1000 %}{{i}}{%endfor%}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":231,"raw_source":"def test_for_with_break\n    assigns = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] } }\n\n    markup   = '{% for i in array.items %}{% break %}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% break %}{% endfor %}'\n    expected = \"1\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% break %}{{ i }}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% if i > 3 %}{% break %}{% endif %}{% endfor %}'\n    expected = \"1234\"\n    assert_template_result(expected, markup, assigns)\n\n    # tests to ensure it only breaks out of the local for loop\n    # and not all of them.\n    assigns  = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    markup   = '{% for item in array %}' \\\n               '{% for i in item %}' \\\n                 '{% if i == 1 %}' \\\n                   '{% break %}' \\\n                 '{% endif %}' \\\n                 '{{ i }}' \\\n               '{% endfor %}' \\\n             '{% endfor %}'\n    expected = '3456'\n    assert_template_result(expected, markup, assigns)\n\n    # test break does nothing when unreached\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n    markup   = '{% for i in array.items %}{% if i == 9999 %}{% break %}{% endif %}{{ i }}{% endfor %}'\n    expected = '12345'\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":26.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_break\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[10]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% break %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% break %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% break %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% if i > 3 %}{% break %}{% endif %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1234\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for item in array %}\"]},{\"type\":\"str\",\"children\":[\"{% for i in item %}\"]},{\"type\":\"str\",\"children\":[\"{% if i == 1 %}\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\"]},{\"type\":\"str\",\"children\":[\"{{ i }}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"3456\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 9999 %}{% break %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":271,"raw_source":"def test_for_with_break_after_nested_loop\n    source = <<~LIQUID.chomp\n      {% for i in (1..2) -%}\n        {% for j in (1..2) -%}\n          {{ i }}-{{ j }},\n        {%- endfor -%}\n        {% break -%}\n      {% endfor -%}\n      after\n    LIQUID\n    assert_template_result(\"1-1,1-2,after\", source)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_break_after_nested_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for i in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% for j in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"    {{ i }}-{{ j }},\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% break -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"after\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1-1,1-2,after\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":284,"raw_source":"def test_for_with_continue\n    assigns = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n\n    markup   = '{% for i in array.items %}{% continue %}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% continue %}{% endfor %}'\n    expected = \"12345\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% continue %}{{ i }}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% if i > 3 %}{% continue %}{% endif %}{{ i }}{% endfor %}'\n    expected = \"123\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% if i == 3 %}{% continue %}{% else %}{{ i }}{% endif %}{% endfor %}'\n    expected = \"1245\"\n    assert_template_result(expected, markup, assigns)\n\n    # tests to ensure it only continues the local for loop and not all of them.\n    assigns  = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    markup   = '{% for item in array %}' \\\n               '{% for i in item %}' \\\n                 '{% if i == 1 %}' \\\n                   '{% continue %}' \\\n                 '{% endif %}' \\\n                 '{{ i }}' \\\n               '{% endfor %}' \\\n             '{% endfor %}'\n    expected = '23456'\n    assert_template_result(expected, markup, assigns)\n\n    # test continue does nothing when unreached\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n    markup   = '{% for i in array.items %}{% if i == 9999 %}{% continue %}{% endif %}{{ i }}{% endfor %}'\n    expected = '12345'\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":28.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_continue\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% continue %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% continue %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% continue %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i > 3 %}{% continue %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 3 %}{% continue %}{% else %}{{ i }}{% endif %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1245\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for item in array %}\"]},{\"type\":\"str\",\"children\":[\"{% for i in item %}\"]},{\"type\":\"str\",\"children\":[\"{% if i == 1 %}\"]},{\"type\":\"str\",\"children\":[\"{% continue %}\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\"]},{\"type\":\"str\",\"children\":[\"{{ i }}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"23456\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 9999 %}{% continue %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":327,"raw_source":"def test_for_tag_string\n    # ruby 1.8.7 \"String\".each => Enumerator with single \"String\" element.\n    # ruby 1.9.3 no longer supports .each on String though we mimic\n    # the functionality for backwards compatibility\n\n    assert_template_result(\n      'test string',\n      '{%for val in string%}{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n\n    assert_template_result(\n      'test string',\n      '{%for val in string limit:1%}{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n\n    assert_template_result(\n      'val-string-1-1-0-1-0-true-true-test string',\n      '{%for val in string%}' \\\n      '{{forloop.name}}-' \\\n      '{{forloop.index}}-' \\\n      '{{forloop.length}}-' \\\n      '{{forloop.index0}}-' \\\n      '{{forloop.rindex}}-' \\\n      '{{forloop.rindex0}}-' \\\n      '{{forloop.first}}-' \\\n      '{{forloop.last}}-' \\\n      '{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_tag_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test string\"]},{\"type\":\"str\",\"children\":[\"{%for val in string%}{{val}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test string\"]},{\"type\":\"str\",\"children\":[\"{%for val in string limit:1%}{{val}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"val-string-1-1-0-1-0-true-true-test string\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for val in string%}\"]},{\"type\":\"str\",\"children\":[\"{{forloop.name}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.index}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.length}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.index0}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.rindex}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.rindex0}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.first}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.last}}-\"]},{\"type\":\"str\",\"children\":[\"{{val}}{%endfor%}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":360,"raw_source":"def test_for_parentloop_references_parent_loop\n    assert_template_result(\n      '1.1 1.2 1.3 2.1 2.2 2.3 ',\n      '{% for inner in outer %}{% for k in inner %}' \\\n      '{{ forloop.parentloop.index }}.{{ forloop.index }} ' \\\n      '{% endfor %}{% endfor %}',\n      { 'outer' => [[1, 1, 1], [1, 1, 1]] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_parentloop_references_parent_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1.1 1.2 1.3 2.1 2.2 2.3 \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for inner in outer %}{% for k in inner %}\"]},{\"type\":\"str\",\"children\":[\"{{ forloop.parentloop.index }}.{{ forloop.index }} \"]},{\"type\":\"str\",\"children\":[\"{% endfor %}{% endfor %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":370,"raw_source":"def test_for_parentloop_nil_when_not_present\n    assert_template_result(\n      '.1 .2 ',\n      '{% for inner in outer %}' \\\n      '{{ forloop.parentloop.index }}.{{ forloop.index }} ' \\\n      '{% endfor %}',\n      { 'outer' => [[1, 1, 1], [1, 1, 1]] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_parentloop_nil_when_not_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".1 .2 \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for inner in outer %}\"]},{\"type\":\"str\",\"children\":[\"{{ forloop.parentloop.index }}.{{ forloop.index }} \"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":380,"raw_source":"def test_inner_for_over_empty_input\n    assert_template_result('oo', '{% for a in (1..2) %}o{% for b in empty %}{% endfor %}{% endfor %}')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inner_for_over_empty_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"oo\"]},{\"type\":\"str\",\"children\":[\"{% for a in (1..2) %}o{% for b in empty %}{% endfor %}{% endfor %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":384,"raw_source":"def test_blank_string_not_iterable\n    assert_template_result('', \"{% for char in characters %}I WILL NOT BE OUTPUT{% endfor %}\", { 'characters' => '' })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_blank_string_not_iterable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% for char in characters %}I WILL NOT BE OUTPUT{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"characters\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":388,"raw_source":"def test_bad_variable_naming_in_for_loop\n    assert_raises(Liquid::SyntaxError) do\n      Liquid::Template.parse('{% for a/b in x %}{% endfor %}')\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bad_variable_naming_in_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for a/b in x %}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":394,"raw_source":"def test_spacing_with_variable_naming_in_for_loop\n    expected = '12345'\n    template = '{% for       item   in   items %}{{item}}{% endfor %}'\n    assigns  = { 'items' => [1, 2, 3, 4, 5] }\n    assert_template_result(expected, template, assigns)\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_spacing_with_variable_naming_in_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for       item   in   items %}{{item}}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":404,"raw_source":"def initialize(data)\n      @data = data\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@data\",{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":408,"raw_source":"def each\n      @each_called = true\n      @data.each { |el| yield el }\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@each_called\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@data\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":413,"raw_source":"def load_slice(from, to)\n      @load_slice_called = true\n      @data[(from..to - 1)]\n    end","complexity_score":3.55,"ast_json":"{\"type\":\"def\",\"children\":[\"load_slice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@load_slice_called\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@data\"]},\"[]\",{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":419,"raw_source":"def test_iterate_with_each_when_no_limit_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '12345'\n    template = '{% for item in items %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(loader.each_called)\n    assert(!loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_each_when_no_limit_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]},\"!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":429,"raw_source":"def test_iterate_with_load_slice_when_limit_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '1'\n    template = '{% for item in items limit:1 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(!loader.each_called)\n    assert(loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_when_limit_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items limit:1 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":439,"raw_source":"def test_iterate_with_load_slice_when_limit_and_offset_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '34'\n    template = '{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(!loader.each_called)\n    assert(loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_when_limit_and_offset_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":449,"raw_source":"def test_iterate_with_load_slice_returns_same_results_as_without\n    loader         = LoaderDrop.new([1, 2, 3, 4, 5])\n    loader_assigns = { 'items' => loader }\n    array_assigns  = { 'items' => [1, 2, 3, 4, 5] }\n    expected       = '34'\n    template       = '{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, loader_assigns)\n    assert_template_result(expected, template, array_assigns)\n  end","complexity_score":10.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_returns_same_results_as_without\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"loader_assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"array_assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"loader_assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"array_assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":459,"raw_source":"def test_for_cleans_up_registers\n    context = Context.new(ErrorDrop.new)\n\n    assert_raises(StandardError) do\n      Liquid::Template.parse('{% for i in (1..2) %}{{ standard_error }}{% endfor %}').render!(context)\n    end\n\n    assert(context.registers[:for_stack].empty?)\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_cleans_up_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in (1..2) %}{{ standard_error }}{% endfor %}\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for_stack\"]}]},\"empty?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":8,"raw_source":"def test_if\n    assert_template_result('  ', ' {% if false %} this text should not go into the output {% endif %} ')\n    assert_template_result(\n      '  this text should go into the output  ',\n      ' {% if true %} this text should go into the output {% endif %} ',\n    )\n    assert_template_result('  you rock ?', '{% if false %} you suck {% endif %} {% if true %} you rock {% endif %}?')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\" {% if false %} this text should not go into the output {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  this text should go into the output  \"]},{\"type\":\"str\",\"children\":[\" {% if true %} this text should go into the output {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  you rock ?\"]},{\"type\":\"str\",\"children\":[\"{% if false %} you suck {% endif %} {% if true %} you rock {% endif %}?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":17,"raw_source":"def test_literal_comparisons\n    assert_template_result(' NO ', '{% assign v = false %}{% if v %} YES {% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% assign v = nil %}{% if v == nil %} YES {% else %} NO {% endif %}')\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_literal_comparisons\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" NO \"]},{\"type\":\"str\",\"children\":[\"{% assign v = false %}{% if v %} YES {% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% assign v = nil %}{% if v == nil %} YES {% else %} NO {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":22,"raw_source":"def test_if_else\n    assert_template_result(' YES ', '{% if false %} NO {% else %} YES {% endif %}')\n    assert_template_result(' YES ', '{% if true %} YES {% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% else %} NO {% endif %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if false %} NO {% else %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %} YES {% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% else %} NO {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":28,"raw_source":"def test_if_boolean\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => true })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_boolean\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":32,"raw_source":"def test_if_or\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => true, 'b' => false })\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => false, 'b' => true })\n    assert_template_result('',      '{% if a or b %} YES {% endif %}', { 'a' => false, 'b' => false })\n\n    assert_template_result(' YES ', '{% if a or b or c %} YES {% endif %}', { 'a' => false, 'b' => false, 'c' => true })\n    assert_template_result('',      '{% if a or b or c %} YES {% endif %}', { 'a' => false, 'b' => false, 'c' => false })\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b or c %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a or b or c %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":42,"raw_source":"def test_if_or_with_operators\n    assert_template_result(' YES ', '{% if a == true or b == true %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result(' YES ', '{% if a == true or b == false %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result('', '{% if a == false or b == false %} YES {% endif %}', { 'a' => true, 'b' => true })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_or_with_operators\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a == true or b == true %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a == true or b == false %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a == false or b == false %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":48,"raw_source":"def test_comparison_of_strings_containing_and_or_or\n    awful_markup = \"a == 'and' and b == 'or' and c == 'foo and bar' and d == 'bar or baz' and e == 'foo' and foo and bar\"\n    assigns      = { 'a' => 'and', 'b' => 'or', 'c' => 'foo and bar', 'd' => 'bar or baz', 'e' => 'foo', 'foo' => true, 'bar' => true }\n    assert_template_result(' YES ', \"{% if #{awful_markup} %} YES {% endif %}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparison_of_strings_containing_and_or_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"awful_markup\",{\"type\":\"str\",\"children\":[\"a == 'and' and b == 'or' and c == 'foo and bar' and d == 'bar or baz' and e == 'foo' and foo and bar\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"and\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"or\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"foo and bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"bar or baz\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"e\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"awful_markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":54,"raw_source":"def test_comparison_of_expressions_starting_with_and_or_or\n    assigns = { 'order' => { 'items_count' => 0 }, 'android' => { 'name' => 'Roy' } }\n    assert_template_result(\n      \"YES\",\n      \"{% if android.name == 'Roy' %}YES{% endif %}\",\n      assigns,\n    )\n    assert_template_result(\n      \"YES\",\n      \"{% if order.items_count == 0 %}YES{% endif %}\",\n      assigns,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparison_of_expressions_starting_with_and_or_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"order\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items_count\"]},{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"android\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Roy\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YES\"]},{\"type\":\"str\",\"children\":[\"{% if android.name == 'Roy' %}YES{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YES\"]},{\"type\":\"str\",\"children\":[\"{% if order.items_count == 0 %}YES{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":68,"raw_source":"def test_if_and\n    assert_template_result(' YES ', '{% if true and true %} YES {% endif %}')\n    assert_template_result('', '{% if false and true %} YES {% endif %}')\n    assert_template_result('', '{% if true and false %} YES {% endif %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_and\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true and true %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false and true %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true and false %} YES {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":74,"raw_source":"def test_hash_miss_generates_false\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => {} })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_miss_generates_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":78,"raw_source":"def test_if_from_variable\n    assert_template_result('', '{% if var %} NO {% endif %}', { 'var' => false })\n    assert_template_result('', '{% if var %} NO {% endif %}', { 'var' => nil })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => { 'bar' => false } })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => {} })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => nil })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => true })\n\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => \"text\" })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => true })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => 1 })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => {} })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => [] })\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% endif %}')\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => \"text\" } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => 1 } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => {} } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => [] } })\n\n    assert_template_result(' YES ', '{% if var %} NO {% else %} YES {% endif %}', { 'var' => false })\n    assert_template_result(' YES ', '{% if var %} NO {% else %} YES {% endif %}', { 'var' => nil })\n    assert_template_result(' YES ', '{% if var %} YES {% else %} NO {% endif %}', { 'var' => true })\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% else %} NO {% endif %}', { 'var' => \"text\" })\n\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => { 'bar' => false } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% else %} NO {% endif %}', { 'foo' => { 'bar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% else %} NO {% endif %}', { 'foo' => { 'bar' => \"text\" } })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => { 'notbar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => {} })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'notfoo' => { 'bar' => true } })\n  end","complexity_score":27.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_from_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"notbar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"notfoo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":111,"raw_source":"def test_nested_if\n    assert_template_result('', '{% if false %}{% if false %} NO {% endif %}{% endif %}')\n    assert_template_result('', '{% if false %}{% if true %} NO {% endif %}{% endif %}')\n    assert_template_result('', '{% if true %}{% if false %} NO {% endif %}{% endif %}')\n    assert_template_result(' YES ', '{% if true %}{% if true %} YES {% endif %}{% endif %}')\n\n    assert_template_result(' YES ', '{% if true %}{% if true %} YES {% else %} NO {% endif %}{% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if true %}{% if false %} NO {% else %} YES {% endif %}{% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if false %}{% if true %} NO {% else %} NONO {% endif %}{% else %} YES {% endif %}')\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if false %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if true %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if false %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if true %} YES {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if true %} YES {% else %} NO {% endif %}{% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if false %} NO {% else %} YES {% endif %}{% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if true %} NO {% else %} NONO {% endif %}{% else %} YES {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":122,"raw_source":"def test_comparisons_on_null\n    assert_template_result('', '{% if null < 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null <= 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null >= 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null > 10 %} NO {% endif %}')\n\n    assert_template_result('', '{% if 10 < null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 <= null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 >= null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 > null %} NO {% endif %}')\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparisons_on_null\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null < 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null <= 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null >= 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null > 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 < null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 <= null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 >= null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 > null %} NO {% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":134,"raw_source":"def test_else_if\n    assert_template_result('0', '{% if 0 == 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}')\n    assert_template_result('1', '{% if 0 != 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}')\n    assert_template_result('2', '{% if 0 != 0 %}0{% elsif 1 != 1%}1{% else %}2{% endif %}')\n\n    assert_template_result('elsif', '{% if false %}if{% elsif true %}elsif{% endif %}')\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_else_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{% if 0 == 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% if 0 != 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% if 0 != 0 %}0{% elsif 1 != 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"elsif\"]},{\"type\":\"str\",\"children\":[\"{% if false %}if{% elsif true %}elsif{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":142,"raw_source":"def test_syntax_error_no_variable\n    assert_raises(SyntaxError) { assert_template_result('', '{% if jerry == 1 %}') }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_no_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if jerry == 1 %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":146,"raw_source":"def test_syntax_error_no_expression\n    assert_raises(SyntaxError) { assert_template_result('', '{% if %}') }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_no_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":150,"raw_source":"def test_if_with_custom_condition\n    original_op = Condition.operators['contains']\n    Condition.operators['contains'] = :[]\n\n    assert_template_result('yes', %({% if 'bob' contains 'o' %}yes{% endif %}))\n    assert_template_result('no', %({% if 'bob' contains 'f' %}yes{% else %}no{% endif %}))\n  ensure\n    Condition.operators['contains'] = original_op\n  end","complexity_score":9.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_with_custom_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_op\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]\",{\"type\":\"str\",\"children\":[\"contains\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"str\",\"children\":[\"{% if 'bob' contains 'o' %}yes{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"no\"]},{\"type\":\"str\",\"children\":[\"{% if 'bob' contains 'f' %}yes{% else %}no{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"lvar\",\"children\":[\"original_op\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":160,"raw_source":"def test_operators_are_ignored_unless_isolated\n    original_op = Condition.operators['contains']\n    Condition.operators['contains'] = :[]\n\n    assert_template_result(\n      'yes',\n      %({% if 'gnomeslab-and-or-liquid' contains 'gnomeslab-and-or-liquid' %}yes{% endif %}),\n    )\n  ensure\n    Condition.operators['contains'] = original_op\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_operators_are_ignored_unless_isolated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_op\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]\",{\"type\":\"str\",\"children\":[\"contains\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"str\",\"children\":[\"{% if 'gnomeslab-and-or-liquid' contains 'gnomeslab-and-or-liquid' %}yes{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"lvar\",\"children\":[\"original_op\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":172,"raw_source":"def test_operators_are_whitelisted\n    assert_raises(SyntaxError) do\n      assert_template_result('', %({% if 1 or throw or or 1 %}yes{% endif %}))\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_operators_are_whitelisted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 1 or throw or or 1 %}yes{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":178,"raw_source":"def test_multiple_conditions\n    tpl = \"{% if a or b and c %}true{% else %}false{% endif %}\"\n\n    tests = {\n      [true, true, true] => true,\n      [true, true, false] => true,\n      [true, false, true] => true,\n      [true, false, false] => true,\n      [false, true, true] => true,\n      [false, true, false] => false,\n      [false, false, true] => false,\n      [false, false, false] => false,\n    }\n\n    tests.each do |vals, expected|\n      a, b, c = vals\n      assigns = { 'a' => a, 'b' => b, 'c' => c }\n      assert_template_result(expected.to_s, tpl, assigns, message: assigns.to_s)\n    end\n  end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_conditions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tpl\",{\"type\":\"str\",\"children\":[\"{% if a or b and c %}true{% else %}false{% endif %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"tests\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"vals\"]},{\"type\":\"arg\",\"children\":[\"expected\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\"]},{\"type\":\"lvasgn\",\"children\":[\"b\"]},{\"type\":\"lvasgn\",\"children\":[\"c\"]}]},{\"type\":\"lvar\",\"children\":[\"vals\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expected\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"tpl\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"to_s\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":11,"raw_source":"def read_template_file(template_path)\n    PARTIALS[template_path] || template_path\n  end","complexity_score":2.1,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PARTIALS\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":17,"raw_source":"def read_template_file(_template_path)\n    'from OtherFileSystem'\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"str\",\"children\":[\"from OtherFileSystem\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":24,"raw_source":"def read_template_file(_template_path)\n    @count ||= 0\n    @count  += 1\n    'from CountingFileSystem'\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":34,"raw_source":"def initialize(tag_name, markup, tokens)\n    markup =~ Syntax\n    @template_name = Regexp.last_match(1)\n    super\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":40,"raw_source":"def parse(tokens)\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":43,"raw_source":"def render_to_output_buffer(_context, output)\n    output << @template_name[1..-2]\n    output\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_name\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":52,"raw_source":"def test_include_tag_looks_for_file_system_in_registers_first\n    assert_equal(\n      'from OtherFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: OtherFileSystem.new }),\n    )\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_looks_for_file_system_in_registers_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from OtherFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OtherFileSystem\"]},\"new\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":59,"raw_source":"def test_include_tag_with\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% include 'product' with products[0] %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: { \"product\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% include 'product' with products[0] %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":68,"raw_source":"def test_include_tag_with_alias\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% include 'product_alias' with products[0] as product %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: { \"product_alias\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with_alias\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% include 'product_alias' with products[0] as product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":77,"raw_source":"def test_include_tag_for_alias\n    assert_template_result(\n      \"Product: Draft 151cm Product: Element 155cm \",\n      \"{% include 'product_alias' for products as product %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: { \"product_alias\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_for_alias\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm Product: Element 155cm \"]},{\"type\":\"str\",\"children\":[\"{% include 'product_alias' for products as product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":86,"raw_source":"def test_include_tag_with_default_name\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% include 'product' %}\",\n      { \"product\" => { 'title' => 'Draft 151cm' } },\n      partials: { \"product\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with_default_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% include 'product' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":95,"raw_source":"def test_include_tag_for\n    assert_template_result(\n      \"Product: Draft 151cm Product: Element 155cm \",\n      \"{% include 'product' for products %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: { \"product\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm Product: Element 155cm \"]},{\"type\":\"str\",\"children\":[\"{% include 'product' for products %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":104,"raw_source":"def test_include_tag_with_local_variables\n    assert_template_result(\n      \"Locale: test123 \",\n      \"{% include 'locale_variables' echo1: 'test123' %}\",\n      partials: { \"locale_variables\" => \"Locale: {{echo1}} {{echo2}}\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with_local_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Locale: test123 \"]},{\"type\":\"str\",\"children\":[\"{% include 'locale_variables' echo1: 'test123' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"locale_variables\"]},{\"type\":\"str\",\"children\":[\"Locale: {{echo1}} {{echo2}}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":112,"raw_source":"def test_include_tag_with_multiple_local_variables\n    assert_template_result(\n      \"Locale: test123 test321\",\n      \"{% include 'locale_variables' echo1: 'test123', echo2: 'test321' %}\",\n      partials: { \"locale_variables\" => \"Locale: {{echo1}} {{echo2}}\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with_multiple_local_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Locale: test123 test321\"]},{\"type\":\"str\",\"children\":[\"{% include 'locale_variables' echo1: 'test123', echo2: 'test321' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"locale_variables\"]},{\"type\":\"str\",\"children\":[\"Locale: {{echo1}} {{echo2}}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":120,"raw_source":"def test_include_tag_with_multiple_local_variables_from_context\n    assert_template_result(\n      \"Locale: test123 test321\",\n      \"{% include 'locale_variables' echo1: echo1, echo2: more_echos.echo2 %}\",\n      { 'echo1' => 'test123', 'more_echos' => { \"echo2\" => 'test321' } },\n      partials: { \"locale_variables\" => \"Locale: {{echo1}} {{echo2}}\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_with_multiple_local_variables_from_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Locale: test123 test321\"]},{\"type\":\"str\",\"children\":[\"{% include 'locale_variables' echo1: echo1, echo2: more_echos.echo2 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"echo1\"]},{\"type\":\"str\",\"children\":[\"test123\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"more_echos\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"echo2\"]},{\"type\":\"str\",\"children\":[\"test321\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"locale_variables\"]},{\"type\":\"str\",\"children\":[\"Locale: {{echo1}} {{echo2}}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":129,"raw_source":"def test_included_templates_assigns_variables\n    assert_template_result(\n      \"bar\",\n      \"{% include 'assignments' %}{{ foo }}\",\n      partials: { 'assignments' => \"{% assign foo = 'bar' %}\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_included_templates_assigns_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{% include 'assignments' %}{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"assignments\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = 'bar' %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":137,"raw_source":"def test_nested_include_tag\n    partials = { \"body\" => \"body {% include 'body_detail' %}\", \"body_detail\" => \"body_detail\" }\n    assert_template_result(\"body body_detail\", \"{% include 'body' %}\", partials: partials)\n\n    partials = partials.merge({\n      \"nested_template\" => \"{% include 'header' %} {% include 'body' %} {% include 'footer' %}\",\n      \"header\" => \"header\",\n      \"footer\" => \"footer\",\n    })\n    assert_template_result(\"header body body_detail footer\", \"{% include 'nested_template' %}\", partials: partials)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_include_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body\"]},{\"type\":\"str\",\"children\":[\"body {% include 'body_detail' %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body_detail\"]},{\"type\":\"str\",\"children\":[\"body_detail\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"body body_detail\"]},{\"type\":\"str\",\"children\":[\"{% include 'body' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partials\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested_template\"]},{\"type\":\"str\",\"children\":[\"{% include 'header' %} {% include 'body' %} {% include 'footer' %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"header\"]},{\"type\":\"str\",\"children\":[\"header\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"footer\"]},{\"type\":\"str\",\"children\":[\"footer\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"header body body_detail footer\"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":149,"raw_source":"def test_nested_include_with_variable\n    partials = {\n      \"nested_product_template\" => \"Product: {{ nested_product_template.title }} {%include 'details'%} \",\n      \"details\" => \"details\",\n    }\n\n    assert_template_result(\n      \"Product: Draft 151cm details \",\n      \"{% include 'nested_product_template' with product %}\",\n      { \"product\" => { \"title\" => 'Draft 151cm' } },\n      partials: partials,\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm details Product: Element 155cm details \",\n      \"{% include 'nested_product_template' for products %}\",\n      { \"products\" => [{ \"title\" => 'Draft 151cm' }, { \"title\" => 'Element 155cm' }] },\n      partials: partials,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_include_with_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested_product_template\"]},{\"type\":\"str\",\"children\":[\"Product: {{ nested_product_template.title }} {%include 'details'%} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"details\"]},{\"type\":\"str\",\"children\":[\"details\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm details \"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_product_template' with product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm details Product: Element 155cm details \"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_product_template' for products %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":170,"raw_source":"def test_recursively_included_template_does_not_produce_endless_loop\n    infinite_file_system = Class.new do\n      def read_template_file(_template_path)\n        \"-{% include 'loop' %}\"\n      end\n    end\n\n    env = Liquid::Environment.build(file_system: infinite_file_system.new)\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse(\"{% include 'loop' %}\", environment: env).render!\n    end\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recursively_included_template_does_not_produce_endless_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"infinite_file_system\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"str\",\"children\":[\"-{% include 'loop' %}\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"infinite_file_system\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'loop' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":172,"raw_source":"def read_template_file(_template_path)\n        \"-{% include 'loop' %}\"\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"str\",\"children\":[\"-{% include 'loop' %}\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":184,"raw_source":"def test_dynamically_choosen_template\n    assert_template_result(\n      \"Test123\",\n      \"{% include template %}\",\n      { \"template\" => 'Test123' },\n      partials: { \"Test123\" => \"Test123\" },\n    )\n\n    assert_template_result(\n      \"Test321\",\n      \"{% include template %}\",\n      { \"template\" => 'Test321' },\n      partials: { \"Test321\" => \"Test321\" },\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% include template for product %}\",\n      { \"template\" => 'product', 'product' => { 'title' => 'Draft 151cm' } },\n      partials: { \"product\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamically_choosen_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Test123\"]},{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"Test123\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Test123\"]},{\"type\":\"str\",\"children\":[\"Test123\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Test321\"]},{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"Test321\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Test321\"]},{\"type\":\"str\",\"children\":[\"Test321\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% include template for product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"product\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":207,"raw_source":"def test_include_tag_caches_second_read_of_same_partial\n    file_system = CountingFileSystem.new\n    environment = Liquid::Environment.build(file_system: file_system)\n    assert_equal(\n      'from CountingFileSystemfrom CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}{% include 'pick_a_source' %}\", environment: environment).render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.count)\n  end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_caches_second_read_of_same_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CountingFileSystem\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystemfrom CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}{% include 'pick_a_source' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":217,"raw_source":"def test_include_tag_doesnt_cache_partials_across_renders\n    file_system = CountingFileSystem.new\n    assert_equal(\n      'from CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.count)\n\n    assert_equal(\n      'from CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(2, file_system.count)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_doesnt_cache_partials_across_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CountingFileSystem\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":232,"raw_source":"def test_include_tag_within_if_statement\n    assert_template_result(\n      \"foo_if_true\",\n      \"{% if true %}{% include 'foo_if_true' %}{% endif %}\",\n      partials: { \"foo_if_true\" => \"foo_if_true\" },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_within_if_statement\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo_if_true\"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% include 'foo_if_true' %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo_if_true\"]},{\"type\":\"str\",\"children\":[\"foo_if_true\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":240,"raw_source":"def test_custom_include_tag\n    original_tag = Liquid::Template.tags['include']\n    Liquid::Template.tags['include'] = CustomInclude\n    begin\n      assert_equal(\n        \"custom_foo\",\n        Template.parse(\"{% include 'custom_foo' %}\").render!,\n      )\n    ensure\n      Liquid::Template.tags['include'] = original_tag\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_include_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"include\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"const\",\"children\":[null,\"CustomInclude\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"custom_foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'custom_foo' %}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"lvar\",\"children\":[\"original_tag\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":253,"raw_source":"def test_custom_include_tag_within_if_statement\n    original_tag = Liquid::Template.tags['include']\n    Liquid::Template.tags['include'] = CustomInclude\n    begin\n      assert_equal(\n        \"custom_foo_if_true\",\n        Template.parse(\"{% if true %}{% include 'custom_foo_if_true' %}{% endif %}\").render!,\n      )\n    ensure\n      Liquid::Template.tags['include'] = original_tag\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_include_tag_within_if_statement\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"include\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"const\",\"children\":[null,\"CustomInclude\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"custom_foo_if_true\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %}{% include 'custom_foo_if_true' %}{% endif %}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"lvar\",\"children\":[\"original_tag\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":266,"raw_source":"def test_does_not_add_error_in_strict_mode_for_missing_variable\n    env = Liquid::Environment.build(file_system: TestFileSystem.new)\n\n    a = Liquid::Template.parse(' {% include \"nested_template\" %}', environment: env)\n    a.render!\n    assert_empty(a.errors)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_add_error_in_strict_mode_for_missing_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% include \\\"nested_template\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_empty\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"errors\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":274,"raw_source":"def test_passing_options_to_included_templates\n    env = Liquid::Environment.build(file_system: TestFileSystem.new)\n\n    assert_raises(Liquid::SyntaxError) do\n      Template.parse(\"{% include template %}\", error_mode: :strict, environment: env).render!(\"template\" => '{{ \"X\" || downcase }}')\n    end\n    with_error_mode(:lax) do\n      assert_equal('x', Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: true, environment: env).render!(\"template\" => '{{ \"X\" || downcase }}'))\n    end\n    assert_raises(Liquid::SyntaxError) do\n      Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: [:locale], environment: env).render!(\"template\" => '{{ \"X\" || downcase }}')\n    end\n    with_error_mode(:lax) do\n      assert_equal('x', Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: [:error_mode], environment: env).render!(\"template\" => '{{ \"X\" || downcase }}'))\n    end\n  end","complexity_score":23.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_passing_options_to_included_templates\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":291,"raw_source":"def test_render_raise_argument_error_when_template_is_undefined\n    assert_template_result(\n      \"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\",\n      \"{% include undefined_variable %}\",\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\",\n      \"{% include nil %}\",\n      render_errors: true,\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_raise_argument_error_when_template_is_undefined\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\"]},{\"type\":\"str\",\"children\":[\"{% include undefined_variable %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\"]},{\"type\":\"str\",\"children\":[\"{% include nil %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":305,"raw_source":"def test_render_raise_argument_error_when_template_is_not_a_string\n    assert_template_result(\n      \"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\",\n      \"{% include 123 %}\",\n      render_errors: true,\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_raise_argument_error_when_template_is_not_a_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\"]},{\"type\":\"str\",\"children\":[\"{% include 123 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":313,"raw_source":"def test_including_via_variable_value\n    assert_template_result(\n      \"from TestFileSystem\",\n      \"{% assign page = 'pick_a_source' %}{% include page %}\",\n      partials: { \"pick_a_source\" => \"from TestFileSystem\" },\n    )\n\n    partials = { \"product\" => \"Product: {{ product.title }} \" }\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% assign page = 'product' %}{% include page %}\",\n      { \"product\" => { 'title' => 'Draft 151cm' } },\n      partials: partials,\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% assign page = 'product' %}{% include page for foo %}\",\n      { \"foo\" => { 'title' => 'Draft 151cm' } },\n      partials: partials,\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_including_via_variable_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"from TestFileSystem\"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'pick_a_source' %}{% include page %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"pick_a_source\"]},{\"type\":\"str\",\"children\":[\"from TestFileSystem\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'product' %}{% include page %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'product' %}{% include page for foo %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":337,"raw_source":"def test_including_with_strict_variables\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('simple' => 'simple'),\n    )\n\n    template = Liquid::Template.parse(\"{% include 'simple' %}\", error_mode: :warn, environment: env)\n    template.render(nil, strict_variables: true)\n\n    assert_equal([], template.errors)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_including_with_strict_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"simple\"]},{\"type\":\"str\",\"children\":[\"simple\"]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'simple' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict_variables\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":348,"raw_source":"def test_break_through_include\n    assert_template_result(\"1\", \"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\")\n    assert_template_result(\n      \"1\",\n      \"{% for i in (1..3) %}{{ i }}{% include 'break' %}{{ i }}{% endfor %}\",\n      partials: { 'break' => \"{% break %}\" },\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_through_include\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% include 'break' %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"break\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":357,"raw_source":"def test_render_tag_renders_error_with_template_name\n    assert_template_result(\n      'Liquid error (foo line 1): standard error',\n      \"{% include 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      render_errors: true,\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% include 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":367,"raw_source":"def test_render_tag_renders_error_with_template_name_from_template_factory\n    assert_template_result(\n      'Liquid error (some/path/foo line 1): standard error',\n      \"{% include 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      template_factory: StubTemplateFactory.new,\n      render_errors: true,\n    )\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% include 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/increment_tag_test.rb","start_line":8,"raw_source":"def test_inc\n    assert_template_result('0 1', '{%increment port %} {{ port }}')\n    assert_template_result(' 0 1 2', '{{port}} {%increment port %} {%increment port%} {{port}}')\n    assert_template_result(\n      '0 0 1 2 1',\n      '{%increment port %} {%increment starboard%} ' \\\n      '{%increment port %} {%increment port%} ' \\\n      '{%increment starboard %}',\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 1\"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {{ port }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0 1 2\"]},{\"type\":\"str\",\"children\":[\"{{port}} {%increment port %} {%increment port%} {{port}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 0 1 2 1\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment port%} \"]},{\"type\":\"str\",\"children\":[\"{%increment starboard %}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/increment_tag_test.rb","start_line":19,"raw_source":"def test_dec\n    assert_template_result('-1 -1', '{%decrement port %} {{ port }}', { 'port' => 10 })\n    assert_template_result(' -1 -2 -2', '{{port}} {%decrement port %} {%decrement port%} {{port}}')\n    assert_template_result(\n      '0 1 2 0 3 1 1 3',\n      '{%increment starboard %} {%increment starboard%} {%increment starboard%} ' \\\n      '{%increment port %} {%increment starboard%} ' \\\n      '{%increment port %} {%decrement port%} ' \\\n      '{%decrement starboard %}',\n    )\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dec\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-1 -1\"]},{\"type\":\"str\",\"children\":[\"{%decrement port %} {{ port }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"port\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" -1 -2 -2\"]},{\"type\":\"str\",\"children\":[\"{{port}} {%decrement port %} {%decrement port%} {{port}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 1 2 0 3 1 1 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%increment starboard %} {%increment starboard%} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%decrement port%} \"]},{\"type\":\"str\",\"children\":[\"{%decrement starboard %}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":8,"raw_source":"def test_inline_comment_returns_nothing\n    assert_template_result('', '{%- # this is an inline comment -%}')\n    assert_template_result('', '{%-# this is an inline comment -%}')\n    assert_template_result('', '{% # this is an inline comment %}')\n    assert_template_result('', '{%# this is an inline comment %}')\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_returns_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%- # this is an inline comment -%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%-# this is an inline comment -%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% # this is an inline comment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%# this is an inline comment %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":15,"raw_source":"def test_inline_comment_does_not_require_a_space_after_the_pound_sign\n    assert_template_result('', '{%#this is an inline comment%}')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_does_not_require_a_space_after_the_pound_sign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%#this is an inline comment%}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":19,"raw_source":"def test_liquid_inline_comment_returns_nothing\n    assert_template_result('Hey there, how are you doing today?', <<~LIQUID)\n      {%- liquid\n        # This is how you'd write a block comment in a liquid tag.\n        # It looks a lot like what you'd have in ruby.\n\n        # You can use it as inline documentation in your\n        # liquid blocks to explain why you're doing something.\n        echo \"Hey there, \"\n\n        # It won't affect the output.\n        echo \"how are you doing today?\"\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_inline_comment_returns_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hey there, how are you doing today?\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  # This is how you'd write a block comment in a liquid tag.\\n\"]},{\"type\":\"str\",\"children\":[\"  # It looks a lot like what you'd have in ruby.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  # You can use it as inline documentation in your\\n\"]},{\"type\":\"str\",\"children\":[\"  # liquid blocks to explain why you're doing something.\\n\"]},{\"type\":\"str\",\"children\":[\"  echo \\\"Hey there, \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  # It won't affect the output.\\n\"]},{\"type\":\"str\",\"children\":[\"  echo \\\"how are you doing today?\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":35,"raw_source":"def test_inline_comment_can_be_written_on_multiple_lines\n    assert_template_result('', <<~LIQUID)\n      {%-\n        # That kind of block comment is also allowed.\n        # It would only be a stylistic difference.\n\n        # Much like JavaScript's /* */ comments and their\n        # leading * on new lines.\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_can_be_written_on_multiple_lines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%-\\n\"]},{\"type\":\"str\",\"children\":[\"  # That kind of block comment is also allowed.\\n\"]},{\"type\":\"str\",\"children\":[\"  # It would only be a stylistic difference.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  # Much like JavaScript's /* */ comments and their\\n\"]},{\"type\":\"str\",\"children\":[\"  # leading * on new lines.\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":47,"raw_source":"def test_inline_comment_multiple_pound_signs\n    assert_template_result('', <<~LIQUID)\n      {%- liquid\n        ######################################\n        # We support comments like this too. #\n        ######################################\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_multiple_pound_signs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  ######################################\\n\"]},{\"type\":\"str\",\"children\":[\"  # We support comments like this too. #\\n\"]},{\"type\":\"str\",\"children\":[\"  ######################################\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":57,"raw_source":"def test_inline_comments_require_the_pound_sign_on_every_new_line\n    assert_match_syntax_error(\"Each line of comments must be prefixed by the '#' character\", <<~LIQUID)\n      {%-\n        # some comment\n        echo 'hello world'\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comments_require_the_pound_sign_on_every_new_line\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Each line of comments must be prefixed by the '#' character\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%-\\n\"]},{\"type\":\"str\",\"children\":[\"  # some comment\\n\"]},{\"type\":\"str\",\"children\":[\"  echo 'hello world'\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":66,"raw_source":"def test_inline_comment_does_not_support_nested_tags\n    assert_template_result(' -%}', \"{%- # {% echo 'hello world' %} -%}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_does_not_support_nested_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" -%}\"]},{\"type\":\"str\",\"children\":[\"{%- # {% echo 'hello world' %} -%}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":8,"raw_source":"def test_liquid_tag\n    assert_template_result('1 2 3', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        echo array | join: \" \"\n      -%}\n    LIQUID\n\n    assert_template_result('1 2 3', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        for value in array\n          echo value\n          unless forloop.last\n            echo \" \"\n          endunless\n        endfor\n      -%}\n    LIQUID\n\n    assert_template_result('4 8 12 6', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        for value in array\n          assign double_value = value | times: 2\n          echo double_value | times: 2\n          unless forloop.last\n            echo \" \"\n          endunless\n        endfor\n\n        echo \" \"\n        echo double_value\n      -%}\n    LIQUID\n\n    assert_template_result('abc', <<~LIQUID)\n      {%- liquid echo \"a\" -%}\n      b\n      {%- liquid echo \"c\" -%}\n    LIQUID\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  echo array | join: \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    echo value\\n\"]},{\"type\":\"str\",\"children\":[\"    unless forloop.last\\n\"]},{\"type\":\"str\",\"children\":[\"      echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"    endunless\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4 8 12 6\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    assign double_value = value | times: 2\\n\"]},{\"type\":\"str\",\"children\":[\"    echo double_value | times: 2\\n\"]},{\"type\":\"str\",\"children\":[\"    unless forloop.last\\n\"]},{\"type\":\"str\",\"children\":[\"      echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"    endunless\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"  echo double_value\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid echo \\\"a\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"b\\n\"]},{\"type\":\"str\",\"children\":[\"{%- liquid echo \\\"c\\\" -%}\\n\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":48,"raw_source":"def test_liquid_tag_errors\n    assert_match_syntax_error(\"syntax error (line 1): Unknown tag 'error'\", <<~LIQUID)\n      {%- liquid error no such tag -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 7): Unknown tag 'error'\", <<~LIQUID)\n      {{ test }}\n\n      {%-\n      liquid\n        for value in array\n\n          error no such tag\n        endfor\n      -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 2): Unknown tag '!!! the guards are vigilant'\", <<~LIQUID)\n      {%- liquid\n        !!! the guards are vigilant\n      -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 4): 'for' tag was never closed\", <<~LIQUID)\n      {%- liquid\n        for value in array\n          echo 'forgot to close the for tag'\n      -%}\n    LIQUID\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_tag_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 1): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{%- liquid error no such tag -%}\\n\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 7): Unknown tag 'error'\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{ test }}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{%-\\n\"]},{\"type\":\"str\",\"children\":[\"liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    error no such tag\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 2): Unknown tag '!!! the guards are vigilant'\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  !!! the guards are vigilant\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 4): 'for' tag was never closed\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    echo 'forgot to close the for tag'\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":79,"raw_source":"def test_line_number_is_correct_after_a_blank_token\n    assert_match_syntax_error(\"syntax error (line 3): Unknown tag 'error'\", \"{% liquid echo ''\\n\\n error %}\")\n    assert_match_syntax_error(\"syntax error (line 3): Unknown tag 'error'\", \"{% liquid echo ''\\n  \\n error %}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_line_number_is_correct_after_a_blank_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{% liquid echo ''\\n\\n error %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{% liquid echo ''\\n  \\n error %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":84,"raw_source":"def test_nested_liquid_tag\n    assert_template_result('good', <<~LIQUID)\n      {%- if true %}\n        {%- liquid\n          echo \"good\"\n        %}\n      {%- endif -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"good\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"    echo \\\"good\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"  %}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endif -%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":94,"raw_source":"def test_cannot_open_blocks_living_past_a_liquid_tag\n    assert_match_syntax_error(\"syntax error (line 3): 'if' tag was never closed\", <<~LIQUID)\n      {%- liquid\n        if true\n      -%}\n      {%- endif -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cannot_open_blocks_living_past_a_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): 'if' tag was never closed\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  if true\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endif -%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":103,"raw_source":"def test_cannot_close_blocks_created_before_a_liquid_tag\n    assert_match_syntax_error(\"syntax error (line 3): 'endif' is not a valid delimiter for liquid tags. use %}\", <<~LIQUID)\n      {%- if true -%}\n      42\n      {%- liquid endif -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cannot_close_blocks_created_before_a_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): 'endif' is not a valid delimiter for liquid tags. use %}\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"42\\n\"]},{\"type\":\"str\",\"children\":[\"{%- liquid endif -%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":111,"raw_source":"def test_liquid_tag_in_raw\n    assert_template_result(\"{% liquid echo 'test' %}\\n\", <<~LIQUID)\n      {% raw %}{% liquid echo 'test' %}{% endraw %}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_tag_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{% liquid echo 'test' %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% raw %}{% liquid echo 'test' %}{% endraw %}\\n\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":117,"raw_source":"def test_nested_liquid_tags\n    assert_template_result('good', <<~LIQUID)\n      {%- liquid\n        liquid\n          if true\n            echo \"good\"\n          endif\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_liquid_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"good\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  liquid\\n\"]},{\"type\":\"str\",\"children\":[\"    if true\\n\"]},{\"type\":\"str\",\"children\":[\"      echo \\\"good\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"    endif\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":128,"raw_source":"def test_nested_liquid_tags_on_same_line\n    assert_template_result('good', <<~LIQUID)\n      {%- liquid liquid liquid echo \"good\" -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_liquid_tags_on_same_line\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"good\"]},{\"type\":\"str\",\"children\":[\"{%- liquid liquid liquid echo \\\"good\\\" -%}\\n\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":134,"raw_source":"def test_nested_liquid_liquid_is_not_skipped_if_used_in_non_tag_position\n    assert_template_result('liquid', <<~LIQUID, { 'liquid' => 'liquid' })\n      {%- liquid liquid liquid echo liquid -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_liquid_liquid_is_not_skipped_if_used_in_non_tag_position\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"liquid\"]},{\"type\":\"str\",\"children\":[\"{%- liquid liquid liquid echo liquid -%}\\n\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"liquid\"]},{\"type\":\"str\",\"children\":[\"liquid\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":140,"raw_source":"def test_next_liquid_with_unclosed_if_tag\n    assert_match_syntax_error(\"Liquid syntax error (line 2): 'if' tag was never closed\", <<~LIQUID)\n      {%- liquid\n        liquid if true\n          echo \"good\"\n        endif\n      -%}\n    LIQUID\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_next_liquid_with_unclosed_if_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 2): 'if' tag was never closed\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  liquid if true\\n\"]},{\"type\":\"str\",\"children\":[\"    echo \\\"good\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"  endif\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":8,"raw_source":"def test_tag_in_raw\n    assert_template_result(\n      '{% comment %} test {% endcomment %}',\n      '{% raw %}{% comment %} test {% endcomment %}{% endraw %}',\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{% comment %} test {% endcomment %}\"]},{\"type\":\"str\",\"children\":[\"{% raw %}{% comment %} test {% endcomment %}{% endraw %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":15,"raw_source":"def test_output_in_raw\n    assert_template_result('>{{ test }}<', '> {%- raw -%}{{ test }}{%- endraw -%} <')\n    assert_template_result(\"> inner  <\", \"> {%- raw -%} inner {%- endraw %} <\")\n    assert_template_result(\"> inner <\", \"> {%- raw -%} inner {%- endraw -%} <\")\n    assert_template_result(\"{Hello}\", \"{% raw %}{{% endraw %}Hello{% raw %}}{% endraw %}\")\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_output_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\">{{ test }}<\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%}{{ test }}{%- endraw -%} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"> inner  <\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%} inner {%- endraw %} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"> inner <\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%} inner {%- endraw -%} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{Hello}\"]},{\"type\":\"str\",\"children\":[\"{% raw %}{{% endraw %}Hello{% raw %}}{% endraw %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":22,"raw_source":"def test_open_tag_in_raw\n    assert_template_result(' Foobar {% invalid ', '{% raw %} Foobar {% invalid {% endraw %}')\n    assert_template_result(' Foobar invalid %} ', '{% raw %} Foobar invalid %} {% endraw %}')\n    assert_template_result(' Foobar {{ invalid ', '{% raw %} Foobar {{ invalid {% endraw %}')\n    assert_template_result(' Foobar invalid }} ', '{% raw %} Foobar invalid }} {% endraw %}')\n    assert_template_result(' Foobar {% invalid {% {% endraw ', '{% raw %} Foobar {% invalid {% {% endraw {% endraw %}')\n    assert_template_result(' Foobar {% {% {% ', '{% raw %} Foobar {% {% {% {% endraw %}')\n    assert_template_result(' test {% raw %} {% endraw %}', '{% raw %} test {% raw %} {% {% endraw %}endraw %}')\n    assert_template_result(' Foobar {{ invalid 1', '{% raw %} Foobar {{ invalid {% endraw %}{{ 1 }}')\n    assert_template_result(' Foobar {% foo {% bar %}', '{% raw %} Foobar {% foo {% bar %}{% endraw %}')\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_open_tag_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% invalid \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% invalid {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar invalid %} \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar invalid %} {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {{ invalid \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {{ invalid {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar invalid }} \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar invalid }} {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% invalid {% {% endraw \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% invalid {% {% endraw {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% {% {% \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% {% {% {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" test {% raw %} {% endraw %}\"]},{\"type\":\"str\",\"children\":[\"{% raw %} test {% raw %} {% {% endraw %}endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {{ invalid 1\"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {{ invalid {% endraw %}{{ 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% foo {% bar %}\"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% foo {% bar %}{% endraw %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":34,"raw_source":"def test_invalid_raw\n    assert_match_syntax_error(/tag was never closed/, '{% raw %} foo')\n    assert_match_syntax_error(/Valid syntax/, '{% raw } foo {% endraw %}')\n    assert_match_syntax_error(/Valid syntax/, '{% raw } foo %}{% endraw %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"tag was never closed\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw %} foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Valid syntax\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw } foo {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Valid syntax\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw } foo %}{% endraw %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":8,"raw_source":"def test_render_with_no_arguments\n    assert_template_result(\n      'rendered content',\n      '{% render \"source\" %}',\n      partials: { 'source' => 'rendered content' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_with_no_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"rendered content\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"source\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"rendered content\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":16,"raw_source":"def test_render_tag_looks_for_file_system_in_registers_first\n    assert_template_result(\n      'from register file system',\n      '{% render \"pick_a_source\" %}',\n      partials: { 'pick_a_source' => 'from register file system' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_looks_for_file_system_in_registers_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"from register file system\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"pick_a_source\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"pick_a_source\"]},{\"type\":\"str\",\"children\":[\"from register file system\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":24,"raw_source":"def test_render_passes_named_arguments_into_inner_scope\n    assert_template_result(\n      'My Product',\n      '{% render \"product\", inner_product: outer_product %}',\n      { 'outer_product' => { 'title' => 'My Product' } },\n      partials: { 'product' => '{{ inner_product.title }}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_passes_named_arguments_into_inner_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"My Product\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"product\\\", inner_product: outer_product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer_product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"My Product\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"{{ inner_product.title }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":33,"raw_source":"def test_render_accepts_literals_as_arguments\n    assert_template_result(\n      '123',\n      '{% render \"snippet\", price: 123 %}',\n      partials: { 'snippet' => '{{ price }}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_accepts_literals_as_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\", price: 123 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"{{ price }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":41,"raw_source":"def test_render_accepts_multiple_named_arguments\n    assert_template_result(\n      '1 2',\n      '{% render \"snippet\", one: 1, two: 2 %}',\n      partials: { 'snippet' => '{{ one }} {{ two }}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_accepts_multiple_named_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\", one: 1, two: 2 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"{{ one }} {{ two }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":49,"raw_source":"def test_render_does_not_inherit_parent_scope_variables\n    assert_template_result(\n      '',\n      '{% assign outer_variable = \"should not be visible\" %}{% render \"snippet\" %}',\n      partials: { 'snippet' => '{{ outer_variable }}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_does_not_inherit_parent_scope_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign outer_variable = \\\"should not be visible\\\" %}{% render \\\"snippet\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"{{ outer_variable }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":57,"raw_source":"def test_render_does_not_inherit_variable_with_same_name_as_snippet\n    assert_template_result(\n      '',\n      \"{% assign snippet = 'should not be visible' %}{% render 'snippet' %}\",\n      partials: { 'snippet' => '{{ snippet }}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_does_not_inherit_variable_with_same_name_as_snippet\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign snippet = 'should not be visible' %}{% render 'snippet' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"{{ snippet }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":65,"raw_source":"def test_render_does_not_mutate_parent_scope\n    assert_template_result(\n      '',\n      \"{% render 'snippet' %}{{ inner }}\",\n      partials: { 'snippet' => '{% assign inner = 1 %}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_does_not_mutate_parent_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% render 'snippet' %}{{ inner }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"{% assign inner = 1 %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":73,"raw_source":"def test_nested_render_tag\n    assert_template_result(\n      'one two',\n      \"{% render 'one' %}\",\n      partials: {\n        'one' => \"one {% render 'two' %}\",\n        'two' => 'two',\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_render_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one two\"]},{\"type\":\"str\",\"children\":[\"{% render 'one' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"one {% render 'two' %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"two\"]},{\"type\":\"str\",\"children\":[\"two\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":84,"raw_source":"def test_recursively_rendered_template_does_not_produce_endless_loop\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('loop' => '{% render \"loop\" %}'),\n    )\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse('{% render \"loop\" %}', environment: env).render!\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recursively_rendered_template_does_not_produce_endless_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"loop\\\" %}\"]}]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"loop\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":94,"raw_source":"def test_sub_contexts_count_towards_the_same_recursion_limit\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('loop_render' => '{% render \"loop_render\" %}'),\n    )\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse('{% render \"loop_render\" %}', environment: env).render!\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sub_contexts_count_towards_the_same_recursion_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop_render\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"loop_render\\\" %}\"]}]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"loop_render\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":104,"raw_source":"def test_dynamically_choosen_templates_are_not_allowed\n    assert_syntax_error(\"{% assign name = 'snippet' %}{% render name %}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamically_choosen_templates_are_not_allowed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_syntax_error\",{\"type\":\"str\",\"children\":[\"{% assign name = 'snippet' %}{% render name %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":108,"raw_source":"def test_include_tag_caches_second_read_of_same_partial\n    file_system = StubFileSystem.new('snippet' => 'echo')\n    assert_equal(\n      'echoecho',\n      Template.parse('{% render \"snippet\" %}{% render \"snippet\" %}')\n      .render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_caches_second_read_of_same_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"echo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"echoecho\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}{% render \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":118,"raw_source":"def test_render_tag_doesnt_cache_partials_across_renders\n    file_system = StubFileSystem.new('snippet' => 'my message')\n\n    assert_equal(\n      'my message',\n      Template.parse('{% include \"snippet\" %}').render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.file_read_count)\n\n    assert_equal(\n      'my message',\n      Template.parse('{% include \"snippet\" %}').render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(2, file_system.file_read_count)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_doesnt_cache_partials_across_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"my message\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":134,"raw_source":"def test_render_tag_within_if_statement\n    assert_template_result(\n      'my message',\n      '{% if true %}{% render \"snippet\" %}{% endif %}',\n      partials: { 'snippet' => 'my message' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_within_if_statement\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"my message\"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% render \\\"snippet\\\" %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"my message\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":142,"raw_source":"def test_break_through_render\n    options = { partials: { 'break' => '{% break %}' } }\n    assert_template_result('1', '{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}', **options)\n    assert_template_result('112233', '{% for i in (1..3) %}{{ i }}{% render \"break\" %}{{ i }}{% endfor %}', **options)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_through_render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"break\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"112233\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% render \\\"break\\\" %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":148,"raw_source":"def test_increment_is_isolated_between_renders\n    assert_template_result(\n      '010',\n      '{% increment %}{% increment %}{% render \"incr\" %}',\n      partials: { 'incr' => '{% increment %}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_increment_is_isolated_between_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"010\"]},{\"type\":\"str\",\"children\":[\"{% increment %}{% increment %}{% render \\\"incr\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"incr\"]},{\"type\":\"str\",\"children\":[\"{% increment %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":156,"raw_source":"def test_decrement_is_isolated_between_renders\n    assert_template_result(\n      '-1-2-1',\n      '{% decrement %}{% decrement %}{% render \"decr\" %}',\n      partials: { 'decr' => '{% decrement %}' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_decrement_is_isolated_between_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-1-2-1\"]},{\"type\":\"str\",\"children\":[\"{% decrement %}{% decrement %}{% render \\\"decr\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"decr\"]},{\"type\":\"str\",\"children\":[\"{% decrement %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":164,"raw_source":"def test_includes_will_not_render_inside_render_tag\n    assert_template_result(\n      'Liquid error (test_include line 1): include usage is not allowed in this context',\n      '{% render \"test_include\" %}',\n      render_errors: true,\n      partials: {\n        'foo' => 'bar',\n        'test_include' => '{% include \"foo\" %}',\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_includes_will_not_render_inside_render_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (test_include line 1): include usage is not allowed in this context\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"test_include\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test_include\"]},{\"type\":\"str\",\"children\":[\"{% include \\\"foo\\\" %}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":176,"raw_source":"def test_includes_will_not_render_inside_nested_sibling_tags\n    assert_template_result(\n      \"Liquid error (test_include line 1): include usage is not allowed in this context\" \\\n        \"Liquid error (nested_render_with_sibling_include line 1): include usage is not allowed in this context\",\n      '{% render \"nested_render_with_sibling_include\" %}',\n      partials: {\n        'foo' => 'bar',\n        'nested_render_with_sibling_include' => '{% render \"test_include\" %}{% include \"foo\" %}',\n        'test_include' => '{% include \"foo\" %}',\n      },\n      render_errors: true,\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_includes_will_not_render_inside_nested_sibling_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid error (test_include line 1): include usage is not allowed in this context\"]},{\"type\":\"str\",\"children\":[\"Liquid error (nested_render_with_sibling_include line 1): include usage is not allowed in this context\"]}]},{\"type\":\"str\",\"children\":[\"{% render \\\"nested_render_with_sibling_include\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested_render_with_sibling_include\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"test_include\\\" %}{% include \\\"foo\\\" %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test_include\"]},{\"type\":\"str\",\"children\":[\"{% include \\\"foo\\\" %}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":190,"raw_source":"def test_render_tag_with\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% render 'product' with products[0] %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: {\n        'product' => \"Product: {{ product.title }} \",\n        'product_alias' => \"Product: {{ product.title }} \",\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% render 'product' with products[0] %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":202,"raw_source":"def test_render_tag_with_alias\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% render 'product_alias' with products[0] as product %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: {\n        'product' => \"Product: {{ product.title }} \",\n        'product_alias' => \"Product: {{ product.title }} \",\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_with_alias\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% render 'product_alias' with products[0] as product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":214,"raw_source":"def test_render_tag_for_alias\n    assert_template_result(\n      \"Product: Draft 151cm Product: Element 155cm \",\n      \"{% render 'product_alias' for products as product %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: {\n        'product' => \"Product: {{ product.title }} \",\n        'product_alias' => \"Product: {{ product.title }} \",\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_for_alias\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm Product: Element 155cm \"]},{\"type\":\"str\",\"children\":[\"{% render 'product_alias' for products as product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":226,"raw_source":"def test_render_tag_for\n    assert_template_result(\n      \"Product: Draft 151cm Product: Element 155cm \",\n      \"{% render 'product' for products %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: {\n        'product' => \"Product: {{ product.title }} \",\n        'product_alias' => \"Product: {{ product.title }} \",\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm Product: Element 155cm \"]},{\"type\":\"str\",\"children\":[\"{% render 'product' for products %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product_alias\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":238,"raw_source":"def test_render_tag_forloop\n    assert_template_result(\n      \"Product: Draft 151cm first  index:1 Product: Element 155cm  last index:2 \",\n      \"{% render 'product' for products %}\",\n      { \"products\" => [{ 'title' => 'Draft 151cm' }, { 'title' => 'Element 155cm' }] },\n      partials: {\n        'product' => \"Product: {{ product.title }} {% if forloop.first %}first{% endif %} {% if forloop.last %}last{% endif %} index:{{ forloop.index }} \",\n      },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_forloop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm first  index:1 Product: Element 155cm  last index:2 \"]},{\"type\":\"str\",\"children\":[\"{% render 'product' for products %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} {% if forloop.first %}first{% endif %} {% if forloop.last %}last{% endif %} index:{{ forloop.index }} \"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":249,"raw_source":"def test_render_tag_for_drop\n    assert_template_result(\n      \"123\",\n      \"{% render 'loop' for loop as value %}\",\n      { \"loop\" => TestEnumerable.new },\n      partials: {\n        'loop' => \"{{ value.foo }}\",\n      },\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_for_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% render 'loop' for loop as value %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{{ value.foo }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":260,"raw_source":"def test_render_tag_with_drop\n    assert_template_result(\n      \"TestEnumerable\",\n      \"{% render 'loop' with loop as value %}\",\n      { \"loop\" => TestEnumerable.new },\n      partials: {\n        'loop' => \"{{ value }}\",\n      },\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_with_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"TestEnumerable\"]},{\"type\":\"str\",\"children\":[\"{% render 'loop' with loop as value %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{{ value }}\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":271,"raw_source":"def test_render_tag_renders_error_with_template_name\n    assert_template_result(\n      'Liquid error (foo line 1): standard error',\n      \"{% render 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      render_errors: true,\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% render 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":281,"raw_source":"def test_render_tag_renders_error_with_template_name_from_template_factory\n    assert_template_result(\n      'Liquid error (some/path/foo line 1): standard error',\n      \"{% render 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      template_factory: StubTemplateFactory.new,\n      render_errors: true,\n    )\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% render 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":8,"raw_source":"def test_no_transform\n    assert_template_result(\n      'this text should come out of the template without change...',\n      'this text should come out of the template without change...',\n    )\n\n    assert_template_result('blah', 'blah')\n    assert_template_result('<blah>', '<blah>')\n    assert_template_result('|,.:', '|,.:')\n    assert_template_result('', '')\n\n    text = %(this shouldnt see any transformation either but has multiple lines\n              as you can clearly see here ...)\n    assert_template_result(text, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_transform\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"this text should come out of the template without change...\"]},{\"type\":\"str\",\"children\":[\"this text should come out of the template without change...\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"blah\"]},{\"type\":\"str\",\"children\":[\"blah\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<blah>\"]},{\"type\":\"str\",\"children\":[\"<blah>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"|,.:\"]},{\"type\":\"str\",\"children\":[\"|,.:\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"this shouldnt see any transformation either but has multiple lines\\n\"]},{\"type\":\"str\",\"children\":[\"              as you can clearly see here ...\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":24,"raw_source":"def test_has_a_block_which_does_nothing\n    assert_template_result(\n      %(the comment block should be removed  .. right?),\n      %(the comment block should be removed {%comment%} be gone.. {%endcomment%} .. right?),\n    )\n\n    assert_template_result('', '{%comment%}{%endcomment%}')\n    assert_template_result('', '{%comment%}{% endcomment %}')\n    assert_template_result('', '{% comment %}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% endcomment %}')\n    assert_template_result('', '{%comment%}comment{%endcomment%}')\n    assert_template_result('', '{% comment %}comment{% endcomment %}')\n    assert_template_result('', '{% comment %} 1 {% comment %} 2 {% endcomment %} 3 {% endcomment %}')\n\n    assert_template_result('', '{%comment%}{%blabla%}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% blabla %}{% endcomment %}')\n    assert_template_result('', '{%comment%}{% endif %}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% endwhatever %}{% endcomment %}')\n    assert_template_result('', '{% comment %}{% raw %} {{%%%%}}  }} { {% endcomment %} {% comment {% endraw %} {% endcomment %}')\n    assert_template_result('', '{% comment %}{% \" %}{% endcomment %}')\n    assert_template_result('', '{% comment %}{%%}{% endcomment %}')\n\n    assert_template_result('foobar', 'foo{%comment%}comment{%endcomment%}bar')\n    assert_template_result('foobar', 'foo{% comment %}comment{% endcomment %}bar')\n    assert_template_result('foobar', 'foo{%comment%} comment {%endcomment%}bar')\n    assert_template_result('foobar', 'foo{% comment %} comment {% endcomment %}bar')\n\n    assert_template_result('foo  bar', 'foo {%comment%} {%endcomment%} bar')\n    assert_template_result('foo  bar', 'foo {%comment%}comment{%endcomment%} bar')\n    assert_template_result('foo  bar', 'foo {%comment%} comment {%endcomment%} bar')\n\n    assert_template_result('foobar', 'foo{%comment%}\n                                     {%endcomment%}bar')\n  end","complexity_score":23.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_a_block_which_does_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"the comment block should be removed  .. right?\"]},{\"type\":\"str\",\"children\":[\"the comment block should be removed {%comment%} be gone.. {%endcomment%} .. right?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}comment{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}comment{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %} 1 {% comment %} 2 {% endcomment %} 3 {% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{%blabla%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% blabla %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{% endif %}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% endwhatever %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% raw %} {{%%%%}}  }} { {% endcomment %} {% comment {% endraw %} {% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% \\\" %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{%%}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{%comment%}comment{%endcomment%}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{% comment %}comment{% endcomment %}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{%comment%} comment {%endcomment%}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{% comment %} comment {% endcomment %}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%} {%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%}comment{%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%} comment {%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foo{%comment%}\\n\"]},{\"type\":\"str\",\"children\":[\"                                     {%endcomment%}bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":59,"raw_source":"def test_hyphenated_assign\n    assigns = { 'a-b' => '1' }\n    assert_template_result('a-b:1 a-b:2', 'a-b:{{a-b}} {%assign a-b = 2 %}a-b:{{a-b}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hyphenated_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a-b\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a-b:1 a-b:2\"]},{\"type\":\"str\",\"children\":[\"a-b:{{a-b}} {%assign a-b = 2 %}a-b:{{a-b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":64,"raw_source":"def test_assign_with_colon_and_spaces\n    assigns = { 'var' => { 'a:b c' => { 'paged' => '1' } } }\n    assert_template_result('var2: 1', '{%assign var2 = var[\"a:b c\"].paged %}var2: {{var2}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_with_colon_and_spaces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a:b c\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"paged\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"var2: 1\"]},{\"type\":\"str\",\"children\":[\"{%assign var2 = var[\\\"a:b c\\\"].paged %}var2: {{var2}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":69,"raw_source":"def test_capture\n    assigns = { 'var' => 'content' }\n    assert_template_result(\n      'content foo content foo ',\n      '{{ var2 }}{% capture var2 %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}',\n      assigns,\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"content foo content foo \"]},{\"type\":\"str\",\"children\":[\"{{ var2 }}{% capture var2 %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":78,"raw_source":"def test_capture_detects_bad_syntax\n    assert_raises(SyntaxError) do\n      assert_template_result(\n        'content foo content foo ',\n        '{{ var2 }}{% capture %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}',\n        { 'var' => 'content' },\n      )\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_detects_bad_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"content foo content foo \"]},{\"type\":\"str\",\"children\":[\"{{ var2 }}{% capture %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":88,"raw_source":"def test_case\n    assigns = { 'condition' => 2 }\n    assert_template_result(\n      ' its 2 ',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 1 }\n    assert_template_result(\n      ' its 1 ',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 3 }\n    assert_template_result(\n      '',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => \"string here\" }\n    assert_template_result(\n      ' hit ',\n      '{% case condition %}{% when \"string here\" %} hit {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => \"bad string here\" }\n    assert_template_result(\n      '',\n      '{% case condition %}{% when \"string here\" %} hit {% endcase %}',\\\n      assigns,\n    )\n  end","complexity_score":10.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 2 \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string here\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" hit \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when \\\"string here\\\" %} hit {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"bad string here\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when \\\"string here\\\" %} hit {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":125,"raw_source":"def test_case_with_else\n    assigns = { 'condition' => 5 }\n    assert_template_result(\n      ' hit ',\n      '{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 6 }\n    assert_template_result(\n      ' else ',\n      '{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 6 }\n    assert_template_result(\n      ' else ',\n      '{% case condition %} {% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n  end","complexity_score":6.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" hit \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" else \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" else \"]},{\"type\":\"str\",\"children\":[\"{% case condition %} {% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":148,"raw_source":"def test_case_on_size\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [] })\n    assert_template_result('1', '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1] })\n    assert_template_result('2', '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1, 1, 1] })\n  end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":157,"raw_source":"def test_case_on_size_with_else\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [] },\n    )\n\n    assert_template_result(\n      '1',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1] },\n    )\n\n    assert_template_result(\n      '2',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1, 1, 1] },\n    )\n  end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_size_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":195,"raw_source":"def test_case_on_length_with_else\n    assert_template_result(\n      'else',\n      '{% case a.empty? %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'false',\n      '{% case false %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'true',\n      '{% case true %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'else',\n      '{% case NULL %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_length_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.empty? %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% case true %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case NULL %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":221,"raw_source":"def test_assign_from_case\n    # Example from the shopify forums\n    code = \"{% case collection.handle %}{% when 'menswear-jackets' %}{% assign ptitle = 'menswear' %}{% when 'menswear-t-shirts' %}{% assign ptitle = 'menswear' %}{% else %}{% assign ptitle = 'womenswear' %}{% endcase %}{{ ptitle }}\"\n    assert_template_result(\"menswear\",   code, { \"collection\" => { 'handle' => 'menswear-jackets' } })\n    assert_template_result(\"menswear\",   code, { \"collection\" => { 'handle' => 'menswear-t-shirts' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'x' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'y' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'z' } })\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_from_case\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case collection.handle %}{% when 'menswear-jackets' %}{% assign ptitle = 'menswear' %}{% when 'menswear-t-shirts' %}{% assign ptitle = 'menswear' %}{% else %}{% assign ptitle = 'womenswear' %}{% endcase %}{{ ptitle }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"menswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"menswear-jackets\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"menswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"menswear-t-shirts\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"x\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"y\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"z\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":231,"raw_source":"def test_case_when_or\n    code = '{% case condition %}{% when 1 or 2 or 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 2 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 3 })\n    assert_template_result(' its 4 ', code, { 'condition' => 4 })\n    assert_template_result('', code, { 'condition' => 5 })\n\n    code = '{% case condition %}{% when 1 or \"string\" or null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 'string' })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => nil })\n    assert_template_result('', code, { 'condition' => 'something else' })\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 or 2 or 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 4 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 or \\\"string\\\" or null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"something else\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":246,"raw_source":"def test_case_when_comma\n    code = '{% case condition %}{% when 1, 2, 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 2 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 3 })\n    assert_template_result(' its 4 ', code, { 'condition' => 4 })\n    assert_template_result('', code, { 'condition' => 5 })\n\n    code = '{% case condition %}{% when 1, \"string\", null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 'string' })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => nil })\n    assert_template_result('', code, { 'condition' => 'something else' })\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_comma\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, 2, 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 4 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, \\\"string\\\", null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"something else\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":261,"raw_source":"def test_case_when_comma_and_blank_body\n    code = '{% case condition %}{% when 1, 2 %} {% assign r = \"result\" %} {% endcase %}{{ r }}'\n    assert_template_result('result', code, { 'condition' => 2 })\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_comma_and_blank_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, 2 %} {% assign r = \\\"result\\\" %} {% endcase %}{{ r }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":266,"raw_source":"def test_assign\n    assert_template_result('variable', '{% assign a = \"variable\"%}{{a}}')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"str\",\"children\":[\"{% assign a = \\\"variable\\\"%}{{a}}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":270,"raw_source":"def test_assign_unassigned\n    assigns = { 'var' => 'content' }\n    assert_template_result('var2:  var2:content', 'var2:{{var2}} {%assign var2 = var%} var2:{{var2}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_unassigned\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"var2:  var2:content\"]},{\"type\":\"str\",\"children\":[\"var2:{{var2}} {%assign var2 = var%} var2:{{var2}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":275,"raw_source":"def test_assign_an_empty_string\n    assert_template_result('', '{% assign a = \"\"%}{{a}}')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_an_empty_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign a = \\\"\\\"%}{{a}}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":279,"raw_source":"def test_assign_is_global\n    assert_template_result('variable', '{%for i in (1..2) %}{% assign a = \"variable\"%}{% endfor %}{{a}}')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_is_global\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"str\",\"children\":[\"{%for i in (1..2) %}{% assign a = \\\"variable\\\"%}{% endfor %}{{a}}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":283,"raw_source":"def test_case_detects_bad_syntax\n    assert_raises(SyntaxError) do\n      assert_template_result('',  '{% case false %}{% when %}true{% endcase %}', {})\n    end\n\n    assert_raises(SyntaxError) do\n      assert_template_result('',  '{% case false %}{% huh %}true{% endcase %}', {})\n    end\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_detects_bad_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% when %}true{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% huh %}true{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":293,"raw_source":"def test_cycle\n    assert_template_result('one', '{%cycle \"one\", \"two\"%}')\n    assert_template_result('one two', '{%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%}')\n    assert_template_result(' two', '{%cycle \"\", \"two\"%} {%cycle \"\", \"two\"%}')\n\n    assert_template_result('one two one', '{%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%}')\n\n    assert_template_result(\n      'text-align: left text-align: right',\n      '{%cycle \"text-align: left\", \"text-align: right\" %} {%cycle \"text-align: left\", \"text-align: right\"%}',\n    )\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one two\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" two\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"\\\", \\\"two\\\"%} {%cycle \\\"\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one two one\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"text-align: left text-align: right\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"text-align: left\\\", \\\"text-align: right\\\" %} {%cycle \\\"text-align: left\\\", \\\"text-align: right\\\"%}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":306,"raw_source":"def test_multiple_cycles\n    assert_template_result(\n      '1 2 1 1 2 3 1',\n      '{%cycle 1,2%} {%cycle 1,2%} {%cycle 1,2%} {%cycle 1,2,3%} {%cycle 1,2,3%} {%cycle 1,2,3%} {%cycle 1,2,3%}',\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_cycles\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 1 1 2 3 1\"]},{\"type\":\"str\",\"children\":[\"{%cycle 1,2%} {%cycle 1,2%} {%cycle 1,2%} {%cycle 1,2,3%} {%cycle 1,2,3%} {%cycle 1,2,3%} {%cycle 1,2,3%}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":313,"raw_source":"def test_multiple_named_cycles\n    assert_template_result(\n      'one one two two one one',\n      '{%cycle 1: \"one\", \"two\" %} {%cycle 2: \"one\", \"two\" %} {%cycle 1: \"one\", \"two\" %} {%cycle 2: \"one\", \"two\" %} {%cycle 1: \"one\", \"two\" %} {%cycle 2: \"one\", \"two\" %}',\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_named_cycles\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one one two two one one\"]},{\"type\":\"str\",\"children\":[\"{%cycle 1: \\\"one\\\", \\\"two\\\" %} {%cycle 2: \\\"one\\\", \\\"two\\\" %} {%cycle 1: \\\"one\\\", \\\"two\\\" %} {%cycle 2: \\\"one\\\", \\\"two\\\" %} {%cycle 1: \\\"one\\\", \\\"two\\\" %} {%cycle 2: \\\"one\\\", \\\"two\\\" %}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":320,"raw_source":"def test_multiple_named_cycles_with_names_from_context\n    assigns = { \"var1\" => 1, \"var2\" => 2 }\n    assert_template_result(\n      'one one two two one one',\n      '{%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %} {%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %} {%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %}',\n      assigns,\n    )\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_named_cycles_with_names_from_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var1\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var2\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one one two two one one\"]},{\"type\":\"str\",\"children\":[\"{%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %} {%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %} {%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":329,"raw_source":"def test_size_of_array\n    assigns = { \"array\" => [1, 2, 3, 4] }\n    assert_template_result('array has 4 elements', \"array has {{ array.size }} elements\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size_of_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"array has 4 elements\"]},{\"type\":\"str\",\"children\":[\"array has {{ array.size }} elements\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":334,"raw_source":"def test_size_of_hash\n    assigns = { \"hash\" => { a: 1, b: 2, c: 3, d: 4 } }\n    assert_template_result('hash has 4 elements', \"hash has {{ hash.size }} elements\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size_of_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hash has 4 elements\"]},{\"type\":\"str\",\"children\":[\"hash has {{ hash.size }} elements\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":339,"raw_source":"def test_illegal_symbols\n    assert_template_result('', '{% if true == empty %}?{% endif %}', {})\n    assert_template_result('', '{% if true == null %}?{% endif %}', {})\n    assert_template_result('', '{% if empty == true %}?{% endif %}', {})\n    assert_template_result('', '{% if null == true %}?{% endif %}', {})\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_illegal_symbols\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true == empty %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true == null %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if empty == true %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null == true %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":346,"raw_source":"def test_ifchanged\n    assigns = { 'array' => [1, 1, 2, 2, 3, 3] }\n    assert_template_result('123', '{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}', assigns)\n\n    assigns = { 'array' => [1, 1, 1, 1] }\n    assert_template_result('1', '{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}', assigns)\n  end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ifchanged\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":354,"raw_source":"def test_multiline_tag\n    assert_template_result('0 1 2 3', \"0{%\\nfor i in (1..3)\\n%} {{\\ni\\n}}{%\\nendfor\\n%}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiline_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 1 2 3\"]},{\"type\":\"str\",\"children\":[\"0{%\\nfor i in (1..3)\\n%} {{\\ni\\n}}{%\\nendfor\\n%}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":8,"raw_source":"def test_true_eql_true\n    text = ' {% if true == true %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_eql_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if true == true %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":13,"raw_source":"def test_true_not_eql_true\n    text = ' {% if true != true %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_not_eql_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if true != true %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":18,"raw_source":"def test_true_lq_true\n    text = ' {% if 0 > 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_lq_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 > 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":23,"raw_source":"def test_one_lq_zero\n    text = ' {% if 1 > 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_one_lq_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 1 > 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":28,"raw_source":"def test_zero_lq_one\n    text = ' {% if 0 < 1 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 < 1 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":33,"raw_source":"def test_zero_lq_or_equal_one\n    text = ' {% if 0 <= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_or_equal_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 <= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":38,"raw_source":"def test_zero_lq_or_equal_one_involving_nil\n    text = ' {% if null <= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n\n    text = ' {% if 0 <= null %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_or_equal_one_involving_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if null <= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 <= null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":46,"raw_source":"def test_zero_lqq_or_equal_one\n    text = ' {% if 0 >= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lqq_or_equal_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 >= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":51,"raw_source":"def test_strings\n    text = \" {% if 'test' == 'test' %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'test' == 'test' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":56,"raw_source":"def test_strings_not_equal\n    text = \" {% if 'test' != 'test' %} true {% else %} false {% endif %} \"\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings_not_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'test' != 'test' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":61,"raw_source":"def test_var_strings_equal\n    text = ' {% if var == \"hello there!\" %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_strings_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == \\\"hello there!\\\" %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":66,"raw_source":"def test_var_strings_are_not_equal\n    text = ' {% if \"hello there!\" == var %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_strings_are_not_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if \\\"hello there!\\\" == var %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":71,"raw_source":"def test_var_and_long_string_are_equal\n    text = \" {% if var == 'hello there!' %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_and_long_string_are_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == 'hello there!' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":76,"raw_source":"def test_var_and_long_string_are_equal_backwards\n    text = \" {% if 'hello there!' == var %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_and_long_string_are_equal_backwards\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'hello there!' == var %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":88,"raw_source":"def test_is_collection_empty\n    text = ' {% if array == empty %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'array' => [] })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_is_collection_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if array == empty %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":93,"raw_source":"def test_is_not_collection_empty\n    text = ' {% if array == empty %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text, { 'array' => [1, 2, 3] })\n  end","complexity_score":2.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_is_not_collection_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if array == empty %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":98,"raw_source":"def test_nil\n    text = ' {% if var == nil %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => nil })\n\n    text = ' {% if var == null %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => nil })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == nil %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":106,"raw_source":"def test_not_nil\n    text = ' {% if var != nil %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 1 })\n\n    text = ' {% if var != null %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 1 })\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_not_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var != nil %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var != null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":11,"raw_source":"def initialize(array)\n      @array = array\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@array\",{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":15,"raw_source":"def each(&block)\n      @array.each(&block)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@array\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":20,"raw_source":"def test_table_row\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n</tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => [] },\n    )\n  end","complexity_score":3.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n</tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":34,"raw_source":"def test_table_row_with_different_cols\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td><td class=\\\"col4\\\"> 4 </td><td class=\\\"col5\\\"> 5 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:5%} {{n}} {% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_with_different_cols\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td><td class=\\\"col4\\\"> 4 </td><td class=\\\"col5\\\"> 5 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:5%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":42,"raw_source":"def test_table_col_counter\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row3\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n\",\n      '{% tablerow n in numbers cols:2%}{{tablerowloop.col}}{% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_col_counter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row3\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:2%}{{tablerowloop.col}}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":50,"raw_source":"def test_quoted_fragment\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      \"{% tablerow n in collections.frontpage cols:3%} {{n}} {% endtablerow %}\",\n      { 'collections' => { 'frontpage' => [1, 2, 3, 4, 5, 6] } },\n    )\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      \"{% tablerow n in collections['frontpage'] cols:3%} {{n}} {% endtablerow %}\",\n      { 'collections' => { 'frontpage' => [1, 2, 3, 4, 5, 6] } },\n    )\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quoted_fragment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in collections.frontpage cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"frontpage\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in collections['frontpage'] cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"frontpage\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":63,"raw_source":"def test_enumerable_drop\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => ArrayDrop.new([1, 2, 3, 4, 5, 6]) },\n    )\n  end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArrayDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":71,"raw_source":"def test_offset_and_limit\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3 offset:1 limit:6%} {{n}} {% endtablerow %}',\n      { 'numbers' => [0, 1, 2, 3, 4, 5, 6, 7] },\n    )\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_offset_and_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3 offset:1 limit:6%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":79,"raw_source":"def test_blank_string_not_iterable\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n</tr>\\n\",\n      \"{% tablerow char in characters cols:3 %}I WILL NOT BE OUTPUT{% endtablerow %}\",\n      { 'characters' => '' },\n    )\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_blank_string_not_iterable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n</tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow char in characters cols:3 %}I WILL NOT BE OUTPUT{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"characters\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":87,"raw_source":"def test_cols_nil_constant_same_as_evaluated_nil_expression\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"<td class=\\\"col1\\\">false</td>\" \\\n      \"<td class=\\\"col2\\\">false</td>\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) cols:nil %}{{ tablerowloop.col_last }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) cols:var %}{{ tablerowloop.col_last }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cols_nil_constant_same_as_evaluated_nil_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">false</td>\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col2\\\">false</td>\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) cols:nil %}{{ tablerowloop.col_last }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) cols:var %}{{ tablerowloop.col_last }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":105,"raw_source":"def test_nil_limit_is_treated_as_zero\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) limit:nil %}{{ i }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) limit:var %}{{ i }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_limit_is_treated_as_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) limit:nil %}{{ i }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) limit:var %}{{ i }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":121,"raw_source":"def test_nil_offset_is_treated_as_zero\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"<td class=\\\"col1\\\">1:false</td>\" \\\n      \"<td class=\\\"col2\\\">2:true</td>\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) offset:nil %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) offset:var %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_offset_is_treated_as_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">1:false</td>\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col2\\\">2:true</td>\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) offset:nil %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) offset:var %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":139,"raw_source":"def test_tablerow_loop_drop_attributes\n    template = <<~LIQUID.chomp\n      {% tablerow i in (1...2) %}\n      col: {{ tablerowloop.col }}\n      col0: {{ tablerowloop.col0 }}\n      col_first: {{ tablerowloop.col_first }}\n      col_last: {{ tablerowloop.col_last }}\n      first: {{ tablerowloop.first }}\n      index: {{ tablerowloop.index }}\n      index0: {{ tablerowloop.index0 }}\n      last: {{ tablerowloop.last }}\n      length: {{ tablerowloop.length }}\n      rindex: {{ tablerowloop.rindex }}\n      rindex0: {{ tablerowloop.rindex0 }}\n      row: {{ tablerowloop.row }}\n      {% endtablerow %}\n    LIQUID\n\n    expected_output = <<~OUTPUT\n      <tr class=\"row1\">\n      <td class=\"col1\">\n      col: 1\n      col0: 0\n      col_first: true\n      col_last: false\n      first: true\n      index: 1\n      index0: 0\n      last: false\n      length: 2\n      rindex: 2\n      rindex0: 1\n      row: 1\n      </td><td class=\"col2\">\n      col: 2\n      col0: 1\n      col_first: false\n      col_last: true\n      first: false\n      index: 2\n      index0: 1\n      last: true\n      length: 2\n      rindex: 1\n      rindex0: 0\n      row: 1\n      </td></tr>\n    OUTPUT\n\n    assert_template_result(expected_output, template)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_loop_drop_attributes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% tablerow i in (1...2) %}\\n\"]},{\"type\":\"str\",\"children\":[\"col: {{ tablerowloop.col }}\\n\"]},{\"type\":\"str\",\"children\":[\"col0: {{ tablerowloop.col0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: {{ tablerowloop.col_first }}\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: {{ tablerowloop.col_last }}\\n\"]},{\"type\":\"str\",\"children\":[\"first: {{ tablerowloop.first }}\\n\"]},{\"type\":\"str\",\"children\":[\"index: {{ tablerowloop.index }}\\n\"]},{\"type\":\"str\",\"children\":[\"index0: {{ tablerowloop.index0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"last: {{ tablerowloop.last }}\\n\"]},{\"type\":\"str\",\"children\":[\"length: {{ tablerowloop.length }}\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: {{ tablerowloop.rindex }}\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: {{ tablerowloop.rindex0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"row: {{ tablerowloop.row }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endtablerow %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"col: 1\\n\"]},{\"type\":\"str\",\"children\":[\"col0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: true\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: false\\n\"]},{\"type\":\"str\",\"children\":[\"first: true\\n\"]},{\"type\":\"str\",\"children\":[\"index: 1\\n\"]},{\"type\":\"str\",\"children\":[\"index0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"last: false\\n\"]},{\"type\":\"str\",\"children\":[\"length: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"row: 1\\n\"]},{\"type\":\"str\",\"children\":[\"</td><td class=\\\"col2\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"col: 2\\n\"]},{\"type\":\"str\",\"children\":[\"col0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: false\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: true\\n\"]},{\"type\":\"str\",\"children\":[\"first: false\\n\"]},{\"type\":\"str\",\"children\":[\"index: 2\\n\"]},{\"type\":\"str\",\"children\":[\"index0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"last: true\\n\"]},{\"type\":\"str\",\"children\":[\"length: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: 1\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"row: 1\\n\"]},{\"type\":\"str\",\"children\":[\"</td></tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":191,"raw_source":"def test_table_row_renders_correct_error_message_for_invalid_parameters\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) limit:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) offset:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) cols:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_renders_correct_error_message_for_invalid_parameters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) limit:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) offset:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) cols:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":211,"raw_source":"def test_table_row_handles_interrupts\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td></tr>\\n\",\n      '{% tablerow n in (1...3) cols:2 %} {{n}} {% break %} {{n}} {% endtablerow %}',\n    )\n\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 3 </td></tr>\\n\",\n      '{% tablerow n in (1...3) cols:2 %} {{n}} {% continue %} {{n}} {% endtablerow %}',\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_handles_interrupts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...3) cols:2 %} {{n}} {% break %} {{n}} {% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 3 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...3) cols:2 %} {{n}} {% continue %} {{n}} {% endtablerow %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":223,"raw_source":"def test_table_row_does_not_leak_interrupts\n    template = <<~LIQUID\n      {% for i in (1..2) -%}\n      {% for j in (1..2) -%}\n      {% tablerow k in (1..3) %}{% break %}{% endtablerow -%}\n      loop j={{ j }}\n      {% endfor -%}\n      loop i={{ i }}\n      {% endfor -%}\n      after loop\n    LIQUID\n\n    expected = <<~STR\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=2\n      loop i=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=2\n      loop i=2\n      after loop\n    STR\n\n    assert_template_result(\n      expected,\n      template,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_does_not_leak_interrupts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for i in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% for j in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow k in (1..3) %}{% break %}{% endtablerow -%}\\n\"]},{\"type\":\"str\",\"children\":[\"loop j={{ j }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"loop i={{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"after loop\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=2\\n\"]},{\"type\":\"str\",\"children\":[\"loop i=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=2\\n\"]},{\"type\":\"str\",\"children\":[\"loop i=2\\n\"]},{\"type\":\"str\",\"children\":[\"after loop\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":8,"raw_source":"def test_unless\n    assert_template_result('  ', ' {% unless true %} this text should not go into the output {% endunless %} ')\n    assert_template_result(\n      '  this text should go into the output  ',\n      ' {% unless false %} this text should go into the output {% endunless %} ',\n    )\n    assert_template_result('  you rock ?', '{% unless true %} you suck {% endunless %} {% unless false %} you rock {% endunless %}?')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\" {% unless true %} this text should not go into the output {% endunless %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  this text should go into the output  \"]},{\"type\":\"str\",\"children\":[\" {% unless false %} this text should go into the output {% endunless %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  you rock ?\"]},{\"type\":\"str\",\"children\":[\"{% unless true %} you suck {% endunless %} {% unless false %} you rock {% endunless %}?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":17,"raw_source":"def test_unless_else\n    assert_template_result(' YES ', '{% unless true %} NO {% else %} YES {% endunless %}')\n    assert_template_result(' YES ', '{% unless false %} YES {% else %} NO {% endunless %}')\n    assert_template_result(' YES ', '{% unless \"foo\" %} NO {% else %} YES {% endunless %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless true %} NO {% else %} YES {% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless false %} YES {% else %} NO {% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless \\\"foo\\\" %} NO {% else %} YES {% endunless %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":23,"raw_source":"def test_unless_in_loop\n    assert_template_result('23', '{% for i in choices %}{% unless i %}{{ forloop.index }}{% endunless %}{% endfor %}', { 'choices' => [1, nil, false] })\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_in_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"23\"]},{\"type\":\"str\",\"children\":[\"{% for i in choices %}{% unless i %}{{ forloop.index }}{% endunless %}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"choices\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":27,"raw_source":"def test_unless_else_in_loop\n    assert_template_result(' TRUE  2  3 ', '{% for i in choices %}{% unless i %} {{ forloop.index }} {% else %} TRUE {% endunless %}{% endfor %}', { 'choices' => [1, nil, false] })\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_else_in_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" TRUE  2  3 \"]},{\"type\":\"str\",\"children\":[\"{% for i in choices %}{% unless i %} {{ forloop.index }} {% else %} TRUE {% endunless %}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"choices\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":9,"raw_source":"def test_standard_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{ 'John' }}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          John\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          John\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":27,"raw_source":"def test_variable_output_with_multiple_blank_lines\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n\n\n          {{- 'John' -}}\n\n\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_output_with_multiple_blank_lines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":47,"raw_source":"def test_tag_output_with_multiple_blank_lines\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n\n\n          {%- if true -%}\n          yes\n          {%- endif -%}\n\n\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_output_with_multiple_blank_lines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":70,"raw_source":"def test_standard_tags\n    whitespace = '          '\n    text       = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true %}\n          yes\n          {% endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n                yes\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false %}\n          no\n          {% endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"          \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":112,"raw_source":"def test_no_trim_output\n    text     = '<p>{{- \\'John\\' -}}</p>'\n    expected = '<p>John</p>'\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{{- 'John' -}}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>John</p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":119,"raw_source":"def test_no_trim_tags\n    text     = '<p>{%- if true -%}yes{%- endif -%}</p>'\n    expected = '<p>yes</p>'\n    assert_template_result(expected, text)\n\n    text     = '<p>{%- if false -%}no{%- endif -%}</p>'\n    expected = '<p></p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{%- if true -%}yes{%- endif -%}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>yes</p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{%- if false -%}no{%- endif -%}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p></p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":129,"raw_source":"def test_single_line_outer_tag\n    text     = '<p> {%- if true %} yes {% endif -%} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {%- if false %} no {% endif -%} </p>'\n    expected = '<p></p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_outer_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if true %} yes {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if false %} no {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p></p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":139,"raw_source":"def test_single_line_inner_tag\n    text     = '<p> {% if true -%} yes {%- endif %} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {% if false -%} no {%- endif %} </p>'\n    expected = '<p>  </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_inner_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if true -%} yes {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if false -%} no {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>  </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":149,"raw_source":"def test_single_line_post_tag\n    text     = '<p> {% if true -%} yes {% endif -%} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {% if false -%} no {% endif -%} </p>'\n    expected = '<p> </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_post_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if true -%} yes {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if false -%} no {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":159,"raw_source":"def test_single_line_pre_tag\n    text     = '<p> {%- if true %} yes {%- endif %} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {%- if false %} no {%- endif %} </p>'\n    expected = '<p> </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_pre_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if true %} yes {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if false %} no {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":169,"raw_source":"def test_pre_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' }}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":186,"raw_source":"def test_pre_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true %}\n          yes\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false %}\n          no\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":223,"raw_source":"def test_post_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{ 'John' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":240,"raw_source":"def test_post_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true -%}\n          yes\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false -%}\n          no\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":277,"raw_source":"def test_pre_and_post_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true %}\n          yes\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false %}\n          no\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_and_post_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":313,"raw_source":"def test_post_and_pre_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true -%}\n          yes\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    whitespace = '          '\n    text       = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false -%}\n          no\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_and_pre_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"          \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":352,"raw_source":"def test_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":368,"raw_source":"def test_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true -%}\n          yes\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false -%}\n          no\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":402,"raw_source":"def test_whitespace_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}},\n          {{- '30' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John,30</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}},\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John,30</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":419,"raw_source":"def test_whitespace_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true -%}\n          yes\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false -%}\n          no\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":453,"raw_source":"def test_complex_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}}\n          {{- '30' -}}\n        </p>\n        <b>\n          {{ 'John' -}}\n          {{- '30' }}\n        </b>\n        <i>\n          {{- 'John' }}\n          {{ '30' -}}\n        </i>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John30</p>\n        <b>\n          John30\n        </b>\n        <i>John\n          30</i>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"        <b>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </b>\\n\"]},{\"type\":\"str\",\"children\":[\"        <i>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </i>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John30</p>\\n\"]},{\"type\":\"str\",\"children\":[\"        <b>\\n\"]},{\"type\":\"str\",\"children\":[\"          John30\\n\"]},{\"type\":\"str\",\"children\":[\"        </b>\\n\"]},{\"type\":\"str\",\"children\":[\"        <i>John\\n\"]},{\"type\":\"str\",\"children\":[\"          30</i>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":483,"raw_source":"def test_complex_trim\n    text = <<-END_TEMPLATE\n      <div>\n        {%- if true -%}\n          {%- if true -%}\n            <p>\n              {{- 'John' -}}\n            </p>\n          {%- endif -%}\n        {%- endif -%}\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div><p>John</p></div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"      <div><p>John</p></div>\\n\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":501,"raw_source":"def test_right_trim_followed_by_tag\n    assert_template_result('ab c', '{{ \"a\" -}}{{ \"b\" }} c')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_right_trim_followed_by_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"a\\\" -}}{{ \\\"b\\\" }} c\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":505,"raw_source":"def test_raw_output\n    whitespace = '        '\n    text       = <<-END_TEMPLATE\n      <div>\n        {% raw %}\n          {%- if true -%}\n            <p>\n              {{- 'John' -}}\n            </p>\n          {%- endif -%}\n        {% endraw %}\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n      #{whitespace}\n                {%- if true -%}\n                  <p>\n                    {{- 'John' -}}\n                  </p>\n                {%- endif -%}\n      #{whitespace}\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raw_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"        \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        {% endraw %}\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":532,"raw_source":"def test_pre_trim_blank_preceding_text\n    assert_template_result(\"\", \"\\n{%- raw %}{% endraw %}\")\n    assert_template_result(\"\", \"\\n{%- if true %}{% endif %}\")\n    assert_template_result(\"BC\", \"{{ 'B' }} \\n{%- if true %}C{% endif %}\")\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_blank_preceding_text\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\\n{%- raw %}{% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\\n{%- if true %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"BC\"]},{\"type\":\"str\",\"children\":[\"{{ 'B' }} \\n{%- if true %}C{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":538,"raw_source":"def test_bug_compatible_pre_trim\n    template = Liquid::Template.parse(\"\\n {%- raw %}{% endraw %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"\\n\", template.render)\n\n    template = Liquid::Template.parse(\"\\n {%- if true %}{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"\\n\", template.render)\n\n    template = Liquid::Template.parse(\"{{ 'B' }} \\n{%- if true %}C{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B C\", template.render)\n\n    template = Liquid::Template.parse(\"B\\n {%- raw %}{% endraw %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B\", template.render)\n\n    template = Liquid::Template.parse(\"B\\n {%- if true %}{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B\", template.render)\n  end","complexity_score":21.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bug_compatible_pre_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"\\n {%- raw %}{% endraw %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"\\n {%- if true %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'B' }} \\n{%- if true %}C{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"B\\n {%- raw %}{% endraw %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"B\\n {%- if true %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":555,"raw_source":"def test_trim_blank\n    assert_template_result('foobar', 'foo {{-}} bar')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_trim_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo {{-}} bar\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":9,"raw_source":"def test_simple_variable\n    assert_template_result('worked', \"{{test}}\", { 'test' => 'worked' })\n    assert_template_result('worked wonderfully', \"{{test}}\", { 'test' => 'worked wonderfully' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked wonderfully\"]},{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked wonderfully\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":14,"raw_source":"def test_variable_render_calls_to_liquid\n    assert_template_result('foobar', '{{ foo }}', { 'foo' => ThingWithToLiquid.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_render_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":18,"raw_source":"def test_variable_lookup_calls_to_liquid_value\n    assert_template_result('1', '{{ foo }}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('2', '{{ list[foo] }}', { 'foo' => IntegerDrop.new('1'), 'list' => [1, 2, 3] })\n    assert_template_result('one', '{{ list[foo] }}', { 'foo' => IntegerDrop.new('1'), 'list' => { 1 => 'one' } })\n    assert_template_result('Yay', '{{ foo }}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('YAY', '{{ foo | upcase }}', { 'foo' => BooleanDrop.new(true) })\n  end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{{ list[foo] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{{ list[foo] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"one\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YAY\"]},{\"type\":\"str\",\"children\":[\"{{ foo | upcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":26,"raw_source":"def test_if_tag_calls_to_liquid_value\n    assert_template_result('one', '{% if foo == 1 %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if foo == eqv %}one{% endif %}', { 'foo' => IntegerDrop.new(1), 'eqv' => IntegerDrop.new(1) })\n    assert_template_result('one', '{% if 0 < foo %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if foo > 0 %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if b > a %}one{% endif %}', { 'b' => IntegerDrop.new(1), 'a' => IntegerDrop.new(0) })\n    assert_template_result('true', '{% if foo == true %}true{% endif %}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('true', '{% if foo %}true{% endif %}', { 'foo' => BooleanDrop.new(true) })\n\n    assert_template_result('', '{% if foo %}true{% endif %}', { 'foo' => BooleanDrop.new(false) })\n    assert_template_result('', '{% if foo == true %}True{% endif %}', { 'foo' => BooleanDrop.new(false) })\n    assert_template_result('', '{% if foo and true %}SHOULD NOT HAPPEN{% endif %}', { 'foo' => BooleanDrop.new(false) })\n\n    assert_template_result('one', '{% if a contains x %}one{% endif %}', { 'a' => [1], 'x' => IntegerDrop.new(1) })\n  end","complexity_score":28.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo == 1 %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo == eqv %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"eqv\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if 0 < foo %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo > 0 %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if b > a %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if foo == true %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if foo %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo == true %}True{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo and true %}SHOULD NOT HAPPEN{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if a contains x %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":42,"raw_source":"def test_unless_tag_calls_to_liquid_value\n    assert_template_result('', '{% unless foo %}true{% endunless %}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('true', '{% unless foo %}true{% endunless %}', { 'foo' => BooleanDrop.new(false) })\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% unless foo %}true{% endunless %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% unless foo %}true{% endunless %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":47,"raw_source":"def test_case_tag_calls_to_liquid_value\n    assert_template_result('One', '{% case foo %}{% when 1 %}One{% endcase %}', { 'foo' => IntegerDrop.new('1') })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"One\"]},{\"type\":\"str\",\"children\":[\"{% case foo %}{% when 1 %}One{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":51,"raw_source":"def test_simple_with_whitespaces\n    assert_template_result(\"  worked  \", \"  {{ test }}  \", { \"test\" => \"worked\" })\n    assert_template_result(\"  worked wonderfully  \", \"  {{ test }}  \", { \"test\" => \"worked wonderfully\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_with_whitespaces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  worked  \"]},{\"type\":\"str\",\"children\":[\"  {{ test }}  \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  worked wonderfully  \"]},{\"type\":\"str\",\"children\":[\"  {{ test }}  \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked wonderfully\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":56,"raw_source":"def test_expression_with_whitespace_in_square_brackets\n    assert_template_result('result', \"{{ a[ 'b' ] }}\", { 'a' => { 'b' => 'result' } })\n    assert_template_result('result', \"{{ a[ [ 'b' ] ] }}\", { 'b' => 'c', 'a' => { 'c' => 'result' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_with_whitespace_in_square_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ a[ 'b' ] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ a[ [ 'b' ] ] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":61,"raw_source":"def test_ignore_unknown\n    assert_template_result(\"\", \"{{ test }}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ignore_unknown\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ test }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":65,"raw_source":"def test_using_blank_as_variable_name\n    assert_template_result(\"\", \"{% assign foo = blank %}{{ foo }}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_using_blank_as_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = blank %}{{ foo }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":69,"raw_source":"def test_using_empty_as_variable_name\n    assert_template_result(\"\", \"{% assign foo = empty %}{{ foo }}\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_using_empty_as_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = empty %}{{ foo }}\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":73,"raw_source":"def test_hash_scoping\n    assert_template_result('worked', \"{{ test.test }}\", { 'test' => { 'test' => 'worked' } })\n    assert_template_result('worked', \"{{ test . test }}\", { 'test' => { 'test' => 'worked' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_scoping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test.test }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test . test }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":78,"raw_source":"def test_false_renders_as_false\n    assert_template_result(\"false\", \"{{ foo }}\", { 'foo' => false })\n    assert_template_result(\"false\", \"{{ false }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_false_renders_as_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":83,"raw_source":"def test_nil_renders_as_empty_string\n    assert_template_result(\"\", \"{{ nil }}\")\n    assert_template_result(\"cat\", \"{{ nil | append: 'cat' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_renders_as_empty_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ nil }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"cat\"]},{\"type\":\"str\",\"children\":[\"{{ nil | append: 'cat' }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":88,"raw_source":"def test_preset_assigns\n    template                 = Template.parse(%({{ test }}))\n    template.assigns['test'] = 'worked'\n    assert_equal('worked', template.render!)\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_preset_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ test }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":94,"raw_source":"def test_reuse_parsed_template\n    template                     = Template.parse(%({{ greeting }} {{ name }}))\n    template.assigns['greeting'] = 'Goodbye'\n    assert_equal('Hello Tobi', template.render!('greeting' => 'Hello', 'name' => 'Tobi'))\n    assert_equal('Hello ', template.render!('greeting' => 'Hello', 'unknown' => 'Tobi'))\n    assert_equal('Hello Brian', template.render!('greeting' => 'Hello', 'name' => 'Brian'))\n    assert_equal('Goodbye Brian', template.render!('name' => 'Brian'))\n    assert_equal({ 'greeting' => 'Goodbye' }, template.assigns)\n  end","complexity_score":15.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reuse_parsed_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ greeting }} {{ name }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Goodbye\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Tobi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"unknown\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Brian\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Brian\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Goodbye Brian\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Brian\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Goodbye\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":104,"raw_source":"def test_assigns_not_polluted_from_template\n    template                 = Template.parse(%({{ test }}{% assign test = 'bar' %}{{ test }}))\n    template.assigns['test'] = 'baz'\n    assert_equal('bazbar', template.render!)\n    assert_equal('bazbar', template.render!)\n    assert_equal('foobar', template.render!('test' => 'foo'))\n    assert_equal('bazbar', template.render!)\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigns_not_polluted_from_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ test }}{% assign test = 'bar' %}{{ test }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":113,"raw_source":"def test_hash_with_default_proc\n    template        = Template.parse(%(Hello {{ test }}))\n    assigns         = Hash.new { |_h, k| raise \"Unknown variable '#{k}'\" }\n    assigns['test'] = 'Tobi'\n    assert_equal('Hello Tobi', template.render!(assigns))\n    assigns.delete('test')\n    e = assert_raises(RuntimeError) do\n      template.render!(assigns)\n    end\n    assert_equal(\"Unknown variable 'test'\", e.message)\n  end","complexity_score":16.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_default_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"Hello {{ test }}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unknown variable '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Tobi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"delete\",{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unknown variable 'test'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":125,"raw_source":"def test_multiline_variable\n    assert_template_result(\"worked\", \"{{\\ntest\\n}}\", { \"test\" => \"worked\" })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiline_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{\\ntest\\n}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":129,"raw_source":"def test_render_symbol\n    assert_template_result('bar', '{{ foo }}', { 'foo' => :bar })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_symbol\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"sym\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":133,"raw_source":"def test_nested_array\n    assert_template_result('', '{{ foo }}', { 'foo' => [[nil]] })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":137,"raw_source":"def test_dynamic_find_var\n    assert_template_result('bar', '{{ [key] }}', { 'key' => 'foo', 'foo' => 'bar' })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_find_var\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ [key] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":141,"raw_source":"def test_raw_value_variable\n    assert_template_result('bar', '{{ [key] }}', { 'key' => 'foo', 'foo' => 'bar' })\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raw_value_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ [key] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":145,"raw_source":"def test_dynamic_find_var_with_drop\n    assert_template_result(\n      'bar',\n      '{{ [list[settings.zero]] }}',\n      {\n        'list' => ['foo'],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'foo' => 'bar',\n      },\n    )\n\n    assert_template_result(\n      'foo',\n      '{{ [list[settings.zero][\"foo\"]] }}',\n      {\n        'list' => [{ 'foo' => 'bar' }],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'bar' => 'foo',\n      },\n    )\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_find_var_with_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ [list[settings.zero]] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ [list[settings.zero][\\\"foo\\\"]] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":167,"raw_source":"def test_double_nested_variable_lookup\n    assert_template_result(\n      'bar',\n      '{{ list[list[settings.zero]][\"foo\"] }}',\n      {\n        'list' => [1, { 'foo' => 'bar' }],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'bar' => 'foo',\n      },\n    )\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_double_nested_variable_lookup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ list[list[settings.zero]][\\\"foo\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":179,"raw_source":"def test_variable_lookup_should_not_hang_with_invalid_syntax\n    Timeout.timeout(1) do\n      assert_template_result(\n        'bar',\n        \"{{['foo'}}\",\n        {\n          'foo' => 'bar',\n        },\n        error_mode: :lax,\n      )\n    end\n\n    very_long_key = \"1234567890\" * 100\n\n    template_list = [\n      \"{{['#{very_long_key}']}}\", # valid\n      \"{{['#{very_long_key}'}}\", # missing closing bracket\n      \"{{[['#{very_long_key}']}}\", # extra open bracket\n    ]\n\n    template_list.each do |template|\n      Timeout.timeout(1) do\n        assert_template_result(\n          'bar',\n          template,\n          {\n            very_long_key => 'bar',\n          },\n          error_mode: :lax,\n        )\n      end\n    end\n  end","complexity_score":12.43,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_should_not_hang_with_invalid_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{['foo'}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"very_long_key\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"1234567890\"]},\"*\",{\"type\":\"int\",\"children\":[100]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template_list\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"']}}\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"'}}\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{[['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"']}}\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_list\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":27,"raw_source":"def fixture(name)\n      File.join(File.expand_path(__dir__), \"fixtures\", name)\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"fixture\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},{\"type\":\"str\",\"children\":[\"fixtures\"]},{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":35,"raw_source":"def assert_template_result(\n      expected, template, assigns = {},\n      message: nil, partials: nil, error_mode: nil, render_errors: false,\n      template_factory: nil\n    )\n      file_system = StubFileSystem.new(partials || {})\n      environment = Liquid::Environment.build(file_system: file_system)\n      template = Liquid::Template.parse(template, line_numbers: true, error_mode: error_mode&.to_sym, environment: environment)\n      registers = Liquid::Registers.new(file_system: file_system, template_factory: template_factory)\n      context = Liquid::Context.build(static_environments: assigns, rethrow_errors: !render_errors, registers: registers, environment: environment)\n      output = template.render(context)\n      assert_equal(expected, output, message)\n    end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_template_result\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expected\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"message\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"partials\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"render_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"template_factory\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},\"to_sym\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_errors\"]},\"!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":49,"raw_source":"def assert_match_syntax_error(match, template, error_mode: nil)\n      exception = assert_raises(Liquid::SyntaxError) do\n        Template.parse(template, line_numbers: true, error_mode: error_mode&.to_sym).render\n      end\n      assert_match(match, exception.message)\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_match_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"match\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},\"to_sym\"]}]}]}]},\"render\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"lvar\",\"children\":[\"match\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":56,"raw_source":"def assert_syntax_error(template, error_mode: nil)\n      assert_match_syntax_error(\"\", template, error_mode: error_mode)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"lvar\",\"children\":[\"error_mode\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":60,"raw_source":"def assert_usage_increment(name, times: 1)\n      old_method = Liquid::Usage.method(:increment)\n      calls = 0\n      begin\n        Liquid::Usage.singleton_class.send(:remove_method, :increment)\n        Liquid::Usage.define_singleton_method(:increment) do |got_name|\n          calls += 1 if got_name == name\n          old_method.call(got_name)\n        end\n        yield\n      ensure\n        Liquid::Usage.singleton_class.send(:remove_method, :increment)\n        Liquid::Usage.define_singleton_method(:increment, old_method)\n      end\n      assert_equal(times, calls, \"Number of calls to Usage.increment with #{name.inspect}\")\n    end","complexity_score":26.15,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_usage_increment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"kwoptarg\",\"children\":[\"times\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_method\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"method\",{\"type\":\"sym\",\"children\":[\"increment\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"calls\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_method\"]},{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"got_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"got_name\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"calls\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_method\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"got_name\"]}]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_method\"]},{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"increment\"]},{\"type\":\"lvar\",\"children\":[\"old_method\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"times\"]},{\"type\":\"lvar\",\"children\":[\"calls\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Number of calls to Usage.increment with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"inspect\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":77,"raw_source":"def with_global_filter(*globals, &blk)\n      environment = Liquid::Environment.build do |w|\n        w.register_filters(globals)\n      end\n\n      Environment.dangerously_override(environment, &blk)\n    end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"with_global_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"globals\"]},{\"type\":\"blockarg\",\"children\":[\"blk\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"w\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"w\"]},\"register_filters\",{\"type\":\"lvar\",\"children\":[\"globals\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"dangerously_override\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blk\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":85,"raw_source":"def with_error_mode(mode)\n      old_mode = Liquid::Environment.default.error_mode\n      Liquid::Environment.default.error_mode = mode\n      yield\n    ensure\n      Liquid::Environment.default.error_mode = old_mode\n    end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"with_error_mode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mode\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_mode\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"mode\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"old_mode\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":93,"raw_source":"def with_custom_tag(tag_name, tag_class, &block)\n      environment = Liquid::Environment.default.dup\n      environment.register_tag(tag_name, tag_class)\n\n      Environment.dangerously_override(environment, &block)\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_custom_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"tag_class\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"register_tag\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"tag_class\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"dangerously_override\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":103,"raw_source":"def to_liquid\n    'foobar'\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foobar\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":109,"raw_source":"def initialize(settings)\n    super()\n    @settings = settings\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"settings\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@settings\",{\"type\":\"lvar\",\"children\":[\"settings\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":114,"raw_source":"def liquid_method_missing(key)\n    @settings[key]\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@settings\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":120,"raw_source":"def initialize(value)\n    super()\n    @value = value.to_i\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":125,"raw_source":"def to_s\n    @value.to_s\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@value\"]},\"to_s\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":129,"raw_source":"def to_liquid_value\n    @value\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":135,"raw_source":"def initialize(value)\n    super()\n    @value = value\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":140,"raw_source":"def to_liquid_value\n    @value\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":144,"raw_source":"def to_s\n    @value ? \"Yay\" : \"Nay\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@value\"]},{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"Nay\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":152,"raw_source":"def initialize(value)\n    super()\n    @value = value\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":157,"raw_source":"def to_liquid_value\n    @value\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":161,"raw_source":"def to_s\n    @value\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":165,"raw_source":"def to_str\n    @value\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_str\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@value\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":169,"raw_source":"def inspect\n    \"#<StringDrop @value=#{@value.inspect}>\"\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<StringDrop @value=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@value\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":173,"raw_source":"def <=>(other)\n    to_liquid_value <=> Liquid::Utils.to_liquid_value(other)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<=>\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_liquid_value\"]},\"<=>\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"other\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":179,"raw_source":"def standard_error\n    raise Liquid::StandardError, 'standard error'\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"standard_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StandardError\"]},{\"type\":\"str\",\"children\":[\"standard error\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":183,"raw_source":"def argument_error\n    raise Liquid::ArgumentError, 'argument error'\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"argument_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"argument error\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":187,"raw_source":"def syntax_error\n    raise Liquid::SyntaxError, 'syntax error'\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"syntax_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]},{\"type\":\"str\",\"children\":[\"syntax error\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":191,"raw_source":"def runtime_error\n    raise 'runtime error'\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"runtime_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"runtime error\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":195,"raw_source":"def exception\n    raise Exception, 'exception'\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Exception\"]},{\"type\":\"str\",\"children\":[\"exception\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":203,"raw_source":"def initialize(values)\n    @file_read_count = 0\n    @values          = values\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@file_read_count\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@values\",{\"type\":\"lvar\",\"children\":[\"values\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":208,"raw_source":"def read_template_file(template_path)\n    @file_read_count += 1\n    @values.fetch(template_path)\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@file_read_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@values\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":217,"raw_source":"def initialize\n    @count = 0\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@count\",{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":221,"raw_source":"def for(template_name)\n    @count += 1\n    template = Liquid::Template.new\n    template.name = \"some/path/\" + template_name\n    template\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"some/path/\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":8,"raw_source":"def test_blankspace\n    template = Liquid::Template.parse(\"  \")\n    assert_equal([\"  \"], template.root.nodelist)\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_blankspace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":13,"raw_source":"def test_variable_beginning\n    template = Liquid::Template.parse(\"{{funk}}  \")\n    assert_equal(2, template.root.nodelist.size)\n    assert_equal(Variable, template.root.nodelist[0].class)\n    assert_equal(String, template.root.nodelist[1].class)\n  end","complexity_score":21.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_beginning\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{funk}}  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":20,"raw_source":"def test_variable_end\n    template = Liquid::Template.parse(\"  {{funk}}\")\n    assert_equal(2, template.root.nodelist.size)\n    assert_equal(String, template.root.nodelist[0].class)\n    assert_equal(Variable, template.root.nodelist[1].class)\n  end","complexity_score":21.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_end\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":27,"raw_source":"def test_variable_middle\n    template = Liquid::Template.parse(\"  {{funk}}  \")\n    assert_equal(3, template.root.nodelist.size)\n    assert_equal(String, template.root.nodelist[0].class)\n    assert_equal(Variable, template.root.nodelist[1].class)\n    assert_equal(String, template.root.nodelist[2].class)\n  end","complexity_score":29.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_middle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}}  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":35,"raw_source":"def test_variable_with_multibyte_character\n    template = Liquid::Template.parse(\"{{ '' }}\")\n    assert_equal(1, template.root.nodelist.size)\n    assert_equal(Variable, template.root.nodelist[0].class)\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_with_multibyte_character\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ '' }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":41,"raw_source":"def test_variable_many_embedded_fragments\n    template = Liquid::Template.parse(\"  {{funk}} {{so}} {{brother}} \")\n    assert_equal(7, template.root.nodelist.size)\n    assert_equal(\n      [String, Variable, String, Variable, String, Variable, String],\n      block_types(template.root.nodelist),\n    )\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_many_embedded_fragments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}} {{so}} {{brother}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":50,"raw_source":"def test_comment_tag_with_block\n    template = Liquid::Template.parse(\"  {% comment %} {% endcomment %} \")\n    assert_equal([String, Comment, String], block_types(template.root.nodelist))\n    assert_equal(3, template.root.nodelist.size)\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_tag_with_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {% comment %} {% endcomment %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Comment\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":56,"raw_source":"def test_doc_tag_with_block\n    template = Liquid::Template.parse(\"  {% doc %} {% enddoc %} \")\n    assert_equal([String, Doc, String], block_types(template.root.nodelist))\n    assert_equal(3, template.root.nodelist.size)\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_with_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {% doc %} {% enddoc %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Doc\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":64,"raw_source":"def block_types(nodelist)\n    nodelist.collect(&:class)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"block_types\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"nodelist\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"nodelist\"]},\"collect\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":8,"raw_source":"def setup\n    @context = Liquid::Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":12,"raw_source":"def test_basic_condition\n    assert_equal(false, Condition.new(1, '==', 2).evaluate(Context.new))\n    assert_equal(true,  Condition.new(1, '==', 1).evaluate(Context.new))\n  end","complexity_score":11.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_basic_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":17,"raw_source":"def test_default_operators_evalute_true\n    assert_evaluates_true(1, '==', 1)\n    assert_evaluates_true(1, '!=', 2)\n    assert_evaluates_true(1, '<>', 2)\n    assert_evaluates_true(1, '<', 2)\n    assert_evaluates_true(2, '>', 1)\n    assert_evaluates_true(1, '>=', 1)\n    assert_evaluates_true(2, '>=', 1)\n    assert_evaluates_true(1, '<=', 2)\n    assert_evaluates_true(1, '<=', 1)\n    # negative numbers\n    assert_evaluates_true(1, '>', -1)\n    assert_evaluates_true(-1, '<', 1)\n    assert_evaluates_true(1.0, '>', -1.0)\n    assert_evaluates_true(-1.0, '<', 1.0)\n  end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_operators_evalute_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"!=\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<>\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[-1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[-1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"float\",\"children\":[1.0]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[-1.0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"float\",\"children\":[-1.0]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"float\",\"children\":[1.0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":34,"raw_source":"def test_default_operators_evalute_false\n    assert_evaluates_false(1, '==', 2)\n    assert_evaluates_false(1, '!=', 1)\n    assert_evaluates_false(1, '<>', 1)\n    assert_evaluates_false(1, '<', 0)\n    assert_evaluates_false(2, '>', 4)\n    assert_evaluates_false(1, '>=', 3)\n    assert_evaluates_false(2, '>=', 4)\n    assert_evaluates_false(1, '<=', 0)\n    assert_evaluates_false(1, '<=', 0)\n  end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_operators_evalute_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"!=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<>\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":46,"raw_source":"def test_contains_works_on_strings\n    assert_evaluates_true('bob', 'contains', 'o')\n    assert_evaluates_true('bob', 'contains', 'b')\n    assert_evaluates_true('bob', 'contains', 'bo')\n    assert_evaluates_true('bob', 'contains', 'ob')\n    assert_evaluates_true('bob', 'contains', 'bob')\n\n    assert_evaluates_false('bob', 'contains', 'bob2')\n    assert_evaluates_false('bob', 'contains', 'a')\n    assert_evaluates_false('bob', 'contains', '---')\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_works_on_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"ob\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bob\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bob2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"---\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":58,"raw_source":"def test_contains_binary_encoding_compatibility_with_utf8\n    assert_evaluates_true(''.b, 'contains', '')\n    assert_evaluates_true('', 'contains', ''.b)\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_binary_encoding_compatibility_with_utf8\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"b\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"b\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":63,"raw_source":"def test_invalid_comparation_operator\n    assert_evaluates_argument_error(1, '~~', 0)\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_comparation_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"~~\"]},{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":67,"raw_source":"def test_comparation_of_int_and_str\n    assert_evaluates_argument_error('1', '>', 0)\n    assert_evaluates_argument_error('1', '<', 0)\n    assert_evaluates_argument_error('1', '>=', 0)\n    assert_evaluates_argument_error('1', '<=', 0)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparation_of_int_and_str\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":74,"raw_source":"def test_hash_compare_backwards_compatibility\n    assert_nil(Condition.new({}, '>', 2).evaluate(Context.new))\n    assert_nil(Condition.new(2, '>', {}).evaluate(Context.new))\n    assert_equal(false, Condition.new({}, '==', 2).evaluate(Context.new))\n    assert_equal(true, Condition.new({ 'a' => 1 }, '==', 'a' => 1).evaluate(Context.new))\n    assert_equal(true, Condition.new({ 'a' => 2 }, 'contains', 'a').evaluate(Context.new))\n  end","complexity_score":27.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_compare_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"hash\",\"children\":[]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":82,"raw_source":"def test_contains_works_on_arrays\n    @context          = Liquid::Context.new\n    @context['array'] = [1, 2, 3, 4, 5]\n    array_expr        = VariableLookup.new(\"array\")\n\n    assert_evaluates_false(array_expr, 'contains', 0)\n    assert_evaluates_true(array_expr, 'contains', 1)\n    assert_evaluates_true(array_expr, 'contains', 2)\n    assert_evaluates_true(array_expr, 'contains', 3)\n    assert_evaluates_true(array_expr, 'contains', 4)\n    assert_evaluates_true(array_expr, 'contains', 5)\n    assert_evaluates_false(array_expr, 'contains', 6)\n    assert_evaluates_false(array_expr, 'contains', \"1\")\n  end","complexity_score":16.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_works_on_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"lvasgn\",\"children\":[\"array_expr\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"array\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[6]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":97,"raw_source":"def test_contains_returns_false_for_nil_operands\n    @context = Liquid::Context.new\n    assert_evaluates_false(VariableLookup.new('not_assigned'), 'contains', '0')\n    assert_evaluates_false(0, 'contains', VariableLookup.new('not_assigned'))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_returns_false_for_nil_operands\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"not_assigned\"]}]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"0\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"not_assigned\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":103,"raw_source":"def test_contains_return_false_on_wrong_data_type\n    assert_evaluates_false(1, 'contains', 0)\n  end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_return_false_on_wrong_data_type\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":107,"raw_source":"def test_contains_with_string_left_operand_coerces_right_operand_to_string\n    assert_evaluates_true(' 1 ', 'contains', 1)\n    assert_evaluates_false(' 1 ', 'contains', 2)\n  end","complexity_score":2.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_with_string_left_operand_coerces_right_operand_to_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\" 1 \"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\" 1 \"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":112,"raw_source":"def test_or_condition\n    condition = Condition.new(1, '==', 2)\n    assert_equal(false, condition.evaluate(Context.new))\n\n    condition.or(Condition.new(2, '==', 1))\n\n    assert_equal(false, condition.evaluate(Context.new))\n\n    condition.or(Condition.new(1, '==', 1))\n\n    assert_equal(true, condition.evaluate(Context.new))\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_or_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"or\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"or\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":125,"raw_source":"def test_and_condition\n    condition = Condition.new(1, '==', 1)\n\n    assert_equal(true, condition.evaluate(Context.new))\n\n    condition.and(Condition.new(2, '==', 2))\n\n    assert_equal(true, condition.evaluate(Context.new))\n\n    condition.and(Condition.new(2, '==', 1))\n\n    assert_equal(false, condition.evaluate(Context.new))\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_and_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"and\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"and\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":139,"raw_source":"def test_should_allow_custom_proc_operator\n    Condition.operators['starts_with'] = proc { |_cond, left, right| left =~ /^#{right}/ }\n\n    assert_evaluates_true('bob', 'starts_with', 'b')\n    assert_evaluates_false('bob', 'starts_with', 'o')\n  ensure\n    Condition.operators.delete('starts_with')\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_should_allow_custom_proc_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_cond\"]},{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"str\",\"children\":[\"o\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"delete\",{\"type\":\"str\",\"children\":[\"starts_with\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":148,"raw_source":"def test_left_or_right_may_contain_operators\n    @context        = Liquid::Context.new\n    @context['one'] = @context['another'] = \"gnomeslab-and-or-liquid\"\n\n    assert_evaluates_true(VariableLookup.new(\"one\"), '==', VariableLookup.new(\"another\"))\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_left_or_right_may_contain_operators\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"another\"]},{\"type\":\"str\",\"children\":[\"gnomeslab-and-or-liquid\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"another\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":155,"raw_source":"def test_default_context_is_deprecated\n    if Gem::Version.new(Liquid::VERSION) >= Gem::Version.new('6.0.0')\n      flunk(\"Condition#evaluate without a context argument is to be removed\")\n    end\n\n    _out, err = capture_io do\n      assert_equal(true, Condition.new(1, '==', 1).evaluate)\n    end\n\n    expected = \"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\" \\\n      \" and will be removed from Liquid 6.0.0.\"\n    assert_includes(err.lines.map(&:strip), expected)\n  end","complexity_score":21.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_context_is_deprecated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"6.0.0\"]}]}]},{\"type\":\"send\",\"children\":[null,\"flunk\",{\"type\":\"str\",\"children\":[\"Condition#evaluate without a context argument is to be removed\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"_out\"]},{\"type\":\"lvasgn\",\"children\":[\"err\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"capture_io\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},\"evaluate\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\"]},{\"type\":\"str\",\"children\":[\" and will be removed from Liquid 6.0.0.\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"lines\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]},{\"type\":\"lvar\",\"children\":[\"expected\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":171,"raw_source":"def assert_evaluates_true(left, op, right)\n    assert(\n      Condition.new(left, op, right).evaluate(@context),\n      \"Evaluated false: #{left.inspect} #{op} #{right.inspect}\",\n    )\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_true\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Evaluated false: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"inspect\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":178,"raw_source":"def assert_evaluates_false(left, op, right)\n    assert(\n      !Condition.new(left, op, right).evaluate(@context),\n      \"Evaluated true: #{left.inspect} #{op} #{right.inspect}\",\n    )\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_false\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},\"!\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Evaluated true: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"inspect\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":185,"raw_source":"def assert_evaluates_argument_error(left, op, right)\n    assert_raises(Liquid::ArgumentError) do\n      Condition.new(left, op, right).evaluate(@context)\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_argument_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":9,"raw_source":"def public_filter\n      \"public\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"public\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":13,"raw_source":"def private_filter\n      \"private\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"private_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"private\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":20,"raw_source":"def late_added_filter(_input)\n      \"filtered\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"late_added_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_input\"]}]},{\"type\":\"str\",\"children\":[\"filtered\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":25,"raw_source":"def setup\n    @environment = Liquid::Environment.build do |env|\n      env.register_filter(AccessScopeFilters)\n    end\n\n    @context = Context.build(environment: @environment)\n  end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"AccessScopeFilters\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":33,"raw_source":"def test_strainer\n    strainer = @environment.create_strainer(@context)\n    assert_equal(5, strainer.invoke('size', 'input'))\n    assert_equal(\"public\", strainer.invoke(\"public_filter\"))\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"public\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":39,"raw_source":"def test_strainer_raises_argument_error\n    strainer = @environment.create_strainer(@context)\n    assert_raises(Liquid::ArgumentError) do\n      strainer.invoke(\"public_filter\", 1)\n    end\n  end","complexity_score":5.43,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_raises_argument_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":46,"raw_source":"def test_strainer_argument_error_contains_backtrace\n    strainer = @environment.create_strainer(@context)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      strainer.invoke(\"public_filter\", 1)\n    end\n\n    assert_match(\n      /\\ALiquid error: wrong number of arguments \\((1 for 0|given 1, expected 0)\\)\\z/,\n      exception.message,\n    )\n\n    source = AccessScopeFilters.instance_method(:public_filter).source_location\n    assert_equal(source[0..1].map(&:to_s), exception.backtrace[0].split(':')[0..1])\n  end","complexity_score":24.03,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_argument_error_contains_backtrace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\ALiquid error: wrong number of arguments \\\\((1 for 0|given 1, expected 0)\\\\)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AccessScopeFilters\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"public_filter\"]}]},\"source_location\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"backtrace\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"split\",{\"type\":\"str\",\"children\":[\":\"]}]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":62,"raw_source":"def test_strainer_only_invokes_public_filter_methods\n    strainer = @environment.create_strainer(@context)\n    assert_equal(false, strainer.class.invokable?('__test__'))\n    assert_equal(false, strainer.class.invokable?('test'))\n    assert_equal(false, strainer.class.invokable?('instance_eval'))\n    assert_equal(false, strainer.class.invokable?('__send__'))\n    assert_equal(true, strainer.class.invokable?('size')) # from the standard lib\n  end","complexity_score":20.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_only_invokes_public_filter_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"__test__\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"instance_eval\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"__send__\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"size\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":71,"raw_source":"def test_strainer_returns_nil_if_no_filter_method_found\n    strainer = @environment.create_strainer(@context)\n    assert_nil(strainer.invoke(\"private_filter\"))\n    assert_nil(strainer.invoke(\"undef_the_filter\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_returns_nil_if_no_filter_method_found\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"private_filter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"undef_the_filter\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":77,"raw_source":"def test_strainer_returns_first_argument_if_no_method_and_arguments_given\n    strainer = @environment.create_strainer(@context)\n    assert_equal(\"password\", strainer.invoke(\"undef_the_method\", \"password\"))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_returns_first_argument_if_no_method_and_arguments_given\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"password\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"undef_the_method\"]},{\"type\":\"str\",\"children\":[\"password\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":82,"raw_source":"def test_strainer_only_allows_methods_defined_in_filters\n    strainer = @environment.create_strainer(@context)\n    assert_equal(\"1 + 1\", strainer.invoke(\"instance_eval\", \"1 + 1\"))\n    assert_equal(\"puts\",  strainer.invoke(\"__send__\", \"puts\", \"Hi Mom\"))\n    assert_equal(\"has_method?\", strainer.invoke(\"invoke\", \"has_method?\", \"invoke\"))\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_only_allows_methods_defined_in_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 + 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"instance_eval\"]},{\"type\":\"str\",\"children\":[\"1 + 1\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"puts\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"__send__\"]},{\"type\":\"str\",\"children\":[\"puts\"]},{\"type\":\"str\",\"children\":[\"Hi Mom\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"has_method?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"invoke\"]},{\"type\":\"str\",\"children\":[\"has_method?\"]},{\"type\":\"str\",\"children\":[\"invoke\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":89,"raw_source":"def test_strainer_uses_a_class_cache_to_avoid_method_cache_invalidation\n    a = Module.new\n    b = Module.new\n\n    strainer = @environment.create_strainer(@context, [a, b])\n\n    assert_kind_of(StrainerTemplate, strainer)\n    assert_kind_of(a, strainer)\n    assert_kind_of(b, strainer)\n    assert_kind_of(Liquid::StandardFilters, strainer)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_uses_a_class_cache_to_avoid_method_cache_invalidation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"b\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[null,\"StrainerTemplate\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"lvar\",\"children\":[\"b\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StandardFilters\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":101,"raw_source":"def test_add_global_filter_clears_cache\n    assert_equal('input', @environment.create_strainer(@context).invoke('late_added_filter', 'input'))\n\n    @environment.register_filter(LateAddedFilter)\n\n    assert_equal('filtered', @environment.create_strainer(nil).invoke('late_added_filter', 'input'))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_global_filter_clears_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},\"invoke\",{\"type\":\"str\",\"children\":[\"late_added_filter\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"LateAddedFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"filtered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"nil\",\"children\":[]}]},\"invoke\",{\"type\":\"str\",\"children\":[\"late_added_filter\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_test.rb","start_line":9,"raw_source":"def render(_context)\n      'Unsubscribe Footer'\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},{\"type\":\"str\",\"children\":[\"Unsubscribe Footer\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_test.rb","start_line":14,"raw_source":"def test_custom_tag\n    email_environment = Liquid::Environment.build do |environment|\n      environment.register_tag(\"unsubscribe_footer\", UnsubscribeFooter)\n    end\n\n    assert(email_environment.tags[\"unsubscribe_footer\"])\n    assert(email_environment.tag_for_name(\"unsubscribe_footer\"))\n    template = Liquid::Template.parse(\"{% unsubscribe_footer %}\", environment: email_environment)\n\n    assert_equal('Unsubscribe Footer', template.render)\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"email_environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"register_tag\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]},{\"type\":\"const\",\"children\":[null,\"UnsubscribeFooter\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"email_environment\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"email_environment\"]},\"tag_for_name\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% unsubscribe_footer %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"email_environment\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unsubscribe Footer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":8,"raw_source":"def test_default\n    assert_raises(FileSystemError) do\n      BlankFileSystem.new.read_template_file(\"dummy\")\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlankFileSystem\"]},\"new\"]},\"read_template_file\",{\"type\":\"str\",\"children\":[\"dummy\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":14,"raw_source":"def test_local\n    file_system = Liquid::LocalFileSystem.new(\"/some/path\")\n    assert_equal(\"/some/path/_mypartial.liquid\", file_system.full_path(\"mypartial\"))\n    assert_equal(\"/some/path/dir/_mypartial.liquid\", file_system.full_path(\"dir/mypartial\"))\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"../dir/mypartial\")\n    end\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"/dir/../../dir/mypartial\")\n    end\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"/etc/passwd\")\n    end\n  end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"LocalFileSystem\"]},\"new\",{\"type\":\"str\",\"children\":[\"/some/path\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/_mypartial.liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"mypartial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/dir/_mypartial.liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"../dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"/dir/../../dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"/etc/passwd\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":32,"raw_source":"def test_custom_template_filename_patterns\n    file_system = Liquid::LocalFileSystem.new(\"/some/path\", \"%s.html\")\n    assert_equal(\"/some/path/mypartial.html\", file_system.full_path(\"mypartial\"))\n    assert_equal(\"/some/path/dir/mypartial.html\", file_system.full_path(\"dir/mypartial\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_template_filename_patterns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"LocalFileSystem\"]},\"new\",{\"type\":\"str\",\"children\":[\"/some/path\"]},{\"type\":\"str\",\"children\":[\"%s.html\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/mypartial.html\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"mypartial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/dir/mypartial.html\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"dir/mypartial\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":8,"raw_source":"def setup\n    @i18n = I18n.new(fixture(\"en_locale.yml\"))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@i18n\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":12,"raw_source":"def test_simple_translate_string\n    assert_equal(\"less is more\", @i18n.translate(\"simple\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_translate_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"less is more\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"simple\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":16,"raw_source":"def test_nested_translate_string\n    assert_equal(\"something wasn't right\", @i18n.translate(\"errors.syntax.oops\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_translate_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"something wasn't right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"errors.syntax.oops\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":20,"raw_source":"def test_single_string_interpolation\n    assert_equal(\"something different\", @i18n.translate(\"whatever\", something: \"different\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_string_interpolation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"something different\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"whatever\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"something\"]},{\"type\":\"str\",\"children\":[\"different\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":30,"raw_source":"def test_raises_unknown_translation\n    assert_raises(I18n::TranslationError) do\n      @i18n.translate(\"doesnt_exist\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raises_unknown_translation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"TranslationError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"doesnt_exist\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":36,"raw_source":"def test_sets_default_path_to_en\n    assert_equal(I18n::DEFAULT_LOCALE, I18n.new.path)\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_path_to_en\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"DEFAULT_LOCALE\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\"]},\"path\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":8,"raw_source":"def test_variable\n    assert_equal(\n      [\"test\"],\n      visit(%({{ test }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":15,"raw_source":"def test_varible_with_filter\n    assert_equal(\n      [\"test\", \"infilter\"],\n      visit(%({{ test | split: infilter }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_varible_with_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"infilter\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test | split: infilter }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":22,"raw_source":"def test_dynamic_variable\n    assert_equal(\n      [\"test\", \"inlookup\"],\n      visit(%({{ test[inlookup] }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"inlookup\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test[inlookup] }}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":29,"raw_source":"def test_echo\n    assert_equal(\n      [\"test\"],\n      visit(%({% echo test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_echo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% echo test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":36,"raw_source":"def test_if_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if test %}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":43,"raw_source":"def test_complex_if_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 and 2 == test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_if_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 and 2 == test %}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":50,"raw_source":"def test_if_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{{ test }}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":57,"raw_source":"def test_unless_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless test %}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless test %}{% endunless %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":64,"raw_source":"def test_complex_unless_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless 1 == 1 and 2 == test %}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_unless_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless 1 == 1 and 2 == test %}{% endunless %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":71,"raw_source":"def test_unless_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless 1 == 1 %}{{ test }}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless 1 == 1 %}{{ test }}{% endunless %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":78,"raw_source":"def test_elsif_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_elsif_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif test %}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":85,"raw_source":"def test_complex_elsif_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif 1 == 1 and 2 == test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_elsif_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif 1 == 1 and 2 == test %}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":92,"raw_source":"def test_elsif_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif 2 == 2 %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_elsif_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif 2 == 2 %}{{ test }}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":99,"raw_source":"def test_else_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% else %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_else_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% else %}{{ test }}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":106,"raw_source":"def test_case_left\n    assert_equal(\n      [\"test\"],\n      visit(%({% case test %}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_left\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case test %}{% endcase %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":113,"raw_source":"def test_case_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% when test %}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% when test %}{% endcase %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":120,"raw_source":"def test_case_when_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% when 2 %}{{ test }}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% when 2 %}{{ test }}{% endcase %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":127,"raw_source":"def test_case_else_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% else %}{{ test }}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_else_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% else %}{{ test }}{% endcase %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":134,"raw_source":"def test_for_in\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_in\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in test %}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":141,"raw_source":"def test_for_limit\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) limit: test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) limit: test %}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":148,"raw_source":"def test_for_offset\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) offset: test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) offset: test %}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":155,"raw_source":"def test_for_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) %}{{ test }}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) %}{{ test }}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":162,"raw_source":"def test_for_range\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..test) %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..test) %}{% endfor %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":169,"raw_source":"def test_tablerow_in\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_in\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in test %}{% endtablerow %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":176,"raw_source":"def test_tablerow_limit\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) limit: test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) limit: test %}{% endtablerow %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":183,"raw_source":"def test_tablerow_offset\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) offset: test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) offset: test %}{% endtablerow %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":190,"raw_source":"def test_tablerow_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) %}{{ test }}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) %}{{ test }}{% endtablerow %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":197,"raw_source":"def test_cycle\n    assert_equal(\n      [\"test\"],\n      visit(%({% cycle test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% cycle test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":204,"raw_source":"def test_assign\n    assert_equal(\n      [\"test\"],\n      visit(%({% assign x = test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% assign x = test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":211,"raw_source":"def test_capture\n    assert_equal(\n      [\"test\"],\n      visit(%({% capture x %}{{ test }}{% endcapture %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% capture x %}{{ test }}{% endcapture %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":218,"raw_source":"def test_include\n    assert_equal(\n      [\"test\"],\n      visit(%({% include test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":225,"raw_source":"def test_include_with\n    assert_equal(\n      [\"test\"],\n      visit(%({% include \"hai\" with test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include \\\"hai\\\" with test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":232,"raw_source":"def test_include_for\n    assert_equal(\n      [\"test\"],\n      visit(%({% include \"hai\" for test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include \\\"hai\\\" for test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":239,"raw_source":"def test_render_with\n    assert_equal(\n      [\"test\"],\n      visit(%({% render \"hai\" with test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% render \\\"hai\\\" with test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":246,"raw_source":"def test_render_for\n    assert_equal(\n      [\"test\"],\n      visit(%({% render \"hai\" for test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% render \\\"hai\\\" for test %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":253,"raw_source":"def test_preserve_tree_structure\n    assert_equal(\n      [[nil, [\n        [nil, [[nil, [[\"other\", []]]]]],\n        [\"test\", []],\n        [\"xs\", []],\n      ]]],\n      traversal(%({% for x in xs offset: test %}{{ other }}{% endfor %})).visit,\n    )\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_preserve_tree_structure\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"other\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"xs\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"str\",\"children\":[\"{% for x in xs offset: test %}{{ other }}{% endfor %}\"]}]},\"visit\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":266,"raw_source":"def traversal(template)\n    ParseTreeVisitor\n      .for(Template.parse(template).root)\n      .add_callback_for(VariableLookup) { |node| node.name } # rubocop:disable Style/SymbolProc\n  end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"traversal\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"name\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":272,"raw_source":"def visit(template)\n    traversal(template).visit.flatten.compact\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"visit\"]},\"flatten\"]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":8,"raw_source":"def test_consume\n    p = new_parser(\"wat: 7\")\n    assert_equal('wat', p.consume(:id))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('7', p.consume(:number))\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_consume\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":15,"raw_source":"def test_jump\n    p = new_parser(\"wat: 7\")\n    p.jump(2)\n    assert_equal('7', p.consume(:number))\n  end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_jump\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"jump\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":21,"raw_source":"def test_consume?\n    p = new_parser(\"wat: 7\")\n    assert_equal('wat', p.consume?(:id))\n    assert_equal(false, p.consume?(:dot))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('7', p.consume?(:number))\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_consume?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"dot\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":29,"raw_source":"def test_id?\n    p = new_parser(\"wat 6 Peter Hegemon\")\n    assert_equal('wat', p.id?('wat'))\n    assert_equal(false, p.id?('endgame'))\n    assert_equal('6', p.consume(:number))\n    assert_equal('Peter', p.id?('Peter'))\n    assert_equal(false, p.id?('Achilles'))\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_id?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat 6 Peter Hegemon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"wat\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"endgame\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Peter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"Peter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"Achilles\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":38,"raw_source":"def test_look\n    p = new_parser(\"wat 6 Peter Hegemon\")\n    assert_equal(true, p.look(:id))\n    assert_equal('wat', p.consume(:id))\n    assert_equal(false, p.look(:comparison))\n    assert_equal(true, p.look(:number))\n    assert_equal(true, p.look(:id, 1))\n    assert_equal(false, p.look(:number, 1))\n  end","complexity_score":15.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_look\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat 6 Peter Hegemon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"comparison\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"number\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":48,"raw_source":"def test_expressions\n    p = new_parser(\"hi.there hi?[5].there? hi.there.bob\")\n    assert_equal('hi.there', p.expression)\n    assert_equal('hi?[5].there?', p.expression)\n    assert_equal('hi.there.bob', p.expression)\n\n    p = new_parser(\"567 6.0 'lol' \\\"wut\\\"\")\n    assert_equal('567', p.expression)\n    assert_equal('6.0', p.expression)\n    assert_equal(\"'lol'\", p.expression)\n    assert_equal('\"wut\"', p.expression)\n  end","complexity_score":19.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expressions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"hi.there hi?[5].there? hi.there.bob\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi?[5].there?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there.bob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"567 6.0 'lol' \\\"wut\\\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"567\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"6.0\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"'lol'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\\"wut\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":61,"raw_source":"def test_ranges\n    p = new_parser(\"(5..7) (1.5..9.6) (young..old) (hi[5].wat..old)\")\n    assert_equal('(5..7)', p.expression)\n    assert_equal('(1.5..9.6)', p.expression)\n    assert_equal('(young..old)', p.expression)\n    assert_equal('(hi[5].wat..old)', p.expression)\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"(5..7) (1.5..9.6) (young..old) (hi[5].wat..old)\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(5..7)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(1.5..9.6)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(young..old)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(hi[5].wat..old)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":69,"raw_source":"def test_arguments\n    p = new_parser(\"filter: hi.there[5], keyarg: 7\")\n    assert_equal('filter', p.consume(:id))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('hi.there[5]', p.argument)\n    assert_equal(',', p.consume(:comma))\n    assert_equal('keyarg: 7', p.argument)\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"filter: hi.there[5], keyarg: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there[5]\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"comma\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"keyarg: 7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":78,"raw_source":"def test_invalid_expression\n    assert_raises(SyntaxError) do\n      p = new_parser(\"==\")\n      p.expression\n    end\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"==\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":87,"raw_source":"def new_parser(str)\n    Parser.new(StringScanner.new(str))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Parser\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":6,"raw_source":"def test_uses_the_file_system_register_if_present\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_the_file_system_register_if_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":22,"raw_source":"def test_reads_from_the_file_system_only_once_per_file\n    file_system = StubFileSystem.new('my_partial' => 'some partial body')\n    context     = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: Liquid::ParseContext.new,\n      )\n    end\n\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reads_from_the_file_system_only_once_per_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"some partial body\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":39,"raw_source":"def test_cache_state_is_stored_per_context\n    parse_context      = Liquid::ParseContext.new\n    shared_file_system = StubFileSystem.new(\n      'my_partial' => 'my shared value',\n    )\n    context_one = Liquid::Context.build(\n      registers: {\n        file_system: shared_file_system,\n      },\n    )\n    context_two = Liquid::Context.build(\n      registers: {\n        file_system: shared_file_system,\n      },\n    )\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context_one,\n        parse_context: parse_context,\n      )\n    end\n\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context_two,\n      parse_context: parse_context,\n    )\n\n    assert_equal(2, shared_file_system.file_read_count)\n  end","complexity_score":14.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_state_is_stored_per_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"shared_file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my shared value\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_one\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_two\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context_one\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context_two\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":72,"raw_source":"def test_cache_is_not_broken_when_a_different_parse_context_is_used\n    file_system = StubFileSystem.new('my_partial' => 'some partial body')\n    context     = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new(my_key: 'value one'),\n    )\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new(my_key: 'value two'),\n    )\n\n    # Technically what we care about is that the file was parsed twice,\n    # but measuring file reads is an OK proxy for this.\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_is_not_broken_when_a_different_parse_context_is_used\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"some partial body\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_key\"]},{\"type\":\"str\",\"children\":[\"value one\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_key\"]},{\"type\":\"str\",\"children\":[\"value two\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":94,"raw_source":"def test_uses_default_template_factory_when_no_template_factory_found_in_register\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_default_template_factory_when_no_template_factory_found_in_register\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":110,"raw_source":"def test_uses_template_factory_register_if_present\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n    assert_equal(1, template_factory.count)\n  end","complexity_score":13.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_template_factory_register_if_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_factory\"]},\"count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":129,"raw_source":"def test_cache_state_is_shared_for_subcontexts\n    parse_context      = Liquid::ParseContext.new\n    shared_file_system = StubFileSystem.new(\n      'my_partial' => 'my shared value',\n    )\n    context = Liquid::Context.build(\n      registers: Liquid::Registers.new(\n        file_system: shared_file_system,\n      ),\n    )\n    subcontext = context.new_isolated_subcontext\n\n    assert_equal(subcontext.registers[:cached_partials].object_id, context.registers[:cached_partials].object_id)\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: parse_context,\n      )\n\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: subcontext,\n        parse_context: parse_context,\n      )\n    end\n\n    assert_equal(1, shared_file_system.file_read_count)\n  end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_state_is_shared_for_subcontexts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"shared_file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my shared value\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"object_id\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"subcontext\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]},\"file_read_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":160,"raw_source":"def test_uses_template_name_from_template_factory\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('some/path/my_partial', partial.name)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some/path/my_partial\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":178,"raw_source":"def test_includes_error_mode_into_template_cache\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    [:lax, :warn, :strict].each do |error_mode|\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: Liquid::ParseContext.new(error_mode: error_mode),\n      )\n    end\n\n    assert_equal(\n      [\"my_partial:lax\", \"my_partial:warn\", \"my_partial:strict\"],\n      context.registers[:cached_partials].keys,\n    )\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_includes_error_mode_into_template_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"lax\"]},{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"lvar\",\"children\":[\"error_mode\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial:lax\"]},{\"type\":\"str\",\"children\":[\"my_partial:warn\"]},{\"type\":\"str\",\"children\":[\"my_partial:strict\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"keys\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":9,"raw_source":"def test_empty\n    assert_equal([], ''.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":13,"raw_source":"def test_quote\n    assert_equal(['\"arg 1\"'], '\"arg 1\"'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quote\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"arg 1\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"arg 1\\\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":17,"raw_source":"def test_words\n    assert_equal(['arg1', 'arg2'], 'arg1 arg2'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":21,"raw_source":"def test_tags\n    assert_equal(['<tr>', '</tr>'], '<tr> </tr>'.scan(QuotedFragment))\n    assert_equal(['<tr></tr>'], '<tr></tr>'.scan(QuotedFragment))\n    assert_equal(['<style', 'class=\"hello\">', '</style>'], %(<style class=\"hello\">' </style>).scan(QuotedFragment))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr>\"]},{\"type\":\"str\",\"children\":[\"</tr>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr> </tr>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr></tr>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr></tr>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<style\"]},{\"type\":\"str\",\"children\":[\"class=\\\"hello\\\">\"]},{\"type\":\"str\",\"children\":[\"</style>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<style class=\\\"hello\\\">' </style>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":27,"raw_source":"def test_double_quoted_words\n    assert_equal(['arg1', 'arg2', '\"arg 3\"'], 'arg1 arg2 \"arg 3\"'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_double_quoted_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"\\\"arg 3\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 \\\"arg 3\\\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":31,"raw_source":"def test_single_quoted_words\n    assert_equal(['arg1', 'arg2', \"'arg 3'\"], 'arg1 arg2 \\'arg 3\\''.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_quoted_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"'arg 3'\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 'arg 3'\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":35,"raw_source":"def test_quoted_words_in_the_middle\n    assert_equal(['arg1', 'arg2', '\"arg 3\"', 'arg4'], 'arg1 arg2 \"arg 3\" arg4   '.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quoted_words_in_the_middle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"\\\"arg 3\\\"\"]},{\"type\":\"str\",\"children\":[\"arg4\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 \\\"arg 3\\\" arg4   \"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":39,"raw_source":"def test_variable_parser\n    assert_equal(['var'],                               'var'.scan(VariableParser))\n    assert_equal(['[var]'],                             '[var]'.scan(VariableParser))\n    assert_equal(['var', 'method'],                     'var.method'.scan(VariableParser))\n    assert_equal(['var', '[method]'],                   'var[method]'.scan(VariableParser))\n    assert_equal(['var', '[method]', '[0]'],            'var[method][0]'.scan(VariableParser))\n    assert_equal(['var', '[\"method\"]', '[0]'],          'var[\"method\"][0]'.scan(VariableParser))\n    assert_equal(['var', '[method]', '[0]', 'method'],  'var[method][0].method'.scan(VariableParser))\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_parser\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var.method\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method][0]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[\\\"method\\\"]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[\\\"method\\\"][0]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]},{\"type\":\"str\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method][0].method\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":49,"raw_source":"def test_variable_parser_with_large_input\n    Timeout.timeout(1) { assert_equal(['[var]'], '[var]'.scan(VariableParser)) }\n\n    very_long_string = \"foo\" * 1000\n\n    # valid dynamic lookup\n    Timeout.timeout(1) { assert_equal([\"[#{very_long_string}]\"], \"[#{very_long_string}]\".scan(VariableParser)) }\n    # invalid dynamic lookup with missing closing bracket\n    Timeout.timeout(1) { assert_equal([very_long_string], \"[#{very_long_string}\".scan(VariableParser)) }\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_parser_with_large_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"very_long_string\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"*\",{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"str\",\"children\":[\"]\"]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":8,"raw_source":"def test_set\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(1, static_register[:a])\n    assert_equal(22, static_register[:b])\n    assert_equal(33, static_register[:c])\n  end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_set\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":18,"raw_source":"def test_get_missing_key\n    static_register = Registers.new\n\n    assert_nil(static_register[:missing])\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_get_missing_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"missing\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":24,"raw_source":"def test_delete\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_nil(static_register.delete(:a))\n\n    assert_equal(22, static_register.delete(:b))\n\n    assert_equal(33, static_register.delete(:c))\n    assert_nil(static_register[:c])\n\n    assert_nil(static_register.delete(:d))\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delete\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":39,"raw_source":"def test_fetch\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(1, static_register.fetch(:a))\n    assert_equal(1, static_register.fetch(:a, \"default\"))\n    assert_equal(22, static_register.fetch(:b))\n    assert_equal(22, static_register.fetch(:b, \"default\"))\n    assert_equal(33, static_register.fetch(:c))\n    assert_equal(33, static_register.fetch(:c, \"default\"))\n\n    assert_raises(KeyError) do\n      static_register.fetch(:d)\n    end\n    assert_equal(\"default\", static_register.fetch(:d, \"default\"))\n\n    result = static_register.fetch(:d) { \"default\" }\n    assert_equal(\"default\", result)\n\n    result = static_register.fetch(:d, \"default 1\") { \"default 2\" }\n    assert_equal(\"default 2\", result)\n  end","complexity_score":33.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"default 1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"default 2\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default 2\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":63,"raw_source":"def test_key\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(true, static_register.key?(:a))\n    assert_equal(true, static_register.key?(:b))\n    assert_equal(true, static_register.key?(:c))\n    assert_equal(false, static_register.key?(:d))\n  end","complexity_score":13.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":74,"raw_source":"def test_static_register_can_be_frozen\n    static_register = Registers.new(a: 1)\n\n    static_register.static.freeze\n\n    assert_raises(RuntimeError) do\n      static_register.static[:a] = \"foo\"\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static[:b] = \"foo\"\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static.delete(:a)\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static.delete(:c)\n    end\n  end","complexity_score":21.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_static_register_can_be_frozen\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"freeze\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":96,"raw_source":"def test_new_static_retains_static\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    new_static_register = Registers.new(static_register)\n    new_static_register[:b] = 222\n\n    newest_static_register = Registers.new(new_static_register)\n    newest_static_register[:c] = 333\n\n    assert_equal(1, static_register[:a])\n    assert_equal(22, static_register[:b])\n    assert_equal(33, static_register[:c])\n\n    assert_equal(1, new_static_register[:a])\n    assert_equal(222, new_static_register[:b])\n    assert_nil(new_static_register[:c])\n\n    assert_equal(1, newest_static_register[:a])\n    assert_equal(2, newest_static_register[:b])\n    assert_equal(333, newest_static_register[:c])\n  end","complexity_score":33.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_static_retains_static\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"new_static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"static_register\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[222]}]},{\"type\":\"lvasgn\",\"children\":[\"newest_static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"new_static_register\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[333]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[222]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[333]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":120,"raw_source":"def test_multiple_instances_are_unique\n    static_register_1 = Registers.new(a: 1, b: 2)\n    static_register_1[:b] = 22\n    static_register_1[:c] = 33\n\n    static_register_2 = Registers.new(a: 10, b: 20)\n    static_register_2[:b] = 220\n    static_register_2[:c] = 330\n\n    assert_equal({ a: 1, b: 2 }, static_register_1.static)\n    assert_equal(1, static_register_1[:a])\n    assert_equal(22, static_register_1[:b])\n    assert_equal(33, static_register_1[:c])\n\n    assert_equal({ a: 10, b: 20 }, static_register_2.static)\n    assert_equal(10, static_register_2[:a])\n    assert_equal(220, static_register_2[:b])\n    assert_equal(330, static_register_2[:c])\n  end","complexity_score":30.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_instances_are_unique\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register_1\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"static_register_2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[20]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[220]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[330]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"static\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[220]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[330]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":140,"raw_source":"def test_initialization_reused_static_same_memory_object\n    static_register_1 = Registers.new(a: 1, b: 2)\n    static_register_1[:b] = 22\n    static_register_1[:c] = 33\n\n    static_register_2 = Registers.new(static_register_1)\n\n    assert_equal(1, static_register_2[:a])\n    assert_equal(2, static_register_2[:b])\n    assert_nil(static_register_2[:c])\n\n    static_register_1.static[:b] = 222\n    static_register_1.static[:c] = 333\n\n    assert_same(static_register_1.static, static_register_2.static)\n  end","complexity_score":22.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_initialization_reused_static_same_memory_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register_1\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"static_register_2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"static_register_1\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[222]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[333]}]},{\"type\":\"send\",\"children\":[null,\"assert_same\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"static\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":8,"raw_source":"def test_add_filter_when_wrong_filter_class\n    c = Context.new\n    s = c.strainer\n    wrong_filter = ->(v) { v.reverse }\n\n    exception = assert_raises(TypeError) do\n      s.class.add_filter(wrong_filter)\n    end\n    assert_equal(exception.message, \"wrong argument type Proc (expected Module)\")\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_when_wrong_filter_class\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"strainer\"]}]},{\"type\":\"lvasgn\",\"children\":[\"wrong_filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"reverse\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"wrong_filter\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]},{\"type\":\"str\",\"children\":[\"wrong argument type Proc (expected Module)\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":22,"raw_source":"def public_filter\n      \"overriden as private\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"overriden as private\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":27,"raw_source":"def test_add_filter_raises_when_module_privately_overrides_registered_public_methods\n    error = assert_raises(Liquid::MethodOverrideError) do\n      Liquid::Environment.build do |env|\n        env.register_filter(PublicMethodOverrideFilter)\n        env.register_filter(PrivateMethodOverrideFilter)\n      end\n    end\n\n    assert_equal('Liquid error: Filter overrides registered public methods as non public: public_filter', error.message)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_raises_when_module_privately_overrides_registered_public_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MethodOverrideError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PrivateMethodOverrideFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Filter overrides registered public methods as non public: public_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":41,"raw_source":"def public_filter\n      \"overriden as protected\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"overriden as protected\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":46,"raw_source":"def test_add_filter_raises_when_module_overrides_registered_public_method_as_protected\n    error = assert_raises(Liquid::MethodOverrideError) do\n      Liquid::Environment.build do |env|\n        env.register_filter(PublicMethodOverrideFilter)\n        env.register_filter(ProtectedMethodOverrideFilter)\n      end\n    end\n\n    assert_equal('Liquid error: Filter overrides registered public methods as non public: public_filter', error.message)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_raises_when_module_overrides_registered_public_method_as_protected\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MethodOverrideError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"ProtectedMethodOverrideFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Filter overrides registered public methods as non public: public_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":58,"raw_source":"def public_filter\n      \"public\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"public\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":63,"raw_source":"def test_add_filter_does_not_raise_when_module_overrides_previously_registered_method\n    with_global_filter do\n      context = Context.new\n      context.add_filters([PublicMethodOverrideFilter])\n      strainer = context.strainer\n      assert(strainer.class.send(:filter_methods).include?('public_filter'))\n    end\n  end","complexity_score":17.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_does_not_raise_when_module_overrides_previously_registered_method\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"filter_methods\"]}]},\"include?\",{\"type\":\"str\",\"children\":[\"public_filter\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":72,"raw_source":"def test_add_filter_does_not_include_already_included_module\n    mod = Module.new do\n      class << self\n        attr_accessor :include_count\n        def included(_mod)\n          self.include_count += 1\n        end\n      end\n      self.include_count = 0\n    end\n    strainer = Context.new.strainer\n    strainer.class.add_filter(mod)\n    strainer.class.add_filter(mod)\n    assert_equal(1, mod.include_count)\n  end","complexity_score":20.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_does_not_include_already_included_module\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"mod\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"sclass\",\"children\":[{\"type\":\"self\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"attr_accessor\",{\"type\":\"sym\",\"children\":[\"include_count\"]}]},{\"type\":\"def\",\"children\":[\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_mod\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"include_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"include_count=\",{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]},\"strainer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mod\"]},\"include_count\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":76,"raw_source":"def included(_mod)\n          self.include_count += 1\n        end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_mod\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"include_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":8,"raw_source":"def test_tag\n    tag = Tag.parse('tag', \"\", new_tokenizer, ParseContext.new)\n    assert_equal('liquid::tag', tag.name)\n    assert_equal('', tag.render(Context.new))\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"liquid::tag\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"render\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":14,"raw_source":"def test_return_raw_text_of_tag\n    tag = Tag.parse(\"long_tag\", \"param1, param2, param3\", new_tokenizer, ParseContext.new)\n    assert_equal(\"long_tag param1, param2, param3\", tag.raw)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_return_raw_text_of_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"long_tag\"]},{\"type\":\"str\",\"children\":[\"param1, param2, param3\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"long_tag param1, param2, param3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"raw\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":19,"raw_source":"def test_tag_name_should_return_name_of_the_tag\n    tag = Tag.parse(\"some_tag\", \"\", new_tokenizer, ParseContext.new)\n    assert_equal('some_tag', tag.tag_name)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_name_should_return_name_of_the_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"tag_name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":25,"raw_source":"def render(_context); end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]}]},null]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":28,"raw_source":"def test_tag_render_to_output_buffer_nil_value\n    custom_tag = CustomTag.parse(\"some_tag\", \"\", new_tokenizer, ParseContext.new)\n    assert_equal('some string', custom_tag.render_to_output_buffer(Context.new, \"some string\"))\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_render_to_output_buffer_nil_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"custom_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CustomTag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some string\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"custom_tag\"]},\"render_to_output_buffer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]},{\"type\":\"str\",\"children\":[\"some string\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":35,"raw_source":"def new_tokenizer\n    Tokenizer.new(\n      source: \"\",\n      string_scanner: StringScanner.new(\"\"),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_tokenizer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/case_tag_unit_test.rb","start_line":8,"raw_source":"def test_case_nodelist\n    template = Liquid::Template.parse('{% case var %}{% when true %}WHEN{% else %}ELSE{% endcase %}')\n    assert_equal(['WHEN', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% case var %}{% when true %}WHEN{% else %}ELSE{% endcase %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"WHEN\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":6,"raw_source":"def test_comment_inside_liquid_tag\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% liquid\n        if 1 != 1\n        comment\n        else\n          echo 123\n        endcomment\n        endif\n      %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_inside_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  if 1 != 1\\n\"]},{\"type\":\"str\",\"children\":[\"  comment\\n\"]},{\"type\":\"str\",\"children\":[\"  else\\n\"]},{\"type\":\"str\",\"children\":[\"    echo 123\\n\"]},{\"type\":\"str\",\"children\":[\"  endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  endif\\n\"]},{\"type\":\"str\",\"children\":[\"%}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":19,"raw_source":"def test_does_not_parse_nodes_inside_a_comment\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% if true %}\n        {% if ... %}\n        {%- for ? -%}\n        {% while true %}\n        {%\n          unless if\n        %}\n        {% endcase %}\n      {% endcomment %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_parse_nodes_inside_a_comment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if ... %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- for ? -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% while true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%\\n\"]},{\"type\":\"str\",\"children\":[\"    unless if\\n\"]},{\"type\":\"str\",\"children\":[\"  %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcase %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":34,"raw_source":"def test_allows_unclosed_tags\n    assert_template_result('', <<~LIQUID.chomp)\n      {% comment %}\n        {% if true %}\n      {% endcomment %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_allows_unclosed_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":42,"raw_source":"def test_open_tags_in_comment\n    assert_template_result('', <<~LIQUID.chomp)\n      {% comment %}\n        {% assign a = 123 {% comment %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% assign foo = \"1\"\n        {% endcomment %}\n      LIQUID\n    end\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% comment %}\n            {% invalid\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n        {% {{ {%- endcomment %}\n      LIQUID\n    end\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_open_tags_in_comment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign a = 123 {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = \\\"1\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% invalid\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% {{ {%- endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":75,"raw_source":"def test_child_comment_tags_need_to_be_closed\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% comment %}\n          {% comment %}{%    endcomment     %}\n        {% endcomment %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% comment %}\n            {% comment %}\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_child_comment_tags_need_to_be_closed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% comment %}{%    endcomment     %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":95,"raw_source":"def test_child_raw_tags_need_to_be_closed\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% raw %}\n          {% endcomment %}\n        {% endraw %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      Liquid::Template.parse(<<~LIQUID.chomp)\n        {% comment %}\n          {% raw %}\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_child_raw_tags_need_to_be_closed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endraw %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":114,"raw_source":"def test_error_line_number_is_correct\n    template = Liquid::Template.parse(<<~LIQUID.chomp, line_numbers: true)\n      {% comment %}\n        {% if true %}\n      {% endcomment %}\n      {{ errors.standard_error }}\n    LIQUID\n\n    output = template.render('errors' => ErrorDrop.new)\n    expected = <<~TEXT.chomp\n\n      Liquid error (line 4): standard error\n    TEXT\n\n    assert_equal(expected, output)\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_line_number_is_correct\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ errors.standard_error }}\\n\"]}]},\"chomp\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Liquid error (line 4): standard error\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":131,"raw_source":"def test_comment_tag_delimiter_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% comment %}\n          {% comment %}\n          {% endcomment\n          {% if true %}\n          {% endif %}\n        {% endcomment %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_tag_delimiter_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":145,"raw_source":"def test_nested_comment_tag_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% comment %}\n          {% comment\n            {% assign foo = 1 %}\n          {% endcomment\n          {% assign foo = 1 %}\n        {% endcomment %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_comment_tag_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment\\n\"]},{\"type\":\"str\",\"children\":[\"    {% assign foo = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":159,"raw_source":"def test_ignores_delimiter_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% if true %}\n          {% comment %}\n            {% commentXXXXX %}wut{% endcommentXXXXX %}\n          {% endcomment %}\n        {% endif %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ignores_delimiter_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% commentXXXXX %}wut{% endcommentXXXXX %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":172,"raw_source":"def test_delimiter_can_have_extra_strings\n    assert_template_result('', \"{% comment %}123{% endcomment xyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\txyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\nxyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\n   xyz  endcomment %}\")\n    assert_template_result('', \"{%comment}{% assign a = 1 %}{%endcomment}{% endif %}\")\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delimiter_can_have_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment xyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\txyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\nxyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\n   xyz  endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment}{% assign a = 1 %}{%endcomment}{% endif %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":180,"raw_source":"def test_with_whitespace_control\n    assert_template_result(\"Hello!\", \"      {%- comment -%}123{%- endcomment -%}Hello!\")\n    assert_template_result(\"Hello!\", \"{%- comment -%}123{%- endcomment -%}     Hello!\")\n    assert_template_result(\"Hello!\", \"      {%- comment -%}123{%- endcomment -%}     Hello!\")\n\n    assert_template_result(\"Hello!\", <<~LIQUID.chomp)\n      {%- comment %}Whitespace control!{% endcomment -%}\n      Hello!\n    LIQUID\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- comment -%}123{%- endcomment -%}Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"{%- comment -%}123{%- endcomment -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- comment -%}123{%- endcomment -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- comment %}Whitespace control!{% endcomment -%}\\n\"]},{\"type\":\"str\",\"children\":[\"Hello!\\n\"]}]},\"chomp\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":191,"raw_source":"def test_dont_override_liquid_tag_whitespace_control\n    assert_template_result(\"Hello!World!\", <<~LIQUID.chomp)\n      Hello!\n      {%- liquid\n        comment\n         this is inside a liquid tag\n        endcomment\n      -%}\n      World!\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dont_override_liquid_tag_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!World!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Hello!\\n\"]},{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  comment\\n\"]},{\"type\":\"str\",\"children\":[\"   this is inside a liquid tag\\n\"]},{\"type\":\"str\",\"children\":[\"  endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]},{\"type\":\"str\",\"children\":[\"World!\\n\"]}]},\"chomp\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":6,"raw_source":"def test_doc_tag\n    template = <<~LIQUID.chomp\n      {% doc %}\n        Renders loading-spinner.\n\n        @param {string} foo - some foo\n        @param {string} [bar] - optional bar\n\n        @example\n        {% render 'loading-spinner', foo: 'foo' %}\n        {% render 'loading-spinner', foo: 'foo', bar: 'bar' %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  Renders loading-spinner.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  @param {string} foo - some foo\\n\"]},{\"type\":\"str\",\"children\":[\"  @param {string} [bar] - optional bar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  @example\\n\"]},{\"type\":\"str\",\"children\":[\"  {% render 'loading-spinner', foo: 'foo' %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% render 'loading-spinner', foo: 'foo', bar: 'bar' %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":23,"raw_source":"def test_doc_tag_body_content\n    doc_content = \"  Documentation content\\n  @param {string} foo - test\\n\"\n    template_source = \"{% doc %}#{doc_content}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(doc_content, doc_tag.nodelist.first.to_s)\n  end","complexity_score":17.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_body_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc_content\",{\"type\":\"str\",\"children\":[\"  Documentation content\\n  @param {string} foo - test\\n\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"doc_content\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]},\"to_s\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":38,"raw_source":"def test_doc_tag_does_not_support_extra_arguments\n    error = assert_raises(Liquid::SyntaxError) do\n      template = <<~LIQUID.chomp\n        {% doc extra %}\n        {% enddoc %}\n      LIQUID\n\n      Liquid::Template.parse(template)\n    end\n\n    exp_error = \"Liquid syntax error: Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"\n    act_error = error.message\n\n    assert_equal(exp_error, act_error)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_does_not_support_extra_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc extra %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exp_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"act_error\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exp_error\"]},{\"type\":\"lvar\",\"children\":[\"act_error\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":54,"raw_source":"def test_doc_tag_must_support_valid_tags\n    assert_match_syntax_error(\"Liquid syntax error (line 1): 'doc' tag was never closed\", '{% doc %} foo')\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\", '{% doc } foo {% enddoc %}')\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\", '{% doc } foo %}{% enddoc %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_must_support_valid_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): 'doc' tag was never closed\"]},{\"type\":\"str\",\"children\":[\"{% doc %} foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]},{\"type\":\"str\",\"children\":[\"{% doc } foo {% enddoc %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]},{\"type\":\"str\",\"children\":[\"{% doc } foo %}{% enddoc %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":60,"raw_source":"def test_doc_tag_ignores_liquid_nodes\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% if true %}\n        {% if ... %}\n        {%- for ? -%}\n        {% while true %}\n        {%\n          unless if\n        %}\n        {% endcase %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_liquid_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if ... %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- for ? -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% while true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%\\n\"]},{\"type\":\"str\",\"children\":[\"    unless if\\n\"]},{\"type\":\"str\",\"children\":[\"  %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcase %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":77,"raw_source":"def test_doc_tag_ignores_unclosed_liquid_tags\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% if true %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_unclosed_liquid_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":87,"raw_source":"def test_doc_tag_does_not_allow_nested_docs\n    error = assert_raises(Liquid::SyntaxError) do\n      template = <<~LIQUID.chomp\n        {% doc %}\n          {% doc %}\n            {% doc %}\n        {% enddoc %}\n      LIQUID\n\n      Liquid::Template.parse(template)\n    end\n\n    exp_error = \"Liquid syntax error: Syntax Error in 'doc' - Nested doc tags are not allowed\"\n    act_error = error.message\n\n    assert_equal(exp_error, act_error)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_does_not_allow_nested_docs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exp_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Syntax Error in 'doc' - Nested doc tags are not allowed\"]}]},{\"type\":\"lvasgn\",\"children\":[\"act_error\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exp_error\"]},{\"type\":\"lvar\",\"children\":[\"act_error\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":105,"raw_source":"def test_doc_tag_ignores_nested_raw_tags\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% raw %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_nested_raw_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":115,"raw_source":"def test_doc_tag_ignores_unclosed_assign\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% assign foo = \"1\"\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_unclosed_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = \\\"1\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":125,"raw_source":"def test_doc_tag_ignores_malformed_syntax\n    template = <<~LIQUID.chomp\n      {% doc %}\n      {% {{ {%- enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_malformed_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% {{ {%- enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":134,"raw_source":"def test_doc_tag_captures_token_before_enddoc\n    template_source = \"{% doc %}{{ incomplete{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(\"{{ incomplete\", doc_tag.nodelist.first.to_s)\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_captures_token_before_enddoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{{ incomplete{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"{{ incomplete\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]},\"to_s\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":148,"raw_source":"def test_doc_tag_preserves_error_line_numbers\n    template = Liquid::Template.parse(<<~LIQUID.chomp, line_numbers: true)\n      {% doc %}\n        {% if true %}\n      {% enddoc %}\n      {{ errors.standard_error }}\n    LIQUID\n\n    expected = <<~TEXT.chomp\n\n      Liquid error (line 4): standard error\n    TEXT\n\n    assert_equal(expected, template.render('errors' => ErrorDrop.new))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_preserves_error_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ errors.standard_error }}\\n\"]}]},\"chomp\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Liquid error (line 4): standard error\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":164,"raw_source":"def test_doc_tag_whitespace_control\n    # Basic whitespace control\n    assert_template_result(\"Hello!\", \"      {%- doc -%}123{%- enddoc -%}Hello!\")\n    assert_template_result(\"Hello!\", \"{%- doc -%}123{%- enddoc -%}     Hello!\")\n    assert_template_result(\"Hello!\", \"      {%- doc -%}123{%- enddoc -%}     Hello!\")\n    assert_template_result(\"Hello!\", <<~LIQUID.chomp)\n      {%- doc %}Whitespace control!{% enddoc -%}\n      Hello!\n    LIQUID\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- doc -%}123{%- enddoc -%}Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"{%- doc -%}123{%- enddoc -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- doc -%}123{%- enddoc -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- doc %}Whitespace control!{% enddoc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"Hello!\\n\"]}]},\"chomp\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":175,"raw_source":"def test_doc_tag_delimiter_handling\n    assert_template_result('', <<~LIQUID.chomp)\n      {%- if true -%}\n        {%- doc -%}\n          {%- docEXTRA -%}wut{% enddocEXTRA -%}xyz\n        {%- enddoc -%}\n      {%- endif -%}\n    LIQUID\n\n    assert_template_result('', \"{% doc %}123{% enddoc xyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\txyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\nxyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\n   xyz  enddoc %}\")\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_delimiter_handling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- doc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"    {%- docEXTRA -%}wut{% enddocEXTRA -%}xyz\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- enddoc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endif -%}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc xyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\txyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\nxyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\n   xyz  enddoc %}\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":190,"raw_source":"def test_doc_tag_visitor\n    template_source = '{% doc %}{% enddoc %}'\n\n    assert_equal(\n      [Liquid::Doc],\n      visit(template_source),\n    )\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_visitor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":199,"raw_source":"def test_doc_tag_blank_with_empty_content\n    template_source = \"{% doc %}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(true, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_empty_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":213,"raw_source":"def test_doc_tag_blank_with_content\n    template_source = \"{% doc %}Some documentation{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(false, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}Some documentation{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":227,"raw_source":"def test_doc_tag_blank_with_whitespace_only\n    template_source = \"{% doc %}    {% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(false, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_whitespace_only\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}    {% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":241,"raw_source":"def test_doc_tag_nodelist_returns_array_with_body\n    doc_content = \"Documentation content\\n@param {string} foo\"\n    template_source = \"{% doc %}#{doc_content}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal([doc_content], doc_tag.nodelist)\n    assert_equal(1, doc_tag.nodelist.length)\n    assert_equal(doc_content, doc_tag.nodelist.first)\n  end","complexity_score":22.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_nodelist_returns_array_with_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc_content\",{\"type\":\"str\",\"children\":[\"Documentation content\\n@param {string} foo\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"doc_content\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":258,"raw_source":"def test_doc_tag_nodelist_with_empty_content\n    template_source = \"{% doc %}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal([\"\"], doc_tag.nodelist)\n    assert_equal(1, doc_tag.nodelist.length)\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_nodelist_with_empty_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"length\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":275,"raw_source":"def traversal(template)\n    ParseTreeVisitor\n      .for(Template.parse(template).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        tag_class = tag.class\n        tag_class\n      end\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"traversal\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_class\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"tag_class\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":284,"raw_source":"def visit(template)\n    traversal(template).visit.flatten.compact\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"visit\"]},\"flatten\"]},\"compact\"]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/for_tag_unit_test.rb","start_line":6,"raw_source":"def test_for_nodelist\n    template = Liquid::Template.parse('{% for item in items %}FOR{% endfor %}')\n    assert_equal(['FOR'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in items %}FOR{% endfor %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"FOR\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/for_tag_unit_test.rb","start_line":11,"raw_source":"def test_for_else_nodelist\n    template = Liquid::Template.parse('{% for item in items %}FOR{% else %}ELSE{% endfor %}')\n    assert_equal(['FOR', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_else_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in items %}FOR{% else %}ELSE{% endfor %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"FOR\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/if_tag_unit_test.rb","start_line":6,"raw_source":"def test_if_nodelist\n    template = Liquid::Template.parse('{% if true %}IF{% else %}ELSE{% endif %}')\n    assert_equal(['IF', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %}IF{% else %}ELSE{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"IF\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_factory_unit_test.rb","start_line":8,"raw_source":"def test_for_returns_liquid_template_instance\n    template = TemplateFactory.new.for(\"anything\")\n    assert_instance_of(Liquid::Template, template)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_returns_liquid_template_instance\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateFactory\"]},\"new\"]},\"for\",{\"type\":\"str\",\"children\":[\"anything\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":8,"raw_source":"def test_sets_default_localization_in_document\n    t = Template.new\n    t.parse('{%comment%}{%endcomment%}')\n    assert_instance_of(I18n, t.root.nodelist[0].options[:locale])\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_localization_in_document\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"I18n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":14,"raw_source":"def test_sets_default_localization_in_context_with_quick_initialization\n    t = Template.new\n    t.parse('{%comment%}{%endcomment%}', locale: I18n.new(fixture(\"en_locale.yml\")))\n\n    locale = t.root.nodelist[0].options[:locale]\n    assert_instance_of(I18n, locale)\n    assert_equal(fixture(\"en_locale.yml\"), locale.path)\n  end","complexity_score":18.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_localization_in_context_with_quick_initialization\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"locale\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"I18n\"]},{\"type\":\"lvar\",\"children\":[\"locale\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"locale\"]},\"path\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":25,"raw_source":"def test_tags_can_be_looped_over\n    with_custom_tag('fake', FakeTag) do\n      result = Template.tags.map { |name, klass| [name, klass] }\n      assert(result.include?([\"fake\", TemplateUnitTest::FakeTag]))\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tags_can_be_looped_over\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"const\",\"children\":[null,\"FakeTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"tags\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"include?\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateUnitTest\"]},\"FakeTag\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":35,"raw_source":"def test_template_inheritance\n    assert_equal(\"foo\", TemplateSubclass.parse(\"foo\").render)\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_template_inheritance\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateSubclass\"]},\"parse\",{\"type\":\"str\",\"children\":[\"foo\"]}]},\"render\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":39,"raw_source":"def test_invalid_utf8\n    input = \"\\xff\\x00\"\n    error = assert_raises(SyntaxError) do\n      Liquid::Tokenizer.new(source: input, string_scanner: StringScanner.new(input))\n    end\n    assert_equal(\n      'Liquid syntax error: Invalid byte sequence in UTF-8',\n      error.message,\n    )\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_utf8\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Invalid byte sequence in UTF-8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":6,"raw_source":"def test_tokenize_strings\n    assert_equal([' '], tokenize(' '))\n    assert_equal(['hello world'], tokenize('hello world'))\n    assert_equal(['{}'], tokenize('{}'))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"hello world\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"hello world\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":12,"raw_source":"def test_tokenize_variables\n    assert_equal(['{{funk}}'], tokenize('{{funk}}'))\n    assert_equal([' ', '{{funk}}', ' '], tokenize(' {{funk}} '))\n    assert_equal([' ', '{{funk}}', ' ', '{{so}}', ' ', '{{brother}}', ' '], tokenize(' {{funk}} {{so}} {{brother}} '))\n    assert_equal([' ', '{{  funk  }}', ' '], tokenize(' {{  funk  }} '))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{funk}}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{funk}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{funk}}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{so}}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{brother}}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{funk}} {{so}} {{brother}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{  funk  }}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{  funk  }} \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":19,"raw_source":"def test_tokenize_blocks\n    assert_equal(['{%comment%}'], tokenize('{%comment%}'))\n    assert_equal([' ', '{%comment%}', ' '], tokenize(' {%comment%} '))\n\n    assert_equal([' ', '{%comment%}', ' ', '{%endcomment%}', ' '], tokenize(' {%comment%} {%endcomment%} '))\n    assert_equal(['  ', '{% comment %}', ' ', '{% endcomment %}', ' '], tokenize(\"  {% comment %} {% endcomment %} \"))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%comment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%comment%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%comment%}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {%comment%} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%comment%}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%endcomment%}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {%comment%} {%endcomment%} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\"{% comment %}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"  {% comment %} {% endcomment %} \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":27,"raw_source":"def test_calculate_line_numbers_per_token_with_profiling\n    assert_equal([1],       tokenize_line_numbers(\"{{funk}}\"))\n    assert_equal([1, 1, 1], tokenize_line_numbers(\" {{funk}} \"))\n    assert_equal([1, 2, 2], tokenize_line_numbers(\"\\n{{funk}}\\n\"))\n    assert_equal([1, 1, 3], tokenize_line_numbers(\" {{\\n funk \\n}} \"))\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_calculate_line_numbers_per_token_with_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\" {{funk}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\"\\n{{funk}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\" {{\\n funk \\n}} \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":34,"raw_source":"def test_tokenize_with_nil_source_returns_empty_array\n    assert_equal([], tokenize(nil))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_with_nil_source_returns_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":38,"raw_source":"def test_incomplete_curly_braces\n    assert_equal([\"{{.}\", \" \"], tokenize('{{.} '))\n    assert_equal([\"{{}\", \"%}\"], tokenize('{{}%}'))\n    assert_equal([\"{{}}\", \"}\"], tokenize('{{}}}'))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_incomplete_curly_braces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{.}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{.} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{}\"]},{\"type\":\"str\",\"children\":[\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{}%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{}}\"]},{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{}}}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":44,"raw_source":"def test_unmatching_start_and_end\n    assert_equal([\"{{%}\"], tokenize('{{%}'))\n    assert_equal([\"{{%%%}}\"], tokenize('{{%%%}}'))\n    assert_equal([\"{%\", \"}}\"], tokenize('{%}}'))\n    assert_equal([\"{%%}\", \"}\"], tokenize('{%%}}'))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unmatching_start_and_end\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{%%%}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{%%%}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%\"]},{\"type\":\"str\",\"children\":[\"}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%%}\"]},{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%%}}\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":53,"raw_source":"def new_tokenizer(source, parse_context: Liquid::ParseContext.new, start_line_number: nil)\n    parse_context.new_tokenizer(source, start_line_number: start_line_number)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_tokenizer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"kwoptarg\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"kwoptarg\",\"children\":[\"start_line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"lvar\",\"children\":[\"start_line_number\"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":57,"raw_source":"def tokenize(source)\n    tokenizer = new_tokenizer(source)\n    tokens    = []\n    # shift is private in Liquid::C::Tokenizer, since it is only for unit testing\n    while (t = tokenizer.send(:shift))\n      tokens << t\n    end\n    tokens\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[null,\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tokens\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":67,"raw_source":"def tokenize_line_numbers(source)\n    tokenizer    = new_tokenizer(source, start_line_number: 1)\n    line_numbers = []\n    loop do\n      line_number = tokenizer.line_number\n      if tokenizer.send(:shift)\n        line_numbers << line_number\n      else\n        break\n      end\n    end\n    line_numbers\n  end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize_line_numbers\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[null,\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"line_numbers\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_numbers\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"break\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"line_numbers\"]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":8,"raw_source":"def test_variable\n    var = create_variable('hello')\n    assert_equal(VariableLookup.new('hello'), var.name)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":13,"raw_source":"def test_filters\n    var = create_variable('hello | textileze')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []]], var.filters)\n\n    var = create_variable('hello | textileze | paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable(%( hello | strftime: '%Y'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['strftime', ['%Y']]], var.filters)\n\n    var = create_variable(%( 'typo' | link_to: 'Typo', true ))\n    assert_equal('typo', var.name)\n    assert_equal([['link_to', ['Typo', true]]], var.filters)\n\n    var = create_variable(%( 'typo' | link_to: 'Typo', false ))\n    assert_equal('typo', var.name)\n    assert_equal([['link_to', ['Typo', false]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3, 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3, 3]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3, 3, 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3, 3, 3]]], var.filters)\n\n    var = create_variable(%( hello | strftime: '%Y, okay?'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['strftime', ['%Y, okay?']]], var.filters)\n\n    var = create_variable(%( hello | things: \"%Y, okay?\", 'the other one'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['things', ['%Y, okay?', 'the other one']]], var.filters)\n  end","complexity_score":71.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze | paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | strftime: '%Y'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"strftime\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'typo' | link_to: 'Typo', true \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"typo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"link_to\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Typo\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'typo' | link_to: 'Typo', false \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"typo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"link_to\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Typo\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3, 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3, 3, 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | strftime: '%Y, okay?'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"strftime\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y, okay?\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | things: \\\"%Y, okay?\\\", 'the other one'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"things\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y, okay?\"]},{\"type\":\"str\",\"children\":[\"the other one\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":55,"raw_source":"def test_filter_with_date_parameter\n    var = create_variable(%( '2006-06-06' | date: \"%m/%d/%Y\"))\n    assert_equal('2006-06-06', var.name)\n    assert_equal([['date', ['%m/%d/%Y']]], var.filters)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_date_parameter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" '2006-06-06' | date: \\\"%m/%d/%Y\\\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-06-06\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"date\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":61,"raw_source":"def test_filters_without_whitespace\n    var = create_variable('hello | textileze | paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable('hello|textileze|paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable(\"hello|replace:'foo','bar'|textileze\")\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['replace', ['foo', 'bar']], ['textileze', []]], var.filters)\n  end","complexity_score":22.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filters_without_whitespace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze | paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello|textileze|paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello|replace:'foo','bar'|textileze\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"replace\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":75,"raw_source":"def test_symbol\n    var = create_variable(\"http://disney.com/logo.gif | image: 'med' \", error_mode: :lax)\n    assert_equal(VariableLookup.new('http://disney.com/logo.gif'), var.name)\n    assert_equal([['image', ['med']]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_symbol\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif | image: 'med' \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"image\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"med\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":81,"raw_source":"def test_string_to_filter\n    var = create_variable(\"'http://disney.com/logo.gif' | image: 'med' \")\n    assert_equal('http://disney.com/logo.gif', var.name)\n    assert_equal([['image', ['med']]], var.filters)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_to_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"'http://disney.com/logo.gif' | image: 'med' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"image\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"med\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":87,"raw_source":"def test_string_single_quoted\n    var = create_variable(%( \"hello\" ))\n    assert_equal('hello', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_single_quoted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" \\\"hello\\\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":92,"raw_source":"def test_string_double_quoted\n    var = create_variable(%( 'hello' ))\n    assert_equal('hello', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_double_quoted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'hello' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":97,"raw_source":"def test_integer\n    var = create_variable(%( 1000 ))\n    assert_equal(1000, var.name)\n  end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_integer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 1000 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1000]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":102,"raw_source":"def test_float\n    var = create_variable(%( 1000.01 ))\n    assert_equal(1000.01, var.name)\n  end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 1000.01 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[1000.01]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":107,"raw_source":"def test_dashes\n    assert_equal(VariableLookup.new('foo-bar'), create_variable('foo-bar').name)\n    assert_equal(VariableLookup.new('foo-bar-2'), create_variable('foo-bar-2').name)\n\n    with_error_mode(:strict) do\n      assert_raises(Liquid::SyntaxError) { create_variable('foo - bar') }\n      assert_raises(Liquid::SyntaxError) { create_variable('-foo') }\n      assert_raises(Liquid::SyntaxError) { create_variable('2foo') }\n    end\n  end","complexity_score":22.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dashes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo-bar\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo-bar\"]}]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo-bar-2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo-bar-2\"]}]},\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo - bar\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"-foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"2foo\"]}]}]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":118,"raw_source":"def test_string_with_special_chars\n    var = create_variable(%( 'hello! $!@.;\"ddasd\" ' ))\n    assert_equal('hello! $!@.;\"ddasd\" ', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_with_special_chars\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'hello! $!@.;\\\"ddasd\\\" ' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello! $!@.;\\\"ddasd\\\" \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":123,"raw_source":"def test_string_dot\n    var = create_variable(%( test.test ))\n    assert_equal(VariableLookup.new('test.test'), var.name)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_dot\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" test.test \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"test.test\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":128,"raw_source":"def test_filter_with_keyword_arguments\n    var = create_variable(%( hello | things: greeting: \"world\", farewell: 'goodbye'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['things', [], { 'greeting' => 'world', 'farewell' => 'goodbye' }]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_keyword_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | things: greeting: \\\"world\\\", farewell: 'goodbye'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"things\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"world\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"farewell\"]},{\"type\":\"str\",\"children\":[\"goodbye\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":134,"raw_source":"def test_lax_filter_argument_parsing\n    var = create_variable(%( number_of_comments | pluralize: 'comment': 'comments' ), error_mode: :lax)\n    assert_equal(VariableLookup.new('number_of_comments'), var.name)\n    assert_equal([['pluralize', ['comment', 'comments']]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lax_filter_argument_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" number_of_comments | pluralize: 'comment': 'comments' \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"number_of_comments\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"pluralize\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"comment\"]},{\"type\":\"str\",\"children\":[\"comments\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":140,"raw_source":"def test_strict_filter_argument_parsing\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        create_variable(%( number_of_comments | pluralize: 'comment': 'comments' ))\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strict_filter_argument_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" number_of_comments | pluralize: 'comment': 'comments' \"]}]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":148,"raw_source":"def test_output_raw_source_of_variable\n    var = create_variable(%( name_of_variable | upcase ))\n    assert_equal(\" name_of_variable | upcase \", var.raw)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_output_raw_source_of_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" name_of_variable | upcase \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" name_of_variable | upcase \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"raw\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":153,"raw_source":"def test_variable_lookup_interface\n    lookup = VariableLookup.new('a.b.c')\n    assert_equal('a', lookup.name)\n    assert_equal(['b', 'c'], lookup.lookups)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_interface\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"a.b.c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"lookups\"]}]}]}]}"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":161,"raw_source":"def create_variable(markup, options = {})\n    Variable.new(markup, ParseContext.new(options))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"create_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":36,"raw_source":"def accept\n      @env['sinatra.accept'] ||= if @env.include?('HTTP_ACCEPT') && (@env['HTTP_ACCEPT'].to_s != '')\n                                   @env['HTTP_ACCEPT']\n                                     .to_s\n                                     .scan(HEADER_VALUE_WITH_PARAMS)\n                                     .map! { |e| AcceptEntry.new(e) }\n                                     .sort\n                                 else\n                                   [AcceptEntry.new('*/*')]\n                                 end\n    end","complexity_score":18.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accept\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.accept\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},\"to_s\"]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},\"to_s\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_VALUE_WITH_PARAMS\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AcceptEntry\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},\"sort\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AcceptEntry\"]},\"new\",{\"type\":\"str\",\"children\":[\"*/*\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":48,"raw_source":"def accept?(type)\n      preferred_type(type).to_s.include?(type)\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"accept?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"preferred_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"to_s\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":52,"raw_source":"def preferred_type(*types)\n      return accept.first if types.empty?\n\n      types.flatten!\n      return types.first if accept.empty?\n\n      accept.detect do |accept_header|\n        type = types.detect { |t| MimeTypeEntry.new(t).accepts?(accept_header) }\n        return type if type\n      end\n    end","complexity_score":20.5,"ast_json":"{\"type\":\"def\",\"children\":[\"preferred_type\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"first\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"flatten!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"accept_header\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MimeTypeEntry\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"accepts?\",{\"type\":\"lvar\",\"children\":[\"accept_header\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":66,"raw_source":"def forwarded?\n      !forwarded_authority.nil?\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"forwarded?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"forwarded_authority\"]},\"nil?\"]},\"!\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":70,"raw_source":"def safe?\n      get? || head? || options? || trace?\n    end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get?\"]},{\"type\":\"send\",\"children\":[null,\"head?\"]}]},{\"type\":\"send\",\"children\":[null,\"options?\"]}]},{\"type\":\"send\",\"children\":[null,\"trace?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":74,"raw_source":"def idempotent?\n      safe? || put? || delete? || link? || unlink?\n    end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\"]},{\"type\":\"send\",\"children\":[null,\"put?\"]}]},{\"type\":\"send\",\"children\":[null,\"delete?\"]}]},{\"type\":\"send\",\"children\":[null,\"link?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlink?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":78,"raw_source":"def link?\n      request_method == 'LINK'\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"LINK\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":82,"raw_source":"def unlink?\n      request_method == 'UNLINK'\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"UNLINK\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":86,"raw_source":"def params\n      super\n    rescue Rack::Utils::ParameterTypeError, Rack::Utils::InvalidParameterError => e\n      raise BadRequest, \"Invalid query parameters: #{Rack::Utils.escape_html(e.message)}\"\n    rescue EOFError => e\n      raise BadRequest, \"Invalid multipart/form-data: #{Rack::Utils.escape_html(e.message)}\"\n    end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"params\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"ParameterTypeError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"InvalidParameterError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"BadRequest\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid query parameters: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"BadRequest\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid multipart/form-data: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":98,"raw_source":"def initialize(entry)\n        params = entry.scan(HEADER_PARAM).map! do |s|\n          key, value = s.strip.split('=', 2)\n          value = value[1..-2].gsub(/\\\\(.)/, '\\1') if value.start_with?('\"')\n          [key, value]\n        end\n\n        @entry  = entry\n        @type   = entry[/[^;]+/].delete(' ')\n        @params = params.to_h\n        @q      = @params.delete('q') { 1.0 }.to_f\n      end","complexity_score":28.18,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_PARAM\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"strip\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\\\\(.)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\\\\1\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@entry\",{\"type\":\"lvar\",\"children\":[\"entry\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"delete\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"to_h\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@q\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"delete\",{\"type\":\"str\",\"children\":[\"q\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"float\",\"children\":[1.0]}]},\"to_f\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":111,"raw_source":"def <=>(other)\n        other.priority <=> priority\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<=>\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"priority\"]},\"<=>\",{\"type\":\"send\",\"children\":[null,\"priority\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":115,"raw_source":"def priority\n        # We sort in descending order; better matches should be higher.\n        [@q, -@type.count('*'), @params.size]\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"priority\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@q\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@type\"]},\"count\",{\"type\":\"str\",\"children\":[\"*\"]}]},\"-@\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"size\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":120,"raw_source":"def to_str\n        @type\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_str\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@type\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":124,"raw_source":"def to_s(full = false)\n        full ? entry : to_str\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"full\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"full\"]},{\"type\":\"send\",\"children\":[null,\"entry\"]},{\"type\":\"send\",\"children\":[null,\"to_str\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":128,"raw_source":"def respond_to?(*args)\n        super || to_str.respond_to?(*args)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_str\"]},\"respond_to?\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":132,"raw_source":"def method_missing(*args, &block)\n        to_str.send(*args, &block)\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_str\"]},\"send\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":140,"raw_source":"def initialize(entry)\n        params = entry.scan(HEADER_PARAM).map! do |s|\n          key, value = s.strip.split('=', 2)\n          value = value[1..-2].gsub(/\\\\(.)/, '\\1') if value.start_with?('\"')\n          [key, value]\n        end\n\n        @type   = entry[/[^;]+/].delete(' ')\n        @params = params.to_h\n      end","complexity_score":22.45,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_PARAM\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"strip\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\\\\(.)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\\\\1\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"delete\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"to_h\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":151,"raw_source":"def accepts?(entry)\n        File.fnmatch(entry, self) && matches_params?(entry.params)\n      end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"fnmatch\",{\"type\":\"lvar\",\"children\":[\"entry\"]},{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"matches_params?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"params\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":155,"raw_source":"def to_str\n        @type\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_str\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@type\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":159,"raw_source":"def matches_params?(params)\n        return true if @params.empty?\n\n        params.all? { |k, v| !@params.key?(k) || @params[k] == v }\n      end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"matches_params?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":174,"raw_source":"def body=(value)\n      value = value.body while Rack::Response === value\n      @body = String === value ? [value.to_str] : value\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"body=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Response\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"body\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_str\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":179,"raw_source":"def each\n      block_given? ? super : enum_for(:each)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"sym\",\"children\":[\"each\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":183,"raw_source":"def finish\n      result = body\n\n      if drop_content_info?\n        headers.delete 'content-length'\n        headers.delete 'content-type'\n      end\n\n      if drop_body?\n        close\n        result = []\n      end\n\n      if calculate_content_length?\n        # if some other code has already set content-length, don't muck with it\n        # currently, this would be the static file-handler\n        headers['content-length'] = body.map(&:bytesize).reduce(0, :+).to_s\n      end\n\n      [status, headers, result]\n    end","complexity_score":27.1,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"drop_content_info?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"drop_body?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"close\"]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"array\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"calculate_content_length?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"bytesize\"]}]}]},\"reduce\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"+\"]}]},\"to_s\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},{\"type\":\"send\",\"children\":[null,\"headers\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":207,"raw_source":"def calculate_content_length?\n      headers['content-type'] && !headers['content-length'] && (Array === body)\n    end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"calculate_content_length?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-length\"]}]},\"!\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":211,"raw_source":"def drop_content_info?\n      informational? || drop_body?\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_content_info?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"informational?\"]},{\"type\":\"send\",\"children\":[null,\"drop_body?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":215,"raw_source":"def drop_body?\n      DROP_BODY_RESPONSES.include?(status)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_body?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DROP_BODY_RESPONSES\"]},\"include?\",{\"type\":\"send\",\"children\":[null,\"status\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":226,"raw_source":"def call(env)\n      result = app.call(env)\n      callback = env['async.callback']\n      return result unless callback && async?(*result)\n\n      after_response { callback.call result }\n      setup_close(env, *result)\n      throw :async\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.callback\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"callback\"]},{\"type\":\"send\",\"children\":[null,\"async?\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"after_response\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"callback\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"send\",\"children\":[null,\"setup_close\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"async\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":238,"raw_source":"def setup_close(env, _status, _headers, body)\n      return unless body.respond_to?(:close) && env.include?('async.close')\n\n      env['async.close'].callback { body.close }\n      env['async.close'].errback { body.close }\n    end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_close\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"_status\"]},{\"type\":\"arg\",\"children\":[\"_headers\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"close\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"async.close\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"errback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":245,"raw_source":"def after_response(&block)\n      raise NotImplementedError, 'only supports EventMachine at the moment' unless defined? EventMachine\n\n      EventMachine.next_tick(&block)\n    end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"after_response\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EventMachine\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]},{\"type\":\"str\",\"children\":[\"only supports EventMachine at the moment\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EventMachine\"]},\"next_tick\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":251,"raw_source":"def async?(status, _headers, body)\n      return true if status == -1\n\n      body.respond_to?(:callback) && body.respond_to?(:errback)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"async?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"status\"]},{\"type\":\"arg\",\"children\":[\"_headers\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},\"==\",{\"type\":\"int\",\"children\":[-1]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"callback\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"errback\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":261,"raw_source":"def call(env)\n      env['sinatra.commonlogger'] ? @app.call(env) : super\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.commonlogger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":267,"raw_source":"def call(env)\n        env['sinatra.commonlogger'] = true\n        call_without_check(env)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.commonlogger\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"call_without_check\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":278,"raw_source":"def http_status; 400 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"http_status\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[400]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":282,"raw_source":"def http_status; 404 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"http_status\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[404]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":288,"raw_source":"def status(value = nil)\n      response.status = Rack::Utils.status_code(value) if value\n      response.status\n    end","complexity_score":7.5,"ast_json":"{\"type\":\"def\",\"children\":[\"status\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"status_code\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":295,"raw_source":"def body(value = nil, &block)\n      if block_given?\n        def block.each; yield(call) end\n        response.body = block\n      elsif value\n        unless request.head? || value.is_a?(Rack::Files::BaseIterator) || value.is_a?(Stream)\n          headers.delete 'content-length'\n        end\n        response.body = value\n      else\n        response.body\n      end\n    end","complexity_score":24.7,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"defs\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"call\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"head?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Files\"]},\"BaseIterator\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-length\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":297,"raw_source":"def block.each; yield(call) end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block\"]},\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"call\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":310,"raw_source":"def redirect(uri, *args)\n      # SERVER_PROTOCOL is required in Rack 3, fall back to HTTP_VERSION\n      # for servers not updated for Rack 3 (like Puma 5)\n      http_version = env['SERVER_PROTOCOL'] || env['HTTP_VERSION']\n      if (http_version == 'HTTP/1.1') && (env['REQUEST_METHOD'] != 'GET')\n        status 303\n      else\n        status 302\n      end\n\n      # According to RFC 2616 section 14.30, \"the field value consists of a\n      # single absolute URI\"\n      response['Location'] = uri(uri.to_s, settings.absolute_redirects?, settings.prefixed_redirects?)\n      halt(*args)\n    end","complexity_score":27.05,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"http_version\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"SERVER_PROTOCOL\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_VERSION\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_version\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP/1.1\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]},\"!=\",{\"type\":\"str\",\"children\":[\"GET\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"int\",\"children\":[303]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"int\",\"children\":[302]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Location\"]},{\"type\":\"send\",\"children\":[null,\"uri\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"absolute_redirects?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"prefixed_redirects?\"]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":328,"raw_source":"def uri(addr = nil, absolute = true, add_script_name = true)\n      return addr if addr.to_s =~ /\\A[a-z][a-z0-9+.\\-]*:/i\n\n      uri = [host = String.new]\n      if absolute\n        host << \"http#{'s' if request.secure?}://\"\n        host << if request.forwarded? || (request.port != (request.secure? ? 443 : 80))\n                  request.host_with_port\n                else\n                  request.host\n                end\n      end\n      uri << request.script_name.to_s if add_script_name\n      uri << (addr || request.path_info).to_s\n      File.join uri\n    end","complexity_score":53.9,"ast_json":"{\"type\":\"def\",\"children\":[\"uri\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"addr\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"absolute\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"add_script_name\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]},\"to_s\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A[a-z][a-z0-9+.\\\\-]*:\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"uri\",{\"type\":\"array\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"host\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"new\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"absolute\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"http\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"secure?\"]},{\"type\":\"str\",\"children\":[\"s\"]},null]}]},{\"type\":\"str\",\"children\":[\"://\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"forwarded?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"port\"]},\"!=\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"secure?\"]},{\"type\":\"int\",\"children\":[443]},{\"type\":\"int\",\"children\":[80]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host_with_port\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"add_script_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"script_name\"]},\"to_s\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"path_info\"]}]}]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":349,"raw_source":"def error(code, body = nil)\n      if code.respond_to? :to_str\n        body = code.to_str\n        code = 500\n      end\n      response.body = body unless body.nil?\n      halt code\n    end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"code\"]},{\"type\":\"optarg\",\"children\":[\"body\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"code\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"code\"]},\"to_str\"]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"int\",\"children\":[500]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"lvar\",\"children\":[\"code\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":359,"raw_source":"def not_found(body = nil)\n      error 404, body\n    end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"body\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"int\",\"children\":[404]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":364,"raw_source":"def headers(hash = nil)\n      response.headers.merge! hash if hash\n      response.headers\n    end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"headers\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"hash\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"headers\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"headers\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":370,"raw_source":"def session\n      request.session\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"session\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":375,"raw_source":"def logger\n      request.logger\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"logger\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"logger\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":380,"raw_source":"def mime_type(type)\n      Base.mime_type(type)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":386,"raw_source":"def content_type(type = nil, params = {})\n      return response['content-type'] unless type\n\n      default = params.delete :default\n      mime_type = mime_type(type) || default\n      raise format('Unknown media type: %p', type) if mime_type.nil?\n\n      mime_type = mime_type.dup\n      unless params.include?(:charset) || settings.add_charset.all? { |p| !(p === mime_type) }\n        params[:charset] = params.delete('charset') || settings.default_encoding\n      end\n      params.delete :charset if mime_type.include? 'charset'\n      unless params.empty?\n        mime_type << ';'\n        mime_type << params.map do |key, val|\n          val = val.inspect if val.to_s =~ /[\";,]/\n          \"#{key}=#{val}\"\n        end.join(';')\n      end\n      response['content-type'] = mime_type\n    end","complexity_score":55.1,"ast_json":"{\"type\":\"def\",\"children\":[\"content_type\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"type\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"Unknown media type: %p\"]},{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"charset\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"add_charset\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]}]},\"!\"]}]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"charset\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"str\",\"children\":[\"charset\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"include?\",{\"type\":\"str\",\"children\":[\"charset\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"charset\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"empty?\"]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"<<\",{\"type\":\"str\",\"children\":[\";\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"to_s\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\";,]\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]},null]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]}]}]}]}]},\"join\",{\"type\":\"str\",\"children\":[\";\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":417,"raw_source":"def attachment(filename = nil, disposition = :attachment)\n      response['Content-Disposition'] = disposition.to_s.dup\n      return unless filename\n\n      params = format('; filename=\"%s\"', File.basename(filename).gsub(/[\"\\r\\n]/, MULTIPART_FORM_DATA_REPLACEMENT_TABLE))\n      response['Content-Disposition'] << params\n      ext = File.extname(filename)\n      content_type(ext) unless response['content-type'] || ext.empty?\n    end","complexity_score":24.0,"ast_json":"{\"type\":\"def\",\"children\":[\"attachment\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"disposition\",{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Content-Disposition\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},\"to_s\"]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"; filename=\\\"%s\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\"\\\\r\\\\n]\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"const\",\"children\":[null,\"MULTIPART_FORM_DATA_REPLACEMENT_TABLE\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Disposition\"]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"lvasgn\",\"children\":[\"ext\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"empty?\"]}]},null,{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":428,"raw_source":"def send_file(path, opts = {})\n      if opts[:type] || !response['content-type']\n        content_type opts[:type] || File.extname(path), default: 'application/octet-stream'\n      end\n\n      disposition = opts[:disposition]\n      filename    = opts[:filename]\n      disposition = :attachment if disposition.nil? && filename\n      filename    = path        if filename.nil?\n      attachment(filename, disposition) if disposition\n\n      last_modified opts[:last_modified] if opts[:last_modified]\n\n      file   = Rack::Files.new(File.dirname(settings.app_file))\n      result = file.serving(request, path)\n\n      result[1].each { |k, v| headers[k] ||= v }\n      headers['content-length'] = result[1]['content-length']\n      opts[:status] &&= Integer(opts[:status])\n      halt (opts[:status] || result[0]), result[2]\n    rescue Errno::ENOENT\n      not_found\n    end","complexity_score":70.4,"ast_json":"{\"type\":\"def\",\"children\":[\"send_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"default\"]},{\"type\":\"str\",\"children\":[\"application/octet-stream\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"disposition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"disposition\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filename\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"lvasgn\",\"children\":[\"disposition\",{\"type\":\"sym\",\"children\":[\"attachment\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},{\"type\":\"send\",\"children\":[null,\"attachment\",{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"lvar\",\"children\":[\"disposition\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_modified\"]}]},{\"type\":\"send\",\"children\":[null,\"last_modified\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_modified\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Files\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"app_file\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"serving\",{\"type\":\"send\",\"children\":[null,\"request\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"[]\",{\"type\":\"str\",\"children\":[\"content-length\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ENOENT\"]}]},null,{\"type\":\"send\",\"children\":[null,\"not_found\"]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":461,"raw_source":"def self.schedule(*) yield end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"schedule\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"yield\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":462,"raw_source":"def self.defer(*)    yield end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"defer\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"yield\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":464,"raw_source":"def initialize(scheduler = self.class, keep_open = false, &back)\n        @back = back.to_proc\n        @scheduler = scheduler\n        @keep_open = keep_open\n        @callbacks = []\n        @closed = false\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"scheduler\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"optarg\",\"children\":[\"keep_open\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"back\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@back\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"back\"]},\"to_proc\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@scheduler\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@keep_open\",{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@callbacks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@closed\",{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":472,"raw_source":"def close\n        return if closed?\n\n        @closed = true\n        @scheduler.schedule { @callbacks.each { |c| c.call } }\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"close\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"ivasgn\",\"children\":[\"@closed\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"call\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":479,"raw_source":"def each(&front)\n        @front = front\n        @scheduler.defer do\n          begin\n            @back.call(self)\n          rescue Exception => e\n            @scheduler.schedule { raise e }\n          ensure\n            close unless @keep_open\n          end\n        end\n      end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"front\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@front\",{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"defer\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@back\"]},\"call\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@keep_open\"]},null,{\"type\":\"send\",\"children\":[null,\"close\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":492,"raw_source":"def <<(data)\n        @scheduler.schedule { @front.call(data.to_s) }\n        self\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<<\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@front\"]},\"call\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":497,"raw_source":"def callback(&block)\n        return yield if closed?\n\n        @callbacks << block\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"callback\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":505,"raw_source":"def closed?\n        @closed\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"closed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@closed\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":515,"raw_source":"def stream(keep_open = false)\n      scheduler = env['async.callback'] ? EventMachine : Stream\n      current   = @params.dup\n      stream = if scheduler == Stream  && keep_open\n        Stream.new(scheduler, false) do |out|\n          until out.closed?\n            with_params(current) { yield(out) }\n          end\n        end\n      else\n        Stream.new(scheduler, keep_open) { |out| with_params(current) { yield(out) } }\n      end\n      body stream\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"keep_open\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"scheduler\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.callback\"]}]},{\"type\":\"const\",\"children\":[null,\"EventMachine\"]},{\"type\":\"const\",\"children\":[null,\"Stream\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"current\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"stream\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"scheduler\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]},{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Stream\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"out\"]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]},\"closed?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_params\",{\"type\":\"lvar\",\"children\":[\"current\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Stream\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]},{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"out\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_params\",{\"type\":\"lvar\",\"children\":[\"current\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"lvar\",\"children\":[\"stream\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":540,"raw_source":"def cache_control(*values)\n      if values.last.is_a?(Hash)\n        hash = values.pop\n        hash.reject! { |_k, v| v == false }\n        hash.reject! { |k, v| values << k if v == true }\n      else\n        hash = {}\n      end\n\n      values.map! { |value| value.to_s.tr('_', '-') }\n      hash.each do |key, value|\n        key = key.to_s.tr('_', '-')\n        value = value.to_i if %w[max-age s-maxage].include? key\n        values << \"#{key}=#{value}\"\n      end\n\n      response['Cache-Control'] = values.join(', ') if values.any?\n    end","complexity_score":38.5,"ast_json":"{\"type\":\"def\",\"children\":[\"cache_control\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"pop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"max-age\"]},{\"type\":\"str\",\"children\":[\"s-maxage\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Cache-Control\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"join\",{\"type\":\"str\",\"children\":[\", \"]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":568,"raw_source":"def expires(amount, *values)\n      values << {} unless values.last.is_a?(Hash)\n\n      if amount.is_a? Integer\n        time    = Time.now + amount.to_i\n        max_age = amount\n      else\n        time    = time_for amount\n        max_age = time - Time.now\n      end\n\n      values.last.merge!(max_age: max_age) { |_key, v1, v2| v1 || v2 }\n      cache_control(*values)\n\n      response['Expires'] = time.httpdate\n    end","complexity_score":27.2,"ast_json":"{\"type\":\"def\",\"children\":[\"expires\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]},{\"type\":\"restarg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"amount\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"amount\"]},\"to_i\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"max_age\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[null,\"time_for\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"max_age\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"max_age\"]},{\"type\":\"lvar\",\"children\":[\"max_age\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_key\"]},{\"type\":\"arg\",\"children\":[\"v1\"]},{\"type\":\"arg\",\"children\":[\"v2\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v1\"]},{\"type\":\"lvar\",\"children\":[\"v2\"]}]}]},{\"type\":\"send\",\"children\":[null,\"cache_control\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Expires\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"httpdate\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":592,"raw_source":"def last_modified(time)\n      return unless time\n\n      time = time_for time\n      response['Last-Modified'] = time.httpdate\n      return if env['HTTP_IF_NONE_MATCH']\n\n      if (status == 200) && env['HTTP_IF_MODIFIED_SINCE']\n        # compare based on seconds since epoch\n        since = Time.httpdate(env['HTTP_IF_MODIFIED_SINCE']).to_i\n        halt 304 if since >= time.to_i\n      end\n\n      if (success? || (status == 412)) && env['HTTP_IF_UNMODIFIED_SINCE']\n        # compare based on seconds since epoch\n        since = Time.httpdate(env['HTTP_IF_UNMODIFIED_SINCE']).to_i\n        halt 412 if since < time.to_i\n      end\n    rescue ArgumentError\n    end","complexity_score":60.73,"ast_json":"{\"type\":\"def\",\"children\":[\"last_modified\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"time\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[null,\"time_for\",{\"type\":\"lvar\",\"children\":[\"time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Last-Modified\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"httpdate\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_NONE_MATCH\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[200]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MODIFIED_SINCE\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"since\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"httpdate\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MODIFIED_SINCE\"]}]}]},\"to_i\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"since\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[304]}]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"success?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[412]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_UNMODIFIED_SINCE\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"since\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"httpdate\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_UNMODIFIED_SINCE\"]}]}]},\"to_i\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"since\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[412]}]},null]}]},null]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null,null]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":623,"raw_source":"def etag(value, options = {})\n      # Before touching this code, please double check RFC 2616 14.24 and 14.26.\n      options      = { kind: options } unless Hash === options\n      kind         = options[:kind] || :strong\n      new_resource = options.fetch(:new_resource) { request.post? }\n\n      unless ETAG_KINDS.include?(kind)\n        raise ArgumentError, ':strong or :weak expected'\n      end\n\n      value = format('\"%s\"', value)\n      value = \"W/#{value}\" if kind == :weak\n      response['ETag'] = value\n\n      return unless success? || status == 304\n\n      if etag_matches?(env['HTTP_IF_NONE_MATCH'], new_resource)\n        halt(request.safe? ? 304 : 412)\n      end\n\n      if env['HTTP_IF_MATCH']\n        return if etag_matches?(env['HTTP_IF_MATCH'], new_resource)\n\n        halt 412\n      end\n\n      nil\n    end","complexity_score":49.28,"ast_json":"{\"type\":\"def\",\"children\":[\"etag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"kind\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"kind\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"kind\"]}]},{\"type\":\"sym\",\"children\":[\"strong\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_resource\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"new_resource\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"post?\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ETAG_KINDS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"kind\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\":strong or :weak expected\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"\\\"%s\\\"\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"kind\"]},\"==\",{\"type\":\"sym\",\"children\":[\"weak\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"W/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"ETag\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"success?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[304]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"etag_matches?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_NONE_MATCH\"]}]},{\"type\":\"lvar\",\"children\":[\"new_resource\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"safe?\"]},{\"type\":\"int\",\"children\":[304]},{\"type\":\"int\",\"children\":[412]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MATCH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"etag_matches?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MATCH\"]}]},{\"type\":\"lvar\",\"children\":[\"new_resource\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[412]}]}]},null]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":653,"raw_source":"def back\n      request.referer\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"back\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"referer\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":658,"raw_source":"def informational?\n      status.between? 100, 199\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"informational?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[199]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":663,"raw_source":"def success?\n      status.between? 200, 299\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"success?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[200]},{\"type\":\"int\",\"children\":[299]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":668,"raw_source":"def redirect?\n      status.between? 300, 399\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[300]},{\"type\":\"int\",\"children\":[399]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":673,"raw_source":"def client_error?\n      status.between? 400, 499\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"client_error?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[400]},{\"type\":\"int\",\"children\":[499]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":678,"raw_source":"def server_error?\n      status.between? 500, 599\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"server_error?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[500]},{\"type\":\"int\",\"children\":[599]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":683,"raw_source":"def not_found?\n      status == 404\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[404]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":688,"raw_source":"def bad_request?\n      status == 400\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"bad_request?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[400]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":694,"raw_source":"def time_for(value)\n      if value.is_a? Numeric\n        Time.at value\n      elsif value.respond_to? :to_s\n        Time.parse value.to_s\n      else\n        value.to_time\n      end\n    rescue ArgumentError => e\n      raise e\n    rescue Exception\n      raise ArgumentError, \"unable to convert #{value.inspect} to a Time object\"\n    end","complexity_score":15.5,"ast_json":"{\"type\":\"def\",\"children\":[\"time_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Numeric\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_time\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unable to convert \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to a Time object\"]}]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":711,"raw_source":"def etag_matches?(list, new_resource = request.post?)\n      return !new_resource if list == '*'\n\n      list.to_s.split(/\\s*,\\s*/).include? response['ETag']\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"etag_matches?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"list\"]},{\"type\":\"optarg\",\"children\":[\"new_resource\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"post?\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"==\",{\"type\":\"str\",\"children\":[\"*\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_resource\"]},\"!\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"to_s\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*,\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"ETag\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":717,"raw_source":"def with_params(temp_params)\n      original = @params\n      @params = temp_params\n      yield\n    ensure\n      @params = original if original\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"temp_params\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original\",{\"type\":\"ivar\",\"children\":[\"@params\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"lvar\",\"children\":[\"temp_params\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"original\"]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"lvar\",\"children\":[\"original\"]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":749,"raw_source":"def initialize\n      super\n      @default_layout = :layout\n      @preferred_extension = nil\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@preferred_extension\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":755,"raw_source":"def erb(template, options = {}, locals = {}, &block)\n      render(:erb, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"erb\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"erb\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":759,"raw_source":"def haml(template, options = {}, locals = {}, &block)\n      render(:haml, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"haml\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"haml\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":763,"raw_source":"def sass(template, options = {}, locals = {})\n      options[:default_content_type] = :css\n      options[:exclude_outvar] = true\n      options[:layout] = nil\n      render :sass, template, options, locals\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sass\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"css\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"sass\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":770,"raw_source":"def scss(template, options = {}, locals = {})\n      options[:default_content_type] = :css\n      options[:exclude_outvar] = true\n      options[:layout] = nil\n      render :scss, template, options, locals\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"scss\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"css\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"scss\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":777,"raw_source":"def builder(template = nil, options = {}, locals = {}, &block)\n      options[:default_content_type] = :xml\n      render_ruby(:builder, template, options, locals, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"builder\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"xml\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"builder\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":782,"raw_source":"def liquid(template, options = {}, locals = {}, &block)\n      render(:liquid, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":786,"raw_source":"def markdown(template, options = {}, locals = {})\n      options[:exclude_outvar] = true\n      render :markdown, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markdown\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"markdown\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":791,"raw_source":"def rdoc(template, options = {}, locals = {})\n      render :rdoc, template, options, locals\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rdoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"rdoc\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":795,"raw_source":"def asciidoc(template, options = {}, locals = {})\n      render :asciidoc, template, options, locals\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"asciidoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"asciidoc\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":799,"raw_source":"def markaby(template = nil, options = {}, locals = {}, &block)\n      render_ruby(:mab, template, options, locals, &block)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"markaby\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"mab\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":803,"raw_source":"def nokogiri(template = nil, options = {}, locals = {}, &block)\n      options[:default_content_type] = :xml\n      render_ruby(:nokogiri, template, options, locals, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nokogiri\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"xml\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"nokogiri\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":808,"raw_source":"def slim(template, options = {}, locals = {}, &block)\n      render(:slim, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"slim\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"slim\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":812,"raw_source":"def yajl(template, options = {}, locals = {})\n      options[:default_content_type] = :json\n      render :yajl, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"yajl\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"json\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"yajl\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":817,"raw_source":"def rabl(template, options = {}, locals = {})\n      Rabl.register!\n      render :rabl, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rabl\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rabl\"]},\"register!\"]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"rabl\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":824,"raw_source":"def find_template(views, name, engine)\n      yield ::File.join(views, \"#{name}.#{@preferred_extension}\")\n\n      Tilt.default_mapping.extensions_for(engine).each do |ext|\n        yield ::File.join(views, \"#{name}.#{ext}\") unless ext == @preferred_extension\n      end\n    end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"find_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"views\"]},{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@preferred_extension\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"default_mapping\"]},\"extensions_for\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@preferred_extension\"]}]},null,{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":835,"raw_source":"def render_ruby(engine, template, options = {}, locals = {}, &block)\n      if template.is_a?(Hash)\n        options = template\n        template = nil\n      end\n      template = proc { block } if template.nil?\n      render engine, template, options, locals\n    end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"render_ruby\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":844,"raw_source":"def render(engine, data, options = {}, locals = {}, &block)\n      # merge app-level options\n      engine_options = settings.respond_to?(engine) ? settings.send(engine) : {}\n      options.merge!(engine_options) { |_key, v1, _v2| v1 }\n\n      # extract generic options\n      locals          = options.delete(:locals) || locals         || {}\n      views           = options.delete(:views)  || settings.views || './views'\n      layout          = options[:layout]\n      layout          = false if layout.nil? && options.include?(:layout)\n      eat_errors      = layout.nil?\n      layout          = engine_options[:layout] if layout.nil? || (layout == true && engine_options[:layout] != false)\n      layout          = @default_layout         if layout.nil? || (layout == true)\n      layout_options  = options.delete(:layout_options) || {}\n      content_type    = options.delete(:default_content_type)\n      content_type    = options.delete(:content_type)   || content_type\n      layout_engine   = options.delete(:layout_engine)  || engine\n      scope           = options.delete(:scope)          || self\n      exclude_outvar  = options.delete(:exclude_outvar)\n      options.delete(:layout)\n\n      # set some defaults\n      options[:outvar] ||= '@_out_buf' unless exclude_outvar\n      options[:default_encoding] ||= settings.default_encoding\n\n      # compile and render template\n      begin\n        layout_was      = @default_layout\n        @default_layout = false\n        template        = compile_template(engine, data, options, views)\n        output          = template.render(scope, locals, &block)\n      ensure\n        @default_layout = layout_was\n      end\n\n      # render layout\n      if layout\n        extra_options = { views: views, layout: false, eat_errors: eat_errors, scope: scope }\n        options = options.merge(extra_options).merge!(layout_options)\n\n        catch(:layout_missing) { return render(layout_engine, layout, options, locals) { output } }\n      end\n\n      if content_type\n        # sass-embedded returns a frozen string\n        output = +output\n        output.extend(ContentTyped).content_type = content_type\n      end\n      output\n    end","complexity_score":96.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine_options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"engine_options\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_key\"]},{\"type\":\"arg\",\"children\":[\"v1\"]},{\"type\":\"arg\",\"children\":[\"_v2\"]}]},{\"type\":\"lvar\",\"children\":[\"v1\"]}]},{\"type\":\"lvasgn\",\"children\":[\"locals\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"locals\"]}]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"views\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"views\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"views\"]}]},{\"type\":\"str\",\"children\":[\"./views\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"eat_errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},\"!=\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"ivar\",\"children\":[\"@default_layout\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"layout_options\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout_options\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]},{\"type\":\"lvar\",\"children\":[\"content_type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout_engine\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout_engine\"]}]},{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"scope\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"scope\"]}]},{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exclude_outvar\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exclude_outvar\"]},null,{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"outvar\"]}]},{\"type\":\"str\",\"children\":[\"@_out_buf\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"default_encoding\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"layout_was\",{\"type\":\"ivar\",\"children\":[\"@default_layout\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[null,\"compile_template\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"scope\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"lvar\",\"children\":[\"layout_was\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"extra_options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"eat_errors\"]},{\"type\":\"lvar\",\"children\":[\"eat_errors\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"scope\"]},{\"type\":\"lvar\",\"children\":[\"scope\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"extra_options\"]}]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"layout_options\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"catch\",{\"type\":\"sym\",\"children\":[\"layout_missing\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"return\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"layout_engine\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content_type\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+@\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ContentTyped\"]}]},\"content_type=\",{\"type\":\"lvar\",\"children\":[\"content_type\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":895,"raw_source":"def compile_template(engine, data, options, views)\n      eat_errors = options.delete :eat_errors\n      template = Tilt[engine]\n      raise \"Template engine not found: #{engine}\" if template.nil?\n\n      case data\n      when Symbol\n        template_cache.fetch engine, data, options, views do\n          body, path, line = settings.templates[data]\n          if body\n            body = body.call if body.respond_to?(:call)\n            template.new(path, line.to_i, options) { body }\n          else\n            found = false\n            @preferred_extension = engine.to_s\n            find_template(views, data, template) do |file|\n              path ||= file # keep the initial path rather than the last one\n              found = File.exist?(file)\n              if found\n                path = file\n                break\n              end\n            end\n            throw :layout_missing if eat_errors && !found\n            template.new(path, 1, options)\n          end\n        end\n      when Proc\n        compile_block_template(template, options, &data)\n      when String\n        template_cache.fetch engine, data, options, views do\n          compile_block_template(template, options) { data }\n        end\n      else\n        raise ArgumentError, \"Sorry, don't know how to render #{data.inspect}.\"\n      end\n    end","complexity_score":75.85,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"arg\",\"children\":[\"options\"]},{\"type\":\"arg\",\"children\":[\"views\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"eat_errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"eat_errors\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Template engine not found: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]}]},null]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\"]},{\"type\":\"lvasgn\",\"children\":[\"path\"]},{\"type\":\"lvasgn\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"data\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"call\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@preferred_extension\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"find_template\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"break\",\"children\":[]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"eat_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"layout_missing\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},{\"type\":\"send\",\"children\":[null,\"compile_block_template\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"compile_block_template\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Sorry, don't know how to render \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\".\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":933,"raw_source":"def compile_block_template(template, options, &body)\n      first_location = caller_locations.first\n      path = first_location.path\n      line = first_location.lineno\n      path = options[:path] || path\n      line = options[:line] || line\n      template.new(path, line.to_i, options, &body)\n    end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_block_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"path\"]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"lineno\"]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"path\"]}]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"line\"]}]},{\"type\":\"lvar\",\"children\":[\"line\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":952,"raw_source":"def initialize\n      @cache = {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@cache\",{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":960,"raw_source":"def fetch(*key)\n      @cache.fetch(key) do\n        @cache[key] = yield\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"key\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cache\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"yield\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":967,"raw_source":"def clear\n      @cache = {}\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"clear\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@cache\",{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":983,"raw_source":"def initialize(app = nil, **_kwargs)\n      super()\n      @app = app\n      @template_cache = TemplateCache.new\n      @pinned_response = nil # whether a before! filter pinned the content-type\n      yield self if block_given?\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"app\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwrestarg\",\"children\":[\"_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_cache\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateCache\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":992,"raw_source":"def call(env)\n      dup.call!(env)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"call!\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":996,"raw_source":"def call!(env) # :nodoc:\n      @env      = env\n      @params   = IndifferentHash.new\n      @request  = Request.new(env)\n      @response = Response.new\n      @pinned_response = nil\n      template_cache.clear if settings.reload_templates\n\n      invoke { dispatch! }\n      invoke { error_block!(response.status) } unless @env['sinatra.error']\n\n      unless @response['content-type']\n        if Array === body && body[0].respond_to?(:content_type)\n          content_type body[0].content_type\n        elsif (default = settings.default_content_type)\n          content_type default\n        end\n      end\n\n      @response.finish\n    end","complexity_score":49.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@env\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Response\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"reload_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"clear\"]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"dispatch!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]}]},null,{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},null,{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"content_type\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_content_type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"default\"]}]},null]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"finish\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1019,"raw_source":"def self.settings\n      self\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1024,"raw_source":"def settings\n      self.class.settings\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"settings\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1030,"raw_source":"def halt(*response)\n      response = response.first if response.length == 1\n      throw :halt, response\n    end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"halt\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"length\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"first\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"lvar\",\"children\":[\"response\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1038,"raw_source":"def pass(&block)\n      throw :pass, block\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"pass\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"pass\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1043,"raw_source":"def forward\n      raise 'downstream app not set' unless @app.respond_to? :call\n\n      status, headers, body = @app.call env\n      @response.status = status\n      @response.body = body\n      @response.headers.merge! headers\n      nil\n    end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"forward\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"downstream app not set\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"send\",\"children\":[null,\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"status=\",{\"type\":\"lvar\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"headers\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1057,"raw_source":"def filter!(type, base = settings, &block)\n      filter!(type, base.superclass, &block) if base.superclass.respond_to?(:filters)\n      base.filters[type].each do |args|\n        result = process_route(*args)\n        block.call(result) if block_given?\n      end\n    end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"filter!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1066,"raw_source":"def route!(base = settings, pass_block = nil)\n      routes = base.routes[@request.request_method]\n\n      routes&.each do |pattern, conditions, block|\n        response.delete_header('content-type') unless @pinned_response\n\n        returned_pass_block = process_route(pattern, conditions) do |*args|\n          env['sinatra.route'] = \"#{@request.request_method} #{pattern}\"\n          route_eval { block[*args] }\n        end\n\n        # don't wipe out pass_block in superclass\n        pass_block = returned_pass_block if returned_pass_block\n      end\n\n      # Run routes defined in superclass.\n      if base.superclass.respond_to?(:routes)\n        return route!(base.superclass, pass_block)\n      end\n\n      route_eval(&pass_block) if pass_block\n      route_missing\n    end","complexity_score":38.0,"ast_json":"{\"type\":\"def\",\"children\":[\"route!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"optarg\",\"children\":[\"pass_block\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"routes\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"routes\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"request_method\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"routes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"conditions\"]},{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pinned_response\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"delete_header\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"returned_pass_block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.route\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"request_method\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"returned_pass_block\"]},{\"type\":\"lvasgn\",\"children\":[\"pass_block\",{\"type\":\"lvar\",\"children\":[\"returned_pass_block\"]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"routes\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},{\"type\":\"lvar\",\"children\":[\"pass_block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pass_block\"]},{\"type\":\"send\",\"children\":[null,\"route_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pass_block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"route_missing\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1091,"raw_source":"def route_eval\n      throw :halt, yield\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"route_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"yield\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1100,"raw_source":"def process_route(pattern, conditions, block = nil, values = [])\n      route = @request.path_info\n      route = '/' if route.empty? && !settings.empty_path_info?\n      route = route[0..-2] if !settings.strict_paths? && route != '/' && route.end_with?('/')\n\n      params = pattern.params(route)\n      return unless params\n\n      params.delete('ignore') # TODO: better params handling, maybe turn it into \"smart\" object or detect changes\n      force_encoding(params)\n      @params = @params.merge(params) { |_k, v1, v2| v2 || v1 } if params.any?\n\n      regexp_exists = pattern.is_a?(Mustermann::Regular) || (pattern.respond_to?(:patterns) && pattern.patterns.any? { |subpattern| subpattern.is_a?(Mustermann::Regular) })\n      if regexp_exists\n        captures           = pattern.match(route).captures.map { |c| URI_INSTANCE.unescape(c) if c }\n        values            += captures\n        @params[:captures] = force_encoding(captures) unless captures.nil? || captures.empty?\n      else\n        values += params.values.flatten\n      end\n\n      catch(:pass) do\n        conditions.each { |c| throw :pass if c.bind(self).call == false }\n        block ? block[self, values] : yield(self, values)\n      end\n    rescue StandardError\n      @env['sinatra.error.params'] = @params\n      raise\n    ensure\n      params ||= {}\n      params.each { |k, _| @params.delete(k) } unless @env['sinatra.error.params']\n    end","complexity_score":110.8,"ast_json":"{\"type\":\"def\",\"children\":[\"process_route\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"conditions\"]},{\"type\":\"optarg\",\"children\":[\"block\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"values\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"route\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"path_info\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"route\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"empty_path_info?\"]},\"!\"]}]},{\"type\":\"lvasgn\",\"children\":[\"route\",{\"type\":\"str\",\"children\":[\"/\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"strict_paths?\"]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"route\"]},\"!=\",{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"route\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"route\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"route\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[-2]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"params\",{\"type\":\"lvar\",\"children\":[\"route\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"str\",\"children\":[\"ignore\"]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"any?\"]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_k\"]},{\"type\":\"arg\",\"children\":[\"v1\"]},{\"type\":\"arg\",\"children\":[\"v2\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v2\"]},{\"type\":\"lvar\",\"children\":[\"v1\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"regexp_exists\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"Regular\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"patterns\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"patterns\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subpattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subpattern\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"Regular\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"regexp_exists\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"captures\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"match\",{\"type\":\"lvar\",\"children\":[\"route\"]}]},\"captures\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI_INSTANCE\"]},\"unescape\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"values\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"captures\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captures\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captures\"]},\"empty?\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"captures\"]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"captures\"]}]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"values\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"values\"]},\"flatten\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"catch\",{\"type\":\"sym\",\"children\":[\"pass\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"conditions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"bind\",{\"type\":\"self\",\"children\":[]}]},\"call\"]},\"==\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"pass\"]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"values\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"values\"]}]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.error.params\"]},{\"type\":\"ivar\",\"children\":[\"@params\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error.params\"]}]},null,{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1138,"raw_source":"def route_missing\n      raise NotFound unless @app\n\n      forward\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"route_missing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotFound\"]}]}]},{\"type\":\"send\",\"children\":[null,\"forward\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1147,"raw_source":"def static!(options = {})\n      return if (public_dir = settings.public_folder).nil?\n\n      path = \"#{public_dir}#{URI_INSTANCE.unescape(request.path_info)}\"\n      return unless valid_path?(path)\n\n      path = File.expand_path(path)\n      return unless path.start_with?(\"#{File.expand_path(public_dir)}/\")\n\n      return unless File.file?(path)\n\n      env['sinatra.static_file'] = path\n      cache_control(*settings.static_cache_control) if settings.static_cache_control?\n\n      headers(settings.static_headers) if settings.static_headers?\n\n      send_file path, options.merge(disposition: nil)\n    end","complexity_score":39.0,"ast_json":"{\"type\":\"def\",\"children\":[\"static!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"public_dir\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"public_folder\"]}]}]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"public_dir\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI_INSTANCE\"]},\"unescape\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"path_info\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"valid_path?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"start_with?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"public_dir\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"file?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.static_file\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_cache_control?\"]},{\"type\":\"send\",\"children\":[null,\"cache_control\",{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_cache_control\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_headers?\"]},{\"type\":\"send\",\"children\":[null,\"headers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_headers\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"send_file\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"disposition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1167,"raw_source":"def invoke(&block)\n      res = catch(:halt, &block)\n\n      res = [res] if (Integer === res) || (String === res)\n      if (Array === res) && (Integer === res.first)\n        res = res.dup\n        status(res.shift)\n        body(res.pop)\n        headers(*res)\n      elsif res.respond_to? :each\n        body res\n      end\n      nil # avoid double setting the same response tuple twice\n    end","complexity_score":26.2,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[null,\"catch\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"first\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"pop\"]}]},{\"type\":\"send\",\"children\":[null,\"headers\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"lvar\",\"children\":[\"res\"]}]},null]}]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1183,"raw_source":"def dispatch!\n      # Avoid passing frozen string in force_encoding\n      @params.merge!(@request.params).each do |key, val|\n        next unless val.respond_to?(:force_encoding)\n\n        val = val.dup if val.frozen?\n        @params[key] = force_encoding(val)\n      end\n\n      invoke do\n        static! if settings.static? && (request.get? || request.head?)\n        filter! :before do\n          @pinned_response = !response['content-type'].nil?\n        end\n        route!\n      end\n    rescue ::Exception => e\n      invoke { handle_exception!(e) }\n    ensure\n      begin\n        filter! :after unless env['sinatra.static_file']\n      rescue ::Exception => e\n        invoke { handle_exception!(e) } unless @env['sinatra.error']\n      end\n    end","complexity_score":66.1,"ast_json":"{\"type\":\"def\",\"children\":[\"dispatch!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"params\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"force_encoding\"]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"frozen?\"]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"dup\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"get?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"head?\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"static!\"]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"sym\",\"children\":[\"before\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"nil?\"]},\"!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"route!\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"handle_exception!\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.static_file\"]}]},null,{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"sym\",\"children\":[\"after\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]}]},null,{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"handle_exception!\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]},null]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1210,"raw_source":"def handle_exception!(boom)\n      error_params = @env['sinatra.error.params']\n\n      @params = @params.merge(error_params) if error_params\n\n      @env['sinatra.error'] = boom\n\n      http_status = if boom.is_a? Sinatra::Error\n                      if boom.respond_to? :http_status\n                        boom.http_status\n                      elsif settings.use_code? && boom.respond_to?(:code)\n                        boom.code\n                      end\n                    end\n\n      http_status = 500 unless http_status&.between?(400, 599)\n      status(http_status)\n\n      if server_error?\n        dump_errors! boom if settings.dump_errors?\n        raise boom if settings.show_exceptions? && (settings.show_exceptions != :after_handler)\n      elsif not_found?\n        headers['X-Cascade'] = 'pass' if settings.x_cascade?\n      end\n\n      if (res = error_block!(boom.class, boom) || error_block!(status, boom))\n        return res\n      end\n\n      if not_found? || bad_request?\n        if boom.message && boom.message != boom.class.name\n          body Rack::Utils.escape_html(boom.message)\n        else\n          content_type 'text/html'\n          body \"<h1>#{not_found? ? 'Not Found' : 'Bad Request'}</h1>\"\n        end\n      end\n\n      return unless server_error?\n\n      raise boom if settings.raise_errors? || settings.show_exceptions?\n\n      error_block! Exception, boom\n    end","complexity_score":93.78,"ast_json":"{\"type\":\"def\",\"children\":[\"handle_exception!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"boom\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error_params\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error.params\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_params\"]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"error_params\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]},{\"type\":\"lvasgn\",\"children\":[\"http_status\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Error\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"http_status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"http_status\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"use_code?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"code\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"code\"]},null]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_status\"]},\"between?\",{\"type\":\"int\",\"children\":[400]},{\"type\":\"int\",\"children\":[599]}]},null,{\"type\":\"lvasgn\",\"children\":[\"http_status\",{\"type\":\"int\",\"children\":[500]}]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"lvar\",\"children\":[\"http_status\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server_error?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"dump_errors?\"]},{\"type\":\"send\",\"children\":[null,\"dump_errors!\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"after_handler\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"x_cascade?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"X-Cascade\"]},{\"type\":\"str\",\"children\":[\"pass\"]}]},null]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[null,\"status\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"send\",\"children\":[null,\"bad_request?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},\"name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<h1>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"str\",\"children\":[\"Not Found\"]},{\"type\":\"str\",\"children\":[\"Bad Request\"]}]}]},{\"type\":\"str\",\"children\":[\"</h1>\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server_error?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"raise_errors?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions?\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"const\",\"children\":[null,\"Exception\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1256,"raw_source":"def error_block!(key, *block_params)\n      base = settings\n      while base.respond_to?(:errors)\n        args_array = base.errors[key]\n\n        next base = base.superclass unless args_array\n\n        args_array.reverse_each do |args|\n          first = args == args_array.first\n          args += [block_params]\n          resp = process_route(*args)\n          return resp unless resp.nil? && !first\n        end\n      end\n      return false unless key.respond_to?(:superclass) && (key.superclass < Exception)\n\n      error_block!(key.superclass, *block_params)\n    end","complexity_score":37.6,"ast_json":"{\"type\":\"def\",\"children\":[\"error_block!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"block_params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"errors\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args_array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},null,{\"type\":\"next\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},\"first\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_params\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"resp\",{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resp\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},\"!\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resp\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"superclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"superclass\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"superclass\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_params\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1275,"raw_source":"def dump_errors!(boom)\n      if boom.respond_to?(:detailed_message)\n        msg = boom.detailed_message(highlight: false)\n        if msg =~ /\\A(.*?)(?: \\(#{ Regexp.quote(boom.class.to_s) }\\))?\\n/\n          msg = $1\n          additional_msg = $'.lines(chomp: true)\n        else\n          additional_msg = []\n        end\n      else\n        msg = boom.message\n        additional_msg = []\n      end\n      msg = [\"#{Time.now.strftime('%Y-%m-%d %H:%M:%S')} - #{boom.class} - #{msg}:\", *additional_msg, *boom.backtrace].join(\"\\n\\t\")\n      @env['rack.errors'].puts(msg)\n    end","complexity_score":28.1,"ast_json":"{\"type\":\"def\",\"children\":[\"dump_errors!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"boom\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"detailed_message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"detailed_message\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"highlight\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"msg\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A(.*?)(?: \\\\(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"quote\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},\"to_s\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\\))?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"nth_ref\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"send\",\"children\":[{\"type\":\"back_ref\",\"children\":[\"$'\"]},\"lines\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"chomp\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"strftime\",{\"type\":\"str\",\"children\":[\"%Y-%m-%d %H:%M:%S\"]}]}]},{\"type\":\"str\",\"children\":[\" - \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" - \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"msg\"]}]},{\"type\":\"str\",\"children\":[\":\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"additional_msg\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"backtrace\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\"\\n\\t\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]},\"puts\",{\"type\":\"lvar\",\"children\":[\"msg\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1307,"raw_source":"def callers_to_ignore\n        CALLERS_TO_IGNORE\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"callers_to_ignore\",{\"type\":\"args\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"CALLERS_TO_IGNORE\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1313,"raw_source":"def reset!\n        @conditions     = []\n        @routes         = {}\n        @filters        = { before: [], after: [] }\n        @errors         = {}\n        @middleware     = []\n        @prototype      = nil\n        @extensions     = []\n\n        @templates = if superclass.respond_to?(:templates)\n                       Hash.new { |_hash, key| superclass.templates[key] }\n                     else\n                       {}\n                     end\n      end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"reset!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@routes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"before\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"after\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@middleware\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@prototype\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@extensions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@templates\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"templates\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_hash\"]},{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1330,"raw_source":"def extensions\n        if superclass.respond_to?(:extensions)\n          (@extensions + superclass.extensions).uniq\n        else\n          @extensions\n        end\n      end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"extensions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"extensions\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"extensions\"]}]}]},\"uniq\"]},{\"type\":\"ivar\",\"children\":[\"@extensions\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1339,"raw_source":"def middleware\n        if superclass.respond_to?(:middleware)\n          superclass.middleware + @middleware\n        else\n          @middleware\n        end\n      end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"middleware\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"middleware\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"middleware\"]},\"+\",{\"type\":\"ivar\",\"children\":[\"@middleware\"]}]},{\"type\":\"ivar\",\"children\":[\"@middleware\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1349,"raw_source":"def set(option, value = (not_set = true), ignore_setter = false, &block)\n        raise ArgumentError if block && !not_set\n\n        if block\n          value = block\n          not_set = false\n        end\n\n        if not_set\n          raise ArgumentError unless option.respond_to?(:each)\n\n          option.each { |k, v| set(k, v) }\n          return self\n        end\n\n        if respond_to?(\"#{option}=\") && !ignore_setter\n          return __send__(\"#{option}=\", value)\n        end\n\n        setter = proc { |val| set option, val, true }\n        getter = proc { value }\n\n        case value\n        when Proc\n          getter = value\n        when Symbol, Integer, FalseClass, TrueClass, NilClass\n          getter = value.inspect\n        when Hash\n          setter = proc do |val|\n            val = value.merge val if Hash === val\n            set option, val, true\n          end\n        end\n\n        define_singleton(\"#{option}=\", setter)\n        define_singleton(option, getter)\n        define_singleton(\"#{option}?\", \"!!#{option}\") unless method_defined? \"#{option}?\"\n        self\n      end","complexity_score":56.2,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"option\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"not_set\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"optarg\",\"children\":[\"ignore_setter\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_set\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvasgn\",\"children\":[\"not_set\",{\"type\":\"false\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_set\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"self\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ignore_setter\"]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__send__\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"setter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"const\",\"children\":[null,\"FalseClass\"]},{\"type\":\"const\",\"children\":[null,\"TrueClass\"]},{\"type\":\"const\",\"children\":[null,\"NilClass\"]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"inspect\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"lvasgn\",\"children\":[\"setter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]},{\"type\":\"lvar\",\"children\":[\"setter\"]}]},{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"getter\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"?\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"?\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"!!\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]}]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1390,"raw_source":"def enable(*opts)\n        opts.each { |key| set(key, true) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1395,"raw_source":"def disable(*opts)\n        opts.each { |key| set(key, false) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"disable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1402,"raw_source":"def error(*codes, &block)\n        args  = compile! 'ERROR', /.*/, block\n        codes = codes.flat_map(&method(:Array))\n        codes << Exception if codes.empty?\n        codes << Sinatra::NotFound if codes.include?(404)\n        codes.each { |c| (@errors[c] ||= []) << args }\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"str\",\"children\":[\"ERROR\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"codes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"flat_map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"Array\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"include?\",{\"type\":\"int\",\"children\":[404]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1411,"raw_source":"def not_found(&block)\n        error(404, &block)\n      end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"int\",\"children\":[404]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1416,"raw_source":"def template(name, &block)\n        filename, line = caller_locations.first\n        templates[name] = [block, filename, line.to_i]\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filename\"]},{\"type\":\"lvasgn\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1422,"raw_source":"def layout(name = :layout, &block)\n        template name, &block\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"layout\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1428,"raw_source":"def inline_templates=(file = nil)\n        file = (caller_files.first || File.expand_path($0)) if file.nil? || file == true\n\n        begin\n          io = ::IO.respond_to?(:binread) ? ::IO.binread(file) : ::IO.read(file)\n          app, data = io.gsub(\"\\r\\n\", \"\\n\").split(/^__END__$/, 2)\n        rescue Errno::ENOENT\n          app, data = nil\n        end\n\n        return unless data\n\n        encoding = if app && app =~ /([^\\n]*\\n)?#[^\\n]*coding: *(\\S+)/m\n                     $2\n                   else\n                     settings.default_encoding\n                   end\n\n        lines = app.count(\"\\n\") + 1\n        template = nil\n        force_encoding data, encoding\n        data.each_line do |line|\n          lines += 1\n          if line =~ /^@@\\s*(.*\\S)\\s*$/\n            template = force_encoding(String.new, encoding)\n            templates[$1.to_sym] = [template, file, lines]\n          elsif template\n            template << line\n          end\n        end\n      end","complexity_score":57.4,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates=\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"file\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]}]},null]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"io\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"binread\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"binread\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app\"]},{\"type\":\"lvasgn\",\"children\":[\"data\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"io\"]},\"gsub\",{\"type\":\"str\",\"children\":[\"\\r\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^__END__$\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ENOENT\"]}]},null,{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app\"]},{\"type\":\"lvasgn\",\"children\":[\"data\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"encoding\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"([^\\\\n]*\\\\n)?#[^\\\\n]*coding: *(\\\\S+)\"]},{\"type\":\"regopt\",\"children\":[\"m\"]}]}]}]},{\"type\":\"nth_ref\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"lines\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each_line\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lines\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^@@\\\\s*(.*\\\\S)\\\\s*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]},\"to_sym\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"lvar\",\"children\":[\"lines\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"line\"]}]},null]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1461,"raw_source":"def mime_type(type, value = nil)\n        return type      if type.nil?\n        return type.to_s if type.to_s.include?('/')\n\n        type = \".#{type}\" unless type.to_s[0] == '.'\n        return Rack::Mime.mime_type(type, nil) unless value\n\n        Rack::Mime::MIME_TYPES[type] = value\n      end","complexity_score":16.1,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]},\"include?\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\".\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"MIME_TYPES\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1474,"raw_source":"def mime_types(type)\n        type = mime_type type\n        if type =~ %r{^application/(xml|javascript)$}\n          [type, \"text/#{$1}\"]\n        elsif type =~ %r{^text/(xml|javascript)$}\n          [type, \"application/#{$1}\"]\n        else\n          [type]\n        end\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_types\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^application/(xml|javascript)$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"text/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^text/(xml|javascript)$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"application/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1488,"raw_source":"def before(path = /.*/, **options, &block)\n        add_filter(:before, path, **options, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"before\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"add_filter\",{\"type\":\"sym\",\"children\":[\"before\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1495,"raw_source":"def after(path = /.*/, **options, &block)\n        add_filter(:after, path, **options, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"after\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"add_filter\",{\"type\":\"sym\",\"children\":[\"after\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1500,"raw_source":"def add_filter(type, path = /.*/, **options, &block)\n        filters[type] << compile!(type, path, block, **options)\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1504,"raw_source":"def on_start(&on_start_callback)\n        @on_start_callback = on_start_callback\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"on_start\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"on_start_callback\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@on_start_callback\",{\"type\":\"lvar\",\"children\":[\"on_start_callback\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1508,"raw_source":"def on_stop(&on_stop_callback)\n        @on_stop_callback = on_stop_callback\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"on_stop\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"on_stop_callback\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@on_stop_callback\",{\"type\":\"lvar\",\"children\":[\"on_stop_callback\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1514,"raw_source":"def condition(name = \"#{caller.first[/`.*'/]} condition\", &block)\n        @conditions << generate_method(name, &block)\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"condition\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\"]},\"first\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"`.*'\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\" condition\"]}]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"generate_method\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1518,"raw_source":"def public=(value)\n        warn_for_deprecation ':public is no longer used to avoid overloading Module#public, use :public_folder or :public_dir instead'\n        set(:public_folder, value)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn_for_deprecation\",{\"type\":\"str\",\"children\":[\":public is no longer used to avoid overloading Module#public, use :public_folder or :public_dir instead\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"public_folder\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1523,"raw_source":"def public_dir=(value)\n        self.public_folder = value\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_dir=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"public_folder=\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1527,"raw_source":"def public_dir\n        public_folder\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public_dir\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"public_folder\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1533,"raw_source":"def get(path, opts = {}, &block)\n        conditions = @conditions.dup\n        route('GET', path, opts, &block)\n\n        @conditions = conditions\n        route('HEAD', path, opts, &block)\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"GET\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"lvar\",\"children\":[\"conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1541,"raw_source":"def put(path, opts = {}, &block)     route 'PUT',     path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"put\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PUT\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1543,"raw_source":"def post(path, opts = {}, &block)    route 'POST',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"post\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"POST\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1545,"raw_source":"def delete(path, opts = {}, &block)  route 'DELETE',  path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"DELETE\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1547,"raw_source":"def head(path, opts = {}, &block)    route 'HEAD',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"head\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1549,"raw_source":"def options(path, opts = {}, &block) route 'OPTIONS', path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"OPTIONS\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1551,"raw_source":"def patch(path, opts = {}, &block)   route 'PATCH',   path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PATCH\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1553,"raw_source":"def link(path, opts = {}, &block)    route 'LINK',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"LINK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1555,"raw_source":"def unlink(path, opts = {}, &block)  route 'UNLINK',  path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"UNLINK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1559,"raw_source":"def helpers(*extensions, &block)\n        class_eval(&block)   if block_given?\n        include(*extensions) if extensions.any?\n      end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1566,"raw_source":"def register(*extensions, &block)\n        extensions << Module.new(&block) if block_given?\n        @extensions += extensions\n        extensions.each do |extension|\n          extend extension\n          extension.registered(self) if extension.respond_to?(:registered)\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"extension\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"lvar\",\"children\":[\"extension\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"registered\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"registered\",{\"type\":\"self\",\"children\":[]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1575,"raw_source":"def development?; environment == :development end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"development?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"development\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1576,"raw_source":"def production?;  environment == :production  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"production?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"production\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1577,"raw_source":"def test?;        environment == :test        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"test\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1581,"raw_source":"def configure(*envs)\n        yield self if envs.empty? || envs.include?(environment.to_sym)\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"configure\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"envs\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"envs\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"envs\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_sym\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1586,"raw_source":"def use(middleware, *args, &block)\n        @prototype = nil\n        @middleware << [middleware, args, block]\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@prototype\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@middleware\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1593,"raw_source":"def quit!\n        return unless running?\n\n        # Use Thin's hard #stop! if available, otherwise just #stop.\n        running_server.respond_to?(:stop!) ? running_server.stop! : running_server.stop\n        warn '== Sinatra has ended his set (crowd applauds)' unless suppress_messages?\n        set :running_server, nil\n        set :handler_name, nil\n\n        on_stop_callback.call unless on_stop_callback.nil?\n      end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"quit!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"stop!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"stop!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"stop\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"suppress_messages?\"]},null,{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"== Sinatra has ended his set (crowd applauds)\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"running_server\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"handler_name\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_stop_callback\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_stop_callback\"]},\"call\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1610,"raw_source":"def run!(options = {}, &block)\n        unless defined?(Rackup::Handler)\n          rackup_warning = <<~MISSING_RACKUP\n            Sinatra could not start, the required gems weren't found!\n\n            Add them to your bundle with:\n\n                bundle add rackup puma\n\n            or install them with:\n\n                gem install rackup puma\n\n          MISSING_RACKUP\n          warn rackup_warning\n          exit 1\n        end\n\n        return if running?\n\n        set options\n        handler         = Rackup::Handler.pick(server)\n        handler_name    = handler.name.gsub(/.*::/, '')\n        server_settings = settings.respond_to?(:server_settings) ? settings.server_settings : {}\n        server_settings.merge!(Port: port, Host: bind)\n\n        begin\n          start_server(handler, server_settings, handler_name, &block)\n        rescue Errno::EADDRINUSE\n          warn \"== Someone is already performing on port #{port}!\"\n          raise\n        ensure\n          quit!\n        end\n      end","complexity_score":33.25,"ast_json":"{\"type\":\"def\",\"children\":[\"run!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rackup\"]},\"Handler\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"rackup_warning\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra could not start, the required gems weren't found!\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Add them to your bundle with:\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    bundle add rackup puma\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"or install them with:\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    gem install rackup puma\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"rackup_warning\"]}]},{\"type\":\"send\",\"children\":[null,\"exit\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rackup\"]},\"Handler\"]},\"pick\",{\"type\":\"send\",\"children\":[null,\"server\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"handler_name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler\"]},\"name\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*::\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"server_settings\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"server_settings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"server_settings\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server_settings\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"Port\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"Host\"]},{\"type\":\"send\",\"children\":[null,\"bind\"]}]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"start_server\",{\"type\":\"lvar\",\"children\":[\"handler\"]},{\"type\":\"lvar\",\"children\":[\"server_settings\"]},{\"type\":\"lvar\",\"children\":[\"handler_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"EADDRINUSE\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"== Someone is already performing on port \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\"!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"quit!\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1649,"raw_source":"def running?\n        running_server?\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"running?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"running_server?\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1654,"raw_source":"def prototype\n        @prototype ||= new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prototype\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@prototype\"]},{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1664,"raw_source":"def new(*args, &block)\n        instance = new!(*args, &block)\n        Wrapper.new(build(instance).to_app, instance)\n      end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"instance\",{\"type\":\"send\",\"children\":[null,\"new!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Wrapper\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"build\",{\"type\":\"lvar\",\"children\":[\"instance\"]}]},\"to_app\"]},{\"type\":\"lvar\",\"children\":[\"instance\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1672,"raw_source":"def build(app)\n        builder = Rack::Builder.new\n        setup_default_middleware builder\n        setup_middleware builder\n        builder.run app\n        builder\n      end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"builder\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_default_middleware\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_middleware\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1680,"raw_source":"def call(env)\n        synchronize { prototype.call(env) }\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"synchronize\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prototype\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1686,"raw_source":"def caller_files\n        cleaned_caller(1).flatten\n      end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"caller_files\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cleaned_caller\",{\"type\":\"int\",\"children\":[1]}]},\"flatten\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1693,"raw_source":"def start_server(handler, server_settings, handler_name)\n        # Ensure we initialize middleware before startup, to match standard Rack\n        # behavior, by ensuring an instance exists:\n        prototype\n        # Run the instance we created:\n        handler.run(self, **server_settings) do |server|\n          unless suppress_messages?\n            warn \"== Sinatra (v#{Sinatra::VERSION}) has taken the stage on #{port} for #{environment} with backup from #{handler_name}\"\n          end\n\n          setup_traps\n          set :running_server, server\n          set :handler_name,   handler_name\n          server.threaded = settings.threaded if server.respond_to? :threaded=\n          on_start_callback.call unless on_start_callback.nil?\n          yield server if block_given?\n        end\n      end","complexity_score":30.1,"ast_json":"{\"type\":\"def\",\"children\":[\"start_server\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"handler\"]},{\"type\":\"arg\",\"children\":[\"server_settings\"]},{\"type\":\"arg\",\"children\":[\"handler_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prototype\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler\"]},\"run\",{\"type\":\"self\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server_settings\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"suppress_messages?\"]},null,{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"== Sinatra (v\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"VERSION\"]}]},{\"type\":\"str\",\"children\":[\") has taken the stage on \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\" for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]}]},{\"type\":\"str\",\"children\":[\" with backup from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler_name\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"setup_traps\"]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"running_server\"]},{\"type\":\"lvar\",\"children\":[\"server\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"handler_name\"]},{\"type\":\"lvar\",\"children\":[\"handler_name\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"threaded=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"threaded=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"threaded\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_start_callback\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_start_callback\"]},\"call\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1712,"raw_source":"def suppress_messages?\n        handler_name =~ /cgi/i || quiet\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"suppress_messages?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handler_name\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"cgi\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]},{\"type\":\"send\",\"children\":[null,\"quiet\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1716,"raw_source":"def setup_traps\n        return unless traps?\n\n        at_exit { quit! }\n\n        %i[INT TERM].each do |signal|\n          old_handler = trap(signal) do\n            quit!\n            old_handler.call if old_handler.respond_to?(:call)\n          end\n        end\n\n        set :traps, false\n      end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_traps\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traps?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"at_exit\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"quit!\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"INT\"]},{\"type\":\"sym\",\"children\":[\"TERM\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"signal\"]}]},{\"type\":\"lvasgn\",\"children\":[\"old_handler\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"trap\",{\"type\":\"lvar\",\"children\":[\"signal\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"quit!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_handler\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_handler\"]},\"call\"]},null]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"traps\"]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1732,"raw_source":"def define_singleton(name, content = Proc.new)\n        singleton_class.class_eval do\n          undef_method(name) if method_defined? name\n          String === content ? class_eval(\"def #{name}() #{content}; end\") : define_method(name, &content)\n        end\n      end","complexity_score":32.3,"ast_json":"{\"type\":\"def\",\"children\":[\"define_singleton\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"optarg\",\"children\":[\"content\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},\"new\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"singleton_class\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"undef_method\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"content\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"def \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\"() \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]}]},{\"type\":\"str\",\"children\":[\"; end\"]}]}]},{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1740,"raw_source":"def host_name(pattern)\n        condition { pattern === request.host }\n      end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"host_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1746,"raw_source":"def user_agent(pattern)\n        condition do\n          if request.user_agent.to_s =~ pattern\n            @params[:agent] = $~[1..-1]\n            true\n          else\n            false\n          end\n        end\n      end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"user_agent\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"user_agent\"]},\"to_s\"]},\"=~\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"agent\"]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$~\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1759,"raw_source":"def provides(*types)\n        types.map! { |t| mime_types(t) }\n        types.flatten!\n        condition do\n          response_content_type = response['content-type']\n          preferred_type = request.preferred_type(types)\n\n          if response_content_type\n            types.include?(response_content_type) || types.include?(response_content_type[/^[^;]+/])\n          elsif preferred_type\n            params = (preferred_type.respond_to?(:params) ? preferred_type.params : {})\n            content_type(preferred_type, params)\n            true\n          else\n            false\n          end\n        end\n      end","complexity_score":29.5,"ast_json":"{\"type\":\"def\",\"children\":[\"provides\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[null,\"mime_types\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"flatten!\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"response_content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"preferred_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"preferred_type\",{\"type\":\"lvar\",\"children\":[\"types\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response_content_type\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"response_content_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response_content_type\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"params\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},\"params\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1778,"raw_source":"def route(verb, path, options = {}, &block)\n        enable :empty_path_info if path == '' && empty_path_info.nil?\n        signature = compile!(verb, path, block, **options)\n        (@routes[verb] ||= []) << signature\n        invoke_hook(:route_added, verb, path, block)\n        signature\n      end","complexity_score":11.6,"ast_json":"{\"type\":\"def\",\"children\":[\"route\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"==\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"empty_path_info\"]},\"nil?\"]}]},{\"type\":\"send\",\"children\":[null,\"enable\",{\"type\":\"sym\",\"children\":[\"empty_path_info\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@routes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"signature\"]}]},{\"type\":\"send\",\"children\":[null,\"invoke_hook\",{\"type\":\"sym\",\"children\":[\"route_added\"]},{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1786,"raw_source":"def invoke_hook(name, *args)\n        extensions.each { |e| e.send(name, *args) if e.respond_to?(name) }\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_hook\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1790,"raw_source":"def generate_method(method_name, &block)\n        define_method(method_name, &block)\n        method = instance_method method_name\n        remove_method method_name\n        method\n      end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"generate_method\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"method\",{\"type\":\"send\",\"children\":[null,\"instance_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1797,"raw_source":"def compile!(verb, path, block, **options)\n        # Because of self.options.host\n        host_name(options.delete(:host)) if options.key?(:host)\n        # Pass Mustermann opts to compile()\n        route_mustermann_opts = options.key?(:mustermann_opts) ? options.delete(:mustermann_opts) : {}.freeze\n\n        options.each_pair { |option, args| send(option, *args) }\n\n        pattern                 = compile(path, route_mustermann_opts)\n        method_name             = \"#{verb} #{path}\"\n        unbound_method          = generate_method(method_name, &block)\n        conditions = @conditions\n        @conditions = []\n        wrapper = block.arity.zero? ?\n          proc { |a, _p| unbound_method.bind(a).call } :\n          proc { |a, p| unbound_method.bind(a).call(*p) }\n\n        [pattern, conditions, wrapper]\n      end","complexity_score":36.9,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"host\"]}]},{\"type\":\"send\",\"children\":[null,\"host_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"host\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"route_mustermann_opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[]},\"freeze\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"option\"]},{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"route_mustermann_opts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"method_name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"unbound_method\",{\"type\":\"send\",\"children\":[null,\"generate_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"ivar\",\"children\":[\"@conditions\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"wrapper\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"_p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unbound_method\"]},\"bind\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"call\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unbound_method\"]},\"bind\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"call\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]}]}]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"lvar\",\"children\":[\"wrapper\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1817,"raw_source":"def compile(path, route_mustermann_opts = {})\n        Mustermann.new(path, **mustermann_opts.merge(route_mustermann_opts))\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"route_mustermann_opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mustermann_opts\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"route_mustermann_opts\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1821,"raw_source":"def setup_default_middleware(builder)\n        builder.use ExtendedRack\n        builder.use ShowExceptions       if show_exceptions?\n        builder.use Rack::MethodOverride if method_override?\n        builder.use Rack::Head\n        setup_logging    builder\n        setup_sessions   builder\n        setup_protection builder\n        setup_host_authorization builder\n      end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_default_middleware\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[null,\"ExtendedRack\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"show_exceptions?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[null,\"ShowExceptions\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_override?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"MethodOverride\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Head\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_logging\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_sessions\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_protection\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_host_authorization\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1832,"raw_source":"def setup_middleware(builder)\n        middleware.each { |c, a, b| builder.use(c, *a, &b) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_middleware\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]},{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"lvar\",\"children\":[\"c\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1836,"raw_source":"def setup_logging(builder)\n        if logging?\n          setup_common_logger(builder)\n          setup_custom_logger(builder)\n        elsif logging == false\n          setup_null_logger(builder)\n        end\n      end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_logging\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"setup_common_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_custom_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging\"]},\"==\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"setup_null_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1845,"raw_source":"def setup_null_logger(builder)\n        builder.use Sinatra::Middleware::Logger, ::Logger::FATAL\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_null_logger\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Middleware\"]},\"Logger\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"FATAL\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1849,"raw_source":"def setup_common_logger(builder)\n        builder.use Sinatra::CommonLogger\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_common_logger\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"CommonLogger\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1853,"raw_source":"def setup_custom_logger(builder)\n        if logging.respond_to? :to_int\n          builder.use Sinatra::Middleware::Logger, logging\n        else\n          builder.use Sinatra::Middleware::Logger\n        end\n      end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_custom_logger\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_int\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Middleware\"]},\"Logger\"]},{\"type\":\"send\",\"children\":[null,\"logging\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Middleware\"]},\"Logger\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1861,"raw_source":"def setup_protection(builder)\n        return unless protection?\n\n        options = Hash === protection ? protection.dup : {}\n        options = {\n          img_src: \"'self' data:\",\n          font_src: \"'self'\"\n        }.merge options\n\n        protect_session = options.fetch(:session) { sessions? }\n        options[:without_session] = !protect_session\n\n        options[:reaction] ||= :drop_session\n\n        builder.use Rack::Protection, options\n      end","complexity_score":17.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_protection\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protection?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"protection\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protection\"]},\"dup\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"img_src\"]},{\"type\":\"str\",\"children\":[\"'self' data:\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"font_src\"]},{\"type\":\"str\",\"children\":[\"'self'\"]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"protect_session\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"session\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"sessions?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"without_session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"protect_session\"]},\"!\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"reaction\"]}]},{\"type\":\"sym\",\"children\":[\"drop_session\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Protection\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1878,"raw_source":"def setup_host_authorization(builder)\n        builder.use Rack::Protection::HostAuthorization, host_authorization\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_host_authorization\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Protection\"]},\"HostAuthorization\"]},{\"type\":\"send\",\"children\":[null,\"host_authorization\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1882,"raw_source":"def setup_sessions(builder)\n        return unless sessions?\n\n        options = {}\n        options[:secret] = session_secret if session_secret?\n        options.merge! sessions.to_hash if sessions.respond_to? :to_hash\n        builder.use session_store, options\n      end","complexity_score":16.5,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_sessions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session_secret?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"secret\"]},{\"type\":\"send\",\"children\":[null,\"session_secret\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions\"]},\"to_hash\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"send\",\"children\":[null,\"session_store\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1891,"raw_source":"def inherited(subclass)\n        subclass.reset!\n        subclass.set :app_file, caller_files.first unless subclass.app_file?\n        super\n      end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"reset!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"app_file?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"app_file\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"first\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1898,"raw_source":"def synchronize(&block)\n        if lock?\n          @@mutex.synchronize(&block)\n        else\n          yield\n        end\n      end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"synchronize\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lock?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@mutex\"]},\"synchronize\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"yield\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1907,"raw_source":"def warn_for_deprecation(message)\n        warn message + \"\\n\\tfrom #{cleaned_caller.first.join(':')}\"\n      end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"warn_for_deprecation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]},\"+\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\\tfrom \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cleaned_caller\"]},\"first\"]},\"join\",{\"type\":\"str\",\"children\":[\":\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1912,"raw_source":"def cleaned_caller(keep = 3)\n        caller(1)\n          .map! { |line| line.split(/:(?=\\d|in )/, 3)[0, keep] }\n          .reject { |file, *_| callers_to_ignore.any? { |pattern| file =~ pattern } }\n      end","complexity_score":15.38,"ast_json":"{\"type\":\"def\",\"children\":[\"cleaned_caller\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"keep\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\",{\"type\":\"int\",\"children\":[1]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\":(?=\\\\d|in )\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[3]}]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"keep\"]}]}]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]},{\"type\":\"restarg\",\"children\":[\"_\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"callers_to_ignore\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"=~\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1921,"raw_source":"def self.force_encoding(data, encoding = default_encoding)\n      return if data == settings || data.is_a?(Tempfile)\n\n      if data.respond_to? :force_encoding\n        data.force_encoding(encoding).encode!\n      elsif data.respond_to? :each_value\n        data.each_value { |v| force_encoding(v, encoding) }\n      elsif data.respond_to? :each\n        data.each { |v| force_encoding(v, encoding) }\n      end\n      data\n    end","complexity_score":24.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"force_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"optarg\",\"children\":[\"encoding\",{\"type\":\"send\",\"children\":[null,\"default_encoding\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Tempfile\"]}]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"force_encoding\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},\"encode!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each_value\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each_value\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1934,"raw_source":"def force_encoding(*args)\n      settings.force_encoding(*args)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"force_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"force_encoding\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2093,"raw_source":"def self.register(*extensions, &block) # :nodoc:\n      added_methods = extensions.flat_map(&:public_instance_methods)\n      Delegator.delegate(*added_methods)\n      super(*extensions, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"added_methods\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"flat_map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"public_instance_methods\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"delegate\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"added_methods\"]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2104,"raw_source":"def self.delegate(*methods)\n      methods.each do |method_name|\n        define_method(method_name) do |*args, &block|\n          return super(*args, &block) if respond_to? method_name\n\n          Delegator.target.send(method_name, *args, &block)\n        end\n        # ensure keyword argument passing is compatible with ruby >= 2.7\n        ruby2_keywords(method_name) if respond_to?(:ruby2_keywords, true)\n        private method_name\n      end\n    end","complexity_score":27.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"delegate\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"methods\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"methods\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"ruby2_keywords\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"ruby2_keywords\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2130,"raw_source":"def initialize(stack, instance)\n      @stack = stack\n      @instance = instance\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"stack\"]},{\"type\":\"arg\",\"children\":[\"instance\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@stack\",{\"type\":\"lvar\",\"children\":[\"stack\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@instance\",{\"type\":\"lvar\",\"children\":[\"instance\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2135,"raw_source":"def settings\n      @instance.settings\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@instance\"]},\"settings\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2139,"raw_source":"def helpers\n      @instance\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@instance\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2143,"raw_source":"def call(env)\n      @stack.call(env)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@stack\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2147,"raw_source":"def inspect\n      \"#<#{@instance.class} app_file=#{settings.app_file.inspect}>\"\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@instance\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" app_file=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"app_file\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2153,"raw_source":"def self.new(base = Base, &block)\n    base = Class.new(base)\n    base.class_eval(&block) if block_given?\n    base\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[null,\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"base\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2160,"raw_source":"def self.register(*extensions, &block)\n    Delegator.target.register(*extensions, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"register\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2165,"raw_source":"def self.helpers(*extensions, &block)\n    Delegator.target.helpers(*extensions, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"helpers\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2170,"raw_source":"def self.use(*args, &block)\n    Delegator.target.use(*args, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"use\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":42,"raw_source":"def self.[](*args)\n      new.merge!(Hash[*args])\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":46,"raw_source":"def default(*args)\n      args.map!(&method(:convert_key))\n\n      super(*args)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":52,"raw_source":"def default=(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":56,"raw_source":"def assoc(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":60,"raw_source":"def rassoc(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rassoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":64,"raw_source":"def fetch(key, *args)\n      args.map!(&method(:convert_value))\n\n      super(convert_key(key), *args)\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":70,"raw_source":"def [](key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":74,"raw_source":"def []=(key, value)\n      super(convert_key(key), convert_value(value))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":80,"raw_source":"def key(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":84,"raw_source":"def key?(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":92,"raw_source":"def value?(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"value?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":98,"raw_source":"def delete(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":103,"raw_source":"def dig(key, *other_keys)\n      super(convert_key(key), *other_keys)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dig\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"other_keys\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_keys\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":107,"raw_source":"def fetch_values(*keys)\n      keys.map!(&method(:convert_key))\n\n      super(*keys)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch_values\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":113,"raw_source":"def slice(*keys)\n      keys.map!(&method(:convert_key))\n\n      self.class[super(*keys)]\n    end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"slice\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":119,"raw_source":"def values_at(*keys)\n      keys.map!(&method(:convert_key))\n\n      super(*keys)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"values_at\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":125,"raw_source":"def merge!(*other_hashes)\n      other_hashes.each do |other_hash|\n        if other_hash.is_a?(self.class)\n          super(other_hash)\n        else\n          other_hash.each_pair do |key, value|\n            key = convert_key(key)\n            value = yield(key, self[key], value) if block_given? && key?(key)\n            self[key] = convert_value(value)\n          end\n        end\n      end\n\n      self\n    end","complexity_score":25.0,"ast_json":"{\"type\":\"def\",\"children\":[\"merge!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"other_hashes\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hashes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other_hash\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":143,"raw_source":"def merge(*other_hashes, &block)\n      dup.merge!(*other_hashes, &block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"other_hashes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"merge!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hashes\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":147,"raw_source":"def replace(other_hash)\n      super(other_hash.is_a?(self.class) ? other_hash : self.class[other_hash])\n    end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other_hash\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"other_hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"other_hash\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":151,"raw_source":"def transform_values(&block)\n      dup.transform_values!(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_values\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"transform_values!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":155,"raw_source":"def transform_values!\n      super\n      super(&method(:convert_value))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_values!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"super\",\"children\":[{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":160,"raw_source":"def transform_keys(&block)\n      dup.transform_keys!(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_keys\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"transform_keys!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":164,"raw_source":"def transform_keys!\n      super\n      super(&method(:convert_key))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_keys!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"super\",\"children\":[{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":169,"raw_source":"def select(*args, &block)\n      return to_enum(:select) unless block_given?\n\n      dup.tap { |hash| hash.select!(*args, &block) }\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"select\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_enum\",{\"type\":\"sym\",\"children\":[\"select\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"select!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":175,"raw_source":"def reject(*args, &block)\n      return to_enum(:reject) unless block_given?\n\n      dup.tap { |hash| hash.reject!(*args, &block) }\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_enum\",{\"type\":\"sym\",\"children\":[\"reject\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":181,"raw_source":"def compact\n      dup.tap(&:compact!)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"compact!\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":185,"raw_source":"def except(*keys)\n      keys.map!(&method(:convert_key))\n\n      self.class[super(*keys)]\n    end if Gem::Version.new(RUBY_VERSION) >= Gem::Version.new(\"3.0\")","complexity_score":4.4,"ast_json":"{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"3.0\"]}]}]},{\"type\":\"def\",\"children\":[\"except\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":193,"raw_source":"def convert_key(key)\n      key.is_a?(Symbol) ? key.to_s : key\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"convert_key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Symbol\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":197,"raw_source":"def convert_value(value)\n      case value\n      when Hash\n        value.is_a?(self.class) ? value : self.class[value]\n      when Array\n        value.map(&method(:convert_value))\n      else\n        value\n      end\n    end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"convert_value\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/middleware/logger.rb","start_line":8,"raw_source":"def initialize(app, level = ::Logger::INFO)\n        @app, @level = app, level\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"level\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"INFO\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"ivasgn\",\"children\":[\"@level\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"lvar\",\"children\":[\"level\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/middleware/logger.rb","start_line":12,"raw_source":"def call(env)\n        logger = ::Logger.new(env[Rack::RACK_ERRORS])\n        logger.level = @level\n\n        env[Rack::RACK_LOGGER] = logger\n        @app.call(env)\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"logger\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"RACK_ERRORS\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"logger\"]},\"level=\",{\"type\":\"ivar\",\"children\":[\"@level\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"RACK_LOGGER\"]},{\"type\":\"lvar\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":14,"raw_source":"def @@eats_errors.flush(*) end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@eats_errors\"]},\"flush\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":16,"raw_source":"def @@eats_errors.puts(*) end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@eats_errors\"]},\"puts\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":18,"raw_source":"def initialize(app)\n      @app = app\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":22,"raw_source":"def call(env)\n      @app.call(env)\n    rescue Exception => e\n      errors = env['rack.errors']\n      env['rack.errors'] = @@eats_errors\n\n      if prefers_plain_text?(env)\n        content_type = 'text/plain'\n        body = dump_exception(e)\n      else\n        content_type = 'text/html'\n        body = pretty(env, e)\n      end\n\n      env['rack.errors'] = errors\n\n      [\n        500,\n        {\n          'content-type' => content_type,\n          'content-length' => body.bytesize.to_s\n        },\n        [body]\n      ]\n    end","complexity_score":20.28,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.errors\"]},{\"type\":\"cvar\",\"children\":[\"@@eats_errors\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prefers_plain_text?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"str\",\"children\":[\"text/plain\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"dump_exception\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"pretty\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.errors\"]},{\"type\":\"lvar\",\"children\":[\"errors\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[500]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"lvar\",\"children\":[\"content_type\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"bytesize\"]},\"to_s\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":48,"raw_source":"def template\n      TEMPLATE\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"TEMPLATE\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":54,"raw_source":"def bad_request?(exception)\n      Sinatra::BadRequest === exception\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"bad_request?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"exception\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"BadRequest\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"exception\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":58,"raw_source":"def prefers_plain_text?(env)\n      Request.new(env).preferred_type('text/plain', 'text/html') != 'text/html' &&\n        [/curl/].index { |item| item =~ env['HTTP_USER_AGENT'] }\n    end","complexity_score":9.7,"ast_json":"{\"type\":\"def\",\"children\":[\"prefers_plain_text?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"preferred_type\",{\"type\":\"str\",\"children\":[\"text/plain\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},\"!=\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"curl\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"=~\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_USER_AGENT\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":63,"raw_source":"def frame_class(frame)\n      if frame.filename =~ %r{lib/sinatra.*\\.rb}\n        'framework'\n      elsif (defined?(Gem) && frame.filename.include?(Gem.dir)) ||\n            frame.filename =~ %r{/bin/(\\w+)\\z}\n        'system'\n      else\n        'app'\n      end\n    end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"frame_class\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"frame\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"lib/sinatra.*\\\\.rb\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"str\",\"children\":[\"framework\"]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"dir\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"/bin/(\\\\w+)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\"system\"]},{\"type\":\"str\",\"children\":[\"app\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection.rb","start_line":27,"raw_source":"def self.new(app, options = {})\n      except = Array options[:except]\n      use_these = Array options[:use]\n\n      if options.fetch(:without_session, false)\n        except += %i[remote_token]\n      end\n\n      Rack::Builder.new do\n        # Off by default, unless added\n        use ::Rack::Protection::AuthenticityToken,     options if use_these.include? :authenticity_token\n        use ::Rack::Protection::ContentSecurityPolicy, options if use_these.include? :content_security_policy\n        use ::Rack::Protection::CookieTossing,         options if use_these.include? :cookie_tossing\n        use ::Rack::Protection::EscapedParams,         options if use_these.include? :escaped_params\n        use ::Rack::Protection::FormToken,             options if use_these.include? :form_token\n        use ::Rack::Protection::ReferrerPolicy,        options if use_these.include? :referrer_policy\n        use ::Rack::Protection::RemoteReferrer,        options if use_these.include? :remote_referrer\n        use ::Rack::Protection::SessionHijacking,      options if use_these.include? :session_hijacking\n        use ::Rack::Protection::StrictTransport,       options if use_these.include? :strict_transport\n\n        # On by default, unless skipped\n        use ::Rack::Protection::FrameOptions,          options unless except.include? :frame_options\n        use ::Rack::Protection::HttpOrigin,            options unless except.include? :http_origin\n        use ::Rack::Protection::IPSpoofing,            options unless except.include? :ip_spoofing\n        use ::Rack::Protection::JsonCsrf,              options unless except.include? :json_csrf\n        use ::Rack::Protection::PathTraversal,         options unless except.include? :path_traversal\n        use ::Rack::Protection::RemoteToken,           options unless except.include? :remote_token\n        use ::Rack::Protection::XSSHeader,             options unless except.include? :xss_header\n        run app\n      end.to_app\n    end","complexity_score":85.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"except\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"except\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"use_these\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"use\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"without_session\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"except\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"remote_token\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"authenticity_token\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"AuthenticityToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"content_security_policy\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"ContentSecurityPolicy\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"cookie_tossing\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"CookieTossing\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"escaped_params\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"EscapedParams\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"form_token\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"FormToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"referrer_policy\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"ReferrerPolicy\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"remote_referrer\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"RemoteReferrer\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"session_hijacking\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"SessionHijacking\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"strict_transport\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"StrictTransport\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"FrameOptions\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"http_origin\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"HttpOrigin\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"ip_spoofing\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"IPSpoofing\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"json_csrf\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"JsonCsrf\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"path_traversal\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"PathTraversal\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"remote_token\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"RemoteToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"xss_header\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"XSSHeader\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}]},\"to_app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":105,"raw_source":"def self.token(session, path: nil, method: :post)\n        new(nil).mask_authenticity_token(session, path: path, method: method)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"kwoptarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"method\",{\"type\":\"sym\",\"children\":[\"post\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"nil\",\"children\":[]}]},\"mask_authenticity_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":109,"raw_source":"def self.random_token\n        SecureRandom.urlsafe_base64(TOKEN_LENGTH, padding: false)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"random_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]},\"urlsafe_base64\",{\"type\":\"const\",\"children\":[null,\"TOKEN_LENGTH\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"padding\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":113,"raw_source":"def accepts?(env)\n        session = session(env)\n        set_token(session)\n\n        safe?(env) ||\n          valid_token?(env, env['HTTP_X_CSRF_TOKEN']) ||\n          valid_token?(env, Request.new(env).params[options[:authenticity_param]]) ||\n          options[:allow_if]&.call(env)\n      rescue StandardError\n        false\n      end","complexity_score":29.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[null,\"valid_token?\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_CSRF_TOKEN\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"valid_token?\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"params\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"authenticity_param\"]}]}]}]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":125,"raw_source":"def mask_authenticity_token(session, path: nil, method: :post)\n        set_token(session)\n\n        token = if path && method\n                  per_form_token(session, path, method)\n                else\n                  global_token(session)\n                end\n\n        mask_token(token)\n      end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mask_authenticity_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"kwoptarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"method\",{\"type\":\"sym\",\"children\":[\"post\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"per_form_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"global_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"mask_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":142,"raw_source":"def set_token(session)\n        session[options[:key]] ||= self.class.random_token\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"set_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"random_token\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":148,"raw_source":"def valid_token?(env, token)\n        return false if token.nil? || !token.is_a?(String) || token.empty?\n\n        session = session(env)\n\n        begin\n          token = decode_token(token)\n        rescue ArgumentError # encoded_masked_token is invalid Base64\n          return false\n        end\n\n        # See if it's actually a masked token or not. We should be able\n        # to handle any unmasked tokens that we've issued without error.\n\n        if unmasked_token?(token)\n          compare_with_real_token(token, session)\n        elsif masked_token?(token)\n          token = unmask_token(token)\n\n          compare_with_global_token(token, session) ||\n            compare_with_real_token(token, session) ||\n            compare_with_per_form_token(token, session, Request.new(env))\n        else\n          false # Token is malformed\n        end\n      end","complexity_score":29.9,"ast_json":"{\"type\":\"def\",\"children\":[\"valid_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"decode_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"unmasked_token?\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_real_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"masked_token?\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"unmask_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"compare_with_global_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_real_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_per_form_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"false\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":178,"raw_source":"def mask_token(token)\n        one_time_pad = SecureRandom.random_bytes(token.length)\n        encrypted_token = xor_byte_strings(one_time_pad, token)\n        masked_token = one_time_pad + encrypted_token\n        encode_token(masked_token)\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mask_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"one_time_pad\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]},\"random_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"encrypted_token\",{\"type\":\"send\",\"children\":[null,\"xor_byte_strings\",{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"masked_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"encrypted_token\"]}]}]},{\"type\":\"send\",\"children\":[null,\"encode_token\",{\"type\":\"lvar\",\"children\":[\"masked_token\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":186,"raw_source":"def unmask_token(masked_token)\n        # Split the token into the one-time pad and the encrypted\n        # value and decrypt it\n        token_length = masked_token.length / 2\n        one_time_pad = masked_token[0...token_length]\n        encrypted_token = masked_token[token_length..]\n        xor_byte_strings(one_time_pad, encrypted_token)\n      end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"unmask_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"masked_token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token_length\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"length\"]},\"/\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"one_time_pad\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"[]\",{\"type\":\"erange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"token_length\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"encrypted_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token_length\"]},null]}]}]},{\"type\":\"send\",\"children\":[null,\"xor_byte_strings\",{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},{\"type\":\"lvar\",\"children\":[\"encrypted_token\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":195,"raw_source":"def unmasked_token?(token)\n        token.length == TOKEN_LENGTH\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unmasked_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"TOKEN_LENGTH\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":199,"raw_source":"def masked_token?(token)\n        token.length == TOKEN_LENGTH * 2\n      end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"masked_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TOKEN_LENGTH\"]},\"*\",{\"type\":\"int\",\"children\":[2]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":203,"raw_source":"def compare_with_real_token(token, session)\n        secure_compare(token, real_token(session))\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_real_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"real_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":207,"raw_source":"def compare_with_global_token(token, session)\n        secure_compare(token, global_token(session))\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_global_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"global_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":211,"raw_source":"def compare_with_per_form_token(token, session, request)\n        secure_compare(token,\n                       per_form_token(session, request.path.chomp('/'), request.request_method))\n      end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_per_form_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"request\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"per_form_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]},\"chomp\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"request_method\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":216,"raw_source":"def real_token(session)\n        decode_token(session[options[:key]])\n      end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"real_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"decode_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"key\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":220,"raw_source":"def global_token(session)\n        token_hmac(session, GLOBAL_TOKEN_IDENTIFIER)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"global_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"token_hmac\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"const\",\"children\":[null,\"GLOBAL_TOKEN_IDENTIFIER\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":224,"raw_source":"def per_form_token(session, path, method)\n        token_hmac(session, \"#{path}##{method.downcase}\")\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"per_form_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"token_hmac\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"str\",\"children\":[\"#\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"downcase\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":228,"raw_source":"def encode_token(token)\n        Base64.urlsafe_encode64(token)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"encode_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_encode64\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":232,"raw_source":"def decode_token(token)\n        Base64.urlsafe_decode64(token)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"decode_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_decode64\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":236,"raw_source":"def token_hmac(session, identifier)\n        OpenSSL::HMAC.digest(\n          OpenSSL::Digest.new('SHA256'),\n          real_token(session),\n          identifier\n        )\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"token_hmac\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"identifier\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"HMAC\"]},\"digest\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"Digest\"]},\"new\",{\"type\":\"str\",\"children\":[\"SHA256\"]}]},{\"type\":\"send\",\"children\":[null,\"real_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"lvar\",\"children\":[\"identifier\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":244,"raw_source":"def xor_byte_strings(s1, s2)\n        s2 = s2.dup\n        size = s1.bytesize\n        i = 0\n        while i < size\n          s2.setbyte(i, s1.getbyte(i) ^ s2.getbyte(i))\n          i += 1\n        end\n        s2\n      end","complexity_score":15.65,"ast_json":"{\"type\":\"def\",\"children\":[\"xor_byte_strings\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s1\"]},{\"type\":\"arg\",\"children\":[\"s2\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"s2\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"size\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s1\"]},\"bytesize\"]}]},{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"size\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"setbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s1\"]},\"getbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"^\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"getbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvar\",\"children\":[\"s2\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":23,"raw_source":"def self.default_options(options)\n        define_method(:default_options) { super().merge(options) }\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"default_options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"sym\",\"children\":[\"default_options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"super\",\"children\":[]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":27,"raw_source":"def self.default_reaction(reaction)\n        alias_method(:default_reaction, reaction)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"default_reaction\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"reaction\"]}]},{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"default_reaction\"]},{\"type\":\"lvar\",\"children\":[\"reaction\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":31,"raw_source":"def default_options\n        DEFAULT_OPTIONS\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default_options\",{\"type\":\"args\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"DEFAULT_OPTIONS\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":35,"raw_source":"def initialize(app, options = {})\n        @app = app\n        @options = default_options.merge(options)\n      end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"default_options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":40,"raw_source":"def safe?(env)\n        %w[GET HEAD OPTIONS TRACE].include? env['REQUEST_METHOD']\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"GET\"]},{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]},{\"type\":\"str\",\"children\":[\"TRACE\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":44,"raw_source":"def accepts?(env)\n        raise NotImplementedError, \"#{self.class} implementation pending\"\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" implementation pending\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":48,"raw_source":"def call(env)\n        unless accepts? env\n          instrument env\n          result = react env\n        end\n        result or app.call(env)\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accepts?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instrument\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"react\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":56,"raw_source":"def react(env)\n        result = send(options[:reaction], env)\n        result if (Array === result) && (result.size == 3)\n      end","complexity_score":12.43,"ast_json":"{\"type\":\"def\",\"children\":[\"react\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"reaction\"]}]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"size\"]},\"==\",{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":61,"raw_source":"def debug(env, message)\n        return unless options[:logging]\n\n        l = options[:logger] || env['rack.logger'] || ::Logger.new(env['rack.errors'])\n        l.debug(message)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"debug\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logging\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"debug\",{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":68,"raw_source":"def warn(env, message)\n        return unless options[:logging]\n\n        l = options[:logger] || env['rack.logger'] || ::Logger.new(env['rack.errors'])\n        l.warn(message)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logging\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"warn\",{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":75,"raw_source":"def instrument(env)\n        return unless (i = options[:instrumenter])\n\n        env['rack.protection.attack'] = self.class.name.split('::').last.downcase\n        i.instrument('rack.protection', env)\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"instrument\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"instrumenter\"]}]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.protection.attack\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]},\"split\",{\"type\":\"str\",\"children\":[\"::\"]}]},\"last\"]},\"downcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"instrument\",{\"type\":\"str\",\"children\":[\"rack.protection\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":82,"raw_source":"def deny(env)\n        warn env, \"attack prevented by #{self.class}\"\n        [options[:status], { 'content-type' => 'text/plain' }, [options[:message]]]\n      end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"deny\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"message\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":87,"raw_source":"def report(env)\n        warn env, \"attack reported by #{self.class}\"\n        env[options[:report_key]] = true\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"report\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack reported by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"report_key\"]}]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":92,"raw_source":"def session?(env)\n        env.include? options[:session_key]\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"session?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":96,"raw_source":"def session(env)\n        return env[options[:session_key]] if session? env\n\n        raise \"you need to set up a session middleware *before* #{self.class}\"\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"you need to set up a session middleware *before* \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":102,"raw_source":"def drop_session(env)\n        return unless session? env\n\n        session(env).clear\n\n        return if [\"1\", \"true\"].include?(ENV[\"RACK_PROTECTION_SILENCE_DROP_SESSION_WARNING\"])\n\n        warn env, \"session dropped by #{self.class}\"\n      end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_session\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"clear\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"true\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"RACK_PROTECTION_SILENCE_DROP_SESSION_WARNING\"]}]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"session dropped by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":112,"raw_source":"def referrer(env)\n        ref = env['HTTP_REFERER'].to_s\n        return if !options[:allow_empty_referrer] && ref.empty?\n\n        URI.parse(ref).host || Request.new(env).host\n      rescue URI::InvalidURIError\n      end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"referrer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ref\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_REFERER\"]}]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_empty_referrer\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ref\"]},\"empty?\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"ref\"]}]},\"host\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"InvalidURIError\"]}]},null,null]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":120,"raw_source":"def origin(env)\n        env['HTTP_ORIGIN'] || env['HTTP_X_ORIGIN']\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"origin\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ORIGIN\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_ORIGIN\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":124,"raw_source":"def random_string(secure = defined? SecureRandom)\n        secure ? SecureRandom.hex(16) : '%032x' % rand((2**128) - 1)\n      rescue NotImplementedError\n        random_string false\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"random_string\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"secure\",{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]}]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"secure\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]},\"hex\",{\"type\":\"int\",\"children\":[16]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"%032x\"]},\"%\",{\"type\":\"send\",\"children\":[null,\"rand\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"**\",{\"type\":\"int\",\"children\":[128]}]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"random_string\",{\"type\":\"false\",\"children\":[]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":130,"raw_source":"def encrypt(value)\n        options[:encryptor].hexdigest value.to_s\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"encrypt\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"encryptor\"]}]},\"hexdigest\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":134,"raw_source":"def secure_compare(a, b)\n        Rack::Utils.secure_compare(a.to_s, b.to_s)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"secure_compare\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"secure_compare\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_s\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":140,"raw_source":"def html?(headers)\n        return false unless (header = headers.detect { |k, _v| k.downcase == 'content-type' })\n\n        options[:html_types].include? header.last[%r{^\\w+/\\w+}]\n      end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"html?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"header\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"downcase\"]},\"==\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"html_types\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"header\"]},\"last\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\\\\w+/\\\\w+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/content_security_policy.rb","start_line":53,"raw_source":"def csp_policy\n        directives = []\n\n        DIRECTIVES.each do |d|\n          if options.key?(d)\n            directives << \"#{d.to_s.sub(/_/, '-')} #{options[d]}\"\n          end\n        end\n\n        # Set these key values to boolean 'true' to include in policy\n        NO_ARG_DIRECTIVES.each do |d|\n          if options.key?(d) && options[d].is_a?(TrueClass)\n            directives << d.to_s.tr('_', '-')\n          end\n        end\n\n        directives.compact.sort.join('; ')\n      end","complexity_score":32.5,"ast_json":"{\"type\":\"def\",\"children\":[\"csp_policy\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"directives\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DIRECTIVES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"d\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"d\"]},\"to_s\"]},\"sub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"d\"]}]}]}]}]},null]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NO_ARG_DIRECTIVES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"d\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"TrueClass\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"d\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"compact\"]},\"sort\"]},\"join\",{\"type\":\"str\",\"children\":[\"; \"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/content_security_policy.rb","start_line":72,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        header = options[:report_only] ? 'content-security-policy-report-only' : 'content-security-policy'\n        headers[header] ||= csp_policy if html? headers\n        [status, headers, body]\n      end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"header\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"report_only\"]}]},{\"type\":\"str\",\"children\":[\"content-security-policy-report-only\"]},{\"type\":\"str\",\"children\":[\"content-security-policy\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"header\"]}]},{\"type\":\"send\",\"children\":[null,\"csp_policy\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":22,"raw_source":"def call(env)\n        status, headers, body = super\n        response = Rack::Response.new(body, status, headers)\n        request = Rack::Request.new(env)\n        remove_bad_cookies(request, response)\n        response.finish\n      end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Response\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_bad_cookies\",{\"type\":\"lvar\",\"children\":[\"request\"]},{\"type\":\"lvar\",\"children\":[\"response\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"finish\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":30,"raw_source":"def accepts?(env)\n        cookie_header = env['HTTP_COOKIE']\n        cookies = Rack::Utils.parse_query(cookie_header, ';,') { |s| s }\n        cookies.each do |k, v|\n          if (k == session_key && Array(v).size > 1) ||\n             (k != session_key && Rack::Utils.unescape(k) == session_key)\n            bad_cookies << k\n          end\n        end\n        bad_cookies.empty?\n      end","complexity_score":31.18,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cookie_header\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_COOKIE\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cookies\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"parse_query\",{\"type\":\"lvar\",\"children\":[\"cookie_header\"]},{\"type\":\"str\",\"children\":[\";,\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cookies\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},\"size\"]},\">\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"!=\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"unescape\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"empty?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":42,"raw_source":"def remove_bad_cookies(request, response)\n        return if bad_cookies.empty?\n\n        paths = cookie_paths(request.path)\n        bad_cookies.each do |name|\n          paths.each { |path| response.set_cookie name, empty_cookie(request.host, path) }\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_bad_cookies\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"request\"]},{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"paths\",{\"type\":\"send\",\"children\":[null,\"cookie_paths\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"set_cookie\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"send\",\"children\":[null,\"empty_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":51,"raw_source":"def redirect(env)\n        request = Request.new(env)\n        warn env, \"attack prevented by #{self.class}\"\n        [302, { 'content-type' => 'text/html', 'location' => request.path }, []]\n      end","complexity_score":5.45,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[302]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"location\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]}]}]},{\"type\":\"array\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":57,"raw_source":"def bad_cookies\n        @bad_cookies ||= []\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"bad_cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@bad_cookies\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":61,"raw_source":"def cookie_paths(path)\n        path = '/' if path.to_s.empty?\n        paths = []\n        Pathname.new(path).descend { |p| paths << p.to_s }\n        paths\n      end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"cookie_paths\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"to_s\"]},\"empty?\"]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"str\",\"children\":[\"/\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"paths\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Pathname\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"descend\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"to_s\"]}]}]},{\"type\":\"lvar\",\"children\":[\"paths\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":68,"raw_source":"def empty_cookie(host, path)\n        { value: '', domain: host, path: path, expires: Time.at(0) }\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"empty_cookie\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]},{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"domain\"]},{\"type\":\"lvar\",\"children\":[\"host\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expires\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":72,"raw_source":"def session_key\n        @session_key ||= options[:session_key]\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"session_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@session_key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":36,"raw_source":"def initialize(*)\n        super\n\n        modes       = Array options[:escape]\n        @escaper    = options[:escaper]\n        @html       = modes.include? :html\n        @javascript = modes.include? :javascript\n        @url        = modes.include? :url\n\n        return unless @javascript && (!@escaper.respond_to? :escape_javascript)\n\n        raise('Use EscapeUtils for JavaScript escaping.')\n      end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"modes\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"escape\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@escaper\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"escaper\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"html\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@javascript\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"javascript\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@url\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"url\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@javascript\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"escape_javascript\"]}]},\"!\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"Use EscapeUtils for JavaScript escaping.\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":50,"raw_source":"def call(env)\n        request  = Request.new(env)\n        get_was  = handle(request.GET)\n        post_was = begin\n          handle(request.POST)\n        rescue StandardError\n          nil\n        end\n        app.call env\n      ensure\n        request.GET.replace  get_was  if get_was\n        request.POST.replace post_was if post_was\n      end","complexity_score":20.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"get_was\",{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"GET\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"post_was\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"POST\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"get_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"GET\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"get_was\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"post_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"POST\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"post_was\"]}]},null]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":64,"raw_source":"def handle(hash)\n        was = hash.dup\n        hash.replace escape(hash)\n        was\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"replace\",{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]},{\"type\":\"lvar\",\"children\":[\"was\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":70,"raw_source":"def escape(object)\n        case object\n        when Hash   then escape_hash(object)\n        when Array  then object.map { |o| escape(o) }\n        when String then escape_string(object)\n        when Tempfile then object\n        end\n      end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"escape\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"escape_hash\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"o\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"escape_string\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tempfile\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":79,"raw_source":"def escape_hash(hash)\n        hash = hash.dup\n        hash.each { |k, v| hash[k] = escape(v) }\n        hash\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_hash\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"dup\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":85,"raw_source":"def escape_string(str)\n        str = @escaper.escape_url(str)        if @url\n        str = @escaper.escape_html(str)       if @html\n        str = @escaper.escape_javascript(str) if @javascript\n        str\n      end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_string\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@url\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_url\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@html\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_html\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@javascript\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_javascript\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/form_token.rb","start_line":20,"raw_source":"def accepts?(env)\n        env['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest' or super\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_REQUESTED_WITH\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"XMLHttpRequest\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/frame_options.rb","start_line":24,"raw_source":"def frame_options\n        @frame_options ||= begin\n          frame_options = options[:frame_options]\n          frame_options = options[:frame_options].to_s.upcase unless frame_options.respond_to? :to_str\n          frame_options.to_str\n        end\n      end","complexity_score":15.0,"ast_json":"{\"type\":\"def\",\"children\":[\"frame_options\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@frame_options\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"frame_options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame_options\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"frame_options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]},\"to_s\"]},\"upcase\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame_options\"]},\"to_str\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/frame_options.rb","start_line":32,"raw_source":"def call(env)\n        status, headers, body        = @app.call(env)\n        headers['x-frame-options'] ||= frame_options if html? headers\n        [status, headers, body]\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-frame-options\"]}]},{\"type\":\"send\",\"children\":[null,\"frame_options\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":33,"raw_source":"def initialize(*)\n        super\n        @permitted_hosts = []\n        @domain_hosts = []\n        @ip_hosts = []\n        @all_permitted_hosts = Array(options[:permitted_hosts])\n\n        @all_permitted_hosts.each do |host|\n          case host\n          when String\n            if host.start_with?(DOT)\n              domain = host[1..-1]\n              @permitted_hosts << domain.downcase\n              @domain_hosts << /\\A#{SUBDOMAINS}#{Regexp.escape(domain)}\\z/i\n            else\n              @permitted_hosts << host.downcase\n            end\n          when IPAddr then @ip_hosts << host\n          end\n        end\n      end","complexity_score":29.4,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@permitted_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@domain_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@ip_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@all_permitted_hosts\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"permitted_hosts\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"domain\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"domain\"]},\"downcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"<<\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SUBDOMAINS\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"escape\",{\"type\":\"lvar\",\"children\":[\"domain\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\\z\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"downcase\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IPAddr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},null]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":55,"raw_source":"def accepts?(env)\n        return true if options[:allow_if]&.call(env)\n        return true if @all_permitted_hosts.empty?\n\n        request = Request.new(env)\n        origin_host = extract_host(request.host_authority)\n        forwarded_host = extract_host(request.forwarded_authority)\n\n        debug env, \"#{self.class} \" \\\n                   \"@all_permitted_hosts=#{@all_permitted_hosts.inspect} \" \\\n                   \"@permitted_hosts=#{@permitted_hosts.inspect} \" \\\n                   \"@domain_hosts=#{@domain_hosts.inspect} \" \\\n                   \"@ip_hosts=#{@ip_hosts.inspect} \" \\\n                   \"origin_host=#{origin_host.inspect} \" \\\n                   \"forwarded_host=#{forwarded_host.inspect}\"\n\n        if host_permitted?(origin_host)\n          if forwarded_host.nil?\n            true\n          else\n            host_permitted?(forwarded_host)\n          end\n        else\n          false\n        end\n      end","complexity_score":30.0,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"origin_host\",{\"type\":\"send\",\"children\":[null,\"extract_host\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host_authority\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"forwarded_host\",{\"type\":\"send\",\"children\":[null,\"extract_host\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"forwarded_authority\"]}]}]},{\"type\":\"send\",\"children\":[null,\"debug\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@all_permitted_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@permitted_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@domain_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@ip_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"origin_host=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"origin_host\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"forwarded_host=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]},\"inspect\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"host_permitted?\",{\"type\":\"lvar\",\"children\":[\"origin_host\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]},\"nil?\"]},{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"host_permitted?\",{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]}]}]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":84,"raw_source":"def extract_host(authority)\n        authority.to_s.split(PORT_REGEXP).first&.downcase\n      end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"extract_host\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"authority\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"authority\"]},\"to_s\"]},\"split\",{\"type\":\"const\",\"children\":[null,\"PORT_REGEXP\"]}]},\"first\"]},\"downcase\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":88,"raw_source":"def host_permitted?(host)\n        exact_match?(host) || domain_match?(host) || ip_match?(host)\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"host_permitted?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"exact_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]},{\"type\":\"send\",\"children\":[null,\"domain_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},{\"type\":\"send\",\"children\":[null,\"ip_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":92,"raw_source":"def exact_match?(host)\n        @permitted_hosts.include?(host)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"exact_match?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":96,"raw_source":"def domain_match?(host)\n        return false if host.nil?\n        return false if host.start_with?(DOT)\n\n        @domain_hosts.any? { |domain_host| host.match?(domain_host) }\n      end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"domain_match?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"domain_host\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"domain_host\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":103,"raw_source":"def ip_match?(host)\n        @ip_hosts.any? { |ip_host| ip_host.include?(host) }\n      rescue IPAddr::InvalidAddressError\n        false\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"ip_match?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ip_host\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ip_host\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IPAddr\"]},\"InvalidAddressError\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/http_origin.rb","start_line":26,"raw_source":"def base_url(env)\n        request = Rack::Request.new(env)\n        port = \":#{request.port}\" unless request.port == DEFAULT_PORTS[request.scheme]\n        \"#{request.scheme}://#{request.host}#{port}\"\n      end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"base_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"port\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DEFAULT_PORTS\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"scheme\"]}]}]},null,{\"type\":\"lvasgn\",\"children\":[\"port\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"port\"]}]}]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"scheme\"]}]},{\"type\":\"str\",\"children\":[\"://\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"port\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/http_origin.rb","start_line":32,"raw_source":"def accepts?(env)\n        return true if safe? env\n        return true unless (origin = env['HTTP_ORIGIN'])\n        return true if base_url(env) == origin\n        return true if options[:allow_if]&.call(env)\n\n        permitted_origins = options[:permitted_origins]\n        Array(permitted_origins).include? origin\n      end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"origin\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ORIGIN\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_url\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"origin\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"permitted_origins\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"permitted_origins\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"permitted_origins\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"origin\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/ip_spoofing.rb","start_line":16,"raw_source":"def accepts?(env)\n        return true unless env.include? 'HTTP_X_FORWARDED_FOR'\n\n        ips = env['HTTP_X_FORWARDED_FOR'].split(',').map(&:strip)\n        return false if env.include?('HTTP_CLIENT_IP') && (!ips.include? env['HTTP_CLIENT_IP'])\n        return false if env.include?('HTTP_X_REAL_IP') && (!ips.include? env['HTTP_X_REAL_IP'])\n\n        true\n      end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_X_FORWARDED_FOR\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"ips\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_FORWARDED_FOR\"]}]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_CLIENT_IP\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ips\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_CLIENT_IP\"]}]}]},\"!\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_X_REAL_IP\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ips\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_REAL_IP\"]}]}]},\"!\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":26,"raw_source":"def call(env)\n        request               = Request.new(env)\n        status, headers, body = app.call(env)\n\n        if has_vector?(request, headers)\n          warn env, \"attack prevented by #{self.class}\"\n\n          react_and_close(env, body) or [status, headers, body]\n        else\n          [status, headers, body]\n        end\n      end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"has_vector?\",{\"type\":\"lvar\",\"children\":[\"request\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"react_and_close\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":39,"raw_source":"def has_vector?(request, headers)\n        return false if request.xhr?\n        return false if options[:allow_if]&.call(request.env)\n        return false unless headers['content-type'].to_s.split(';', 2).first =~ %r{^\\s*application/json\\s*$}\n\n        origin(request.env).nil? and referrer(request.env) != request.host\n      end","complexity_score":24.65,"ast_json":"{\"type\":\"def\",\"children\":[\"has_vector?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"request\"]},{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"xhr?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"to_s\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\\\\s*application/json\\\\s*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"origin\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":47,"raw_source":"def react_and_close(env, body)\n        reaction = react(env)\n\n        close_body(body) if reaction\n\n        reaction\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"react_and_close\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"reaction\",{\"type\":\"send\",\"children\":[null,\"react\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reaction\"]},{\"type\":\"send\",\"children\":[null,\"close_body\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"reaction\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":55,"raw_source":"def close_body(body)\n        body.close if body.respond_to?(:close)\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"close_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"close\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/path_traversal.rb","start_line":15,"raw_source":"def call(env)\n        path_was         = env['PATH_INFO']\n        env['PATH_INFO'] = cleanup path_was if path_was && !path_was.empty?\n        app.call env\n      ensure\n        env['PATH_INFO'] = path_was\n      end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path_was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path_was\"]},\"empty?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[null,\"cleanup\",{\"type\":\"lvar\",\"children\":[\"path_was\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"lvar\",\"children\":[\"path_was\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/path_traversal.rb","start_line":23,"raw_source":"def cleanup(path)\n        encoding = path.encoding\n        dot   = '.'.encode(encoding)\n        slash = '/'.encode(encoding)\n        backslash = '\\\\'.encode(encoding)\n\n        parts     = []\n        unescaped = path.gsub(/%2e/i, dot).gsub(/%2f/i, slash).gsub(/%5c/i, backslash)\n        unescaped = unescaped.gsub(backslash, slash)\n\n        unescaped.split(slash).each do |part|\n          next if part.empty? || (part == dot)\n\n          part == '..' ? parts.pop : parts << part\n        end\n\n        cleaned = slash + parts.join(slash)\n        cleaned << slash if parts.any? && unescaped =~ (%r{/\\.{0,2}$})\n        cleaned\n      end","complexity_score":36.2,"ast_json":"{\"type\":\"def\",\"children\":[\"cleanup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"encoding\"]}]},{\"type\":\"lvasgn\",\"children\":[\"dot\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\".\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"slash\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"/\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"backslash\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"unescaped\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%2e\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"dot\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%2f\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"slash\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%5c\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"backslash\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"unescaped\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"backslash\"]},{\"type\":\"lvar\",\"children\":[\"slash\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"split\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"part\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"empty?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"dot\"]}]}]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"==\",{\"type\":\"str\",\"children\":[\"..\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"pop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"part\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cleaned\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"slash\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"=~\",{\"type\":\"begin\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"/\\\\.{0,2}$\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cleaned\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"cleaned\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/referrer_policy.rb","start_line":20,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['referrer-policy'] ||= options[:referrer_policy]\n        [status, headers, body]\n      end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"referrer-policy\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"referrer_policy\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/remote_referrer.rb","start_line":17,"raw_source":"def accepts?(env)\n        safe?(env) or referrer(env) == Request.new(env).host\n      end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/remote_token.rb","start_line":19,"raw_source":"def accepts?(env)\n        super or referrer(env) == Request.new(env).host\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/session_hijacking.rb","start_line":21,"raw_source":"def accepts?(env)\n        session = session env\n        key     = options[:tracking_key]\n        if session.include? key\n          session[key].all? { |k, v| v == encode(env[k]) }\n        else\n          session[key] = {}\n          options[:track].each { |k| session[key][k] = encode(env[k]) }\n        end\n      end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tracking_key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"encode\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"track\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"encode\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/session_hijacking.rb","start_line":32,"raw_source":"def encode(value)\n        value.to_s.downcase\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]},\"downcase\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/strict_transport.rb","start_line":25,"raw_source":"def strict_transport\n        @strict_transport ||= begin\n          strict_transport = \"max-age=#{options[:max_age]}\"\n          strict_transport += '; includeSubDomains' if options[:include_subdomains]\n          strict_transport += '; preload' if options[:preload]\n          strict_transport.to_str\n        end\n      end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_transport\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@strict_transport\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"max-age=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"max_age\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"include_subdomains\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\"]},\"+\",{\"type\":\"str\",\"children\":[\"; includeSubDomains\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"preload\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\"]},\"+\",{\"type\":\"str\",\"children\":[\"; preload\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strict_transport\"]},\"to_str\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/strict_transport.rb","start_line":34,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['strict-transport-security'] ||= strict_transport\n        [status, headers, body]\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"strict-transport-security\"]}]},{\"type\":\"send\",\"children\":[null,\"strict_transport\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/xss_header.rb","start_line":19,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['x-xss-protection']       ||= \"1; mode=#{options[:xss_mode]}\" if html? headers\n        headers['x-content-type-options'] ||= 'nosniff'                       if options[:nosniff]\n        [status, headers, body]\n      end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-xss-protection\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"1; mode=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"xss_mode\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nosniff\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-content-type-options\"]}]},{\"type\":\"str\",\"children\":[\"nosniff\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/host_authorization_spec.rb","start_line":8,"raw_source":"def assert_response(outcome:, headers:, last_response:)\n    fail_message = \"Expected outcome '#{outcome}' for headers '#{headers}' \" \\\n                   \"last_response.status '#{last_response.status}'\"\n\n    case outcome\n    when :allowed\n      expect(last_response).to be_ok, fail_message\n    when :stopped\n      expect(last_response.status).to eq(403), fail_message\n      expect(last_response.body).to eq('Host not permitted'), fail_message\n    end\n  end","complexity_score":20.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_response\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"outcome\"]},{\"type\":\"kwarg\",\"children\":[\"headers\"]},{\"type\":\"kwarg\",\"children\":[\"last_response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"fail_message\",{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Expected outcome '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outcome\"]}]},{\"type\":\"str\",\"children\":[\"' for headers '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"str\",\"children\":[\"' \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"last_response.status '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"status\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outcome\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"allowed\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"lvar\",\"children\":[\"last_response\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"be_ok\"]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"stopped\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"status\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"int\",\"children\":[403]}]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"body\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"str\",\"children\":[\"Host not permitted\"]}]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":8,"raw_source":"def close\n        @closed = true\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"close\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@closed\",{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":12,"raw_source":"def closed?\n        @closed\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"closed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@closed\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":17,"raw_source":"def self.body\n      @body ||= begin\n        body = ['ok']\n        body.extend(Closeable)\n        body\n      end\n    end","complexity_score":4.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"Closeable\"]}]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":25,"raw_source":"def self.call(env)\n      Thread.current[:last_env] = env\n      [200, { 'content-type' => 'application/json' }, body]\n    end","complexity_score":3.25,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"last_env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"application/json\"]}]}]},{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/dummy_app.rb","start_line":4,"raw_source":"def self.call(env)\n    Thread.current[:last_env] = env\n    body = (env['REQUEST_METHOD'] == 'HEAD' ? '' : 'ok')\n    [200, { 'content-type' => env['wants'] || 'text/plain' }, [body]]\n  end","complexity_score":8.55,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"last_env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"HEAD\"]}]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"wants\"]}]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/not_implemented_as_pending.rb","start_line":5,"raw_source":"def self.included(base)\n    base.class_eval do\n      alias_method :__finish__, :finish\n      remove_method :finish\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"__finish__\"]},{\"type\":\"sym\",\"children\":[\"finish\"]}]},{\"type\":\"send\",\"children\":[null,\"remove_method\",{\"type\":\"sym\",\"children\":[\"finish\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/not_implemented_as_pending.rb","start_line":12,"raw_source":"def finish(reporter)\n    if @exception.is_a?(NotImplementedError)\n      from = @exception.backtrace[0]\n      message = \"#{@exception.message} (from #{from})\"\n      @pending_declared_in_example = message\n      metadata[:pending] = true\n      @exception = nil\n    end\n\n    __finish__(reporter)\n  end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"reporter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"backtrace\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"message\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"message\"]}]},{\"type\":\"str\",\"children\":[\" (from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@pending_declared_in_example\",{\"type\":\"lvar\",\"children\":[\"message\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"metadata\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"pending\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@exception\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"__finish__\",{\"type\":\"lvar\",\"children\":[\"reporter\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":16,"raw_source":"def call(env)\n        was = env.dup\n        res = app.call(env)\n        was.each do |k, v|\n          next if env[k] == v\n\n          raise \"env[#{k.inspect}] changed from #{v.inspect} to #{env[k].inspect}\"\n        end\n        res\n      end","complexity_score":18.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"was\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"env[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"] changed from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"inspect\"]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":42,"raw_source":"def call(env)\n        env['foo.bar'] = 42\n        app.call(env)\n      end","complexity_score":3.45,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"foo.bar\"]},{\"type\":\"int\",\"children\":[42]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":48,"raw_source":"def call(env)\n        app.call(env)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":11,"raw_source":"def app\n    @app ||= nil\n    @app || mock_app(DummyApp)\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},{\"type\":\"send\",\"children\":[null,\"mock_app\",{\"type\":\"const\",\"children\":[null,\"DummyApp\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":16,"raw_source":"def mock_app(app = nil, lint: true, &block)\n    app = block if app.nil? && (block.arity == 1)\n    if app\n      klass = described_class\n      mock_app do\n        use Rack::Head\n        use(Rack::Config) { |e| e['rack.session'] ||= {} }\n        use klass\n        run app\n      end\n    elsif lint\n      @app = Rack::Lint.new Rack::Builder.new(&block).to_app\n    else\n      @app = Rack::Builder.new(&block).to_app\n    end\n  end","complexity_score":34.43,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"app\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"lint\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"app\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"send\",\"children\":[null,\"described_class\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Head\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Config\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.session\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lint\"]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Lint\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"to_app\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"to_app\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":33,"raw_source":"def with_headers(headers)\n    proc { [200, { 'content-type' => 'text/plain' }.merge(headers), ['ok']] }\n  end","complexity_score":3.38,"ast_json":"{\"type\":\"def\",\"children\":[\"with_headers\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":37,"raw_source":"def env\n    Thread.current[:last_env]\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"env\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_env\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/capture.rb","start_line":87,"raw_source":"def capture(*args, &block)\n      return block[*args] if ruby?\n\n      if haml? && Tilt[:haml] == Tilt::HamlTemplate && defined?(Haml::Buffer)\n        buffer = Haml::Buffer.new(nil, Haml::Options.new.for_buffer)\n        with_haml_buffer(buffer) { capture_haml(*args, &block) }\n      else\n        buf_was = @_out_buf\n        @_out_buf = +''\n        begin\n          raw = block[*args]\n          captured = block.binding.eval('@_out_buf')\n          captured.empty? ? raw : captured\n        ensure\n          @_out_buf = buf_was\n        end\n      end\n    end","complexity_score":39.8,"ast_json":"{\"type\":\"def\",\"children\":[\"capture\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ruby?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"haml?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"haml\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"HamlTemplate\"]}]}]},{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Buffer\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"buffer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Buffer\"]},\"new\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Options\"]},\"new\"]},\"for_buffer\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_haml_buffer\",{\"type\":\"lvar\",\"children\":[\"buffer\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"capture_haml\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"buf_was\",{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@_out_buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"raw\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"captured\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"binding\"]},\"eval\",{\"type\":\"str\",\"children\":[\"@_out_buf\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captured\"]},\"empty?\"]},{\"type\":\"lvar\",\"children\":[\"raw\"]},{\"type\":\"lvar\",\"children\":[\"captured\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@_out_buf\",{\"type\":\"lvar\",\"children\":[\"buf_was\"]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/capture.rb","start_line":106,"raw_source":"def capture_later(&block)\n      engine = current_engine\n      proc { |*a| with_engine(engine) { @capture = capture(*a, &block) } }\n    end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"capture_later\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine\",{\"type\":\"send\",\"children\":[null,\"current_engine\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_engine\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@capture\",{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":111,"raw_source":"def self.registered(base)\n      base.set :environments, %w[test production development]\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"environments\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"production\"]},{\"type\":\"str\",\"children\":[\"development\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":118,"raw_source":"def config_file(*paths)\n      Dir.chdir(root || '.') do\n        paths.each do |pattern|\n          Dir.glob(pattern) do |file|\n            raise UnsupportedConfigType unless ['.yml', '.yaml', '.erb'].include?(File.extname(file))\n\n            logger.info \"loading config file '#{file}'\" if logging? && respond_to?(:logger)\n            document = ERB.new(File.read(file)).result\n            yaml = YAML.respond_to?(:unsafe_load) ? YAML.unsafe_load(document) : YAML.load(document)\n            config = config_for_env(yaml)\n            config.each_pair { |key, value| set(key, value) }\n          end\n        end\n      end\n    end","complexity_score":44.5,"ast_json":"{\"type\":\"def\",\"children\":[\"config_file\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"paths\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"chdir\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"str\",\"children\":[\".\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"glob\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\".yml\"]},{\"type\":\"str\",\"children\":[\".yaml\"]},{\"type\":\"str\",\"children\":[\".erb\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"UnsupportedConfigType\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging?\"]},{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logger\"]},\"info\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"loading config file '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"document\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ERB\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"yaml\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"unsafe_load\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"unsafe_load\",{\"type\":\"lvar\",\"children\":[\"document\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"document\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"config\",{\"type\":\"send\",\"children\":[null,\"config_for_env\",{\"type\":\"lvar\",\"children\":[\"yaml\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"config\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":135,"raw_source":"def message\n        'Invalid config file type, use .yml, .yaml or .erb'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"message\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Invalid config file type, use .yml, .yaml or .erb\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":145,"raw_source":"def config_for_env(hash)\n      return from_environment_key(hash) if environment_keys?(hash)\n\n      hash.each_with_object(IndifferentHash[]) do |(k, v), acc|\n        if environment_keys?(v)\n          acc.merge!(k => v[environment.to_s]) if v.key?(environment.to_s)\n        else\n          acc.merge!(k => v)\n        end\n      end\n    end","complexity_score":24.8,"ast_json":"{\"type\":\"def\",\"children\":[\"config_for_env\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment_keys?\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"from_environment_key\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each_with_object\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IndifferentHash\"]},\"[]\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"arg\",\"children\":[\"acc\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment_keys?\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"acc\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"acc\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":159,"raw_source":"def from_environment_key(hash)\n      hash[environment.to_s] || hash[environment.to_sym] || {}\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"from_environment_key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_sym\"]}]}]},{\"type\":\"hash\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":165,"raw_source":"def environment_keys?(hash)\n      hash.is_a?(Hash) && hash.any? { |k, _| environments.include?(k.to_s) }\n    end","complexity_score":8.3,"ast_json":"{\"type\":\"def\",\"children\":[\"environment_keys?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environments\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":132,"raw_source":"def content_for(key, value = nil, options = {}, &block)\n      block ||= proc { |*| value }\n      clear_content_for(key) if options[:flush]\n      content_blocks[key.to_sym] << capture_later(&block)\n    end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"content_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"flush\"]}]},{\"type\":\"send\",\"children\":[null,\"clear_content_for\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"capture_later\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":148,"raw_source":"def content_for?(key)\n      content_blocks[key.to_sym].any?\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"content_for?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"any?\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":155,"raw_source":"def clear_content_for(key)\n      content_blocks.delete(key.to_sym) if content_for?(key)\n    end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"clear_content_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_for?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":176,"raw_source":"def yield_content(key, *args, &block)\n      if block_given? && !content_for?(key)\n        haml? && Tilt[:haml] == Tilt::HamlTemplate && respond_to?(:capture_haml) ? capture_haml(*args, &block) : yield(*args)\n      else\n        content = content_blocks[key.to_sym].map { |b| capture(*args, &b) }\n        content.join.tap do |c|\n          if block_given? && (erb? || erubi?)\n            @_out_buf << c\n          end\n        end\n      end\n    end","complexity_score":42.6,"ast_json":"{\"type\":\"def\",\"children\":[\"yield_content\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_for?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"haml?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"haml\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"HamlTemplate\"]}]}]},{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"capture_haml\"]}]}]},{\"type\":\"send\",\"children\":[null,\"capture_haml\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]},\"join\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"erb?\"]},{\"type\":\"send\",\"children\":[null,\"erubi?\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":191,"raw_source":"def content_blocks\n      @content_blocks ||= Hash.new { |h, k| h[k] = [] }\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"content_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@content_blocks\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":9,"raw_source":"def extensions\n        @extensions ||= { helpers: [], register: [] }\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"extensions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@extensions\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"helpers\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"register\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":13,"raw_source":"def register(name, path)\n        autoload name, path, :register\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[null,\"autoload\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"register\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":17,"raw_source":"def helpers(name, path)\n        autoload name, path, :helpers\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[null,\"autoload\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"helpers\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":21,"raw_source":"def autoload(name, path, method = nil)\n        extensions[method] << name if method\n        Sinatra.autoload(name, path)\n      end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"autoload\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"method\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extensions\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"autoload\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":26,"raw_source":"def registered(base)\n        @extensions.each do |method, list|\n          list = list.map { |name| Sinatra.const_get name }\n          base.send(method, *list) unless base == ::Sinatra::Application\n        end\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"arg\",\"children\":[\"list\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"list\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"const_get\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Sinatra\"]},\"Application\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":43,"raw_source":"def self.registered(base)\n        base.register Common, Custom\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"register\",{\"type\":\"const\",\"children\":[null,\"Common\"]},{\"type\":\"const\",\"children\":[null,\"Custom\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":49,"raw_source":"def self.registered(base)\n      base.register Common, Custom\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"register\",{\"type\":\"const\",\"children\":[null,\"Common\"]},{\"type\":\"const\",\"children\":[null,\"Custom\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":62,"raw_source":"def initialize(app)\n        @response_array  = nil\n        @response_hash   = {}\n        @response        = app.response\n        @request         = app.request\n        @deleted         = []\n\n        @options = {\n          path: @request.script_name.to_s.empty? ? '/' : @request.script_name,\n          domain: @request.host == 'localhost' ? nil : @request.host,\n          secure: @request.secure?,\n          httponly: true\n        }\n\n        return unless app.settings.respond_to? :cookie_options\n\n        @options.merge! app.settings.cookie_options\n      end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@response_array\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@response_hash\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"response\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"request\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@deleted\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"path\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"script_name\"]},\"to_s\"]},\"empty?\"]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"script_name\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"domain\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"host\"]},\"==\",{\"type\":\"str\",\"children\":[\"localhost\"]}]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"host\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"secure\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"secure?\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"httponly\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"cookie_options\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"cookie_options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":81,"raw_source":"def ==(other)\n        other.respond_to? :to_hash and to_hash == other.to_hash\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"==\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"to_hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":85,"raw_source":"def [](key)\n        response_cookies[key.to_s] || request_cookies[key.to_s]\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":89,"raw_source":"def []=(key, value)\n        set(key, value: value)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":94,"raw_source":"def assoc(key)\n          to_hash.assoc(key.to_s)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"assoc\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":99,"raw_source":"def clear\n        each_key { |k| delete(k) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"clear\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":103,"raw_source":"def compare_by_identity?\n        false\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_by_identity?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":107,"raw_source":"def default\n        nil\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":113,"raw_source":"def delete(key)\n        result = self[key]\n        @response.delete_cookie(key.to_s, @options)\n        result\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"delete_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"ivar\",\"children\":[\"@options\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":119,"raw_source":"def delete_if\n        return enum_for(__method__) unless block_given?\n\n        each { |k, v| delete(k) if yield(k, v) }\n        self\n      end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"delete_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":126,"raw_source":"def each(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":132,"raw_source":"def each_key(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each_key(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_key\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each_key\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":140,"raw_source":"def each_value(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each_value(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_value\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each_value\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":146,"raw_source":"def empty?\n        to_hash.empty?\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"empty?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"empty?\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":150,"raw_source":"def fetch(key, &block)\n        response_cookies.fetch(key.to_s) do\n          request_cookies.fetch(key.to_s, &block)\n        end\n      end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"fetch\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"fetch\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":157,"raw_source":"def flatten\n          to_hash.flatten\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"flatten\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"flatten\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":162,"raw_source":"def has_key?(key)\n        response_cookies.key? key.to_s or request_cookies.key? key.to_s\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"has_key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":166,"raw_source":"def has_value?(value)\n        response_cookies.value? value or request_cookies.value? value\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"has_value?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"value?\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"value?\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":170,"raw_source":"def hash\n        to_hash.hash\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"hash\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":177,"raw_source":"def inspect\n        \"<##{self.class}: #{to_hash.inspect[1..-2]}>\"\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<#\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"inspect\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":182,"raw_source":"def invert\n          to_hash.invert\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"invert\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"invert\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":187,"raw_source":"def keep_if\n        return enum_for(__method__) unless block_given?\n\n        delete_if { |*a| !yield(*a) }\n      end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"keep_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]}]},\"!\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":193,"raw_source":"def key(value)\n        to_hash.key(value)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"key\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":199,"raw_source":"def keys\n        to_hash.keys\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"keys\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":203,"raw_source":"def length\n        to_hash.length\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"length\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"length\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":207,"raw_source":"def merge(other, &block)\n        to_hash.merge(other, &block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"other\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":211,"raw_source":"def merge!(other)\n        other.each_pair do |key, value|\n          self[key] = if block_given? && include?(key)\n                        yield(key.to_s, self[key], value)\n                      else\n                        value\n                      end\n        end\n      end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"merge!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":221,"raw_source":"def rassoc(value)\n        to_hash.rassoc(value)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"rassoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"rassoc\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":225,"raw_source":"def rehash\n        response_cookies.rehash\n        request_cookies.rehash\n        self\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"rehash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"rehash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"rehash\"]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":231,"raw_source":"def reject(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.reject(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"reject\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":239,"raw_source":"def replace(other)\n        select! { |k, _v| other.include?(k) or other.include?(k.to_s) }\n        merge! other\n      end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"select!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"merge!\",{\"type\":\"lvar\",\"children\":[\"other\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":244,"raw_source":"def select(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.select(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"select\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"select\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":252,"raw_source":"def set(key, options = {})\n        @response.set_cookie key.to_s, @options.merge(options)\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"set_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":256,"raw_source":"def shift\n        key, value = to_hash.shift\n        delete(key)\n        [key, value]\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"shift\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":265,"raw_source":"def sort(&block)\n          to_hash.sort(&block)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"sort\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"sort\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":272,"raw_source":"def to_hash\n        request_cookies.merge(response_cookies)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"to_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"merge\",{\"type\":\"send\",\"children\":[null,\"response_cookies\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":276,"raw_source":"def to_a\n        to_hash.to_a\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_a\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"to_a\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":280,"raw_source":"def to_s\n        to_hash.to_s\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"to_s\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":287,"raw_source":"def values\n        to_hash.values\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"values\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":291,"raw_source":"def values_at(*list)\n        list.map { |k| self[k] }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"values_at\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"list\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":297,"raw_source":"def warn(message)\n        super \"#{caller.first[/^[^:]:\\d+:/]} warning: #{message}\"\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\"]},\"first\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^:]:\\\\d+:\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\" warning: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":301,"raw_source":"def deleted\n        parse_response\n        @deleted\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"deleted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_response\"]},{\"type\":\"ivar\",\"children\":[\"@deleted\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":306,"raw_source":"def response_cookies\n        parse_response\n        @response_hash\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"response_cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_response\"]},{\"type\":\"ivar\",\"children\":[\"@response_hash\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":311,"raw_source":"def parse_response\n        cookies_from_response = Array(@response['Set-Cookie'])\n        return if @response_array == cookies_from_response\n\n        hash = {}\n\n        cookies_from_response.each do |line|\n          key, value = line.split(';', 2).first.to_s.split('=', 2)\n          next if key.nil?\n\n          key = Rack::Utils.unescape(key)\n          if line =~ /expires=Thu, 01[-\\s]Jan[-\\s]1970/\n            @deleted << key\n          else\n            @deleted.delete key\n            hash[key] = value\n          end\n        end\n\n        @response_hash.replace hash\n        @response_array = cookies_from_response\n      end","complexity_score":30.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_response\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cookies_from_response\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Set-Cookie\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response_array\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]},\"to_s\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"nil?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"unescape\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"expires=Thu, 01[-\\\\s]Jan[-\\\\s]1970\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@deleted\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@deleted\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response_hash\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@response_array\",{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":334,"raw_source":"def request_cookies\n        @request.cookies.reject { |key, _value| deleted.include? key }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"request_cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"cookies\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"_value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"deleted\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":339,"raw_source":"def cookies\n      @cookies ||= Jar.new(self)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@cookies\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Jar\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/custom_logger.rb","start_line":51,"raw_source":"def logger\n      if settings.respond_to?(:logger)\n        settings.logger\n      else\n        request.logger\n      end\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"logger\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"logger\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"logger\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":12,"raw_source":"def erb?\n      @current_engine == :erb\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"erb?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"erb\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":20,"raw_source":"def erubi?\n      @current_engine == :erubi or\n        (erb? && Tilt[:erb] == Tilt::ErubiTemplate)\n    end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"erubi?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"erubi\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"erb?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"erb\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"ErubiTemplate\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":26,"raw_source":"def haml?\n      @current_engine == :haml\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"haml?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"haml\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":31,"raw_source":"def sass?\n      @current_engine == :sass\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sass?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"sass\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":36,"raw_source":"def scss?\n      @current_engine == :scss\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"scss?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"scss\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":41,"raw_source":"def builder?\n      @current_engine == :builder\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"builder?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"builder\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":46,"raw_source":"def liquid?\n      @current_engine == :liquid\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":51,"raw_source":"def markdown?\n      @current_engine == :markdown\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markdown?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"markdown\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":56,"raw_source":"def rdoc?\n      @current_engine == :rdoc\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rdoc?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"rdoc\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":61,"raw_source":"def markaby?\n      @current_engine == :markaby\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markaby?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"markaby\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":66,"raw_source":"def nokogiri?\n      @current_engine == :nokogiri\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nokogiri?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"nokogiri\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":71,"raw_source":"def slim?\n      @current_engine == :slim\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"slim?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"slim\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":76,"raw_source":"def ruby?\n      @current_engine == :ruby\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"ruby?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"ruby\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":80,"raw_source":"def initialize(*)\n      @current_engine = :ruby\n      super\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_engine\",{\"type\":\"sym\",\"children\":[\"ruby\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":86,"raw_source":"def with_engine(engine)\n      engine_was = @current_engine\n      @current_engine = engine.to_sym\n      yield\n    ensure\n      @current_engine = engine_was\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_engine\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine_was\",{\"type\":\"ivar\",\"children\":[\"@current_engine\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_engine\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_sym\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_engine\",{\"type\":\"lvar\",\"children\":[\"engine_was\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":96,"raw_source":"def render(engine, *)\n      with_engine(engine) { super }\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_engine\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":51,"raw_source":"def self.new(&block)\n      ext = Module.new.extend(self)\n      ext.class_eval(&block)\n      ext\n    end","complexity_score":10.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ext\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},\"extend\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":57,"raw_source":"def settings\n      self\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":61,"raw_source":"def configure(*args, &block)\n      record(:configure, *args) { |c| c.instance_exec(c, &block) }\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"configure\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"sym\",\"children\":[\"configure\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"instance_exec\",{\"type\":\"lvar\",\"children\":[\"c\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":65,"raw_source":"def registered(base = nil, &block)\n      base ? replay(base) : record(:class_eval, &block)\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},{\"type\":\"send\",\"children\":[null,\"replay\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"sym\",\"children\":[\"class_eval\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":71,"raw_source":"def record(method, *args, &block)\n      recorded_methods << [method, args, block]\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"record\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"recorded_methods\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":75,"raw_source":"def replay(object)\n      recorded_methods.each { |m, a, b| object.send(m, *a, &b) }\n    end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"replay\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"recorded_methods\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]},{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"m\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":79,"raw_source":"def recorded_methods\n      @recorded_methods ||= []\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"recorded_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@recorded_methods\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":83,"raw_source":"def method_missing(method, *args, &block)\n      return super unless Sinatra::Base.respond_to? method\n\n      record(method, *args, &block)\n      DontCall.new(method)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DontCall\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":91,"raw_source":"def initialize(method) @method = method end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@method\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":92,"raw_source":"def method_missing(*) raise \"not supposed to use result of #{@method}!\" end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"not supposed to use result of \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@method\"]}]},{\"type\":\"str\",\"children\":[\"!\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":93,"raw_source":"def inspect; \"#<#{self.class}: #{@method}>\" end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@method\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":32,"raw_source":"def surround(front, back = front, &block)\n      \"#{front}#{_capture_haml(&block).chomp}#{back}\\n\"\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"surround\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"front\"]},{\"type\":\"optarg\",\"children\":[\"back\",{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"back\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":36,"raw_source":"def precede(str, &block)\n      \"#{str}#{_capture_haml(&block).chomp}\\n\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"precede\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":40,"raw_source":"def succeed(str, &block)\n      \"#{_capture_haml(&block).chomp}#{str}\\n\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"succeed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":44,"raw_source":"def _capture_haml(*args, &block)\n      capture(*args, &block)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"_capture_haml\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":92,"raw_source":"def encode(object)\n        ::MultiJson.dump(object)\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"MultiJson\"]},\"dump\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":97,"raw_source":"def json(object, options = {})\n      content_type resolve_content_type(options)\n      resolve_encoder_action object, resolve_encoder(options)\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"json\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"send\",\"children\":[null,\"resolve_content_type\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"send\",\"children\":[null,\"resolve_encoder_action\",{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"send\",\"children\":[null,\"resolve_encoder\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":104,"raw_source":"def resolve_content_type(options = {})\n      options[:content_type] || settings.json_content_type\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_content_type\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"json_content_type\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":108,"raw_source":"def resolve_encoder(options = {})\n      options[:json_encoder] || settings.json_encoder\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_encoder\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"json_encoder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"json_encoder\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":112,"raw_source":"def resolve_encoder_action(object, encoder)\n      %i[encode generate].each do |method|\n        return encoder.send(method, object) if encoder.respond_to? method\n      end\n      raise \"#{encoder} does not respond to #generate nor #encode\" unless encoder.is_a? Symbol\n\n      object.__send__(encoder)\n    end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_encoder_action\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]},{\"type\":\"arg\",\"children\":[\"encoder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"encode\"]},{\"type\":\"sym\",\"children\":[\"generate\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Symbol\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]}]},{\"type\":\"str\",\"children\":[\" does not respond to #generate nor #encode\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"__send__\",{\"type\":\"lvar\",\"children\":[\"encoder\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":58,"raw_source":"def prefetch(*urls)\n      link(:prefetch, *urls)\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prefetch\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"urls\"]}]},{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"sym\",\"children\":[\"prefetch\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":64,"raw_source":"def stylesheet(*urls)\n      urls << {} unless urls.last.respond_to? :to_hash\n      urls.last[:type] ||= mime_type(:css)\n      link(:stylesheet, *urls)\n    end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"stylesheet\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"urls\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"<<\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"sym\",\"children\":[\"css\"]}]}]},{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"sym\",\"children\":[\"stylesheet\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":83,"raw_source":"def link(*urls)\n      opts          = urls.last.respond_to?(:to_hash) ? urls.pop : {}\n      opts[:rel]    = urls.shift unless urls.first.respond_to? :to_str\n      options       = opts.map { |k, v| \" #{k}=#{v.to_s.inspect}\" }\n      html_pattern  = \"<link href=\\\"%s\\\"#{options.join} />\"\n      http_pattern  = ['<%s>', *options].join ';'\n      link          = (response['Link'] ||= '')\n\n      link = response['Link'] = +link\n\n      urls.map do |url|\n        link << \",\" unless link.empty?\n        link << (http_pattern % url)\n        html_pattern % url\n      end.join\n    end","complexity_score":38.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"urls\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"first\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"rel\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"shift\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"to_s\"]},\"inspect\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"html_pattern\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<link href=\\\"%s\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"join\"]}]},{\"type\":\"str\",\"children\":[\" />\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"http_pattern\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<%s>\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\";\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"link\",{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Link\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"link\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Link\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"+@\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"<<\",{\"type\":\"str\",\"children\":[\",\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"<<\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html_pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]},\"join\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":118,"raw_source":"def link_headers\n      yield if block_given?\n      return '' unless response.include? 'Link'\n\n      response['Link'].split(\",\").map do |line|\n        url, *opts = line.split(';').map(&:strip)\n        \"<link href=\\\"#{url[1..-2]}\\\" #{opts.join ' '} />\"\n      end.join\n    end","complexity_score":26.1,"ast_json":"{\"type\":\"def\",\"children\":[\"link_headers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"include?\",{\"type\":\"str\",\"children\":[\"Link\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Link\"]}]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"url\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<link href=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"str\",\"children\":[\"\\\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"str\",\"children\":[\" />\"]}]}]}]},\"join\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":128,"raw_source":"def self.registered(_base)\n      puts \"WARNING: #{self} is a helpers module, not an extension.\"\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_base\"]}]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"WARNING: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"self\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\" is a helpers module, not an extension.\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":61,"raw_source":"def head(*args, &block)     super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"head\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":62,"raw_source":"def delete(*args, &block)   super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":63,"raw_source":"def get(*args, &block)      super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":64,"raw_source":"def options(*args, &block)  super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":65,"raw_source":"def patch(*args, &block)    super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":66,"raw_source":"def post(*args, &block)     super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"post\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":67,"raw_source":"def put(*args, &block)      super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"put\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":69,"raw_source":"def route(*args, &block)\n      options = Hash === args.last ? args.pop : {}\n      routes = [*args.pop]\n      args.each do |verb|\n        verb = verb.to_s.upcase if Symbol === verb\n        routes.each do |route|\n          super(verb, route, options, &block)\n        end\n      end\n    end","complexity_score":20.8,"ast_json":"{\"type\":\"def\",\"children\":[\"route\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"routes\",{\"type\":\"array\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"lvasgn\",\"children\":[\"verb\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},\"to_s\"]},\"upcase\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"routes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"route\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"route\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":82,"raw_source":"def route_args(args)\n      options = Hash === args.last ? args.pop : {}\n      [args, options]\n    end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"route_args\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":189,"raw_source":"def self.new(base, pattern, conditions = {}, &block)\n      Module.new do\n        # quelch uninitialized variable warnings, since these get used by compile method.\n        @pattern = nil\n        @conditions = nil\n        extend NamespacedMethods\n        include InstanceMethods\n        @base = base\n        @extensions = []\n        @errors = {}\n        @pattern, @conditions = compile(pattern, conditions)\n        @templates            = Hash.new { |_h, k| @base.templates[k] }\n        namespace = self\n        before { extend(@namespace = namespace) }\n        class_eval(&block)\n      end\n    end","complexity_score":40.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]},{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pattern\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"const\",\"children\":[null,\"NamespacedMethods\"]}]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"const\",\"children\":[null,\"InstanceMethods\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@base\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@extensions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pattern\"]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@templates\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@base\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"namespace\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"ivasgn\",\"children\":[\"@namespace\",{\"type\":\"lvar\",\"children\":[\"namespace\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":208,"raw_source":"def settings\n        @namespace\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@namespace\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":212,"raw_source":"def template_cache\n        super.fetch(:nested, @namespace) { TemplateCache.new }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"template_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"fetch\",{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"ivar\",\"children\":[\"@namespace\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateCache\"]},\"new\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":216,"raw_source":"def redirect_to(uri, *args)\n        redirect(\"#{@namespace.pattern}#{uri}\", *args)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect_to\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"redirect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@namespace\"]},\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":222,"raw_source":"def namespace(pattern, conditions = {}, &block)\n        Sinatra::Namespace.new(self, pattern, conditions, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"namespace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Namespace\"]},\"new\",{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":237,"raw_source":"def self.prefixed(*names)\n        names.each { |n| define_method(n) { |*a, &b| prefixed(n, *a, &b) } }\n      end","complexity_score":11.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"prefixed\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"names\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"n\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]},{\"type\":\"blockarg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"prefixed\",{\"type\":\"lvar\",\"children\":[\"n\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":243,"raw_source":"def helpers(*extensions, &block)\n        class_eval(&block) if block_given?\n        include(*extensions) if extensions.any?\n      end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":248,"raw_source":"def register(*extensions, &block)\n        extensions << Module.new(&block) if block_given?\n        @extensions += extensions\n        extensions.each do |extension|\n          extend extension\n          extension.registered(self) if extension.respond_to?(:registered)\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"extension\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"lvar\",\"children\":[\"extension\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"registered\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"registered\",{\"type\":\"self\",\"children\":[]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":257,"raw_source":"def invoke_hook(name, *args)\n        @extensions.each { |e| e.send(name, *args) if e.respond_to?(name) }\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_hook\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":261,"raw_source":"def not_found(&block)\n        error(Sinatra::NotFound, &block)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":265,"raw_source":"def errors\n        base.errors.merge(namespace_errors)\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"errors\"]},\"merge\",{\"type\":\"send\",\"children\":[null,\"namespace_errors\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":269,"raw_source":"def namespace_errors\n        @errors\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"namespace_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@errors\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":273,"raw_source":"def error(*codes, &block)\n        args  = Sinatra::Base.send(:compile!, 'ERROR', /.*/, block)\n        codes = codes.map { |c| Array(c) }.flatten\n        codes << Exception if codes.empty?\n        codes << Sinatra::NotFound if codes.include?(404)\n\n        codes.each do |c|\n          errors = @errors[c] ||= []\n          errors << args\n        end\n      end","complexity_score":20.6,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"send\",{\"type\":\"sym\",\"children\":[\"compile!\"]},{\"type\":\"str\",\"children\":[\"ERROR\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"codes\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},\"flatten\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"include?\",{\"type\":\"int\",\"children\":[404]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"errors\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"errors\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":285,"raw_source":"def respond_to(*args)\n        return @conditions[:provides] || base.respond_to if args.empty?\n\n        @conditions[:provides] = args\n      end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"provides\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"provides\"]},{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":291,"raw_source":"def set(key, value = self, &block)\n        return key.each { |k, v| set(k, v) } if key.respond_to?(:each) && block.nil? && (value == self)\n        raise ArgumentError, \"may not set #{key}\" unless ([:views] + ALLOWED_ENGINES).include?(key)\n\n        block ||= proc { value }\n        singleton_class.send(:define_method, key, &block)\n      end","complexity_score":23.7,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"nil?\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"==\",{\"type\":\"self\",\"children\":[]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"views\"]}]},\"+\",{\"type\":\"const\",\"children\":[null,\"ALLOWED_ENGINES\"]}]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"may not set \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"define_method\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":299,"raw_source":"def enable(*opts)\n        opts.each { |key| set(key, true) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":303,"raw_source":"def disable(*opts)\n        opts.each { |key| set(key, false) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"disable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":307,"raw_source":"def template(name, &block)\n        first_location = caller_locations.first\n        filename = first_location.path\n        line = first_location.lineno\n        templates[name] = [block, filename, line]\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"path\"]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"lineno\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"lvar\",\"children\":[\"line\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":314,"raw_source":"def layout(name = :layout, &block)\n        template name, &block\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"layout\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":318,"raw_source":"def pattern\n        @pattern\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"pattern\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@pattern\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":324,"raw_source":"def app\n        base.respond_to?(:base) ? base.base : base\n      end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"base\"]},{\"type\":\"send\",\"children\":[null,\"base\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":328,"raw_source":"def compile(pattern, conditions, default_pattern = nil)\n        if pattern.respond_to? :to_hash\n          conditions = conditions.merge pattern.to_hash\n          pattern = nil\n        end\n        base_pattern = @pattern\n        base_conditions = @conditions\n        pattern ||= default_pattern\n        [prefixed_path(base_pattern, pattern),\n         (base_conditions || {}).merge(conditions)]\n      end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"conditions\"]},{\"type\":\"optarg\",\"children\":[\"default_pattern\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"conditions\"]},\"merge\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"to_hash\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"base_pattern\",{\"type\":\"ivar\",\"children\":[\"@pattern\"]}]},{\"type\":\"lvasgn\",\"children\":[\"base_conditions\",{\"type\":\"ivar\",\"children\":[\"@conditions\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"default_pattern\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prefixed_path\",{\"type\":\"lvar\",\"children\":[\"base_pattern\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_conditions\"]},{\"type\":\"hash\",\"children\":[]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":340,"raw_source":"def prefixed_path(a, b)\n        return a || b || /.*/ unless a && b\n        return Mustermann.new(b) if a == /.*/\n\n        Mustermann.new(a) + Mustermann.new(b)\n      end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"prefixed_path\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"==\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":347,"raw_source":"def prefixed(method, pattern = nil, conditions = {}, &block)\n        default = %r{(?:/.*)?} if (method == :before) || (method == :after)\n        pattern, conditions = compile pattern, conditions, default\n        result = base.send(method, pattern, **conditions, &block)\n        invoke_hook :route_added, method.to_s.upcase, pattern, block\n        result\n      end","complexity_score":21.3,"ast_json":"{\"type\":\"def\",\"children\":[\"prefixed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"optarg\",\"children\":[\"pattern\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"==\",{\"type\":\"sym\",\"children\":[\"before\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"==\",{\"type\":\"sym\",\"children\":[\"after\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(?:/.*)?\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\"]},{\"type\":\"lvasgn\",\"children\":[\"conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"invoke_hook\",{\"type\":\"sym\",\"children\":[\"route_added\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":355,"raw_source":"def method_missing(method, *args, &block)\n        base.send(method, *args, &block)\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":359,"raw_source":"def respond_to?(method, include_private = false)\n        super || base.respond_to?(method, include_private)\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"optarg\",\"children\":[\"include_private\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"include_private\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":368,"raw_source":"def self.extended(base)\n      base.extend BaseMethods\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extended\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"BaseMethods\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/quiet_logger.rb","start_line":37,"raw_source":"def self.registered(app)\n      quiet_logger_prefixes = begin\n        app.settings.quiet_logger_prefixes.join('|')\n      rescue StandardError\n        ''\n      end\n      return warn('You need to specify the paths you wish to exclude from logging via `set :quiet_logger_prefixes, %w(images css fonts)`') if quiet_logger_prefixes.empty?\n\n      const_set('QUIET_LOGGER_REGEX', %r(\\A/{0,2}(?:#{quiet_logger_prefixes})))\n      ::Rack::CommonLogger.prepend(\n        ::Module.new do\n          def log(env, *)\n            super unless env['PATH_INFO'] =~ QUIET_LOGGER_REGEX\n          end\n        end\n      )\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"quiet_logger_prefixes\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"quiet_logger_prefixes\"]},\"join\",{\"type\":\"str\",\"children\":[\"|\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"str\",\"children\":[\"\"]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"quiet_logger_prefixes\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"You need to specify the paths you wish to exclude from logging via `set :quiet_logger_prefixes, %w(images css fonts)`\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"const_set\",{\"type\":\"str\",\"children\":[\"QUIET_LOGGER_REGEX\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A/{0,2}(?:\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"quiet_logger_prefixes\"]}]},{\"type\":\"str\",\"children\":[\")\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"CommonLogger\"]},\"prepend\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"=~\",{\"type\":\"const\",\"children\":[null,\"QUIET_LOGGER_REGEX\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/quiet_logger.rb","start_line":48,"raw_source":"def log(env, *)\n            super unless env['PATH_INFO'] =~ QUIET_LOGGER_REGEX\n          end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"=~\",{\"type\":\"const\",\"children\":[null,\"QUIET_LOGGER_REGEX\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":128,"raw_source":"def self.for(app)\n          @app_list_map[app]\n        end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app_list_map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":133,"raw_source":"def initialize\n          @path_watcher_map = Hash.new do |hash, key|\n            hash[key] = Watcher.new(key)\n          end\n        end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@path_watcher_map\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]},{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":142,"raw_source":"def watch(path, element)\n          watcher_for(path).elements << element\n        end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"watch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watcher_for\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"elements\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"element\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":149,"raw_source":"def ignore(path)\n          watcher_for(path).ignore\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"ignore\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watcher_for\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"ignore\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":155,"raw_source":"def watcher_for(path)\n          @path_watcher_map[File.expand_path(path)]\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"watcher_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@path_watcher_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":161,"raw_source":"def watchers\n          @path_watcher_map.values\n        end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"watchers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@path_watcher_map\"]},\"values\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":167,"raw_source":"def updated\n          watchers.find_all(&:updated?)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"updated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watchers\"]},\"find_all\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"updated?\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":175,"raw_source":"def initialize(path)\n        @ignore = nil\n        @path = path\n        @elements = []\n        update\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@ignore\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@elements\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"update\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":183,"raw_source":"def updated?\n        !ignore? && !removed? && mtime != File.mtime(path)\n      end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"updated?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ignore?\"]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"removed?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mtime\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":188,"raw_source":"def update\n        @mtime = File.mtime(path)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"update\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@mtime\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":194,"raw_source":"def inline_templates?\n        elements.any? { |element| element.type == :inline_templates }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"elements\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"type\"]},\"==\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":200,"raw_source":"def ignore\n        @ignore = true\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"ignore\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@ignore\",{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":206,"raw_source":"def ignore?\n        !!@ignore\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"ignore?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ignore\"]},\"!\"]},\"!\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":211,"raw_source":"def removed?\n        !File.exist?(path)\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"removed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"send\",\"children\":[null,\"path\"]}]},\"!\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":220,"raw_source":"def after_reload(&block)\n      @@after_reload << block\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"after_reload\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@after_reload\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":227,"raw_source":"def self.registered(klass)\n      @reloader_loaded_in ||= {}\n      return if @reloader_loaded_in[klass]\n\n      @reloader_loaded_in[klass] = true\n\n      klass.extend BaseMethods\n      klass.extend ExtensionMethods\n      klass.set(:reloader) { klass.development? }\n      klass.set(:reload_templates) { klass.reloader? }\n      klass.before do\n        if klass.reloader?\n          MUTEX_FOR_PERFORM.synchronize { Reloader.perform(klass) }\n        end\n      end\n      klass.set(:inline_templates, klass.app_file) if klass == Sinatra::Application\n    end","complexity_score":26.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reloader_loaded_in\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reloader_loaded_in\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reloader_loaded_in\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"klass\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"BaseMethods\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ExtensionMethods\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"reloader\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"development?\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"reload_templates\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"reloader?\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"reloader?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MUTEX_FOR_PERFORM\"]},\"synchronize\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Reloader\"]},\"perform\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Application\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"app_file\"]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":247,"raw_source":"def self.perform(klass)\n      reloaded_paths = []\n      Watcher::List.for(klass).updated.each do |watcher|\n        klass.set(:inline_templates, watcher.path) if watcher.inline_templates?\n        watcher.elements.each { |element| klass.deactivate(element) }\n        # Deletes all old elements.\n        watcher.elements.delete_if { true }\n        $LOADED_FEATURES.delete(watcher.path)\n        require watcher.path\n        watcher.update\n        reloaded_paths << watcher.path\n      end\n      return if reloaded_paths.empty?\n\n      @@after_reload.each do |block|\n        block.arity.zero? ? block.call : block.call(reloaded_paths)\n      end\n      # Prevents after_reload from increasing each time it's reloaded.\n      @@after_reload.delete_if do |blk|\n        path, = blk.source_location\n        path && reloaded_paths.include?(path)\n      end\n    end","complexity_score":46.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"perform\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"reloaded_paths\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},\"updated\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"watcher\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"inline_templates?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"elements\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"deactivate\",{\"type\":\"lvar\",\"children\":[\"element\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"elements\"]},\"delete_if\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$LOADED_FEATURES\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"update\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@after_reload\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@after_reload\"]},\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"blk\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blk\"]},\"source_location\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":274,"raw_source":"def run!(*args)\n        if settings.reloader?\n          super unless running?\n        else\n          super\n        end\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"run!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"reloader?\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},null,{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":288,"raw_source":"def compile!(verb, path, block, **options)\n        source_location = block.respond_to?(:source_location) ?\n          block.source_location.first : caller_files[1]\n        signature = super\n        watch_element(\n          source_location, :route, { verb: verb, signature: signature }\n        )\n        signature\n      end","complexity_score":10.13,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source_location\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"source_location\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"source_location\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"source_location\"]},{\"type\":\"sym\",\"children\":[\"route\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"signature\"]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":302,"raw_source":"def inline_templates=(file = nil)\n        file = (caller_files[1] || File.expand_path($0)) if file.nil? || file == true\n        watch_element(file, :inline_templates)\n        super\n      end","complexity_score":12.55,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates=\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"file\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":311,"raw_source":"def use(middleware, *args, &block)\n        path = caller_files[1] || File.expand_path($0)\n        watch_element(path, :middleware, [middleware, args, block])\n        super\n      end","complexity_score":6.83,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"middleware\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":320,"raw_source":"def add_filter(type, path = nil, **options, &block)\n        source_location = block.respond_to?(:source_location) ?\n          block.source_location.first : caller_files[1]\n        result = super\n        watch_element(source_location, :\"#{type}_filter\", filters[type].last)\n        result\n      end","complexity_score":15.33,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source_location\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"source_location\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"source_location\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"source_location\"]},{\"type\":\"dsym\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\"_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"last\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":331,"raw_source":"def error(*codes, &block)\n        path = caller_files[1] || File.expand_path($0)\n        result = super\n        codes.each do |c|\n          watch_element(path, :error, code: c, handler: @errors[c])\n        end\n        result\n      end","complexity_score":11.23,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"error\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"handler\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":343,"raw_source":"def register(*extensions, &block)\n        start_registering_extension\n        result = super\n        stop_registering_extension\n        result\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"start_registering_extension\"]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"stop_registering_extension\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":352,"raw_source":"def inherited(subclass)\n        result = super\n        subclass.register Sinatra::Reloader\n        result\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Reloader\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":362,"raw_source":"def deactivate(element)\n        case element.type\n        when :route\n          verb      = element.representation[:verb]\n          signature = element.representation[:signature]\n          (routes[verb] ||= []).delete(signature)\n        when :middleware\n          @middleware.delete(element.representation)\n        when :before_filter\n          filters[:before].delete(element.representation)\n        when :after_filter\n          filters[:after].delete(element.representation)\n        when :error\n          code    = element.representation[:code]\n          handler = element.representation[:handler]\n          @errors.delete(code) if @errors[code] == handler\n        end\n      end","complexity_score":44.2,"ast_json":"{\"type\":\"def\",\"children\":[\"deactivate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"type\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"route\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"verb\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"verb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"signature\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"routes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"delete\",{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"middleware\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@middleware\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"before_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"before\"]}]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"after_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"after\"]}]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"error\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"code\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"handler\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"handler\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},null]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":383,"raw_source":"def also_reload(*glob)\n        Dir[*glob].each { |path| Watcher::List.for(self).watch_file(path) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"also_reload\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"glob\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"glob\"]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]},\"watch_file\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":389,"raw_source":"def dont_reload(*glob)\n        Dir[*glob].each { |path| Watcher::List.for(self).ignore(path) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"dont_reload\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"glob\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"glob\"]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]},\"ignore\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":396,"raw_source":"def register_path; @register_path ||= nil; end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register_path\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@register_path\"]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":399,"raw_source":"def start_registering_extension\n        @register_path = caller_files[2]\n      end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"start_registering_extension\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@register_path\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":404,"raw_source":"def stop_registering_extension\n        @register_path = nil\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"stop_registering_extension\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@register_path\",{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":409,"raw_source":"def registering_extension?\n        !register_path.nil?\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"registering_extension?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register_path\"]},\"nil?\"]},\"!\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":421,"raw_source":"def watch_element(path, type, representation = nil)\n        list = Watcher::List.for(self)\n        element = Watcher::Element.new(type, representation)\n        list.watch(path, element)\n        list.watch(register_path, element) if registering_extension?\n      end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"watch_element\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"representation\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"list\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"element\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"Element\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"representation\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"watch\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"element\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"registering_extension?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"watch\",{\"type\":\"send\",\"children\":[null,\"register_path\"]},{\"type\":\"lvar\",\"children\":[\"element\"]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/required_params.rb","start_line":49,"raw_source":"def required_params(*keys)\n      _required_params(params, *keys)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"required_params\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"send\",\"children\":[null,\"params\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/required_params.rb","start_line":55,"raw_source":"def _required_params(p, *keys)\n      keys.each do |key|\n        if key.is_a?(Hash)\n          _required_params(p, *key.keys)\n          key.each do |k, v|\n            _required_params(p[k.to_s], v)\n          end\n        elsif key.is_a?(Array)\n          _required_params(p, *key)\n        else\n          halt 400 unless p.respond_to?(:key?) && p&.key?(key.to_s)\n        end\n      end\n      true\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"_required_params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]},{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"keys\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[400]}]}]}]}]}]},{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":92,"raw_source":"def initialize(app)\n        @app = app\n        @map = {}\n        @generic = {}\n        @default = nil\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@map\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@generic\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":99,"raw_source":"def on(type, &block)\n        @app.settings.mime_types(type).each do |mime|\n          case mime\n          when '*/*'            then @default     = block\n          when %r{^([^/]+)/\\*$} then @generic[$1] = block\n          else                       @map[mime]   = block\n          end\n        end\n      end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"on\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"settings\"]},\"mime_types\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mime\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"*/*\"]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^([^/]+)/\\\\*$\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@generic\"]},\"[]=\",{\"type\":\"nth_ref\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"mime\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":109,"raw_source":"def finish\n        yield self if block_given?\n        mime_type = @app.content_type ||\n                    @app.request.preferred_type(@map.keys)  ||\n                    @app.request.preferred_type             ||\n                    'text/html'\n        type = mime_type.split(/\\s*;\\s*/, 2).first\n        handlers = [@map[type], @generic[type[%r{^[^/]+}]], @default].compact\n        handlers.each do |block|\n          if (result = block.call(type))\n            @app.content_type mime_type\n            @app.halt result\n          end\n        end\n        @app.halt 500, 'Unknown template engine'\n      end","complexity_score":33.85,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"content_type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"request\"]},\"preferred_type\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"keys\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"request\"]},\"preferred_type\"]}]},{\"type\":\"str\",\"children\":[\"text/html\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*;\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"handlers\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@generic\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^/]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@default\"]}]},\"compact\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handlers\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"content_type\",{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"halt\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"halt\",{\"type\":\"int\",\"children\":[500]},{\"type\":\"str\",\"children\":[\"Unknown template engine\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":126,"raw_source":"def method_missing(method, *args, &block)\n        return super if args.any? || block.nil? || !@app.mime_type(method)\n\n        on(method, &block)\n      end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"nil?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"on\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":136,"raw_source":"def respond_with(template, object = nil, &block)\n        unless Symbol === template\n          object = template\n          template = nil\n        end\n        format = Format.new(self)\n        format.on '*/*' do |type|\n          exts = settings.ext_map[type]\n          exts << :xml if type.end_with? '+xml'\n          if template\n            args = template_cache.fetch(type, template) { template_for(template, exts) }\n            if args.any?\n              locals = { object: object }\n              locals.merge! object.to_hash if object.respond_to? :to_hash\n\n              renderer = args.first\n              options = args[1..] + [{ locals: locals }]\n\n              halt send(renderer, *options)\n            end\n          end\n          if object\n            exts.each do |ext|\n              halt json(object) if ext == :json\n              next unless object.respond_to? method = \"to_#{ext}\"\n\n              halt(*object.send(method))\n            end\n          end\n          false\n        end\n        format.finish(&block)\n      end","complexity_score":77.6,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_with\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"object\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"format\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Format\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"on\",{\"type\":\"str\",\"children\":[\"*/*\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exts\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"ext_map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"+xml\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"<<\",{\"type\":\"sym\",\"children\":[\"xml\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"template_for\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"exts\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"any?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"object\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"locals\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"to_hash\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"renderer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},null]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locals\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"renderer\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"==\",{\"type\":\"sym\",\"children\":[\"json\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"send\",\"children\":[null,\"json\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"lvasgn\",\"children\":[\"method\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"to_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}]},null]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"finish\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":170,"raw_source":"def respond_to(&block)\n        Format.new(self).finish(&block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Format\"]},\"new\",{\"type\":\"self\",\"children\":[]}]},\"finish\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":176,"raw_source":"def template_for(name, exts)\n        # in production this is cached, so don't worry too much about runtime\n        possible = []\n        settings.template_engines[:all].each do |engine|\n          exts.each { |ext| possible << [engine, \"#{name}.#{ext}\"] }\n        end\n\n        exts.each do |ext|\n          settings.template_engines[ext].each { |e| possible << [e, name] }\n        end\n\n        possible.each do |engine, template|\n          klass = Tilt.default_mapping.template_map[engine.to_s] ||\n                  Tilt.lazy_map[engine.to_s].fetch(0, [])[0]\n\n          find_template(settings.views, template, klass) do |file|\n            next unless File.exist? file\n\n            return settings.rendering_method(engine) << template.to_sym\n          end\n        end\n        [] # nil or false would not be cached\n      end","complexity_score":53.8,"ast_json":"{\"type\":\"def\",\"children\":[\"template_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"exts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"possible\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"template_engines\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"all\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"template_engines\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"ext\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"default_mapping\"]},\"template_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"lazy_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},\"fetch\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"array\",\"children\":[]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"find_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"views\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"rendering_method\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"to_sym\"]}]}]}]}]}]}]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":201,"raw_source":"def remap_extensions\n      ext_map.clear\n      Rack::Mime::MIME_TYPES.each { |e, t| ext_map[t] << e[1..].to_sym }\n      ext_map['text/javascript'] << 'js'\n      ext_map['text/xml'] << 'xml'\n    end","complexity_score":18.53,"ast_json":"{\"type\":\"def\",\"children\":[\"remap_extensions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"clear\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"MIME_TYPES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]},{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},null]}]},\"to_sym\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"str\",\"children\":[\"text/javascript\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"js\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"str\",\"children\":[\"text/xml\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"xml\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":208,"raw_source":"def mime_type(*)\n      result = super\n      remap_extensions\n      result\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_type\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"remap_extensions\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":214,"raw_source":"def respond_to(*formats)\n      @respond_to ||= nil\n\n      if formats.any?\n        @respond_to ||= []\n        @respond_to.concat formats\n      elsif @respond_to.nil? && superclass.respond_to?(:respond_to)\n        superclass.respond_to\n      else\n        @respond_to\n      end\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"formats\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@respond_to\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"formats\"]},\"any?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@respond_to\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@respond_to\"]},\"concat\",{\"type\":\"lvar\",\"children\":[\"formats\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@respond_to\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"respond_to\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to\"]},{\"type\":\"ivar\",\"children\":[\"@respond_to\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":227,"raw_source":"def rendering_method(engine)\n      return [engine] if Sinatra::Templates.method_defined? engine\n      return [:mab] if engine.to_sym == :markaby\n\n      %i[render engine]\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"rendering_method\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Templates\"]},\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"markaby\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"mab\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"sym\",\"children\":[\"engine\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":236,"raw_source":"def compile!(verb, path, block, **options)\n      options[:provides] ||= respond_to if respond_to\n      super\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to\"]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"provides\"]}]},{\"type\":\"send\",\"children\":[null,\"respond_to\"]}]},null]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":241,"raw_source":"def self.jrubyify(engs)\n      not_supported = [:markdown]\n      engs.each_key do |key|\n        engs[key].collect! { |eng| eng == :yajl ? :json_pure : eng }\n        engs[key].delete_if { |eng| not_supported.include?(eng) }\n      end\n      engs\n    end","complexity_score":14.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"jrubyify\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"not_supported\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"markdown\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"collect!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"eng\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"eng\"]},\"==\",{\"type\":\"sym\",\"children\":[\"yajl\"]}]},{\"type\":\"sym\",\"children\":[\"json_pure\"]},{\"type\":\"lvar\",\"children\":[\"eng\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"eng\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_supported\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"eng\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"engs\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":250,"raw_source":"def self.engines\n      engines = {\n        css: %i[sass scss],\n        xml: %i[builder nokogiri],\n        html: %i[erb erubi haml hamlit slim liquid\n                 mab markdown rdoc],\n        all: (Sinatra::Templates.instance_methods.map(&:to_sym) +\n          [:mab] - %i[find_template markaby]),\n        json: [:yajl]\n      }\n      engines.default = []\n      defined?(JRUBY_VERSION) ? jrubyify(engines) : engines\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"engines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engines\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"css\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"sass\"]},{\"type\":\"sym\",\"children\":[\"scss\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"xml\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"builder\"]},{\"type\":\"sym\",\"children\":[\"nokogiri\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"html\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"erb\"]},{\"type\":\"sym\",\"children\":[\"erubi\"]},{\"type\":\"sym\",\"children\":[\"haml\"]},{\"type\":\"sym\",\"children\":[\"hamlit\"]},{\"type\":\"sym\",\"children\":[\"slim\"]},{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"sym\",\"children\":[\"mab\"]},{\"type\":\"sym\",\"children\":[\"markdown\"]},{\"type\":\"sym\",\"children\":[\"rdoc\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"all\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Templates\"]},\"instance_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_sym\"]}]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"mab\"]}]}]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"find_template\"]},{\"type\":\"sym\",\"children\":[\"markaby\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"json\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"yajl\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engines\"]},\"default=\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"JRUBY_VERSION\"]}]},{\"type\":\"send\",\"children\":[null,\"jrubyify\",{\"type\":\"lvar\",\"children\":[\"engines\"]}]},{\"type\":\"lvar\",\"children\":[\"engines\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":264,"raw_source":"def self.registered(base)\n      base.set :ext_map, Hash.new { |h, k| h[k] = [] }\n      base.set :template_engines, engines\n      base.remap_extensions\n      base.helpers Helpers\n    end","complexity_score":8.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"ext_map\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"template_engines\"]},{\"type\":\"send\",\"children\":[null,\"engines\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"remap_extensions\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"helpers\",{\"type\":\"const\",\"children\":[null,\"Helpers\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":53,"raw_source":"def app_file\n      File.expand_path('server.rb', __dir__)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"server.rb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":57,"raw_source":"def run\n      @pipe     = start\n      @started  = Time.now\n      warn \"#{server} up and running on port #{port}\" if ping\n    end","complexity_score":9.7,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pipe\",{\"type\":\"send\",\"children\":[null,\"start\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@started\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ping\"]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]}]},{\"type\":\"str\",\"children\":[\" up and running on port \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":63,"raw_source":"def kill\n      return unless pipe\n\n      Process.kill('KILL', pipe.pid)\n    rescue NotImplementedError\n      system \"kill -9 #{pipe.pid}\"\n    rescue Errno::ESRCH\n    end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"kill\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"kill\",{\"type\":\"str\",\"children\":[\"KILL\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"pid\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"system\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"kill -9 \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"pid\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ESRCH\"]}]},null,null]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":72,"raw_source":"def get(url)\n      Timeout.timeout(1) { get_url(\"#{protocol}://127.0.0.1:#{port}#{url}\") }\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"get_url\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protocol\"]}]},{\"type\":\"str\",\"children\":[\"://127.0.0.1:\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":76,"raw_source":"def get_stream(url = '/stream', &block)\n      Net::HTTP.start '127.0.0.1', port do |http|\n        request = Net::HTTP::Get.new url\n        http.request request do |response|\n          response.read_body(&block)\n        end\n      end\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"get_stream\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"url\",{\"type\":\"str\",\"children\":[\"/stream\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"start\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"read_body\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":85,"raw_source":"def get_response(url)\n      Net::HTTP.start '127.0.0.1', port do |http|\n        request = Net::HTTP::Get.new url\n        http.request request do |response|\n          response\n        end\n      end\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get_response\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"start\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"lvar\",\"children\":[\"response\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":94,"raw_source":"def log\n      @log ||= +''\n      loop { @log << pipe.read_nonblock(1) }\n    rescue Exception\n      @log\n    end","complexity_score":10.73,"ast_json":"{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@log\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@log\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"read_nonblock\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null,{\"type\":\"ivar\",\"children\":[\"@log\"]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":105,"raw_source":"def start\n      IO.popen(command)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"start\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IO\"]},\"popen\",{\"type\":\"send\",\"children\":[null,\"command\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":110,"raw_source":"def command\n      \"bundle exec ruby #{app_file} -p #{port} -e production\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"command\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"bundle exec ruby \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_file\"]}]},{\"type\":\"str\",\"children\":[\" -p \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\" -e production\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":114,"raw_source":"def ping(timeout = 30)\n      loop do\n        return if alive?\n\n        if Time.now - @started > timeout\n          warn command, log\n          raise \"timeout starting server with command '#{command}'\"\n        else\n          sleep 0.1\n        end\n      end\n    end","complexity_score":20.33,"ast_json":"{\"type\":\"def\",\"children\":[\"ping\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"timeout\",{\"type\":\"int\",\"children\":[30]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alive?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@started\"]}]},\">\",{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"send\",\"children\":[null,\"command\"]},{\"type\":\"send\",\"children\":[null,\"log\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"timeout starting server with command '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"command\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"sleep\",{\"type\":\"float\",\"children\":[0.1]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":127,"raw_source":"def alive?\n      3.times { get(ping_path) }\n      true\n    rescue EOFError, SystemCallError, OpenURI::HTTPError, Timeout::Error\n      false\n    end","complexity_score":6.55,"ast_json":"{\"type\":\"def\",\"children\":[\"alive?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[3]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"send\",\"children\":[null,\"ping_path\"]}]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]},{\"type\":\"const\",\"children\":[null,\"SystemCallError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenURI\"]},\"HTTPError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"Error\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":135,"raw_source":"def ping_path\n      '/ping'\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"ping_path\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"/ping\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":140,"raw_source":"def port\n      4567\n    end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"port\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[4567]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":144,"raw_source":"def protocol\n      'http'\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"protocol\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"http\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":148,"raw_source":"def get_url(url)\n      uri = URI.parse(url)\n\n      return uri.read unless protocol == 'https'\n\n      get_https_url(uri)\n    end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"get_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"uri\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protocol\"]},\"==\",{\"type\":\"str\",\"children\":[\"https\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"read\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get_https_url\",{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":156,"raw_source":"def get_https_url(uri)\n      http = Net::HTTP.new(uri.host, uri.port)\n      http.use_ssl      = true\n      http.verify_mode  = OpenSSL::SSL::VERIFY_NONE\n      request = Net::HTTP::Get.new(uri.request_uri)\n      http.request(request).body\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"get_https_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"http\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"host\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"port\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"use_ssl=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"verify_mode=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"SSL\"]},\"VERIFY_NONE\"]}]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"request_uri\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},\"body\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":79,"raw_source":"def stream(*)\n      stream = super\n      stream.extend Stream\n      stream.app = self\n      env['async.close'].callback { stream.close } if env.key? 'async.close'\n      stream\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"stream\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"app=\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"key?\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"close\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"stream\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":92,"raw_source":"def self.extended(obj)\n        obj.closed = false\n        obj.lineno = 0\n        obj.pos = 0\n        obj.callback { obj.closed = true }\n        obj.errback  { obj.closed = true }\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extended\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"lineno=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"pos=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"errback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"true\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":100,"raw_source":"def <<(data)\n        raise IOError, 'not opened for writing' if closed?\n\n        @transformer ||= nil\n        data = data.to_s\n        data = @transformer[data] if @transformer\n        @pos += data.bytesize\n        super(data)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"<<\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"IOError\"]},{\"type\":\"str\",\"children\":[\"not opened for writing\"]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@transformer\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"data\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},{\"type\":\"lvasgn\",\"children\":[\"data\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"data\"]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pos\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"bytesize\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":110,"raw_source":"def each\n        # that way body.each.map { ... } works\n        return self unless block_given?\n\n        super\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":117,"raw_source":"def map(&block)\n        # dup would not copy the mixin\n        clone.map!(&block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"map\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"clone\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":122,"raw_source":"def map!(&block)\n        @transformer ||= nil\n\n        if @transformer\n          inner = @transformer\n          outer = block\n          block = proc { |value| outer[inner[value]] }\n        end\n        @transformer = block\n        self\n      end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"map!\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@transformer\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"ivar\",\"children\":[\"@transformer\"]}]},{\"type\":\"lvasgn\",\"children\":[\"outer\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outer\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@transformer\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"self\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":134,"raw_source":"def write(data)\n        self << data\n        data.to_s.bytesize\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"write\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"lvar\",\"children\":[\"data\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]},\"bytesize\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":142,"raw_source":"def print(*args)\n        args.each { |arg| self << arg }\n        nil\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"print\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arg\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"lvar\",\"children\":[\"arg\"]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":147,"raw_source":"def printf(format, *args)\n        print(format.to_s % args)\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"printf\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"format\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"to_s\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":151,"raw_source":"def putc(c)\n        print c.chr\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"putc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"chr\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":155,"raw_source":"def puts(*args)\n        args.each { |arg| self << \"#{arg}\\n\" }\n        nil\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"puts\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arg\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arg\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":160,"raw_source":"def close_read\n        raise IOError, 'closing non-duplex IO for reading'\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"close_read\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"IOError\"]},{\"type\":\"str\",\"children\":[\"closing non-duplex IO for reading\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":164,"raw_source":"def closed_read?\n        true\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"closed_read?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":168,"raw_source":"def closed_write?\n        closed?\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"closed_write?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"closed?\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":172,"raw_source":"def external_encoding\n        Encoding.find settings.default_encoding\n      rescue NameError\n        settings.default_encoding\n      end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"external_encoding\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Encoding\"]},\"find\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NameError\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":178,"raw_source":"def settings\n        app.settings\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"settings\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":182,"raw_source":"def rewind\n        @pos = @lineno = 0\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rewind\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@pos\",{\"type\":\"ivasgn\",\"children\":[\"@lineno\",{\"type\":\"int\",\"children\":[0]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":186,"raw_source":"def not_open_for_reading(*)\n        raise IOError, 'not opened for reading'\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"not_open_for_reading\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"IOError\"]},{\"type\":\"str\",\"children\":[\"not opened for reading\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":208,"raw_source":"def enum_not_open_for_reading(*)\n        not_open_for_reading if block_given?\n        enum_for(:not_open_for_reading)\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enum_not_open_for_reading\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"not_open_for_reading\"]},null]},{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"sym\",\"children\":[\"not_open_for_reading\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":220,"raw_source":"def dummy(*) end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dummy\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":227,"raw_source":"def seek(*)\n        0\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"seek\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"int\",\"children\":[0]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":233,"raw_source":"def sync\n        true\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sync\",{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":237,"raw_source":"def tty?\n        false\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"tty?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":123,"raw_source":"def mock_app(base = Sinatra::Base, &block)\n      inner = nil\n      @app  = Sinatra.new(base) do\n        inner = self\n        class_eval(&block)\n      end\n      @settings = inner\n      app\n    end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@settings\",{\"type\":\"lvar\",\"children\":[\"inner\"]}]},{\"type\":\"send\",\"children\":[null,\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":136,"raw_source":"def app=(base)\n      @app = base\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"app=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"base\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":151,"raw_source":"def app\n      @app ||= Class.new Sinatra::Base\n      Rack::Lint.new @app\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Lint\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@app\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":162,"raw_source":"def options(uri, params = {}, env = {}, &block)\n        env = env_for(uri, env.merge(method: 'OPTIONS', params: params))\n        current_session.send(:process_request, uri, env, &block)\n      end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[null,\"env_for\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_session\"]},\"send\",{\"type\":\"sym\",\"children\":[\"process_request\"]},{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":174,"raw_source":"def patch(uri, params = {}, env = {}, &block)\n        env = env_for(uri, env.merge(method: 'PATCH', params: params))\n        current_session.send(:process_request, uri, env, &block)\n      end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[null,\"env_for\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"PATCH\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_session\"]},\"send\",{\"type\":\"sym\",\"children\":[\"process_request\"]},{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":181,"raw_source":"def last_request?\n      last_request\n      true\n    rescue Rack::Test::Error\n      false\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"last_request?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":190,"raw_source":"def session\n      return {} unless last_request?\n      raise Rack::Test::Error, 'session not enabled for app' unless last_env['rack.session'] || app.session?\n\n      last_request.session\n    end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.session\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"session?\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]},{\"type\":\"str\",\"children\":[\"session not enabled for app\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},\"session\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":198,"raw_source":"def last_env\n      last_request.env\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"last_env\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},\"env\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":34,"raw_source":"def self.registered(_)\n      Sinatra::Request.include WebDAV::Request\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Request\"]},\"include\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"WebDAV\"]},\"Request\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":39,"raw_source":"def self.included(base)\n        base.class_eval do\n          alias_method :_safe?, :safe?\n          alias_method :_idempotent?, :idempotent?\n\n          def safe?\n            _safe? or propfind?\n          end\n\n          def idempotent?\n            _idempotent? or propfind? or move? or unlock? # or lock?\n          end\n        end\n      end","complexity_score":10.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"_safe?\"]},{\"type\":\"sym\",\"children\":[\"safe?\"]}]},{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"_idempotent?\"]},{\"type\":\"sym\",\"children\":[\"idempotent?\"]}]},{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_safe?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]}]},{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_idempotent?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]},{\"type\":\"send\",\"children\":[null,\"move?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlock?\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":44,"raw_source":"def safe?\n            _safe? or propfind?\n          end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_safe?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":48,"raw_source":"def idempotent?\n            _idempotent? or propfind? or move? or unlock? # or lock?\n          end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_idempotent?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]},{\"type\":\"send\",\"children\":[null,\"move?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlock?\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":54,"raw_source":"def propfind?\n        request_method == 'PROPFIND'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"propfind?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"PROPFIND\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":58,"raw_source":"def proppatch?\n        request_method == 'PROPPATCH'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"proppatch?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"PROPPATCH\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":62,"raw_source":"def mkcol?\n        request_method == 'MKCOL'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mkcol?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"MKCOL\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":66,"raw_source":"def copy?\n        request_method == 'COPY'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"copy?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"COPY\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":70,"raw_source":"def move?\n        request_method == 'MOVE'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"move?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"MOVE\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":78,"raw_source":"def unlock?\n        request_method == 'UNLOCK'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlock?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"UNLOCK\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":83,"raw_source":"def propfind(path, opts = {}, &bk)  route 'PROPFIND',  path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"propfind\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PROPFIND\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":84,"raw_source":"def proppatch(path, opts = {}, &bk) route 'PROPPATCH', path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"proppatch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PROPPATCH\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":85,"raw_source":"def mkcol(path, opts = {}, &bk)     route 'MKCOL',     path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mkcol\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"MKCOL\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":86,"raw_source":"def copy(path, opts = {}, &bk)      route 'COPY',      path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"copy\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"COPY\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":87,"raw_source":"def move(path, opts = {}, &bk)      route 'MOVE',      path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"move\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"MOVE\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":89,"raw_source":"def unlock(path, opts = {}, &bk)    route 'UNLOCK',    path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlock\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"UNLOCK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/capture_spec.rb","start_line":17,"raw_source":"def render(engine, template)\n    subject.send(:render, engine, template.to_sym).strip.gsub(/\\s+/, ' ')\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"subject\"]},\"send\",{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"to_sym\"]}]},\"strip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\" \"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/config_file_spec.rb","start_line":4,"raw_source":"def config_file(*args, &block)\n    mock_app do\n      register Sinatra::ConfigFile\n      set :root, File.expand_path('config_file', __dir__)\n      instance_eval(&block) if block\n      config_file(*args)\n    end\n  end","complexity_score":17.8,"ast_json":"{\"type\":\"def\",\"children\":[\"config_file\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"ConfigFile\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"config_file\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"config_file\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/content_for_spec.rb","start_line":17,"raw_source":"def render(engine, template)\n    subject.send(:render, engine, template, :layout => false).gsub(/\\s/, '')\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"subject\"]},\"send\",{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"false\",\"children\":[]}]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/content_for_spec.rb","start_line":202,"raw_source":"def body\n            last_response.body.gsub(/\\s/, '')\n          end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_response\"]},\"body\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/cookies_spec.rb","start_line":4,"raw_source":"def cookie_route(*cookies, headers: {}, &block)\n    result = nil\n    set_cookie(cookies)\n    @cookie_app.get('/') do\n      result = instance_eval(&block)\n      \"ok\"\n    end\n    get '/', {}, headers || {}\n    expect(last_response).to be_ok\n    expect(body).to eq(\"ok\")\n    result\n  end","complexity_score":24.4,"ast_json":"{\"type\":\"def\",\"children\":[\"cookie_route\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"cookies\"]},{\"type\":\"kwoptarg\",\"children\":[\"headers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"set_cookie\",{\"type\":\"lvar\",\"children\":[\"cookies\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cookie_app\"]},\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[null,\"last_response\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"be_ok\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/cookies_spec.rb","start_line":17,"raw_source":"def cookies(*set_cookies)\n    cookie_route(*set_cookies) { cookies }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"cookies\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"set_cookies\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cookie_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"set_cookies\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"cookies\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":33,"raw_source":"def mock_app(&block)\n    super do\n      class_eval(&block)\n    end\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":39,"raw_source":"def results_in(obj)\n    expect(OkJson.decode(get('/').body)).to eq(obj)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"results_in\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OkJson\"]},\"decode\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"body\"]}]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":68,"raw_source":"def enc.generate(obj) obj.inspect end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enc\"]},\"generate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":75,"raw_source":"def enc.encode(obj) obj.inspect end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enc\"]},\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":87,"raw_source":"def enc.generate(obj) obj.inspect end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enc\"]},\"generate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":97,"raw_source":"def enc.encode(obj) obj.inspect end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enc\"]},\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":6,"raw_source":"def mock_app(&block)\n    super do\n      register Sinatra::Namespace\n      class_eval(&block)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Namespace\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":13,"raw_source":"def namespace(*args, &block)\n    mock_app { namespace(*args, &block) }\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"namespace\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"namespace\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":142,"raw_source":"def foo\n                  'foo'\n                end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":336,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":352,"raw_source":"def magic\n              42\n            end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":367,"raw_source":"def magic\n              42\n            end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":386,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":405,"raw_source":"def magic\n              42\n            end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":429,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":448,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":454,"raw_source":"def magic\n                super - 19\n              end","complexity_score":1.3,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"-\",{\"type\":\"int\",\"children\":[19]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":497,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":516,"raw_source":"def magic\n                42\n              end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"magic\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[42]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":844,"raw_source":"def dump_args(*args)\n            args.inspect\n          end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dump_args\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"inspect\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":851,"raw_source":"def dump_args(*args)\n              super(:foo, *args)\n            end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dump_args\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":860,"raw_source":"def dump_args(*args)\n              super(:foo_bar, *args)\n            end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dump_args\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo_bar\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":40,"raw_source":"def decode(s)\n    ts = lex(s)\n    v, ts = textparse(ts)\n    if ts.length > 0\n      raise Error, 'trailing garbage'\n    end\n    v\n  end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"lex\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"textparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"trailing garbage\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":54,"raw_source":"def textparse(ts)\n    if ts.length < 0\n      raise Error, 'empty'\n    end\n\n    typ, _, val = ts[0]\n    case typ\n    when '{' then objparse(ts)\n    when '[' then arrparse(ts)\n    else\n      raise Error, \"unexpected #{val.inspect}\"\n    end\n  end","complexity_score":17.3,"ast_json":"{\"type\":\"def\",\"children\":[\"textparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"empty\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[null,\"objparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[null,\"arrparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":71,"raw_source":"def valparse(ts)\n    if ts.length < 0\n      raise Error, 'empty'\n    end\n\n    typ, _, val = ts[0]\n    case typ\n    when '{' then objparse(ts)\n    when '[' then arrparse(ts)\n    when :val,:str then [val, ts[1..-1]]\n    else\n      raise Error, \"unexpected #{val.inspect}\"\n    end\n  end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"valparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"empty\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[null,\"objparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[null,\"arrparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"sym\",\"children\":[\"str\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":89,"raw_source":"def objparse(ts)\n    ts = eat('{', ts)\n    obj = {}\n\n    if ts[0][0] == '}'\n      return obj, ts[1..-1]\n    end\n\n    k, v, ts = pairparse(ts)\n    obj[k] = v\n\n    if ts[0][0] == '}'\n      return obj, ts[1..-1]\n    end\n\n    loop do\n      ts = eat(',', ts)\n\n      k, v, ts = pairparse(ts)\n      obj[k] = v\n\n      if ts[0][0] == '}'\n        return obj, ts[1..-1]\n      end\n    end\n  end","complexity_score":38.7,"ast_json":"{\"type\":\"def\",\"children\":[\"objparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"k\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"pairparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"k\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"pairparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":119,"raw_source":"def pairparse(ts)\n    (typ, _, k), ts = ts[0], ts[1..-1]\n    if typ != :str\n      raise Error, \"unexpected #{k.inspect}\"\n    end\n    ts = eat(':', ts)\n    v, ts = valparse(ts)\n    [k, v, ts]\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"pairparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"k\"]}]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":132,"raw_source":"def arrparse(ts)\n    ts = eat('[', ts)\n    arr = []\n\n    if ts[0][0] == ']'\n      return arr, ts[1..-1]\n    end\n\n    v, ts = valparse(ts)\n    arr << v\n\n    if ts[0][0] == ']'\n      return arr, ts[1..-1]\n    end\n\n    loop do\n      ts = eat(',', ts)\n\n      v, ts = valparse(ts)\n      arr << v\n\n      if ts[0][0] == ']'\n        return arr, ts[1..-1]\n      end\n    end\n  end","complexity_score":36.5,"ast_json":"{\"type\":\"def\",\"children\":[\"arrparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"arr\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":160,"raw_source":"def eat(typ, ts)\n    if ts[0][0] != typ\n      raise Error, \"expected #{typ} (got #{ts[0].inspect})\"\n    end\n    ts[1..-1]\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"eat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"typ\"]},{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"!=\",{\"type\":\"lvar\",\"children\":[\"typ\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]}]},{\"type\":\"str\",\"children\":[\" (got \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":170,"raw_source":"def lex(s)\n    ts = []\n    while s.length > 0\n      typ, lexeme, val = tok(s)\n      if typ == nil\n        raise Error, \"invalid character at #{s[0,10].inspect}\"\n      end\n      if typ != :space\n        ts << [typ, lexeme, val]\n      end\n      s = s[lexeme.length..-1]\n    end\n    ts\n  end","complexity_score":25.28,"ast_json":"{\"type\":\"def\",\"children\":[\"lex\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"lexeme\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[null,\"tok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"==\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid character at \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[10]}]},\"inspect\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"space\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"lvar\",\"children\":[\"lexeme\"]},{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lexeme\"]},\"length\"]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":199,"raw_source":"def tok(s)\n    case s[0]\n    when ?{  then ['{', s[0,1], s[0,1]]\n    when ?}  then ['}', s[0,1], s[0,1]]\n    when ?:  then [':', s[0,1], s[0,1]]\n    when ?,  then [',', s[0,1], s[0,1]]\n    when ?[  then ['[', s[0,1], s[0,1]]\n    when ?]  then [']', s[0,1], s[0,1]]\n    when ?n  then nulltok(s)\n    when ?t  then truetok(s)\n    when ?f  then falsetok(s)\n    when ?\"  then strtok(s)\n    when Spc then [:space, s[0,1], s[0,1]]\n    when ?\\t then [:space, s[0,1], s[0,1]]\n    when ?\\n then [:space, s[0,1], s[0,1]]\n    when ?\\r then [:space, s[0,1], s[0,1]]\n    else          numtok(s)\n    end\n  end","complexity_score":54.3,"ast_json":"{\"type\":\"def\",\"children\":[\"tok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"}\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"}\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"]\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"]\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"n\"]},{\"type\":\"send\",\"children\":[null,\"nulltok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"t\"]},{\"type\":\"send\",\"children\":[null,\"truetok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[null,\"falsetok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"send\",\"children\":[null,\"strtok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Spc\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\t\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\r\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"numtok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":220,"raw_source":"def nulltok(s);  s[0,4] == 'null'  && [:val, 'null',  nil]   end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"nulltok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[4]}]},\"==\",{\"type\":\"str\",\"children\":[\"null\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"null\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":221,"raw_source":"def truetok(s);  s[0,4] == 'true'  && [:val, 'true',  true]  end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"truetok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[4]}]},\"==\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"true\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":222,"raw_source":"def falsetok(s); s[0,5] == 'false' && [:val, 'false', false] end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"falsetok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[5]}]},\"==\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"false\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":225,"raw_source":"def numtok(s)\n    m = /-?([1-9][0-9]+|[0-9])([.][0-9]+)?([eE][+-]?[0-9]+)?/.match(s)\n    if m && m.begin(0) == 0\n      if m[3] && !m[2]\n        [:val, m[0], Integer(m[1])*(10**Integer(m[3][1..-1]))]\n      elsif m[2]\n        [:val, m[0], Float(m[0])]\n      else\n        [:val, m[0], Integer(m[0])]\n      end\n    end\n  end","complexity_score":37.7,"ast_json":"{\"type\":\"def\",\"children\":[\"numtok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"-?([1-9][0-9]+|[0-9])([.][0-9]+)?([eE][+-]?[0-9]+)?\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"begin\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"!\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[10]},\"**\",{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"Float\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":239,"raw_source":"def strtok(s)\n    m = /\"([^\"\\\\]|\\\\[\"\\/\\\\bfnrt]|\\\\u[0-9a-fA-F]{4})*\"/.match(s)\n    if ! m\n      raise Error, \"invalid string literal at #{abbrev(s)}\"\n    end\n    [:str, m[0], unquote(m[0])]\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"strtok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"([^\\\"\\\\\\\\]|\\\\\\\\[\\\"/\\\\\\\\bfnrt]|\\\\\\\\u[0-9a-fA-F]{4})*\\\"\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"!\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid string literal at \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"abbrev\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"str\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"unquote\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":248,"raw_source":"def abbrev(s)\n    t = s[0,10]\n    p = t['`']\n    t = t[0,p] if p\n    t = t + '...' if t.length < s.length\n    '`' + t + '`'\n  end","complexity_score":16.3,"ast_json":"{\"type\":\"def\",\"children\":[\"abbrev\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"[]\",{\"type\":\"str\",\"children\":[\"`\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"length\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"+\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"`\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"`\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":260,"raw_source":"def unquote(q)\n    q = q[1...-1]\n    a = q.dup # allocate a big enough string\n    r, w = 0, 0\n    while r < q.length\n      c = q[r]\n      case true\n      when c == ?\\\\\n        r += 1\n        if r >= q.length\n          raise Error, \"string literal ends with a \\\"\\\\\\\": \\\"#{q}\\\"\"\n        end\n\n        case q[r]\n        when ?\",?\\\\,?/,?'\n          a[w] = q[r]\n          r += 1\n          w += 1\n        when ?b,?f,?n,?r,?t\n          a[w] = Unesc[q[r]]\n          r += 1\n          w += 1\n        when ?u\n          r += 1\n          uchar = begin\n            hexdec4(q[r,4])\n          rescue RuntimeError => e\n            raise Error, \"invalid escape sequence \\\\u#{q[r,4]}: #{e}\"\n          end\n          r += 4\n          if surrogate? uchar\n            if q.length >= r+6\n              uchar1 = hexdec4(q[r+2,4])\n              uchar = subst(uchar, uchar1)\n              if uchar != Ucharerr\n                # A valid pair; consume.\n                r += 6\n              end\n            end\n          end\n          w += ucharenc(a, w, uchar)\n        else\n          raise Error, \"invalid escape char #{q[r]} in \\\"#{q}\\\"\"\n        end\n      when c == ?\", c < Spc\n        raise Error, \"invalid character in string literal \\\"#{q}\\\"\"\n      else\n        # Copy anything else byte-for-byte.\n        # Valid UTF-8 will remain valid UTF-8.\n        # Invalid UTF-8 will remain invalid UTF-8.\n        a[w] = c\n        r += 1\n        w += 1\n      end\n    end\n    a[0,w]\n  end","complexity_score":131.33,"ast_json":"{\"type\":\"def\",\"children\":[\"unquote\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"q\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"q\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"erange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"dup\"]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},{\"type\":\"lvasgn\",\"children\":[\"w\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"length\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"==\",{\"type\":\"str\",\"children\":[\"\\\\\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"string literal ends with a \\\"\\\\\\\": \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]}]},{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]},null]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"str\",\"children\":[\"\\\\\"]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"str\",\"children\":[\"'\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"w\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"w\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"str\",\"children\":[\"n\"]},{\"type\":\"str\",\"children\":[\"r\"]},{\"type\":\"str\",\"children\":[\"t\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"w\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Unesc\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"w\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"u\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"uchar\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"hexdec4\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid escape sequence \\\\u\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"surrogate?\",{\"type\":\"lvar\",\"children\":[\"uchar\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"length\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"uchar1\",{\"type\":\"send\",\"children\":[null,\"hexdec4\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"uchar\",{\"type\":\"send\",\"children\":[null,\"subst\",{\"type\":\"lvar\",\"children\":[\"uchar\"]},{\"type\":\"lvar\",\"children\":[\"uchar1\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uchar\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[6]}]},null]}]},null]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"w\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"ucharenc\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"w\"]},{\"type\":\"lvar\",\"children\":[\"uchar\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid escape char \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"str\",\"children\":[\" in \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]}]},{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"==\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Spc\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid character in string literal \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"q\"]}]},{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"w\"]},{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"w\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"w\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":322,"raw_source":"def ucharenc(a, i, u)\n    case true\n    when u <= Uchar1max\n      a[i] = (u & 0xff).chr\n      1\n    when u <= Uchar2max\n      a[i+0] = (Utag2 | ((u>>6)&0xff)).chr\n      a[i+1] = (Utagx | (u&Umaskx)).chr\n      2\n    when u <= Uchar3max\n      a[i+0] = (Utag3 | ((u>>12)&0xff)).chr\n      a[i+1] = (Utagx | ((u>>6)&Umaskx)).chr\n      a[i+2] = (Utagx | (u&Umaskx)).chr\n      3\n    else\n      a[i+0] = (Utag4 | ((u>>18)&0xff)).chr\n      a[i+1] = (Utagx | ((u>>12)&Umaskx)).chr\n      a[i+2] = (Utagx | ((u>>6)&Umaskx)).chr\n      a[i+3] = (Utagx | (u&Umaskx)).chr\n      4\n    end\n  end","complexity_score":89.95,"ast_json":"{\"type\":\"def\",\"children\":[\"ucharenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"i\"]},{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar1max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar2max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag2\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar3max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag3\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag4\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[18]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[4]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":346,"raw_source":"def hexdec4(s)\n    if s.length != 4\n      raise Error, 'short'\n    end\n    (nibble(s[0])<<12) | (nibble(s[1])<<8) | (nibble(s[2])<<4) | nibble(s[3])\n  end","complexity_score":29.15,"ast_json":"{\"type\":\"def\",\"children\":[\"hexdec4\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]},\"!=\",{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"short\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"<<\",{\"type\":\"int\",\"children\":[12]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},\"<<\",{\"type\":\"int\",\"children\":[8]}]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},\"<<\",{\"type\":\"int\",\"children\":[4]}]}]}]},\"|\",{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":354,"raw_source":"def subst(u1, u2)\n    if Usurr1 <= u1 && u1 < Usurr2 && Usurr2 <= u2 && u2 < Usurr3\n      return ((u1-Usurr1)<<10) | (u2-Usurr2) + Usurrself\n    end\n    return Ucharerr\n  end","complexity_score":16.28,"ast_json":"{\"type\":\"def\",\"children\":[\"subst\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u1\"]},{\"type\":\"arg\",\"children\":[\"u2\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u1\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr2\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr2\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u2\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u2\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr3\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u1\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurr1\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[10]}]}]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u2\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurr2\"]}]}]},\"+\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":362,"raw_source":"def unsubst(u)\n    if u < Usurrself || u > Umax || surrogate?(u)\n      return Ucharerr, Ucharerr\n    end\n    u -= Usurrself\n    [Usurr1 + ((u>>10)&0x3ff), Usurr2 + (u&0x3ff)]\n  end","complexity_score":15.5,"ast_json":"{\"type\":\"def\",\"children\":[\"unsubst\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">\",{\"type\":\"const\",\"children\":[null,\"Umax\"]}]}]},{\"type\":\"send\",\"children\":[null,\"surrogate?\",{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[10]}]}]},\"&\",{\"type\":\"int\",\"children\":[1023]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr2\"]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[1023]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":371,"raw_source":"def surrogate?(u)\n    Usurr1 <= u && u < Usurr3\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"surrogate?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr3\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":376,"raw_source":"def nibble(c)\n    case true\n    when ?0 <= c && c <= ?9 then c.ord - ?0.ord\n    when ?a <= c && c <= ?z then c.ord - ?a.ord + 10\n    when ?A <= c && c <= ?Z then c.ord - ?A.ord + 10\n    else\n      raise Error, \"invalid hex code #{c}\"\n    end\n  end","complexity_score":33.1,"ast_json":"{\"type\":\"def\",\"children\":[\"nibble\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"0\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"9\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"0\"]},\"ord\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"z\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"ord\"]}]},\"+\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},\"ord\"]}]},\"+\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid hex code \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":396,"raw_source":"def encode(x)\n    case x\n    when Hash    then objenc(x)\n    when Array   then arrenc(x)\n    else\n      raise Error, 'root value must be an Array or a Hash'\n    end\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"objenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"arrenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"root value must be an Array or a Hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":406,"raw_source":"def valenc(x)\n    case x\n    when Hash    then objenc(x)\n    when Array   then arrenc(x)\n    when String  then strenc(x)\n    when Numeric then numenc(x)\n    when true    then \"true\"\n    when false   then \"false\"\n    when nil     then \"null\"\n    else\n      raise Error, \"cannot encode #{x.class}: #{x.inspect}\"\n    end\n  end","complexity_score":17.2,"ast_json":"{\"type\":\"def\",\"children\":[\"valenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"objenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"arrenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"strenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Numeric\"]},{\"type\":\"send\",\"children\":[null,\"numenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"null\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"cannot encode \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"inspect\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":421,"raw_source":"def objenc(x)\n    '{' + x.map{|k,v| keyenc(k) + ':' + valenc(v)}.join(',') + '}'\n  end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"objenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"keyenc\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"+\",{\"type\":\"str\",\"children\":[\":\"]}]},\"+\",{\"type\":\"send\",\"children\":[null,\"valenc\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},\"+\",{\"type\":\"str\",\"children\":[\"}\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":426,"raw_source":"def arrenc(a)\n    '[' + a.map{|x| valenc(x)}.join(',') + ']'\n  end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"arrenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"send\",\"children\":[null,\"valenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},\"+\",{\"type\":\"str\",\"children\":[\"]\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":431,"raw_source":"def keyenc(k)\n    case k\n    when String then strenc(k)\n    else\n      raise Error, \"Hash key is not a string: #{k.inspect}\"\n    end\n  end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"keyenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"strenc\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Hash key is not a string: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":440,"raw_source":"def strenc(s)\n    t = StringIO.new\n    t.putc(?\")\n    r = 0\n    while r < s.length\n      case s[r]\n      when ?\"  then t.print('\\\\\"')\n      when ?\\\\ then t.print('\\\\\\\\')\n      when ?\\b then t.print('\\\\b')\n      when ?\\f then t.print('\\\\f')\n      when ?\\n then t.print('\\\\n')\n      when ?\\r then t.print('\\\\r')\n      when ?\\t then t.print('\\\\t')\n      else\n        c = s[r]\n        case true\n        when Spc <= c && c <= ?~\n          t.putc(c)\n        when true\n          u, size = uchardec(s, r)\n          r += size - 1 # we add one more at the bottom of the loop\n          if u < 0x10000\n            t.print('\\\\u')\n            hexenc4(t, u)\n          else\n            u1, u2 = unsubst(u)\n            t.print('\\\\u')\n            hexenc4(t, u1)\n            t.print('\\\\u')\n            hexenc4(t, u2)\n          end\n        else\n          # invalid byte; skip it\n        end\n      end\n      r += 1\n    end\n    t.putc(?\")\n    t.string\n  end","complexity_score":80.8,"ast_json":"{\"type\":\"def\",\"children\":[\"strenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringIO\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\\\\"\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\\\\\\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\b\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\f\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\n\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\r\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\r\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\t\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\t\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Spc\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\"]},{\"type\":\"lvasgn\",\"children\":[\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"uchardec\",{\"type\":\"lvar\",\"children\":[\"s\"]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"size\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"int\",\"children\":[65536]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u1\"]},{\"type\":\"lvasgn\",\"children\":[\"u2\"]}]},{\"type\":\"send\",\"children\":[null,\"unsubst\",{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u2\"]}]}]}]}]}]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"string\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":482,"raw_source":"def hexenc4(t, u)\n    t.putc(Hex[(u>>12)&0xf])\n    t.putc(Hex[(u>>8)&0xf])\n    t.putc(Hex[(u>>4)&0xf])\n    t.putc(Hex[u&0xf])\n  end","complexity_score":22.15,"ast_json":"{\"type\":\"def\",\"children\":[\"hexenc4\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]},{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[8]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[4]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":490,"raw_source":"def numenc(x)\n    if x.nan? || x.infinite?\n      return 'null'\n    end rescue nil\n    \"#{x}\"\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"numenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"nan?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"infinite?\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"null\"]}]},null]},{\"type\":\"resbody\",\"children\":[null,null,{\"type\":\"nil\",\"children\":[]}]},null]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":501,"raw_source":"def uchardec(s, i)\n    n = s.length - i\n    return [Ucharerr, 1] if n < 1\n\n    c0 = s[i].ord\n\n    # 1-byte, 7-bit sequence?\n    if c0 < Utagx\n      return [c0, 1]\n    end\n\n    # unexpected continuation byte?\n    return [Ucharerr, 1] if c0 < Utag2\n\n    # need continuation byte\n    return [Ucharerr, 1] if n < 2\n    c1 = s[i+1].ord\n    return [Ucharerr, 1] if c1 < Utagx || Utag2 <= c1\n\n    # 2-byte, 11-bit sequence?\n    if c0 < Utag3\n      u = (c0&Umask2)<<6 | (c1&Umaskx)\n      return [Ucharerr, 1] if u <= Uchar1max\n      return [u, 2]\n    end\n\n    # need second continuation byte\n    return [Ucharerr, 1] if n < 3\n    c2 = s[i+2].ord\n    return [Ucharerr, 1] if c2 < Utagx || Utag2 <= c2\n\n    # 3-byte, 16-bit sequence?\n    if c0 < Utag4\n      u = (c0&Umask3)<<12 | (c1&Umaskx)<<6 | (c2&Umaskx)\n      return [Ucharerr, 1] if u <= Uchar2max\n      return [u, 3]\n    end\n\n    # need third continuation byte\n    return [Ucharerr, 1] if n < 4\n    c3 = s[i+3].ord\n    return [Ucharerr, 1] if c3 < Utagx || Utag2 <= c3\n\n    # 4-byte, 21-bit sequence?\n    if c0 < Utag5\n      u = (c0&Umask4)<<18 | (c1&Umaskx)<<12 | (c2&Umaskx)<<6 | (c3&Umaskx)\n      return [Ucharerr, 1] if u <= Uchar3max\n      return [u, 4]\n    end\n\n    return [Ucharerr, 1]\n  end","complexity_score":104.35,"ast_json":"{\"type\":\"def\",\"children\":[\"uchardec\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]},{\"type\":\"arg\",\"children\":[\"i\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"n\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"<\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"c0\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"ord\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utagx\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utag2\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"<\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"c1\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},\"ord\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c1\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utagx\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag2\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c1\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utag3\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umask2\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[6]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c1\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar1max\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"<\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"c2\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]}]},\"ord\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c2\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utagx\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag2\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c2\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utag4\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umask3\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[12]}]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c1\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[6]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c2\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar2max\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"<\",{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"c3\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[3]}]}]},\"ord\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c3\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utagx\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag2\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c3\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Utag5\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c0\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umask4\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[18]}]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c1\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[12]}]}]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c2\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[6]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c3\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar3max\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":6,"raw_source":"def tmp_dir\n    File.expand_path('../tmp', __dir__)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tmp_dir\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"../tmp\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":12,"raw_source":"def app_file_path\n    File.join(tmp_dir, \"example_app_#{$example_app_counter}.rb\")\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file_path\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"tmp_dir\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"example_app_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$example_app_counter\"]}]},{\"type\":\"str\",\"children\":[\".rb\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":19,"raw_source":"def app_name\n    \"ExampleApp#{$example_app_counter}\"\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"app_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"ExampleApp\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$example_app_counter\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":25,"raw_source":"def app_const\n    Module.const_get(app_name)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_const\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"const_get\",{\"type\":\"send\",\"children\":[null,\"app_name\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":39,"raw_source":"def write_app_file(options={})\n    options[:routes] ||= ['get(\"/foo\") { erb :foo }']\n    options[:inline_templates] ||= nil\n    options[:extensions] ||= []\n    options[:middlewares] ||= []\n    options[:filters] ||= []\n    options[:errors] ||= {}\n    options[:name] ||= app_name\n    options[:enable_reloader] = true unless options[:enable_reloader] === false\n    options[:parent] ||= 'Sinatra::Base'\n\n    update_file(app_file_path) do |f|\n      template_path = File.expand_path('reloader/app.rb.erb', __dir__)\n      template = Tilt.new(template_path, nil, :trim => '<>')\n      f.write template.render(Object.new, options)\n    end\n  end","complexity_score":19.9,"ast_json":"{\"type\":\"def\",\"children\":[\"write_app_file\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"routes\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"get(\\\"/foo\\\") { erb :foo }\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"extensions\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"middlewares\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"errors\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"app_name\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"enable_reloader\"]}]},\"===\",{\"type\":\"false\",\"children\":[]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"enable_reloader\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"parent\"]}]},{\"type\":\"str\",\"children\":[\"Sinatra::Base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"update_file\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_path\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"reloader/app.rb.erb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"template_path\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"trim\"]},{\"type\":\"str\",\"children\":[\"<>\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"write\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Object\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":61,"raw_source":"def update_file(path, &block)\n    original_mtime = File.exist?(path) ? File.mtime(path) : Time.at(0)\n    new_time = original_mtime + 1\n    File.open(path, 'w', &block)\n    File.utime(new_time, new_time, path)\n  end","complexity_score":10.7,"ast_json":"{\"type\":\"def\",\"children\":[\"update_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_mtime\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_time\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"original_mtime\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"open\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"str\",\"children\":[\"w\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"utime\",{\"type\":\"lvar\",\"children\":[\"new_time\"]},{\"type\":\"lvar\",\"children\":[\"new_time\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":71,"raw_source":"def setup_example_app(options={})\n    $example_app_counter ||= 0\n    $example_app_counter += 1\n\n    FileUtils.mkdir_p(tmp_dir)\n    write_app_file(options)\n    $LOADED_FEATURES.delete app_file_path\n    require app_file_path\n    self.app = app_const\n    app_const.enable :reloader\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_example_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$example_app_counter\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$example_app_counter\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FileUtils\"]},\"mkdir_p\",{\"type\":\"send\",\"children\":[null,\"tmp_dir\"]}]},{\"type\":\"send\",\"children\":[null,\"write_app_file\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$LOADED_FEATURES\"]},\"delete\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"app=\",{\"type\":\"send\",\"children\":[null,\"app_const\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_const\"]},\"enable\",{\"type\":\"sym\",\"children\":[\"reloader\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":261,"raw_source":"def self.registered(klass)\n          klass.get('/bar') { 'bar' }\n        end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"get\",{\"type\":\"str\",\"children\":[\"/bar\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":282,"raw_source":"def self.registered(klass)\n          klass.use Rack::Head\n        end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Head\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":303,"raw_source":"def self.registered(klass)\n          klass.before { @hi = 'hi' }\n        end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@hi\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":324,"raw_source":"def self.registered(klass)\n          klass.after { @bye = 'bye' }\n        end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"after\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@bye\",{\"type\":\"str\",\"children\":[\"bye\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":7,"raw_source":"def respond_app(&block)\n    mock_app do\n      set :app_file, __FILE__\n      set :views, root + '/respond_with'\n      register Sinatra::RespondWith\n      class_eval(&block)\n    end\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"app_file\"]},{\"type\":\"str\",\"children\":[\"(method)\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"root\"]},\"+\",{\"type\":\"str\",\"children\":[\"/respond_with\"]}]}]},{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"RespondWith\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":16,"raw_source":"def respond_to(*args, &block)\n    respond_app { get('/') { respond_to(*args, &block) } }\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"respond_to\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":20,"raw_source":"def respond_with(*args, &block)\n    respond_app { get('/') { respond_with(*args, &block) } }\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_with\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"respond_with\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":24,"raw_source":"def req(*types)\n    path = types.shift if types.first.is_a?(String) && types.first.start_with?('/')\n    accept = types.map { |t| Sinatra::Base.mime_type(t).to_s }.join ','\n    get (path || '/'), {}, 'HTTP_ACCEPT' => accept\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"req\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"shift\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"accept\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"to_s\"]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]},{\"type\":\"lvar\",\"children\":[\"accept\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":221,"raw_source":"def object.to_pdf; \"hi\" end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"object\"]},\"to_pdf\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"hi\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":4,"raw_source":"def stream(&block)\n    rack_middleware = @use\n    out = nil\n    mock_app do\n      rack_middleware.each { |args| use(*args) }\n      helpers Sinatra::Streaming\n      get('/') { out = stream(&block) }\n    end\n    get('/')\n    out\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"rack_middleware\",{\"type\":\"ivar\",\"children\":[\"@use\"]}]},{\"type\":\"lvasgn\",\"children\":[\"out\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"rack_middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"helpers\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Streaming\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"out\",{\"type\":\"send\",\"children\":[null,\"stream\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":16,"raw_source":"def use(*args)\n    @use << args\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@use\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":147,"raw_source":"def initialize(app) @app = app end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":148,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          body.map! { |s| s.upcase }\n          [status, headers, body]\n        end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"upcase\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":172,"raw_source":"def initialize(app) @app = app end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":173,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.map(&:upcase)]\n        end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":186,"raw_source":"def initialize(app) @app = app end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":187,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.map(&:upcase).map(&:reverse)]\n        end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"reverse\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":200,"raw_source":"def initialize(app) @app = app end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":201,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.each.map(&:upcase)]\n        end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"each\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/asciidoctor_test.rb","start_line":7,"raw_source":"def asciidoc_app(&block)\n      mock_app do\n        set :views, __dir__ + '/views'\n        get('/', &block)\n      end\n      get '/'\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"asciidoc_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/base_test.rb","start_line":10,"raw_source":"def initialize(argument:)\n        @argument = argument\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"argument\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@argument\",{\"type\":\"lvar\",\"children\":[\"argument\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/base_test.rb","start_line":109,"raw_source":"def route_missing\n        env['sinatra.route-missing'] = '1'\n        super\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"route_missing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.route-missing\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/builder_test.rb","start_line":7,"raw_source":"def builder_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"builder_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":4,"raw_source":"def self.parses pattern, example, expected_params, mtype = :sinatra, mopts = {}\n    it \"parses #{example} with #{pattern} into params #{expected_params}\" do\n      compiled = mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      params = compiled.params(example)\n      fail %Q{\"#{example}\" does not parse on pattern \"#{pattern}\".} unless params\n\n      assert_equal expected_params, params, \"Pattern #{pattern} does not match path #{example}.\"\n    end\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parses\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"example\"]},{\"type\":\"arg\",\"children\":[\"expected_params\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"parses \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\" with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\" into params \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expected_params\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled\"]},\"params\",{\"type\":\"lvar\",\"children\":[\"example\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\"\\\" does not parse on pattern \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\".\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected_params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Pattern \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\" does not match path \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\".\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":14,"raw_source":"def self.fails pattern, example, mtype = :sinatra, mopts = {}\n    it \"does not parse #{example} with #{pattern}\" do\n      compiled = mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      match = compiled.match(example)\n      fail %Q{\"#{pattern}\" does parse \"#{example}\" but it should fail} if match\n    end\n  end","complexity_score":18.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"fails\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"example\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"does not parse \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\" with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"match\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled\"]},\"match\",{\"type\":\"lvar\",\"children\":[\"example\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"match\"]},{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\" does parse \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\"\\\" but it should fail\"]}]}]},null]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":22,"raw_source":"def self.raises pattern, mtype = :sinatra, mopts = {}\n    it \"does not compile #{pattern}\" do\n      assert_raises(Mustermann::CompileError, %Q{Pattern \"#{pattern}\" compiles but it should not}) do\n        mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      end\n    end\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raises\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"does not compile \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"CompileError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Pattern \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\" compiles but it should not\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":29,"raw_source":"def self.setup(&block)     setup_blocks    << block  end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"setup\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"setup_blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":30,"raw_source":"def self.teardown(&block)  teardown_blocks << block  end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"teardown\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"teardown_blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":31,"raw_source":"def self.setup_blocks()    @setup_blocks    ||= []   end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"setup_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@setup_blocks\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":32,"raw_source":"def self.teardown_blocks() @teardown_blocks ||= []   end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"teardown_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@teardown_blocks\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":34,"raw_source":"def setup_blocks(base = self.class)\n    setup_blocks base.superclass if base.superclass.respond_to? :setup_blocks\n    base.setup_blocks.each do |block|\n      instance_eval(&block)\n    end\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_blocks\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"setup_blocks\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_blocks\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"setup_blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":41,"raw_source":"def teardown_blocks(base = self.class)\n    teardown_blocks base.superclass if base.superclass.respond_to? :teardown_blocks\n    base.teardown_blocks.each do |block|\n      instance_eval(&block)\n    end\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown_blocks\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"teardown_blocks\"]}]},{\"type\":\"send\",\"children\":[null,\"teardown_blocks\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"teardown_blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":51,"raw_source":"def self.context(*name, &block)\n    subclass = Class.new(self)\n    remove_tests(subclass)\n    subclass.class_eval(&block) if block_given?\n    const_set(context_name(name.join(\" \")), subclass)\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"context\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"subclass\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_tests\",{\"type\":\"lvar\",\"children\":[\"subclass\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"const_set\",{\"type\":\"send\",\"children\":[null,\"context_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"lvar\",\"children\":[\"subclass\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":58,"raw_source":"def self.test(name, &block)\n    define_method(test_name(name), &block)\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"send\",\"children\":[null,\"test_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":69,"raw_source":"def self.context_name(name)\n    # \"Test#{sanitize_name(name).gsub(/(^| )(\\w)/) { $2.upcase }}\".to_sym\n    name = \"Test#{sanitize_name(name).gsub(/(^| )(\\w)/) { $2.upcase }}\"\n    name.tr(\" \", \"_\").to_sym\n  end","complexity_score":7.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"context_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Test\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(^| )(\\\\w)\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"nth_ref\",\"children\":[2]},\"upcase\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"tr\",{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"_\"]}]},\"to_sym\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":75,"raw_source":"def self.test_name(name)\n    name = \"test_#{sanitize_name(name).gsub(/\\s+/,'_')}_0\"\n    name = name.succ while method_defined? name\n    name.to_sym\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"test_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"test_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"_\"]}]}]},{\"type\":\"str\",\"children\":[\"_0\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"succ\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_sym\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":81,"raw_source":"def self.sanitize_name(name)\n    # name.gsub(/\\W+/, ' ').strip\n    name.gsub(/\\W+/, ' ')\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"sanitize_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\W+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\" \"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":86,"raw_source":"def self.remove_tests(subclass)\n    subclass.public_instance_methods.grep(/^test_/).each do |meth|\n      subclass.send(:undef_method, meth.to_sym)\n    end\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"remove_tests\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"public_instance_methods\"]},\"grep\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^test_\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"meth\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"send\",{\"type\":\"sym\",\"children\":[\"undef_method\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"meth\"]},\"to_sym\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":6,"raw_source":"def method_missing(*a, &b)\n      @last_call = [*a.map(&:to_s)]\n      @last_call << b if b\n    end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]},{\"type\":\"blockarg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@last_call\",{\"type\":\"array\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@last_call\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"b\"]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":12,"raw_source":"def self.delegates(name)\n    it \"delegates #{name}\" do\n      m = mirror { send name }\n      assert_equal [name.to_s], m.last_call\n    end\n\n    it \"delegates #{name} with arguments\" do\n      m = mirror { send name, \"foo\", \"bar\" }\n      assert_equal [name.to_s, \"foo\", \"bar\"], m.last_call\n    end\n\n    it \"delegates #{name} with block\" do\n      block = proc { }\n      m = mirror { send(name, &block) }\n      assert_equal [name.to_s, block], m.last_call\n    end\n  end","complexity_score":45.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"delegates\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" with arguments\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" with block\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]},{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":34,"raw_source":"def teardown\n    Sinatra::Delegator.target = @target_was\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target=\",{\"type\":\"ivar\",\"children\":[\"@target_was\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":38,"raw_source":"def delegation_app(&block)\n    mock_app { Sinatra::Delegator.target = self }\n    delegate(&block)\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"delegation_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target=\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"delegate\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":43,"raw_source":"def mirror(&block)\n    mirror = Mirror.new\n    Sinatra::Delegator.target = mirror\n    delegate(&block)\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mirror\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"mirror\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mirror\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target=\",{\"type\":\"lvar\",\"children\":[\"mirror\"]}]},{\"type\":\"send\",\"children\":[null,\"delegate\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":49,"raw_source":"def delegate(&block)\n    assert Sinatra::Delegator.target != Sinatra::Application\n    Object.new.extend(Sinatra::Delegator).instance_eval(&block) if block\n    Sinatra::Delegator.target\n  end","complexity_score":16.5,"ast_json":"{\"type\":\"def\",\"children\":[\"delegate\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target\"]},\"!=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Application\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Object\"]},\"new\"]},\"extend\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]}]},\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":55,"raw_source":"def target\n    Sinatra::Delegator.target\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"target\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":122,"raw_source":"def respond_to?(method, *)\n        method.to_sym == :options or super\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"options\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":126,"raw_source":"def method_missing(method, *args, &block)\n        return super unless method.to_sym == :options\n        {:some => :option}\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"options\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"some\"]},{\"type\":\"sym\",\"children\":[\"option\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":4,"raw_source":"def engine\n    Tilt::ERBTemplate\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"engine\",{\"type\":\"args\",\"children\":[]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"ERBTemplate\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":8,"raw_source":"def setup\n    Tilt.prefer engine, :erb\n    super\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"prefer\",{\"type\":\"send\",\"children\":[null,\"engine\"]},{\"type\":\"sym\",\"children\":[\"erb\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":13,"raw_source":"def erb_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"erb_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":64,"raw_source":"def container\n        @_out_buf << \"THIS.\"\n        yield\n        @_out_buf << \"SPARTA!\"\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"container\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"str\",\"children\":[\"THIS.\"]}]},{\"type\":\"yield\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"str\",\"children\":[\"SPARTA!\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":69,"raw_source":"def is; \"IS.\" end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"is\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"IS.\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":111,"raw_source":"def engine; Tilt::ErubiTemplate end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"engine\",{\"type\":\"args\",\"children\":[]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"ErubiTemplate\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":5,"raw_source":"def foo\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":9,"raw_source":"def im_hiding_in_ur_foos\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"im_hiding_in_ur_foos\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":14,"raw_source":"def bar\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"bar\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":19,"raw_source":"def baz\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"baz\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":24,"raw_source":"def quux\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"quux\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":29,"raw_source":"def foo=(name); end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":30,"raw_source":"def bar?(name); end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"bar?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":31,"raw_source":"def fizz!(name); end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"fizz!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":45,"raw_source":"Sinatra::Base.register { def im_in_ur_anonymous_module; end }","complexity_score":2.0,"ast_json":"{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"register\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"im_in_ur_anonymous_module\",{\"type\":\"args\",\"children\":[]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":79,"raw_source":"def bizzle\n      bizzle_option\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"bizzle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"bizzle_option\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":83,"raw_source":"def self.registered(base)\n      fail \"base should be BizzleApp\" unless base == BizzleApp\n      fail \"base should have already extended BizzleExtension\" unless base.respond_to?(:bizzle)\n      base.set :bizzle_option, 'bizzle!'\n    end","complexity_score":7.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"BizzleApp\"]}]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"base should be BizzleApp\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"bizzle\"]}]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"base should have already extended BizzleExtension\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"bizzle_option\"]},{\"type\":\"str\",\"children\":[\"bizzle!\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/haml_test.rb","start_line":7,"raw_source":"def haml_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"haml_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":6,"raw_source":"def test_default\n    assert true\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":10,"raw_source":"def status_app(code, &block)\n    code += 2 if [204, 304].include? code\n    block ||= proc { }\n    mock_app do\n      get('/') do\n        status code\n        instance_eval(&block).inspect\n      end\n    end\n    get '/'\n  end","complexity_score":25.13,"ast_json":"{\"type\":\"def\",\"children\":[\"status_app\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"code\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[204]},{\"type\":\"int\",\"children\":[304]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"inspect\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":761,"raw_source":"def attachment_app(filename=nil)\n      mock_app do\n        get('/attachment') do\n          attachment filename\n          response.write(\"<sinatra></sinatra>\")\n        end\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"attachment_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/attachment\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"attachment\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"write\",{\"type\":\"str\",\"children\":[\"<sinatra></sinatra>\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":818,"raw_source":"def teardown\n      File.unlink @file\n      @file = nil\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"unlink\",{\"type\":\"ivar\",\"children\":[\"@file\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@file\",{\"type\":\"nil\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":823,"raw_source":"def send_file_app(opts={})\n      path = @file\n      mock_app {\n        get '/file.txt' do\n          send_file path, opts\n        end\n      }\n    end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"send_file_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"ivar\",\"children\":[\"@file\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/file.txt\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send_file\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1012,"raw_source":"def obj.method_missing(*a, &b) 60.send(*a, &b) end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"obj\"]},\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]},{\"type\":\"blockarg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[60]},\"send\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1013,"raw_source":"def obj.is_a?(thing) 60.is_a?(thing) end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"obj\"]},\"is_a?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"thing\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[60]},\"is_a?\",{\"type\":\"lvar\",\"children\":[\"thing\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1944,"raw_source":"module ::HelperOne; def one; '1'; end; end","complexity_score":0.0,"ast_json":"{\"type\":\"module\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"HelperOne\"]},{\"type\":\"def\",\"children\":[\"one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1945,"raw_source":"module ::HelperTwo; def two; '2'; end; end","complexity_score":0.0,"ast_json":"{\"type\":\"module\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"HelperTwo\"]},{\"type\":\"def\",\"children\":[\"two\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1967,"raw_source":"def foo\n            'foo'\n          end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1998,"raw_source":"def one; nil end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":1999,"raw_source":"def two; nil end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"two\",{\"type\":\"args\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2003,"raw_source":"def two; '2' end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"two\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"2\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2018,"raw_source":"def my_test\n        'BaseHelper#test'\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"my_test\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"BaseHelper#test\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2031,"raw_source":"def my_test\n          'InlineHelper#test'\n        end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"my_test\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"InlineHelper#test\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2045,"raw_source":"def self.included(base)\n        base.extend(ClassMethods)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ClassMethods\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2050,"raw_source":"def nickname(name)\n          # do something.\n        end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"nickname\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":10,"raw_source":"def test_flattened_constructor\n    hash = Sinatra::IndifferentHash[:a, 1, ?b, 2]\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_flattened_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":16,"raw_source":"def test_pairs_constructor\n    hash = Sinatra::IndifferentHash[[[:a, 1], [?b, 2]]]\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pairs_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":22,"raw_source":"def test_default_block\n    hash = Sinatra::IndifferentHash.new { |h, k| h[k] = k.upcase }\n    assert_nil hash.default\n    assert_equal ?A, hash.default(:a)\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":28,"raw_source":"def test_default_object\n    hash = Sinatra::IndifferentHash.new({:a=>1, ?b=>2})\n    assert_equal({ :a=>1, ?b=>2 }, hash.default)\n    assert_equal({ :a=>1, ?b=>2 }, hash[:a])\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":34,"raw_source":"def test_default_assignment\n    hash = Sinatra::IndifferentHash.new\n    hash.default = { :a=>1, ?b=>2 }\n    assert_equal({ ?a=>1, ?b=>2 }, hash.default)\n    assert_equal({ ?a=>1, ?b=>2 }, hash[:a])\n  end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_assignment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default=\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":41,"raw_source":"def test_assignment\n    hash = Sinatra::IndifferentHash.new\n    hash[:a] = :a\n    hash[?b] = :b\n    hash[3] = 3\n    hash[:simple_nested] = { :a=>:a, ?b=>:b }\n\n    assert_equal :a, hash[?a]\n    assert_equal :b, hash[?b]\n    assert_equal 3, hash[3]\n    assert_equal({ ?a=>:a, ?b=>:b }, hash['simple_nested'])\n    assert_nil hash[?d]\n  end","complexity_score":18.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assignment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":55,"raw_source":"def test_merge!\n    # merge! is already mostly tested by the different constructors, so we\n    # really just need to test the block form here\n    hash = Sinatra::IndifferentHash[:a=>'a', ?b=>'b', 3=>3]\n    hash.merge!(?a=>'A', :b=>'B', :d=>'D') do |key, oldval, newval|\n      \"#{oldval}*#{key}*#{newval}\"\n    end\n\n    assert_equal({ ?a=>'a*a*A', ?b=>'b*b*B', 3=>3, ?d=>'D' }, hash)\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"B\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"oldval\"]},{\"type\":\"arg\",\"children\":[\"newval\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"oldval\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newval\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a*a*A\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"b*b*B\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":68,"raw_source":"def setup\n    @hash = Sinatra::IndifferentHash[:a=>:a, ?b=>:b, 3=>3,\n      :simple_nested=>{ :a=>:a, ?b=>:b },\n      :nested=>{ :a=>[{ :a=>:a, ?b=>:b }, :c, 4], ?f=>:f, 7=>7 }\n    ]\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"sym\",\"children\":[\"f\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":75,"raw_source":"def test_hash_constructor\n    assert_equal :a, @hash[?a]\n    assert_equal :b, @hash[?b]\n    assert_equal 3, @hash[3]\n    assert_equal({ ?a=>:a, ?b=>:b }, @hash['nested'][?a][0])\n    assert_equal :c, @hash['nested'][?a][1]\n    assert_equal 4, @hash['nested'][?a][2]\n    assert_equal :f, @hash['nested'][?f]\n    assert_equal 7, @hash['nested'][7]\n    assert_equal :a, @hash['simple_nested'][?a]\n    assert_equal :b, @hash['simple_nested'][?b]\n    assert_nil @hash[?d]\n  end","complexity_score":41.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"f\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":89,"raw_source":"def test_assoc\n    assert_nil @hash.assoc(:d)\n    assert_equal [?a, :a], @hash.assoc(:a)\n    assert_equal [?b, :b], @hash.assoc(:b)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":95,"raw_source":"def test_rassoc\n    assert_nil @hash.rassoc(:d)\n    assert_equal [?a, :a], @hash.rassoc(:a)\n    assert_equal [?b, :b], @hash.rassoc(:b)\n    assert_equal ['simple_nested', { ?a=>:a, ?b=>:b }], @hash.rassoc(:a=>:a, ?b=>:b)\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rassoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":102,"raw_source":"def test_fetch\n    assert_raises(KeyError) { @hash.fetch(:d) }\n    assert_equal 1, @hash.fetch(:d, 1)\n    assert_equal 2, @hash.fetch(:d) { 2 }\n    assert_equal ?d, @hash.fetch(:d) { |k| k }\n    assert_equal :a, @hash.fetch(:a, 1)\n    assert_equal :a, @hash.fetch(:a) { 2 }\n  end","complexity_score":19.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":111,"raw_source":"def test_symbolic_retrieval\n    assert_equal :a, @hash[:a]\n    assert_equal :b, @hash[:b]\n    assert_equal({ ?a=>:a, ?b=>:b }, @hash[:nested][:a][0])\n    assert_equal :c, @hash[:nested][:a][1]\n    assert_equal 4, @hash[:nested][:a][2]\n    assert_equal :f, @hash[:nested][:f]\n    assert_equal 7, @hash[:nested][7]\n    assert_equal :a, @hash[:simple_nested][:a]\n    assert_equal :b, @hash[:simple_nested][:b]\n    assert_nil @hash[:d]\n  end","complexity_score":38.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_symbolic_retrieval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"f\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":124,"raw_source":"def test_key\n    assert_nil @hash.key(:d)\n    assert_equal ?a, @hash.key(:a)\n    assert_equal 'simple_nested', @hash.key(:a=>:a, ?b=>:b)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":130,"raw_source":"def test_key?\n    assert_operator @hash, :key?, :a\n    assert_operator @hash, :key?, ?b\n    assert_operator @hash, :key?, 3\n    refute_operator @hash, :key?, :d\n  end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":137,"raw_source":"def test_value?\n    assert_operator @hash, :value?, :a\n    assert_operator @hash, :value?, :b\n    assert_operator @hash, :value?, 3\n    assert_operator @hash, :value?, { :a=>:a, ?b=>:b }\n    refute_operator @hash, :value?, :d\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_value?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":145,"raw_source":"def test_delete\n    @hash.delete(:a)\n    @hash.delete(?b)\n    assert_nil @hash[:a]\n    assert_nil @hash[?b]\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delete\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"delete\",{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":152,"raw_source":"def test_dig\n    assert_equal :a, @hash.dig(:a)\n    assert_equal :b, @hash.dig(?b)\n    assert_nil @hash.dig(:d)\n\n    assert_equal :a, @hash.dig(:simple_nested, :a)\n    assert_equal :b, @hash.dig('simple_nested', ?b)\n    assert_nil @hash.dig('simple_nested', :d)\n\n    assert_equal :a, @hash.dig(:nested, :a, 0, :a)\n    assert_equal :b, @hash.dig('nested', ?a, 0, ?b)\n    assert_nil @hash.dig('nested', ?a, 0, :d)\n  end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dig\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":166,"raw_source":"def test_slice\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash.slice(:a)\n    assert_equal Sinatra::IndifferentHash[b: :b], @hash.slice(?b)\n    assert_equal Sinatra::IndifferentHash[3 => 3], @hash.slice(3)\n    assert_equal Sinatra::IndifferentHash.new, @hash.slice(:d)\n    assert_equal Sinatra::IndifferentHash[a: :a, b: :b, 3 => 3], @hash.slice(:a, :b, 3)\n    assert_equal Sinatra::IndifferentHash[simple_nested: { a: :a, ?b => :b }], @hash.slice(:simple_nested)\n    assert_equal Sinatra::IndifferentHash[nested: { a: [{ a: :a, ?b => :b }, :c, 4], ?f => :f, 7 => 7 }], @hash.slice(:nested)\n  end","complexity_score":26.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"sym\",\"children\":[\"f\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"nested\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":176,"raw_source":"def test_fetch_values\n    assert_raises(KeyError) { @hash.fetch_values(3, :d) }\n    assert_equal [:a, :b, 3, ?D], @hash.fetch_values(:a, ?b, 3, :d) { |k| k.upcase }\n  end","complexity_score":8.78,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch_values\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"str\",\"children\":[\"D\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch_values\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":181,"raw_source":"def test_values_at\n    assert_equal [:a, :b, 3, nil], @hash.values_at(:a, ?b, 3, :d)\n  end","complexity_score":2.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_values_at\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"values_at\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":185,"raw_source":"def test_merge\n    # merge just calls merge!, which is already thoroughly tested\n    hash2 = @hash.merge(?a=>1, :q=>2) { |key, oldval, newval| \"#{oldval}*#{key}*#{newval}\" }\n\n    refute_equal @hash, hash2\n    assert_equal 'a*a*1', hash2[:a]\n    assert_equal 2, hash2[?q]\n  end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"oldval\"]},{\"type\":\"arg\",\"children\":[\"newval\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"oldval\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newval\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a*a*1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"q\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":194,"raw_source":"def test_merge_with_multiple_argument\n    hash = Sinatra::IndifferentHash.new.merge({a: 1}, {b: 2}, {c: 3})\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n    assert_equal 3, hash[?c]\n\n    hash2 = Sinatra::IndifferentHash[d: 4]\n    hash3 = {e: 5}\n    hash.merge!(hash2, hash3)\n\n    assert_equal 4, hash[?d]\n    assert_equal 5, hash[?e]\n  end","complexity_score":21.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge_with_multiple_argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash3\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"e\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"lvar\",\"children\":[\"hash3\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"e\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":208,"raw_source":"def test_replace\n    @hash.replace(?a=>1, :q=>2)\n    assert_equal({ ?a=>1, ?q=>2 }, @hash)\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_replace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"replace\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":213,"raw_source":"def test_transform_values!\n    @hash.transform_values! { |v| v.is_a?(Hash) ? Hash[v.to_a] : v }\n\n    assert_instance_of Sinatra::IndifferentHash, @hash[:simple_nested]\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_values!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_values!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"to_a\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":219,"raw_source":"def test_transform_values\n    hash2 = @hash.transform_values { |v| v.respond_to?(:upcase) ? v.upcase : v }\n\n    refute_equal @hash, hash2\n    assert_equal :A, hash2[:a]\n    assert_equal :A, hash2[?a]\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_values\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"upcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":227,"raw_source":"def test_transform_keys!\n    @hash.transform_keys! { |k| k.respond_to?(:to_sym) ? k.to_sym : k }\n\n    assert_equal :a, @hash[:a]\n    assert_equal :a, @hash[?a]\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_keys!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_keys!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_sym\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_sym\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":234,"raw_source":"def test_transform_keys\n    hash2 = @hash.transform_keys { |k| k.respond_to?(:upcase) ? k.upcase : k }\n\n    refute_equal @hash, hash2\n    refute_operator hash2, :key?, :a\n    refute_operator hash2, :key?, ?a\n    assert_equal :a, hash2[:A]\n    assert_equal :a, hash2[?A]\n  end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_keys\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"upcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"A\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"A\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":244,"raw_source":"def test_select\n    hash = @hash.select { |k, v| v == :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n\n    hash2 = @hash.select { |k, v| true }\n    assert_equal @hash, hash2\n    assert_instance_of Sinatra::IndifferentHash, hash2\n\n    enum = @hash.select\n    assert_instance_of Enumerator, enum\n  end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_select\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"lvasgn\",\"children\":[\"enum\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Enumerator\"]},{\"type\":\"lvar\",\"children\":[\"enum\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":257,"raw_source":"def test_select!\n    @hash.select! { |k, v| v == :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_select!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":262,"raw_source":"def test_reject\n    hash = @hash.reject { |k, v| v != :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n\n    hash2 = @hash.reject { |k, v| false }\n    assert_equal @hash, hash2\n    assert_instance_of Sinatra::IndifferentHash, hash2\n\n    enum = @hash.reject\n    assert_instance_of Enumerator, enum\n  end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"lvasgn\",\"children\":[\"enum\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Enumerator\"]},{\"type\":\"lvar\",\"children\":[\"enum\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":275,"raw_source":"def test_reject!\n    @hash.reject! { |k, v| v != :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":280,"raw_source":"def test_compact\n    hash_with_nil_values = @hash.merge({?z => nil})\n    compacted_hash = hash_with_nil_values.compact\n    assert_equal @hash, compacted_hash\n    assert_instance_of Sinatra::IndifferentHash, compacted_hash\n\n    empty_hash = Sinatra::IndifferentHash.new\n    compacted_hash = empty_hash.compact\n    assert_equal empty_hash, compacted_hash\n\n    non_empty_hash = Sinatra::IndifferentHash[a: :a]\n    compacted_hash = non_empty_hash.compact\n    assert_equal non_empty_hash, compacted_hash\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash_with_nil_values\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"z\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash_with_nil_values\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"empty_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"empty_hash\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"empty_hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"non_empty_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"non_empty_hash\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"non_empty_hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":295,"raw_source":"def test_except\n    hash = @hash.except(?b, 3, :simple_nested, 'nested')\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n  end if Gem::Version.new(RUBY_VERSION) >= Gem::Version.new(\"3.0\")","complexity_score":4.4,"ast_json":"{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"3.0\"]}]}]},{\"type\":\"def\",\"children\":[\"test_except\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"except\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"str\",\"children\":[\"nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_async_helper.rb","start_line":6,"raw_source":"def it(message, &block)\n    Server.all_async.each do |server|\n      next unless server.installed?\n      super(\"with #{server.name}: #{message}\") { server.run_test(self, &block) }\n    end\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"it\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all_async\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"installed?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"name\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"run_test\",{\"type\":\"self\",\"children\":[]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_async_helper.rb","start_line":13,"raw_source":"def self.extend_object(obj)\n    super\n\n    base_port = 5100 + Process.pid % 100\n    servers = %w(puma)\n\n    servers.each_with_index do |server, index|\n      Server.run(server, base_port+index, async: true)\n    end\n  end","complexity_score":10.65,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extend_object\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"base_port\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[5100]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"pid\"]},\"%\",{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"servers\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"puma\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"each_with_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_port\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"async\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":12,"raw_source":"def self.all\n      @all ||= []\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"all\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@all\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":16,"raw_source":"def self.all_async\n      @all_async ||= []\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"all_async\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@all_async\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":20,"raw_source":"def self.each(&block)\n      all.each(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"all\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":24,"raw_source":"def self.run(server, port, async: false)\n      new(server, port, async).run\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"port\"]},{\"type\":\"kwoptarg\",\"children\":[\"async\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"lvar\",\"children\":[\"port\"]},{\"type\":\"lvar\",\"children\":[\"async\"]}]},\"run\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":28,"raw_source":"def app_file\n      File.expand_path('integration/app.rb', __dir__)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"integration/app.rb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":32,"raw_source":"def environment\n      \"development\"\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"development\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":36,"raw_source":"def initialize(server, port, async)\n      @installed, @pipe, @server, @port = nil, nil, server, port\n      ENV['PUMA_MIN_THREADS'] = '1' if server == 'puma'\n      if async\n        Server.all_async << self\n      else\n        Server.all << self\n      end\n    end","complexity_score":13.9,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"port\"]},{\"type\":\"arg\",\"children\":[\"async\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@installed\"]},{\"type\":\"ivasgn\",\"children\":[\"@pipe\"]},{\"type\":\"ivasgn\",\"children\":[\"@server\"]},{\"type\":\"ivasgn\",\"children\":[\"@port\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"lvar\",\"children\":[\"port\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"==\",{\"type\":\"str\",\"children\":[\"puma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PUMA_MIN_THREADS\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"async\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all_async\"]},\"<<\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all\"]},\"<<\",{\"type\":\"self\",\"children\":[]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":46,"raw_source":"def run\n      return unless installed?\n      kill\n      @log     = +\"\"\n      super\n      at_exit { kill }\n    end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"installed?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"kill\"]},{\"type\":\"ivasgn\",\"children\":[\"@log\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"at_exit\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"kill\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":54,"raw_source":"def installed?\n      return @installed unless @installed.nil?\n      s = server == 'HTTP' ? 'net/http/server' : server\n      require s\n      @installed = true\n    rescue LoadError\n      warn \"#{server} is not installed, skipping integration tests\"\n      @installed = false\n    end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"installed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@installed\"]},\"nil?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@installed\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP\"]}]},{\"type\":\"str\",\"children\":[\"net/http/server\"]},{\"type\":\"send\",\"children\":[null,\"server\"]}]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"lvar\",\"children\":[\"s\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@installed\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoadError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]}]},{\"type\":\"str\",\"children\":[\" is not installed, skipping integration tests\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@installed\",{\"type\":\"false\",\"children\":[]}]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":64,"raw_source":"def command\n      @command ||= begin\n        cmd = [\"APP_ENV=#{environment}\", \"exec\"]\n        if RbConfig.respond_to? :ruby\n          cmd << RbConfig.ruby.inspect\n        else\n          file, dir = RbConfig::CONFIG.values_at('ruby_install_name', 'bindir')\n          cmd << File.expand_path(file, dir).inspect\n        end\n        cmd << \"-w\" unless net_http_server?\n        cmd << \"-I\" << File.expand_path('../lib', __dir__).inspect\n        cmd << app_file.inspect << '-s' << server << '-o' << '127.0.0.1' << '-p' << port\n        cmd << \"-e\" << environment.to_s << '2>&1'\n        cmd.join \" \"\n      end\n    end","complexity_score":58.3,"ast_json":"{\"type\":\"def\",\"children\":[\"command\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@command\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cmd\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"APP_ENV=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]}]}]},{\"type\":\"str\",\"children\":[\"exec\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"ruby\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"ruby\"]},\"inspect\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file\"]},{\"type\":\"lvasgn\",\"children\":[\"dir\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"CONFIG\"]},\"values_at\",{\"type\":\"str\",\"children\":[\"ruby_install_name\"]},{\"type\":\"str\",\"children\":[\"bindir\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"lvar\",\"children\":[\"dir\"]}]},\"inspect\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"net_http_server?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-w\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-I\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"../lib\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},\"inspect\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_file\"]},\"inspect\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-s\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"server\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-o\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-p\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-e\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"2>&1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":81,"raw_source":"def webrick?\n      name.to_s == \"webrick\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"webrick?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"webrick\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":85,"raw_source":"def puma?\n      name.to_s == \"puma\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"puma?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"puma\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":89,"raw_source":"def falcon?\n      name.to_s == \"falcon\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"falcon?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"falcon\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":93,"raw_source":"def trinidad?\n      name.to_s == \"trinidad\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"trinidad?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"trinidad\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":97,"raw_source":"def net_http_server?\n      name.to_s == 'HTTP'\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"net_http_server?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":101,"raw_source":"def warnings\n      log.scan(%r[(?:\\(eval|lib/sinatra).*warning:.*$])\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"log\"]},\"scan\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(?:\\\\(eval|lib/sinatra).*warning:.*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":105,"raw_source":"def run_test(target, &block)\n      retries ||= 3\n      target.server = self\n      run unless alive?\n      target.instance_eval(&block)\n    rescue Exception => error\n      retries -= 1\n      kill\n      retries < 0 ? retry : raise(error)\n    end","complexity_score":22.93,"ast_json":"{\"type\":\"def\",\"children\":[\"run_test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"target\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"retries\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target\"]},\"server=\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alive?\"]},null,{\"type\":\"send\",\"children\":[null,\"run\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target\"]},\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"error\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"retries\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"kill\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"retries\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"retry\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"error\"]}]}]}]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":119,"raw_source":"def it(message, &block)\n    Server.each do |server|\n      next unless server.installed?\n      super(\"with #{server.name}: #{message}\") { server.run_test(self, &block) }\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"it\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"installed?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"name\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"run_test\",{\"type\":\"self\",\"children\":[]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":126,"raw_source":"def self.extend_object(obj)\n    super\n\n    base_port = 5000 + Process.pid % 100\n    servers = Sinatra::Base.server.dup\n\n    # TruffleRuby doesn't support `Fiber.set_scheduler` yet\n    unsupported_truffleruby = RUBY_ENGINE == \"truffleruby\" && !Fiber.respond_to?(:set_scheduler)\n    # Ruby 2.7 uses falcon 0.42.3 which isn't working with rackup 2.2.0+\n    too_old_ruby = RUBY_VERSION <= \"3.0.0\"\n\n    if unsupported_truffleruby || too_old_ruby\n      warn \"skip falcon server\"\n      servers.delete('falcon')\n    end\n\n    servers.each_with_index do |server, index|\n      Server.run(server, base_port+index)\n    end\n  end","complexity_score":24.75,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extend_object\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"base_port\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[5000]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"pid\"]},\"%\",{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"servers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"server\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"unsupported_truffleruby\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},\"==\",{\"type\":\"str\",\"children\":[\"truffleruby\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Fiber\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"set_scheduler\"]}]},\"!\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"too_old_ruby\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]},\"<=\",{\"type\":\"str\",\"children\":[\"3.0.0\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unsupported_truffleruby\"]},{\"type\":\"lvar\",\"children\":[\"too_old_ruby\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"skip falcon server\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"falcon\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"each_with_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_port\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"index\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":6,"raw_source":"def command_for(app_file)\n    [\n      \"ruby\",\n      app_file,\n      \"-p\",\n      \"0\", # any free port\n      \"-s\",\n      \"puma\",\n    ]\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"command_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app_file\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ruby\"]},{\"type\":\"lvar\",\"children\":[\"app_file\"]},{\"type\":\"str\",\"children\":[\"-p\"]},{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"-s\"]},{\"type\":\"str\",\"children\":[\"puma\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":17,"raw_source":"def with_process(command:, env: {}, debug: false)\n    process = ChildProcess.build(*command)\n    process.leader = true # ensure entire process tree dies\n    process.environment.merge!(env)\n    read_io, write_io = IO.pipe\n    process.io.stdout = write_io\n    process.io.stderr = write_io\n    process.start\n    # Close parent's copy of the write end of the pipe so when the (forked) child\n    # process closes its write end of the pipe the parent receives EOF when\n    # attempting to read from it. If the parent leaves its write end open, it\n    # will not detect EOF.\n    write_io.close\n\n    echo_output(read_io) if debug || debug_all?\n\n    yield process, read_io\n  ensure\n    read_io.close\n    process.stop\n  end","complexity_score":24.6,"ast_json":"{\"type\":\"def\",\"children\":[\"with_process\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"command\"]},{\"type\":\"kwoptarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"debug\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"process\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ChildProcess\"]},\"build\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"leader=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"environment\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"read_io\"]},{\"type\":\"lvasgn\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IO\"]},\"pipe\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"io\"]},\"stdout=\",{\"type\":\"lvar\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"io\"]},\"stderr=\",{\"type\":\"lvar\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"write_io\"]},\"close\"]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"debug\"]},{\"type\":\"send\",\"children\":[null,\"debug_all?\"]}]},{\"type\":\"send\",\"children\":[null,\"echo_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]}]},null]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},{\"type\":\"lvar\",\"children\":[\"read_io\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"close\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"stop\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":39,"raw_source":"def echo_output(read_io)\n    Thread.new do\n      begin\n        loop { print read_io.readpartial(8192) }\n      rescue EOFError\n      end\n    end\n  end","complexity_score":8.73,"ast_json":"{\"type\":\"def\",\"children\":[\"echo_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"readpartial\",{\"type\":\"int\",\"children\":[8192]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]}]},null,null]},null]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":48,"raw_source":"def debug_all?\n    ENV.key?(\"DEBUG_START_PROCESS\")\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"debug_all?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"key?\",{\"type\":\"str\",\"children\":[\"DEBUG_START_PROCESS\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":52,"raw_source":"def wait_timeout\n    case RUBY_ENGINE\n    when \"jruby\", \"truffleruby\"\n      # takes some time to start the JVM\n      10.0\n    else\n      3.0\n    end\n  end","complexity_score":2.68,"ast_json":"{\"type\":\"def\",\"children\":[\"wait_timeout\",{\"type\":\"args\",\"children\":[]},{\"type\":\"case\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"jruby\"]},{\"type\":\"str\",\"children\":[\"truffleruby\"]},{\"type\":\"float\",\"children\":[10.0]}]},{\"type\":\"float\",\"children\":[3.0]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":62,"raw_source":"def wait_for_output(read_io, matcher, timeout = wait_timeout)\n    return true if read_io.expect(matcher, timeout).to_a.any?\n\n    raise \"Waited for #{timeout} seconds, but received no output matching: \" \\\n          \"#{matcher.source}\"\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"wait_for_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"read_io\"]},{\"type\":\"arg\",\"children\":[\"matcher\"]},{\"type\":\"optarg\",\"children\":[\"timeout\",{\"type\":\"send\",\"children\":[null,\"wait_timeout\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"expect\",{\"type\":\"lvar\",\"children\":[\"matcher\"]},{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},\"to_a\"]},\"any?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Waited for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},{\"type\":\"str\",\"children\":[\" seconds, but received no output matching: \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matcher\"]},\"source\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":6,"raw_source":"def test_app_start_without_rackup\n    # Why we skip head versions: The Gemfile used here would have to support\n    # the ENVs and we would need to bundle before starting the app\n    #\n    # Example from locally playing with this:\n    #\n    #   root@df8b1e7cb106:/app# rack_session=head BUNDLE_GEMFILE=./test/integration/gemfile_without_rackup.rb ruby ./test/integration/simple_app.rb -p 0 -s puma\n    #   The git source https://github.com/rack/rack-session.git is not yet checked out. Please run `bundle install` before trying to start your application\n    #\n    # Using bundler/inline is an idea, but it would add to the startup time\n    skip \"So much work to run with rack head branch\" if ENV['rack'] == 'head'\n    skip \"So much work to run with rack-session head branch\" if ENV['rack_session'] == 'head'\n\n    app_file = File.join(__dir__, \"integration\", \"simple_app.rb\")\n    gem_file = File.join(__dir__, \"integration\", \"gemfile_without_rackup.rb\")\n    command = command_for(app_file)\n    env = { \"BUNDLE_GEMFILE\" => gem_file }\n\n    with_process(command: command, env: env) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra could not start, the required gems weren't found/)\n    end\n  end","complexity_score":22.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_app_start_without_rackup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"head\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"So much work to run with rack head branch\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack_session\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"head\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"So much work to run with rack-session head branch\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"simple_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"gem_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"gemfile_without_rackup.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"BUNDLE_GEMFILE\"]},{\"type\":\"lvar\",\"children\":[\"gem_file\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra could not start, the required gems weren't found\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":29,"raw_source":"def test_classic_app_start\n    app_file = File.join(__dir__, \"integration\", \"simple_app.rb\")\n    command = command_for(app_file)\n    with_process(command: command) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra \\(v.+\\) has taken the stage/)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_classic_app_start\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"simple_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra \\\\(v.+\\\\) has taken the stage\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":37,"raw_source":"def test_classic_app_with_zeitwerk\n    app_file = File.join(__dir__, \"integration\", \"zeitwerk_app.rb\")\n    command = command_for(app_file)\n    with_process(command: command) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra \\(v.+\\) has taken the stage/)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_classic_app_with_zeitwerk\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"zeitwerk_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra \\\\(v.+\\\\) has taken the stage\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/liquid_test.rb","start_line":7,"raw_source":"def liquid_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/mapped_error_test.rb","start_line":10,"raw_source":"def http_status; 501 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"http_status\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[501]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/mapped_error_test.rb","start_line":14,"raw_source":"def code; 4000 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"code\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[4000]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/mapped_error_test.rb","start_line":18,"raw_source":"def code; 419 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"code\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[419]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/mapped_error_test.rb","start_line":25,"raw_source":"def test_default\n    assert true\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markaby_test.rb","start_line":7,"raw_source":"def markaby_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"markaby_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markdown_test.rb","start_line":4,"raw_source":"def markdown_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"markdown_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markdown_test.rb","start_line":12,"raw_source":"def setup\n    Tilt.prefer engine, 'markdown', 'mkd', 'md'\n    super\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"prefer\",{\"type\":\"send\",\"children\":[null,\"engine\"]},{\"type\":\"str\",\"children\":[\"markdown\"]},{\"type\":\"str\",\"children\":[\"mkd\"]},{\"type\":\"str\",\"children\":[\"md\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":16,"raw_source":"def call(env)\n      (env['test.ran'] ||= []) << self.class.to_s\n      app.call(env)\n    end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test.ran\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":23,"raw_source":"def call(env)\n      env['PATH_INFO'] = env['PATH_INFO'].upcase\n      super\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"upcase\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":37,"raw_source":"def call(env)\n      env['PATH_INFO'] = env['PATH_INFO'].downcase\n      super\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"downcase\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":70,"raw_source":"def call(env)\n      req = Rack::Request.new(env)\n      req.update_param('bar', 'baz'.freeze)\n      super\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"req\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"baz\"]},\"freeze\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":83,"raw_source":"def call(env)\n      req = Rack::Request.new(env)\n      req.update_param('s', :s)\n      req.update_param('i', 1)\n      req.update_param('c', 3.to_c)\n      req.update_param('t', true)\n      req.update_param('f', false)\n      req.update_param('n', nil)\n      super\n    end","complexity_score":9.85,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"req\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"sym\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"i\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[3]},\"to_c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"t\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"n\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":101,"raw_source":"def initialize(app, **)\n      super app\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"kwrestarg\",\"children\":[]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/nokogiri_test.rb","start_line":7,"raw_source":"def nokogiri_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"nokogiri_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rabl_test.rb","start_line":11,"raw_source":"def rabl_app(&block)\n    mock_app {\n      set :views, __dir__ + '/views'\n      get '/', &block\n    }\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"rabl_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rack_test.rb","start_line":10,"raw_source":"def build(*middleware)\n    endpoint = middleware.pop\n    @app = Rack::Builder.app do\n      middleware.each { |m| use m }\n      run endpoint\n    end\n  end","complexity_score":9.9,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"middleware\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"endpoint\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"pop\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"endpoint\"]}]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rack_test.rb","start_line":18,"raw_source":"def check(*middleware)\n    build(*middleware)\n    assert get('/foo').ok?\n    assert_body 'foo'\n    assert get('/bar').ok?\n    assert_body 'bar'\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"check\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"middleware\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"build\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/foo\"]}]},\"ok?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_body\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/bar\"]}]},\"ok?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_body\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rdoc_test.rb","start_line":8,"raw_source":"def rdoc_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"rdoc_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/response_test.rb","start_line":6,"raw_source":"def assert_same_body(a, b)\n    assert_equal a.to_enum(:each).to_a, b.to_enum(:each).to_a\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_same_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_enum\",{\"type\":\"sym\",\"children\":[\"each\"]}]},\"to_a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_enum\",{\"type\":\"sym\",\"children\":[\"each\"]}]},\"to_a\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/response_test.rb","start_line":58,"raw_source":"def object.inject(*) fail 'called' end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"object\"]},\"inject\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"called\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/response_test.rb","start_line":59,"raw_source":"def object.to_ary(*) fail 'called' end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"object\"]},\"to_ary\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"called\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/response_test.rb","start_line":60,"raw_source":"def object.each(*) end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"object\"]},\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/result_test.rb","start_line":4,"raw_source":"def http_status; 400 end","complexity_score":0.25,"ast_json":"{\"type\":\"def\",\"children\":[\"http_status\",{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[400]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/result_test.rb","start_line":28,"raw_source":"def res.each ; yield call ; end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"res\"]},\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"call\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/route_added_hook_test.rb","start_line":5,"raw_source":"def self.routes ; @routes ; end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"routes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@routes\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/route_added_hook_test.rb","start_line":6,"raw_source":"def self.procs ; @procs ; end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"procs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@procs\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/route_added_hook_test.rb","start_line":7,"raw_source":"def self.route_added(verb, path, proc)\n    @routes << [verb, path]\n    @procs << proc\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"route_added\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"proc\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@routes\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@procs\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"proc\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":4,"raw_source":"def route_def(pattern)\n  mock_app { get(pattern) { } }\nend","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"route_def\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"args\",\"children\":[]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":9,"raw_source":"def to_pattern(*)\n    self\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"to_pattern\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"self\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":13,"raw_source":"def params(input)\n    { \"one\" => +\"this\", \"two\" => +\"is\", \"three\" => +\"a\", \"four\" => +\"test\" }\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"this\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"two\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"is\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},\"+@\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":1510,"raw_source":"def protect(*args)\n        condition {\n          unless authorize(params[\"user\"], params[\"password\"])\n            halt 403, \"go away\"\n          end\n        }\n      end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"protect\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"authorize\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"params\"]},\"[]\",{\"type\":\"str\",\"children\":[\"user\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"params\"]},\"[]\",{\"type\":\"str\",\"children\":[\"password\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[403]},{\"type\":\"str\",\"children\":[\"go away\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":1523,"raw_source":"def authorize(username, password)\n          username == \"foo\" && password == \"bar\"\n        end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"authorize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"username\"]},{\"type\":\"arg\",\"children\":[\"password\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"username\"]},\"==\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"password\"]},\"==\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/sass_test.rb","start_line":7,"raw_source":"def sass_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sass_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/scss_test.rb","start_line":7,"raw_source":"def scss_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"scss_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":8,"raw_source":"def self.assertions\n      @assertions ||= 0\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"assertions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@assertions\"]},{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":12,"raw_source":"def self.assertions= assertions\n      @assertions = assertions\n    end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"assertions=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"assertions\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@assertions\",{\"type\":\"lvar\",\"children\":[\"assertions\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":16,"raw_source":"def self.run(app, options={})\n      assert(app < Sinatra::Base)\n      assert_equal 9001, options[:Port]\n      assert_equal 'foo.local', options[:Host]\n      yield new\n    end","complexity_score":9.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9001]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"Port\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo.local\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"Host\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":23,"raw_source":"def stop\n    end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"stop\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":40,"raw_source":"def teardown\n    $stderr = STDERR\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown\",{\"type\":\"args\",\"children\":[]},{\"type\":\"gvasgn\",\"children\":[\"$stderr\",{\"type\":\"const\",\"children\":[null,\"STDERR\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":50,"raw_source":"def self.start_hook; end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"start_hook\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":51,"raw_source":"def self.stop_hook; end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"stop_hook\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":96,"raw_source":"def initialize(app)\n        @@initialized = true\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"cvasgn\",\"children\":[\"@@initialized\",{\"type\":\"true\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":99,"raw_source":"def self.initialized\n        @@initialized\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"initialized\",{\"type\":\"args\",\"children\":[]},{\"type\":\"cvar\",\"children\":[\"@@initialized\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":102,"raw_source":"def call(env)\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":106,"raw_source":"def foo\n        @foo\n      end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@foo\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":109,"raw_source":"def foo=(value)\n        @foo = 'oops'\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"foo=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@foo\",{\"type\":\"str\",\"children\":[\"oops\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":458,"raw_source":"def priv; end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"priv\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":460,"raw_source":"def pub; end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"pub\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":580,"raw_source":"def self.track\n        Rack.send :remove_const, :Builder\n        Rack.const_set :Builder, MiddlewareTracker\n        MiddlewareTracker.used.clear\n        yield\n      ensure\n        Rack.send :remove_const, :Builder\n        Rack.const_set :Builder, MiddlewareTracker.superclass\n      end","complexity_score":13.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"track\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_const\"]},{\"type\":\"sym\",\"children\":[\"Builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"const_set\",{\"type\":\"sym\",\"children\":[\"Builder\"]},{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"used\"]},\"clear\"]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_const\"]},{\"type\":\"sym\",\"children\":[\"Builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"const_set\",{\"type\":\"sym\",\"children\":[\"Builder\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"superclass\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":590,"raw_source":"def self.used\n        @used ||= []\n      end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"used\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@used\"]},{\"type\":\"array\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":594,"raw_source":"def use(middleware, *)\n        MiddlewareTracker.used << middleware\n        super\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"used\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"middleware\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/slim_test.rb","start_line":7,"raw_source":"def slim_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"slim_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/static_test.rb","start_line":106,"raw_source":"def assert_valid_range(http_range, range, path, file)\n    request = Rack::MockRequest.new(@app)\n    response = request.get(\"/#{File.basename(path)}\", 'HTTP_RANGE' => http_range)\n\n    should_be = file[range]\n    expected_range = \"bytes #{range.begin}-#{range.end}/#{file.length}\"\n\n    assert_equal(\n      206,response.status,\n      \"Should be HTTP/1.1 206 Partial content\"\n    )\n    assert_equal(\n      should_be.length,\n      response.body.length,\n      \"Unexpected response length for #{http_range}\"\n    )\n    assert_equal(\n      should_be,\n      response.body,\n      \"Unexpected response data for #{http_range}\"\n    )\n    assert_equal(\n      should_be.length.to_s,\n      response['Content-Length'],\n      \"Incorrect Content-Length for #{http_range}\"\n    )\n    assert_equal(\n      expected_range,\n      response['Content-Range'],\n      \"Incorrect Content-Range for #{http_range}\"\n    )\n  end","complexity_score":27.7,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_valid_range\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http_range\"]},{\"type\":\"arg\",\"children\":[\"range\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"MockRequest\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@app\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"get\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"HTTP_RANGE\"]},{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"should_be\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"range\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_range\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"bytes \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"range\"]},\"begin\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"range\"]},\"end\"]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"length\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[206]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"status\"]},{\"type\":\"str\",\"children\":[\"Should be HTTP/1.1 206 Partial content\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"should_be\"]},\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"body\"]},\"length\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected response length for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"should_be\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"body\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected response data for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"should_be\"]},\"length\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Length\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Incorrect Content-Length for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected_range\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Range\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Incorrect Content-Range for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":70,"raw_source":"def initialize(*)     @schedule, @defer = [], []                end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@schedule\"]},{\"type\":\"ivasgn\",\"children\":[\"@defer\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[]},{\"type\":\"array\",\"children\":[]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":71,"raw_source":"def schedule(&block)  @schedule << block                        end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"schedule\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@schedule\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":72,"raw_source":"def defer(&block)     @defer    << block                        end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"defer\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@defer\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":73,"raw_source":"def schedule!(*)      @schedule.pop.call until @schedule.empty? end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"schedule!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@schedule\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@schedule\"]},\"pop\"]},\"call\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":74,"raw_source":"def defer!(*)         @defer.pop.call    until @defer.empty?    end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"defer!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@defer\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@defer\"]},\"pop\"]},\"call\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":131,"raw_source":"def close.callback; yield end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"close\"]},\"callback\",{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":132,"raw_source":"def close.errback; end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"close\"]},\"errback\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":5,"raw_source":"def prepare\n  end","complexity_score":0.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prepare\",{\"type\":\"args\",\"children\":[]},null]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":8,"raw_source":"def evaluate(scope, locals={}, &block)\n    inner = block ? block.call : ''\n    data + inner\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"scope\"]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"data\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"inner\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":17,"raw_source":"def render_app(base=Sinatra::Base, options = {}, &block)\n    base, options = Sinatra::Base, base if base.is_a? Hash\n    mock_app(base) do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n      template(:layout3) { \"Layout 3!\\n\" }\n    end\n    get '/'\n  end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"render_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\"]},{\"type\":\"lvasgn\",\"children\":[\"options\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},{\"type\":\"lvar\",\"children\":[\"base\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"sym\",\"children\":[\"layout3\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Layout 3!\\n\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":28,"raw_source":"def with_default_layout\n    layout = __dir__ + '/views/layout.test'\n    File.open(layout, 'wb') { |io| io.write \"Layout!\\n\" }\n    yield\n  ensure\n    File.unlink(layout) rescue nil\n  end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"with_default_layout\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views/layout.test\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"open\",{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"str\",\"children\":[\"wb\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"io\"]},\"write\",{\"type\":\"str\",\"children\":[\"Layout!\\n\"]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"unlink\",{\"type\":\"lvar\",\"children\":[\"layout\"]}]},{\"type\":\"resbody\",\"children\":[null,null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":363,"raw_source":"def some_scope.foo() 'World!' end","complexity_score":1.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"send\",\"children\":[null,\"some_scope\"]},\"foo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"World!\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":376,"raw_source":"def find_template(views, name, engine, &block)\n        Array(views).each { |v| super(v, name, engine, &block) }\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"views\"]},{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"views\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":40,"raw_source":"def assertions\n    @assertions ||= 0\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assertions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@assertions\"]},{\"type\":\"int\",\"children\":[0]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":48,"raw_source":"def include?(middleware)\n    @ins.any? { |m| middleware === m }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"include?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ins\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":63,"raw_source":"def self.example(desc = nil, &block)\n    @example_count = 0 unless instance_variable_defined? :@example_count\n    @example_count += 1\n    it(desc || \"Example #{@example_count}\", &block)\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"example\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"desc\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instance_variable_defined?\",{\"type\":\"sym\",\"children\":[\"@example_count\"]}]},null,{\"type\":\"ivasgn\",\"children\":[\"@example_count\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@example_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"desc\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Example \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@example_count\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":78,"raw_source":"def mock_app(base=Sinatra::Base, &block)\n    @app = Sinatra.new(base, &block)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":82,"raw_source":"def app\n    Rack::Lint.new(@app)\n  end","complexity_score":1.0,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Lint\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@app\"]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":86,"raw_source":"def body\n    response.body.to_s\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body\"]},\"to_s\"]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":90,"raw_source":"def assert_body(value)\n    if value.respond_to? :to_str\n      assert_equal value.lstrip.gsub(/\\s*\\n\\s*/, \"\"), body.lstrip.gsub(/\\s*\\n\\s*/, \"\")\n    else\n      assert_match value, body\n    end\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"lstrip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*\\\\n\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"lstrip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*\\\\n\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":98,"raw_source":"def assert_status(expected)\n    assert_equal Integer(expected), Integer(status)\n  end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_status\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expected\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"expected\"]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[null,\"status\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":102,"raw_source":"def assert_like(a,b)\n    pattern = /id=['\"][^\"']*[\"']|\\s+/\n    assert_equal a.strip.gsub(pattern, \"\"), b.strip.gsub(pattern, \"\")\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_like\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"id=['\\\"][^\\\"']*[\\\"']|\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"strip\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"strip\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":107,"raw_source":"def assert_include(str, substr)\n    assert str.include?(substr), \"expected #{str.inspect} to include #{substr.inspect}\"\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_include\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"arg\",\"children\":[\"substr\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"substr\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to include \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"substr\"]},\"inspect\"]}]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":111,"raw_source":"def options(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"OPTIONS\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":115,"raw_source":"def patch(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"PATCH\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"PATCH\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":119,"raw_source":"def link(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"LINK\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"LINK\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":123,"raw_source":"def unlink(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"UNLINK\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"UNLINK\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":128,"raw_source":"def method_missing(name, *args, &block)\n    if response && response.respond_to?(name)\n      response.send(name, *args, &block)\n    else\n      super\n    end\n  rescue Rack::Test::Error\n    super\n  end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]},null]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":139,"raw_source":"def silence_warnings\n    $VERBOSE, v = nil, $VERBOSE\n    yield\n  ensure\n    $VERBOSE = v\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"silence_warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$VERBOSE\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"gvar\",\"children\":[\"$VERBOSE\"]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"gvasgn\",\"children\":[\"$VERBOSE\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/yajl_test.rb","start_line":7,"raw_source":"def yajl_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"yajl_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}"}

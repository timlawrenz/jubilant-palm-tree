{"repo_name":"rubocop","file_path":"./repos/rubocop/lib/rubocop/cop/message_annotator.rb","start_line":111,"raw_source":"def extra_details?\n        options[:extra_details] || config.for_all_cops['ExtraDetails']\n      end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"extra_details?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"extra_details\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"config\"]},\"for_all_cops\"]},\"[]\",{\"type\":\"str\",\"children\":[\"ExtraDetails\"]}]}]}]}","id":"f19e56cd-64ad-4156-a6a0-d752f78cb1d5"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/app/services/ci/reset_skipped_jobs_service.rb","start_line":38,"raw_source":"def process(job)\n      Gitlab::OptimisticLocking.retry_lock(job, name: 'ci_requeue_job') do |job|\n        job.process(current_user)\n      end\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"process\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"job\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gitlab\"]},\"OptimisticLocking\"]},\"retry_lock\",{\"type\":\"lvar\",\"children\":[\"job\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"ci_requeue_job\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"job\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"job\"]},\"process\",{\"type\":\"send\",\"children\":[null,\"current_user\"]}]}]}]}","id":"b2183c2b-7784-4645-853b-9585122cfef0"}
{"repo_name":"rails","file_path":"./repos/rails/activerecord/test/cases/associations_test.rb","start_line":503,"raw_source":"def test_push_has_many_through_does_not_load_target\n    david = authors(:david)\n\n    david.categories << categories(:technology)\n    assert_not_predicate david.categories, :loaded?\n    assert_includes david.categories, categories(:technology)\n  end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_push_has_many_through_does_not_load_target\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"david\",{\"type\":\"send\",\"children\":[null,\"authors\",{\"type\":\"sym\",\"children\":[\"david\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"david\"]},\"categories\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"categories\",{\"type\":\"sym\",\"children\":[\"technology\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_not_predicate\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"david\"]},\"categories\"]},{\"type\":\"sym\",\"children\":[\"loaded?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"david\"]},\"categories\"]},{\"type\":\"send\",\"children\":[null,\"categories\",{\"type\":\"sym\",\"children\":[\"technology\"]}]}]}]}]}","id":"cf382e1b-2ad1-4b56-882d-e3ba7fa873cf"}
{"repo_name":"discourse","file_path":"./repos/discourse/app/models/category_list.rb","start_line":115,"raw_source":"def find_relevant_topics\n    featured_topics_by_category_id = Hash.new { |h, k| h[k] = [] }\n\n    relevant_topics_query.each do |t|\n      # hint for the serializer\n      t.include_last_poster = true\n      t.dismissed = dismissed_topic?(t)\n      featured_topics_by_category_id[t.category_featured_topic_category_id] << t\n    end\n\n    categories_with_descendants.each do |category|\n      category.displayable_topics = featured_topics_by_category_id[category.id]\n    end\n  end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"find_relevant_topics\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"featured_topics_by_category_id\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"relevant_topics_query\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"include_last_poster=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"dismissed=\",{\"type\":\"send\",\"children\":[null,\"dismissed_topic?\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"featured_topics_by_category_id\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"category_featured_topic_category_id\"]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"categories_with_descendants\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"category\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"category\"]},\"displayable_topics=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"featured_topics_by_category_id\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"category\"]},\"id\"]}]}]}]}]}]}","id":"fd7541b6-7f75-45e8-9330-5ec45feff6bb"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/lib/gitlab/gitaly_client.rb","start_line":411,"raw_source":"def self.token(storage)\n      params = Gitlab.config.repositories.storages[storage]\n      raise \"storage not found: #{storage.inspect}\" if params.nil?\n\n      params['gitaly_token'].presence || Gitlab.config.gitaly['token']\n    end","complexity_score":17.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"storage\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gitlab\"]},\"config\"]},\"repositories\"]},\"storages\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"storage\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"storage not found: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"storage\"]},\"inspect\"]}]}]}]},null]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"[]\",{\"type\":\"str\",\"children\":[\"gitaly_token\"]}]},\"presence\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gitlab\"]},\"config\"]},\"gitaly\"]},\"[]\",{\"type\":\"str\",\"children\":[\"token\"]}]}]}]}]}","id":"818291fc-115e-4a66-9383-7235ee43f760"}
{"repo_name":"fluentd","file_path":"./repos/fluentd/lib/fluent/plugin_helper/storage.rb","start_line":339,"raw_source":"def update(key, &block)\n          @monitor.synchronize do\n            v = block.call(@storage.get(key))\n            @storage.put(key, v)\n            v\n          end\n        end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"update\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@monitor\"]},\"synchronize\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@storage\"]},\"get\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@storage\"]},\"put\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}","id":"e88c4fd0-b1f0-41ea-a5de-175bac4b517e"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/lib/gitlab/database/migration_helpers.rb","start_line":976,"raw_source":"def replace_sql(column, pattern, replacement)\n        quoted_pattern = Arel::Nodes::Quoted.new(pattern.to_s)\n        quoted_replacement = Arel::Nodes::Quoted.new(replacement.to_s)\n\n        replace = Arel::Nodes::NamedFunction.new(\n          \"regexp_replace\", [column, quoted_pattern, quoted_replacement]\n        )\n\n        Arel::Nodes::SqlLiteral.new(replace.to_sql)\n      end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"replace_sql\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"column\"]},{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"replacement\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"quoted_pattern\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Arel\"]},\"Nodes\"]},\"Quoted\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"to_s\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"quoted_replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Arel\"]},\"Nodes\"]},\"Quoted\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"replacement\"]},\"to_s\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replace\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Arel\"]},\"Nodes\"]},\"NamedFunction\"]},\"new\",{\"type\":\"str\",\"children\":[\"regexp_replace\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"column\"]},{\"type\":\"lvar\",\"children\":[\"quoted_pattern\"]},{\"type\":\"lvar\",\"children\":[\"quoted_replacement\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Arel\"]},\"Nodes\"]},\"SqlLiteral\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"replace\"]},\"to_sql\"]}]}]}]}","id":"abbe2086-acf4-4e33-b633-2779edc5cdc6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":7,"raw_source":"def initialize(value)\n      super()\n      @value = value\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"95ad5eaf-4456-40de-ba5d-f419d76a165c"}
{"repo_name":"rails","file_path":"./repos/rails/activerecord/test/cases/autosave_association_test.rb","start_line":736,"raw_source":"def test_indexed_errors_on_base_attribute_should_be_properly_translated\n    I18n.backend.store_translations(\n      :en,\n      activerecord: {\n        attributes: {\n          person: {\n            reference: \"Super reference\",\n          },\n          reference: {\n            base: \"\"\n          }\n        }\n      }\n    )\n    reference = Class.new(ActiveRecord::Base) do\n      self.table_name = \"references\"\n      def self.name; \"Reference\"; end\n\n      validate :should_be_favorite\n      validates_presence_of :job_id\n\n      private\n        def should_be_favorite\n          errors.add(:base, \"should be favorite\") unless favorite?\n        end\n    end\n\n    person = Class.new(ActiveRecord::Base) do\n      self.table_name = \"people\"\n      def self.name; \"Person\"; end\n\n      has_one :reference, autosave: true, anonymous_class: reference\n      validates :reference, presence: true\n    end\n\n    p = person.new\n    assert_not_predicate p, :valid?\n    assert_equal [\"Super reference can't be blank\"], p.errors.full_messages\n\n    reference_invalid = reference.new(favorite: false)\n    p.reference = reference_invalid\n\n    assert_not_predicate reference_invalid, :valid?\n    assert_not_predicate p, :valid?\n    assert_equal [\" should be favorite\", \"Reference job can't be blank\"], p.errors.full_messages\n  ensure\n    I18n.backend = I18n::Backend::Simple.new\n  end","complexity_score":36.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_indexed_errors_on_base_attribute_should_be_properly_translated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"backend\"]},\"store_translations\",{\"type\":\"sym\",\"children\":[\"en\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"activerecord\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"attributes\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"person\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"reference\"]},{\"type\":\"str\",\"children\":[\"Super reference\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"reference\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"base\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"reference\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ActiveRecord\"]},\"Base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"table_name=\",{\"type\":\"str\",\"children\":[\"references\"]}]},{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Reference\"]}]},{\"type\":\"send\",\"children\":[null,\"validate\",{\"type\":\"sym\",\"children\":[\"should_be_favorite\"]}]},{\"type\":\"send\",\"children\":[null,\"validates_presence_of\",{\"type\":\"sym\",\"children\":[\"job_id\"]}]},{\"type\":\"send\",\"children\":[null,\"private\"]},{\"type\":\"def\",\"children\":[\"should_be_favorite\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"favorite?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"errors\"]},\"add\",{\"type\":\"sym\",\"children\":[\"base\"]},{\"type\":\"str\",\"children\":[\"should be favorite\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"person\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ActiveRecord\"]},\"Base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"table_name=\",{\"type\":\"str\",\"children\":[\"people\"]}]},{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Person\"]}]},{\"type\":\"send\",\"children\":[null,\"has_one\",{\"type\":\"sym\",\"children\":[\"reference\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"autosave\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"anonymous_class\"]},{\"type\":\"lvar\",\"children\":[\"reference\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"validates\",{\"type\":\"sym\",\"children\":[\"reference\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"presence\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"person\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_not_predicate\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"sym\",\"children\":[\"valid?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Super reference can't be blank\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"errors\"]},\"full_messages\"]}]},{\"type\":\"lvasgn\",\"children\":[\"reference_invalid\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reference\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"favorite\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"reference=\",{\"type\":\"lvar\",\"children\":[\"reference_invalid\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_not_predicate\",{\"type\":\"lvar\",\"children\":[\"reference_invalid\"]},{\"type\":\"sym\",\"children\":[\"valid?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_not_predicate\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"sym\",\"children\":[\"valid?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" should be favorite\"]},{\"type\":\"str\",\"children\":[\"Reference job can't be blank\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"errors\"]},\"full_messages\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"backend=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"Backend\"]},\"Simple\"]},\"new\"]}]}]}]}","id":"abb8ea50-438f-4b85-bec8-49d4d9fba075"}
{"repo_name":"rails","file_path":"./repos/rails/actionpack/lib/action_dispatch/routing/polymorphic_routes.rb","start_line":266,"raw_source":"def handle_class_call(target, klass)\n            target.public_send get_method_for_class klass\n          end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"handle_class_call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"target\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target\"]},\"public_send\",{\"type\":\"send\",\"children\":[null,\"get_method_for_class\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]}","id":"6159e356-1485-4160-9b43-d9b9aa6fb7fe"}
{"repo_name":"fastlane","file_path":"./repos/fastlane/fastlane/helper/plugin_scores_helper.rb","start_line":160,"raw_source":"def load_cache\n          if self.cache.key?(self.name)\n            cache_data = self.cache[self.name]\n          else\n            cache_data = {}\n          end\n\n          self.cache[self.name] = cache_data\n\n          if self.data[:sha] == cache_data[:sha]\n            self.data[:initial_commit] = cache_data[:initial_commit]\n            self.data[:age_in_days] = (DateTime.now - self.data[:initial_commit]).to_i\n            self.data[:readme_score] = cache_data[:readme_score]\n            self.data[:tests] = cache_data[:tests]\n            self.data[:actions] = cache_data[:actions]\n            self.data[:sha] = cache_data[:sha]\n\n            self.data[:github_stars] = cache_data[:github_stars]\n            self.data[:github_subscribers] = cache_data[:github_subscribers]\n            self.data[:github_issues] = cache_data[:github_issues]\n            self.data[:github_forks] = cache_data[:github_forks]\n            self.data[:github_contributors] = cache_data[:github_contributors]\n\n            return true\n          end\n\n          return false\n        end","complexity_score":65.1,"ast_json":"{\"type\":\"def\",\"children\":[\"load_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"cache\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"cache_data\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"cache\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"name\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cache_data\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"cache\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"name\"]},{\"type\":\"lvar\",\"children\":[\"cache_data\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"sha\"]}]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"sha\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"initial_commit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"initial_commit\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"age_in_days\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DateTime\"]},\"now\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"initial_commit\"]}]}]}]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"readme_score\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"readme_score\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"tests\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tests\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"actions\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"actions\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"sha\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"sha\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"github_stars\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"github_stars\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"github_subscribers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"github_subscribers\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"github_issues\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"github_issues\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"github_forks\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"github_forks\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"data\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"github_contributors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache_data\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"github_contributors\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]}]}","id":"ea1a8e33-f1b5-4b39-b27e-722e744ca0a1"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/scripts/internal_events/cli/helpers.rb","start_line":24,"raw_source":"def new_page!(on_step: nil, steps: [])\n      cli.say TTY::Cursor.clear_screen\n      cli.say TTY::Cursor.move_to(0, 0)\n      cli.say \"#{progress_bar(on_step, steps)}\\n\" if on_step && steps&.any?\n    end","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"new_page!\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"on_step\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"steps\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cli\"]},\"say\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TTY\"]},\"Cursor\"]},\"clear_screen\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cli\"]},\"say\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TTY\"]},\"Cursor\"]},\"move_to\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"on_step\"]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"steps\"]},\"any?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cli\"]},\"say\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"progress_bar\",{\"type\":\"lvar\",\"children\":[\"on_step\"]},{\"type\":\"lvar\",\"children\":[\"steps\"]}]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},null]}]}]}","id":"050d98e2-d71e-4b4c-85e9-dc7e40ebcf42"}
{"repo_name":"spree","file_path":"./repos/spree/core/app/models/spree/digital_link.rb","start_line":30,"raw_source":"def expired?\n      if line_item.order.store.preferred_limit_digital_download_days\n        created_at <= line_item.order.store.preferred_digital_asset_authorized_days.day.ago\n      else\n        false\n      end\n    end","complexity_score":19.4,"ast_json":"{\"type\":\"def\",\"children\":[\"expired?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_item\"]},\"order\"]},\"store\"]},\"preferred_limit_digital_download_days\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"created_at\"]},\"<=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_item\"]},\"order\"]},\"store\"]},\"preferred_digital_asset_authorized_days\"]},\"day\"]},\"ago\"]}]},{\"type\":\"false\",\"children\":[]}]}]}","id":"74a27642-f4df-49f7-b61e-04232f645fdf"}
{"repo_name":"discourse","file_path":"./repos/discourse/lib/theme_settings_manager.rb","start_line":10,"raw_source":"def self.cast_row_value(row)\n    type_name = self.types.invert[row.data_type].downcase.capitalize\n    klass = \"ThemeSettingsManager::#{type_name}\".constantize\n    klass.cast(klass.extract_value_from_row(row))\n  end","complexity_score":13.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"cast_row_value\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"row\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type_name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"types\"]},\"invert\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"row\"]},\"data_type\"]}]},\"downcase\"]},\"capitalize\"]}]},{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"ThemeSettingsManager::\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type_name\"]}]}]},\"constantize\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"cast\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"extract_value_from_row\",{\"type\":\"lvar\",\"children\":[\"row\"]}]}]}]}]}","id":"80211a36-4e9c-4989-b190-98d7b1e855ac"}
{"repo_name":"fastlane","file_path":"./repos/fastlane/spaceship/lib/spaceship/connect_api/provisioning/provisioning.rb","start_line":150,"raw_source":"def get_certificate(certificate_id: nil, includes: nil)\n          params = provisioning_request_client.build_params(filter: nil, includes: includes, limit: nil, sort: nil)\n          provisioning_request_client.get(\"#{Version::V1}/certificates/#{certificate_id}\", params)\n        end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"get_certificate\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"certificate_id\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"includes\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"provisioning_request_client\"]},\"build_params\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filter\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"includes\"]},{\"type\":\"lvar\",\"children\":[\"includes\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"limit\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"sort\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"provisioning_request_client\"]},\"get\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Version\"]},\"V1\"]}]},{\"type\":\"str\",\"children\":[\"/certificates/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"certificate_id\"]}]}]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]}","id":"6d54a2b6-5add-4aef-86ee-4f342741bdd1"}
{"repo_name":"rails","file_path":"./repos/rails/railties/test/generators/model_generator_test.rb","start_line":397,"raw_source":"def test_fixtures_respect_reserved_yml_keywords\n    run_generator [\"LineItem\", \"no:integer\", \"Off:boolean\", \"ON:boolean\"]\n\n    assert_generated_fixture(\"test/fixtures/line_items.yml\",\n                             \"one\" => { \"no\" => 1, \"Off\" => false, \"ON\" => false }, \"two\" => { \"no\" => 1, \"Off\" => false, \"ON\" => false })\n  end","complexity_score":2.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fixtures_respect_reserved_yml_keywords\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"run_generator\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"LineItem\"]},{\"type\":\"str\",\"children\":[\"no:integer\"]},{\"type\":\"str\",\"children\":[\"Off:boolean\"]},{\"type\":\"str\",\"children\":[\"ON:boolean\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_generated_fixture\",{\"type\":\"str\",\"children\":[\"test/fixtures/line_items.yml\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"no\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Off\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ON\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"two\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"no\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Off\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ON\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}]}]}","id":"9efc2286-a981-43fa-80f5-42286c43ee5d"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/lib/gitlab/ci/config/extendable/entry.rb","start_line":48,"raw_source":"def extends_keys\n            strong_memoize(:extends_keys) do\n              next unless extensible?\n\n              Array(value.fetch(:extends)).map(&:to_s).map(&:to_sym)\n            end\n          end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"extends_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strong_memoize\",{\"type\":\"sym\",\"children\":[\"extends_keys\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extensible?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"value\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"extends\"]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_sym\"]}]}]}]}]}]}","id":"cf9e4a58-15f8-41c6-8d96-4c6e4412af3e"}
{"repo_name":"gitlabhq","file_path":"./repos/gitlabhq/app/services/import/gitlab_projects/file_acquisition_strategies/remote_file.rb","start_line":33,"raw_source":"def file_url\n          @file_url ||= params[:remote_import_url]\n        end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"file_url\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@file_url\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"params\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"remote_import_url\"]}]}]}]}","id":"5fd2746b-d0ff-4a1d-9b9b-90b9a032d1f4"}
{"repo_name":"manageiq","file_path":"./repos/manageiq/spec/support/report_helper.rb","start_line":14,"raw_source":"def numeric_charts_2d_from_summaries(other)\n        report = MiqReport.new(\n          :db          => \"Vm\",\n          :sortby      => [\"ext_management_system.name\"],\n          :order       => \"Descending\",\n          :cols        => %w[name num_cpu],\n          :include     => {\"ext_management_system\" => {\"columns\" => [\"name\"]}},\n          :col_order   => %w[name num_cpu ext_management_system.name],\n          :headers     => [\"Name\", \"Number of CPUs\", \"Cloud/Infrastructure Provider Name\"],\n          :dims        => 1,\n          :group       => \"y\",\n          :rpt_options => {:summary => {:hide_detail_rows => false}},\n          :col_options => {\"num_cpu\" => {:grouping => %i[avg max min total]},\n                           \"name\"    => {:break_label => \"Cloud/Infrastructure Provider : Name: \"}},\n          :graph       => {:type => \"Column\", :mode => \"values\", :column => \"Vm-num_cpu:total\", :count => 2, :other => other},\n          :extras      => {}\n        )\n\n        report.table = Ruport::Data::Table.new(\n          :column_names => %w[name num_cpu ext_management_system.name id],\n          :data         => [\n            [\"bar\", 1, system_name_1 = 'blah', 352],\n            [\"foo\", 3, system_name_1,          353],\n            [\"pat\", 1, system_name_2 = 'bleh', 354],\n            [\"mat\", 1, system_name_2,          355],\n            [\"cuk\", 1, system_name_3 = 'blrg', 356],\n            [\"gek\", 2, system_name_3,          357],\n            [\"tik\", 1, system_name_4 = 'blud', 358],\n            [\"tak\", 1, system_name_4,          359],\n          ]\n        )\n        report\n      end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"numeric_charts_2d_from_summaries\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"report\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiqReport\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"db\"]},{\"type\":\"str\",\"children\":[\"Vm\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"sortby\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ext_management_system.name\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"order\"]},{\"type\":\"str\",\"children\":[\"Descending\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"cols\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"num_cpu\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ext_management_system\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"columns\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]}]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"col_order\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"num_cpu\"]},{\"type\":\"str\",\"children\":[\"ext_management_system.name\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"headers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Name\"]},{\"type\":\"str\",\"children\":[\"Number of CPUs\"]},{\"type\":\"str\",\"children\":[\"Cloud/Infrastructure Provider Name\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"dims\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"group\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"rpt_options\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"summary\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"hide_detail_rows\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"col_options\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"num_cpu\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"grouping\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"avg\"]},{\"type\":\"sym\",\"children\":[\"max\"]},{\"type\":\"sym\",\"children\":[\"min\"]},{\"type\":\"sym\",\"children\":[\"total\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"break_label\"]},{\"type\":\"str\",\"children\":[\"Cloud/Infrastructure Provider : Name: \"]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"graph\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"str\",\"children\":[\"Column\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"mode\"]},{\"type\":\"str\",\"children\":[\"values\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"column\"]},{\"type\":\"str\",\"children\":[\"Vm-num_cpu:total\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"count\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"other\"]},{\"type\":\"lvar\",\"children\":[\"other\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"extras\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"table=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ruport\"]},\"Data\"]},\"Table\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"column_names\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"num_cpu\"]},{\"type\":\"str\",\"children\":[\"ext_management_system.name\"]},{\"type\":\"str\",\"children\":[\"id\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"data\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvasgn\",\"children\":[\"system_name_1\",{\"type\":\"str\",\"children\":[\"blah\"]}]},{\"type\":\"int\",\"children\":[352]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"lvar\",\"children\":[\"system_name_1\"]},{\"type\":\"int\",\"children\":[353]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"pat\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvasgn\",\"children\":[\"system_name_2\",{\"type\":\"str\",\"children\":[\"bleh\"]}]},{\"type\":\"int\",\"children\":[354]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"mat\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"system_name_2\"]},{\"type\":\"int\",\"children\":[355]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"cuk\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvasgn\",\"children\":[\"system_name_3\",{\"type\":\"str\",\"children\":[\"blrg\"]}]},{\"type\":\"int\",\"children\":[356]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"gek\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"lvar\",\"children\":[\"system_name_3\"]},{\"type\":\"int\",\"children\":[357]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"tik\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvasgn\",\"children\":[\"system_name_4\",{\"type\":\"str\",\"children\":[\"blud\"]}]},{\"type\":\"int\",\"children\":[358]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"tak\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"system_name_4\"]},{\"type\":\"int\",\"children\":[359]}]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"report\"]}]}]}","id":"6c272b3b-372a-489e-86d7-7f3585f4e28f"}
{"repo_name":"discourse","file_path":"./repos/discourse/lib/import_export/importer.rb","start_line":57,"raw_source":"def import_groups\n      return if @groups.blank?\n\n      puts \"Importing groups...\"\n\n      @groups.each do |group_data|\n        g = group_data.dup\n        user_ids = g.delete(:user_ids)\n        external_id = g.delete(:id)\n        new_group = Group.find_by_name(g[:name]) || Group.create!(g)\n        user_ids.each do |external_user_id|\n          begin\n            new_group.add(User.find(new_user_id(external_user_id)))\n          rescue StandardError\n            ActiveRecord::RecordNotUnique\n          end\n        end\n      end\n\n      self\n    end","complexity_score":27.2,"ast_json":"{\"type\":\"def\",\"children\":[\"import_groups\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@groups\"]},\"blank?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"str\",\"children\":[\"Importing groups...\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@groups\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"group_data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"g\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"group_data\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"user_ids\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"g\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"user_ids\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"external_id\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"g\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_group\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Group\"]},\"find_by_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"g\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"name\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Group\"]},\"create!\",{\"type\":\"lvar\",\"children\":[\"g\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"user_ids\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"external_user_id\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_group\"]},\"add\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"User\"]},\"find\",{\"type\":\"send\",\"children\":[null,\"new_user_id\",{\"type\":\"lvar\",\"children\":[\"external_user_id\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ActiveRecord\"]},\"RecordNotUnique\"]}]},null]}]}]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"867b2c0b-4783-4c75-a592-cd06c395f4c8"}

{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":72,"raw_source":"def test_meaningless_parens_lax\n    with_error_mode(:lax) do\n      assigns = { 'b' => 'bar', 'c' => 'baz' }\n      markup  = \"a == 'foo' or (b == 'bar' and c == 'baz') or false\"\n      assert_template_result(' YES ', \"{% if #{markup} %} YES {% endif %}\", assigns)\n    end\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_meaningless_parens_lax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"a == 'foo' or (b == 'bar' and c == 'baz') or false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}","id":"a6ad98e0-9906-43d5-9484-479828b73ec2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":258,"raw_source":"def test_included_template_name_with_line_numbers\n    environment = Liquid::Environment.build(file_system: TestFileSystem.new)\n    template = Liquid::Template.parse(\"Argument error:\\n{% include 'product' %}\", line_numbers: true, environment: environment)\n    page     = template.render('errors' => ErrorDrop.new)\n\n    assert_equal(\"Argument error:\\nLiquid error (product line 1): argument error\", page)\n    assert_equal(\"product\", template.errors.first.template_name)\n  end","complexity_score":14.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_included_template_name_with_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"Argument error:\\n{% include 'product' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"page\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Argument error:\\nLiquid error (product line 1): argument error\"]},{\"type\":\"lvar\",\"children\":[\"page\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"template_name\"]}]}]}]}","id":"e8559528-ba9c-4ddb-8052-6c0eb87ba611"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":156,"raw_source":"def deprecated_default_context\n      warn(\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\" \\\n        \" and will be removed from Liquid 6.0.0.\")\n      Context.new\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"deprecated_default_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\"]},{\"type\":\"str\",\"children\":[\" and will be removed from Liquid 6.0.0.\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}","id":"d65284db-0e44-4512-aa69-bbccd9188cbc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":694,"raw_source":"def time_for(value)\n      if value.is_a? Numeric\n        Time.at value\n      elsif value.respond_to? :to_s\n        Time.parse value.to_s\n      else\n        value.to_time\n      end\n    rescue ArgumentError => e\n      raise e\n    rescue Exception\n      raise ArgumentError, \"unable to convert #{value.inspect} to a Time object\"\n    end","complexity_score":15.5,"ast_json":"{\"type\":\"def\",\"children\":[\"time_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Numeric\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_time\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unable to convert \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to a Time object\"]}]}]}]},null]}]}","id":"b9405835-3be1-4d76-901a-7320c4f99a8b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":246,"raw_source":"def test_render_for\n    assert_equal(\n      [\"test\"],\n      visit(%({% render \"hai\" for test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% render \\\"hai\\\" for test %}\"]}]}]}]}","id":"52202ee8-ff91-4c86-b024-2cea49e9498a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/static_test.rb","start_line":106,"raw_source":"def assert_valid_range(http_range, range, path, file)\n    request = Rack::MockRequest.new(@app)\n    response = request.get(\"/#{File.basename(path)}\", 'HTTP_RANGE' => http_range)\n\n    should_be = file[range]\n    expected_range = \"bytes #{range.begin}-#{range.end}/#{file.length}\"\n\n    assert_equal(\n      206,response.status,\n      \"Should be HTTP/1.1 206 Partial content\"\n    )\n    assert_equal(\n      should_be.length,\n      response.body.length,\n      \"Unexpected response length for #{http_range}\"\n    )\n    assert_equal(\n      should_be,\n      response.body,\n      \"Unexpected response data for #{http_range}\"\n    )\n    assert_equal(\n      should_be.length.to_s,\n      response['Content-Length'],\n      \"Incorrect Content-Length for #{http_range}\"\n    )\n    assert_equal(\n      expected_range,\n      response['Content-Range'],\n      \"Incorrect Content-Range for #{http_range}\"\n    )\n  end","complexity_score":27.7,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_valid_range\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http_range\"]},{\"type\":\"arg\",\"children\":[\"range\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"MockRequest\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@app\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"get\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"HTTP_RANGE\"]},{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"should_be\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"range\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_range\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"bytes \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"range\"]},\"begin\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"range\"]},\"end\"]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"length\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[206]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"status\"]},{\"type\":\"str\",\"children\":[\"Should be HTTP/1.1 206 Partial content\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"should_be\"]},\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"body\"]},\"length\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected response length for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"should_be\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"body\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected response data for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"should_be\"]},\"length\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Length\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Incorrect Content-Length for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected_range\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Range\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Incorrect Content-Range for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_range\"]}]}]}]}]}]}","id":"72810263-a358-472d-a0ef-4ced572dfb80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":130,"raw_source":"def test_key?\n    assert_operator @hash, :key?, :a\n    assert_operator @hash, :key?, ?b\n    assert_operator @hash, :key?, 3\n    refute_operator @hash, :key?, :d\n  end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}","id":"fd782728-1178-4992-a470-84f6f85798b6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":55,"raw_source":"def test_filter_with_date_parameter\n    var = create_variable(%( '2006-06-06' | date: \"%m/%d/%Y\"))\n    assert_equal('2006-06-06', var.name)\n    assert_equal([['date', ['%m/%d/%Y']]], var.filters)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_date_parameter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" '2006-06-06' | date: \\\"%m/%d/%Y\\\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-06-06\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"date\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"ec3b3390-9f7b-41f3-bebf-c8fb5f87c82e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":615,"raw_source":"def test_override_global_filter\n    global = Module.new do\n      def notice(output)\n        \"Global #{output}\"\n      end\n    end\n\n    local = Module.new do\n      def notice(output)\n        \"Local #{output}\"\n      end\n    end\n\n    with_global_filter(global) do\n      assert_equal('Global test', Template.parse(\"{{'test' | notice }}\").render!)\n      assert_equal('Local test', Template.parse(\"{{'test' | notice }}\").render!({}, filters: [local]))\n    end\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_override_global_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Global \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"local\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"notice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Local \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"lvar\",\"children\":[\"global\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Global test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{'test' | notice }}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Local test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{'test' | notice }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"local\"]}]}]}]}]}]}]}]}]}]}","id":"03aa3984-1ea1-4d01-93c7-eda0772a9e84"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":306,"raw_source":"def test_sort\n    assert_equal([1, 2, 3, 4], @filters.sort([4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }], @filters.sort([{ \"a\" => 4 }, { \"a\" => 3 }, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"88a77b09-455e-47ad-9bd9-8d5ffdb7647a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":940,"raw_source":"def default(input, default_value = '', options = {})\n      options = {} unless options.is_a?(Hash)\n      false_check = options['allow_false'] ? input.nil? : !Liquid::Utils.to_liquid_value(input)\n      false_check || (input.respond_to?(:empty?) && input.empty?) ? default_value : input\n    end","complexity_score":17.1,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"default_value\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"false_check\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"str\",\"children\":[\"allow_false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"!\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"false_check\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"empty?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"empty?\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"default_value\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}","id":"851b0c18-7e39-4469-8f88-1e2d7e0c1d62"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":337,"raw_source":"def test_including_with_strict_variables\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('simple' => 'simple'),\n    )\n\n    template = Liquid::Template.parse(\"{% include 'simple' %}\", error_mode: :warn, environment: env)\n    template.render(nil, strict_variables: true)\n\n    assert_equal([], template.errors)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_including_with_strict_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"simple\"]},{\"type\":\"str\",\"children\":[\"simple\"]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'simple' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict_variables\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]}]}]}]}","id":"33b85153-a860-48e1-9d27-afface291e2f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":222,"raw_source":"def falsetok(s); s[0,5] == 'false' && [:val, 'false', false] end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"falsetok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[5]}]},\"==\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"6e21671f-e85e-4bf3-b8b4-f8025979feca"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":208,"raw_source":"def mime_type(*)\n      result = super\n      remap_extensions\n      result\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_type\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"remap_extensions\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"d0acc282-25ab-4faa-9ffc-4d0709e036ce"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":49,"raw_source":"def assert_match_syntax_error(match, template, error_mode: nil)\n      exception = assert_raises(Liquid::SyntaxError) do\n        Template.parse(template, line_numbers: true, error_mode: error_mode&.to_sym).render\n      end\n      assert_match(match, exception.message)\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_match_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"match\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},\"to_sym\"]}]}]}]},\"render\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"lvar\",\"children\":[\"match\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"2f9f7466-9bf2-4d27-8b63-23b7984fdb82"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":81,"raw_source":"def self.raise_missing_variable_terminator(token, parse_context)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.variable_termination\", token: token, tag_end: VariableEnd.inspect)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_missing_variable_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.variable_termination\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag_end\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableEnd\"]},\"inspect\"]}]}]}]}]}]}","id":"e5663194-1062-4c98-9729-02037f3c559a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":153,"raw_source":"def base64_encode(input)\n      Base64.strict_encode64(Utils.to_s(input))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"strict_encode64\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}","id":"9e1d60f6-8b43-47a1-8ee3-b0b7eb0fa788"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1071,"raw_source":"def uniq(&block)\n        to_a.uniq do |item|\n          item = Utils.to_liquid_value(item)\n          block ? yield(item) : item\n        end\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"uniq\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"uniq\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"item\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]}]}","id":"cbe6deca-91e9-4356-87d8-04f9c848dca5"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":75,"raw_source":"def add_filters(filters)\n      filters = [filters].flatten.compact\n      @filters += filters\n      @strainer = nil\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filters\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filters\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filters\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]}]},\"flatten\"]},\"compact\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"filters\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"39071494-d26a-4ba5-b247-6249328acd26"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":167,"raw_source":"def test_object_methods_not_allowed\n    [:dup, :clone, :singleton_class, :eval, :class_eval, :inspect].each do |method|\n      output = Liquid::Template.parse(\" {{ product.#{method} }} \").render!('product' => ProductDrop.new)\n      assert_equal('  ', output)\n    end\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_object_methods_not_allowed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"dup\"]},{\"type\":\"sym\",\"children\":[\"clone\"]},{\"type\":\"sym\",\"children\":[\"singleton_class\"]},{\"type\":\"sym\",\"children\":[\"eval\"]},{\"type\":\"sym\",\"children\":[\"class_eval\"]},{\"type\":\"sym\",\"children\":[\"inspect\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\" {{ product.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\" }} \"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}","id":"163bf469-c0d6-4b6b-b3e8-6f1e4c17244a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":496,"raw_source":"def test_apply_global_filter\n    global_filter_proc = ->(output) { \"#{output} filtered\" }\n\n    context = Context.new\n    context.global_filter = global_filter_proc\n\n    assert_equal('hi filtered', context.apply_global_filter('hi'))\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_apply_global_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_filter_proc\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"str\",\"children\":[\" filtered\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"global_filter=\",{\"type\":\"lvar\",\"children\":[\"global_filter_proc\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi filtered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}]}","id":"6da9aec0-55a7-4e3e-9f29-6d7c86360dae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":24,"raw_source":"def test_has_a_block_which_does_nothing\n    assert_template_result(\n      %(the comment block should be removed  .. right?),\n      %(the comment block should be removed {%comment%} be gone.. {%endcomment%} .. right?),\n    )\n\n    assert_template_result('', '{%comment%}{%endcomment%}')\n    assert_template_result('', '{%comment%}{% endcomment %}')\n    assert_template_result('', '{% comment %}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% endcomment %}')\n    assert_template_result('', '{%comment%}comment{%endcomment%}')\n    assert_template_result('', '{% comment %}comment{% endcomment %}')\n    assert_template_result('', '{% comment %} 1 {% comment %} 2 {% endcomment %} 3 {% endcomment %}')\n\n    assert_template_result('', '{%comment%}{%blabla%}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% blabla %}{% endcomment %}')\n    assert_template_result('', '{%comment%}{% endif %}{%endcomment%}')\n    assert_template_result('', '{% comment %}{% endwhatever %}{% endcomment %}')\n    assert_template_result('', '{% comment %}{% raw %} {{%%%%}}  }} { {% endcomment %} {% comment {% endraw %} {% endcomment %}')\n    assert_template_result('', '{% comment %}{% \" %}{% endcomment %}')\n    assert_template_result('', '{% comment %}{%%}{% endcomment %}')\n\n    assert_template_result('foobar', 'foo{%comment%}comment{%endcomment%}bar')\n    assert_template_result('foobar', 'foo{% comment %}comment{% endcomment %}bar')\n    assert_template_result('foobar', 'foo{%comment%} comment {%endcomment%}bar')\n    assert_template_result('foobar', 'foo{% comment %} comment {% endcomment %}bar')\n\n    assert_template_result('foo  bar', 'foo {%comment%} {%endcomment%} bar')\n    assert_template_result('foo  bar', 'foo {%comment%}comment{%endcomment%} bar')\n    assert_template_result('foo  bar', 'foo {%comment%} comment {%endcomment%} bar')\n\n    assert_template_result('foobar', 'foo{%comment%}\n                                     {%endcomment%}bar')\n  end","complexity_score":23.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_a_block_which_does_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"the comment block should be removed  .. right?\"]},{\"type\":\"str\",\"children\":[\"the comment block should be removed {%comment%} be gone.. {%endcomment%} .. right?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}comment{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}comment{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %} 1 {% comment %} 2 {% endcomment %} 3 {% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{%blabla%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% blabla %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment%}{% endif %}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% endwhatever %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% raw %} {{%%%%}}  }} { {% endcomment %} {% comment {% endraw %} {% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{% \\\" %}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}{%%}{% endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{%comment%}comment{%endcomment%}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{% comment %}comment{% endcomment %}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{%comment%} comment {%endcomment%}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foo{% comment %} comment {% endcomment %}bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%} {%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%}comment{%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo  bar\"]},{\"type\":\"str\",\"children\":[\"foo {%comment%} comment {%endcomment%} bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foo{%comment%}\\n\"]},{\"type\":\"str\",\"children\":[\"                                     {%endcomment%}bar\"]}]}]}]}]}","id":"e9876491-6067-4c59-a881-5f4ba3c73e92"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":140,"raw_source":"def test_strict_filter_argument_parsing\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        create_variable(%( number_of_comments | pluralize: 'comment': 'comments' ))\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strict_filter_argument_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" number_of_comments | pluralize: 'comment': 'comments' \"]}]}]}]}]}","id":"65a2b651-8e6b-4e37-9c06-b2e2fd199d38"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":176,"raw_source":"def whitespace_handler(token, parse_context)\n      if token[2] == WhitespaceControl\n        previous_token = @nodelist.last\n        if previous_token.is_a?(String)\n          first_byte = previous_token.getbyte(0)\n          previous_token.rstrip!\n          if previous_token.empty? && parse_context[:bug_compatible_whitespace_trimming] && first_byte\n            previous_token << first_byte\n          end\n        end\n      end\n      parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n    end","complexity_score":25.0,"ast_json":"{\"type\":\"def\",\"children\":[\"whitespace_handler\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"previous_token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"last\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"getbyte\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"rstrip!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]}]}]},{\"type\":\"lvar\",\"children\":[\"first_byte\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"previous_token\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"first_byte\"]}]},null]}]},null]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]}]}]}","id":"4a01fc40-bc61-4fd7-a374-16050f5bc026"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":668,"raw_source":"def redirect?\n      status.between? 300, 399\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[300]},{\"type\":\"int\",\"children\":[399]}]}]}","id":"f9939da6-4762-4178-a60c-c858273fe1be"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":175,"raw_source":"def test_doc_tag_delimiter_handling\n    assert_template_result('', <<~LIQUID.chomp)\n      {%- if true -%}\n        {%- doc -%}\n          {%- docEXTRA -%}wut{% enddocEXTRA -%}xyz\n        {%- enddoc -%}\n      {%- endif -%}\n    LIQUID\n\n    assert_template_result('', \"{% doc %}123{% enddoc xyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\txyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\nxyz %}\")\n    assert_template_result('', \"{% doc %}123{% enddoc\\n   xyz  enddoc %}\")\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_delimiter_handling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- doc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"    {%- docEXTRA -%}wut{% enddocEXTRA -%}xyz\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- enddoc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endif -%}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc xyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\txyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\nxyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% doc %}123{% enddoc\\n   xyz  enddoc %}\"]}]}]}]}","id":"bc0dd6c9-b74c-4776-9b94-b621259fec25"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":104,"raw_source":"def inspect\n      \"#<Condition #{[@left, @operator, @right].compact.join(' ')}>\"\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<Condition \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@left\"]},{\"type\":\"ivar\",\"children\":[\"@operator\"]},{\"type\":\"ivar\",\"children\":[\"@right\"]}]},\"compact\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}","id":"65263703-dbf7-44b2-bb62-84a486dd0aaf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":14,"raw_source":"def test_for\n    assert_template_result(' yo  yo  yo  yo ', '{%for item in array%} yo {%endfor%}', { 'array' => [1, 2, 3, 4] })\n    assert_template_result('yoyo', '{%for item in array%}yo{%endfor%}', { 'array' => [1, 2] })\n    assert_template_result(' yo ', '{%for item in array%} yo {%endfor%}', { 'array' => [1] })\n    assert_template_result('', '{%for item in array%}{%endfor%}', { 'array' => [1, 2] })\n    expected = <<HERE\n\n  yo\n\n  yo\n\n  yo\n\nHERE\n    template = <<~HERE\n      {%for item in array%}\n        yo\n      {%endfor%}\n    HERE\n    assert_template_result(expected, template, { 'array' => [1, 2, 3] })\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" yo  yo  yo  yo \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} yo {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yoyo\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}yo{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" yo \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} yo {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for item in array%}\\n\"]},{\"type\":\"str\",\"children\":[\"  yo\\n\"]},{\"type\":\"str\",\"children\":[\"{%endfor%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}","id":"655fbc73-40f3-4cbb-99b2-152b0f5833fd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":105,"raw_source":"def run_test(target, &block)\n      retries ||= 3\n      target.server = self\n      run unless alive?\n      target.instance_eval(&block)\n    rescue Exception => error\n      retries -= 1\n      kill\n      retries < 0 ? retry : raise(error)\n    end","complexity_score":22.93,"ast_json":"{\"type\":\"def\",\"children\":[\"run_test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"target\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"retries\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target\"]},\"server=\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alive?\"]},null,{\"type\":\"send\",\"children\":[null,\"run\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target\"]},\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"error\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"retries\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"kill\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"retries\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"retry\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"error\"]}]}]}]}]},null]}]}","id":"e9864fdd-d7be-4de7-b379-d4a2ec2685f3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":88,"raw_source":"def test_assign_score_of_array\n    assert_equal(1, assign_score_of([]))\n    assert_equal(2, assign_score_of([123]))\n    assert_equal(6, assign_score_of([123, 'abcd']))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[123]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[6]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[123]},{\"type\":\"str\",\"children\":[\"abcd\"]}]}]}]}]}]}","id":"cb62d480-1585-42cf-8698-b37c1d5fbf69"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":159,"raw_source":"def test_split\n    assert_equal(['12', '34'], @filters.split('12~34', '~'))\n    assert_equal(['A? ', ' ,Z'], @filters.split('A? ~ ~ ~ ,Z', '~ ~ ~'))\n    assert_equal(['A?Z'], @filters.split('A?Z', '~'))\n    assert_equal([], @filters.split(nil, ' '))\n    assert_equal(['A', 'Z'], @filters.split('A1Z', 1))\n  end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_split\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"12~34\"]},{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A? \"]},{\"type\":\"str\",\"children\":[\" ,Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A? ~ ~ ~ ,Z\"]},{\"type\":\"str\",\"children\":[\"~ ~ ~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A?Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A?Z\"]},{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"split\",{\"type\":\"str\",\"children\":[\"A1Z\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"66aee3ab-369e-4b3b-a3e6-6c11ba9f7254"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":362,"raw_source":"def unsubst(u)\n    if u < Usurrself || u > Umax || surrogate?(u)\n      return Ucharerr, Ucharerr\n    end\n    u -= Usurrself\n    [Usurr1 + ((u>>10)&0x3ff), Usurr2 + (u&0x3ff)]\n  end","complexity_score":15.5,"ast_json":"{\"type\":\"def\",\"children\":[\"unsubst\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">\",{\"type\":\"const\",\"children\":[null,\"Umax\"]}]}]},{\"type\":\"send\",\"children\":[null,\"surrogate?\",{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]},{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[10]}]}]},\"&\",{\"type\":\"int\",\"children\":[1023]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr2\"]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[1023]}]}]}]}]}]}]}","id":"46ff94f8-8a8d-47d4-b8d0-47d8068e7df3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":70,"raw_source":"def parse_number(markup, ss)\n        # check if the markup is simple integer or float\n        case markup\n        when INTEGER_REGEX\n          return Integer(markup, 10)\n        when FLOAT_REGEX\n          return markup.to_f\n        end\n\n        ss.string = markup\n        # the first byte must be a digit or  a dash\n        byte = ss.scan_byte\n\n        return false if byte != DASH && (byte < ZERO || byte > NINE)\n\n        if byte == DASH\n          peek_byte = ss.peek_byte\n\n          # if it starts with a dash, the next byte must be a digit\n          return false if peek_byte.nil? || !(peek_byte >= ZERO && peek_byte <= NINE)\n        end\n\n        # The markup could be a float with multiple dots\n        first_dot_pos = nil\n        num_end_pos = nil\n\n        while (byte = ss.scan_byte)\n          return false if byte != DOT && (byte < ZERO || byte > NINE)\n\n          # we found our number and now we are just scanning the rest of the string\n          next if num_end_pos\n\n          if byte == DOT\n            if first_dot_pos.nil?\n              first_dot_pos = ss.pos\n            else\n              # we found another dot, so we know that the number ends here\n              num_end_pos = ss.pos - 1\n            end\n          end\n        end\n\n        num_end_pos = markup.length if ss.eos?\n\n        if num_end_pos\n          # number ends with a number \"123.123\"\n          markup.byteslice(0, num_end_pos).to_f\n        else\n          # number ends with a dot \"123.\"\n          markup.byteslice(0, first_dot_pos).to_f\n        end\n      end","complexity_score":66.45,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_number\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"ss\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"INTEGER_REGEX\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FLOAT_REGEX\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"to_f\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"string=\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"DASH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\">\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DASH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"peek_byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"peek_byte\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"first_dot_pos\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"byte\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"scan_byte\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"ZERO\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\">\",{\"type\":\"const\",\"children\":[null,\"NINE\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_dot_pos\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"first_dot_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]}]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"eos?\"]},{\"type\":\"lvasgn\",\"children\":[\"num_end_pos\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"length\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"byteslice\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"num_end_pos\"]}]},\"to_f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"byteslice\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"first_dot_pos\"]}]},\"to_f\"]}]}]}]}","id":"8d5354aa-cd8f-413c-a248-f21c0f20b367"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":364,"raw_source":"def headers(hash = nil)\n      response.headers.merge! hash if hash\n      response.headers\n    end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"headers\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"hash\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"headers\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"headers\"]}]}]}","id":"3aa9aa25-14ff-428b-b31d-f98fde027ae2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":71,"raw_source":"def parse_expression(markup)\n      parse_context.parse_expression(markup)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}","id":"0283d50e-de90-413e-b215-f89ebf458d4b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":34,"raw_source":"def test_allows_unclosed_tags\n    assert_template_result('', <<~LIQUID.chomp)\n      {% comment %}\n        {% if true %}\n      {% endcomment %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_allows_unclosed_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}","id":"feb531c2-e4b3-464d-9475-5c2b6c96f95a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":39,"raw_source":"def test_variable_parser\n    assert_equal(['var'],                               'var'.scan(VariableParser))\n    assert_equal(['[var]'],                             '[var]'.scan(VariableParser))\n    assert_equal(['var', 'method'],                     'var.method'.scan(VariableParser))\n    assert_equal(['var', '[method]'],                   'var[method]'.scan(VariableParser))\n    assert_equal(['var', '[method]', '[0]'],            'var[method][0]'.scan(VariableParser))\n    assert_equal(['var', '[\"method\"]', '[0]'],          'var[\"method\"][0]'.scan(VariableParser))\n    assert_equal(['var', '[method]', '[0]', 'method'],  'var[method][0].method'.scan(VariableParser))\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_parser\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var.method\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method][0]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[\\\"method\\\"]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[\\\"method\\\"][0]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"[method]\"]},{\"type\":\"str\",\"children\":[\"[0]\"]},{\"type\":\"str\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"var[method][0].method\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]}]}","id":"a8354a0f-27a1-4c8e-a136-da16b87c9c67"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":61,"raw_source":"def debug(env, message)\n        return unless options[:logging]\n\n        l = options[:logger] || env['rack.logger'] || ::Logger.new(env['rack.errors'])\n        l.debug(message)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"debug\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logging\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"debug\",{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}","id":"8ea905e1-0ef6-419b-9e69-794e4d622e1b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":44,"raw_source":"def _capture_haml(*args, &block)\n      capture(*args, &block)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"_capture_haml\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"dc7c558e-ee01-41fc-87c0-d1cbb080a91d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":225,"raw_source":"def test_include_with\n    assert_equal(\n      [\"test\"],\n      visit(%({% include \"hai\" with test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include \\\"hai\\\" with test %}\"]}]}]}]}","id":"0469aaca-5ec9-41e9-872b-83860da486c7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":271,"raw_source":"def test_for_with_break_after_nested_loop\n    source = <<~LIQUID.chomp\n      {% for i in (1..2) -%}\n        {% for j in (1..2) -%}\n          {{ i }}-{{ j }},\n        {%- endfor -%}\n        {% break -%}\n      {% endfor -%}\n      after\n    LIQUID\n    assert_template_result(\"1-1,1-2,after\", source)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_break_after_nested_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for i in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% for j in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"    {{ i }}-{{ j }},\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% break -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"after\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1-1,1-2,after\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"3718d550-6d45-4b6b-b00b-bdddeb7ed539"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":134,"raw_source":"def test_lax_filter_argument_parsing\n    var = create_variable(%( number_of_comments | pluralize: 'comment': 'comments' ), error_mode: :lax)\n    assert_equal(VariableLookup.new('number_of_comments'), var.name)\n    assert_equal([['pluralize', ['comment', 'comments']]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lax_filter_argument_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" number_of_comments | pluralize: 'comment': 'comments' \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"number_of_comments\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"pluralize\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"comment\"]},{\"type\":\"str\",\"children\":[\"comments\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"6f8d86b8-b9f3-49db-8c33-b4c8c1e31cb4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":274,"raw_source":"def test_passing_options_to_included_templates\n    env = Liquid::Environment.build(file_system: TestFileSystem.new)\n\n    assert_raises(Liquid::SyntaxError) do\n      Template.parse(\"{% include template %}\", error_mode: :strict, environment: env).render!(\"template\" => '{{ \"X\" || downcase }}')\n    end\n    with_error_mode(:lax) do\n      assert_equal('x', Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: true, environment: env).render!(\"template\" => '{{ \"X\" || downcase }}'))\n    end\n    assert_raises(Liquid::SyntaxError) do\n      Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: [:locale], environment: env).render!(\"template\" => '{{ \"X\" || downcase }}')\n    end\n    with_error_mode(:lax) do\n      assert_equal('x', Template.parse(\"{% include template %}\", error_mode: :strict, include_options_blacklist: [:error_mode], environment: env).render!(\"template\" => '{{ \"X\" || downcase }}'))\n    end\n  end","complexity_score":23.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_passing_options_to_included_templates\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"X\\\" || downcase }}\"]}]}]}]}]}]}]}]}","id":"06eec928-896d-4b58-b2ce-06785a1f2904"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":65,"raw_source":"def dangerously_override(environment)\n        original_default = @default\n        @default = environment\n        yield\n      ensure\n        @default = original_default\n      end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"dangerously_override\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_default\",{\"type\":\"ivar\",\"children\":[\"@default\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"original_default\"]}]}]}]}","id":"3233064c-778c-462f-84a3-31959bd37a7f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2093,"raw_source":"def self.register(*extensions, &block) # :nodoc:\n      added_methods = extensions.flat_map(&:public_instance_methods)\n      Delegator.delegate(*added_methods)\n      super(*extensions, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"added_methods\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"flat_map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"public_instance_methods\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"delegate\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"added_methods\"]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"f1fa5f4f-40a0-42e7-ba40-3ec95fcb5ef5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1030,"raw_source":"def halt(*response)\n      response = response.first if response.length == 1\n      throw :halt, response\n    end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"halt\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"length\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"first\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"lvar\",\"children\":[\"response\"]}]}]}]}","id":"8515ecf0-b5e1-43ae-b7b6-1a95417b0c45"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":13,"raw_source":"def initialize(parse_context)\n      @parse_context = parse_context\n      @body = new_body\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}","id":"8dceda07-1c2b-4e64-8c3c-4dd4b9298071"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":668,"raw_source":"def test_strip\n    assert_template_result('ab c', \"{{ source | strip }}\", { 'source' => \" ab c  \" })\n    assert_template_result('ab c', \"{{ source | strip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}","id":"686e8b67-bc71-41a2-ac2e-3d7003d9abf4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":763,"raw_source":"def sass(template, options = {}, locals = {})\n      options[:default_content_type] = :css\n      options[:exclude_outvar] = true\n      options[:layout] = nil\n      render :sass, template, options, locals\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sass\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"css\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"sass\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"cf920796-bc52-4a0f-afe4-d160360cf59a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":19,"raw_source":"def test_tag_name_should_return_name_of_the_tag\n    tag = Tag.parse(\"some_tag\", \"\", new_tokenizer, ParseContext.new)\n    assert_equal('some_tag', tag.tag_name)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_name_should_return_name_of_the_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"tag_name\"]}]}]}]}","id":"e458d184-5f39-49e4-aa88-475acce35df3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":86,"raw_source":"def self.remove_tests(subclass)\n    subclass.public_instance_methods.grep(/^test_/).each do |meth|\n      subclass.send(:undef_method, meth.to_sym)\n    end\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"remove_tests\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"public_instance_methods\"]},\"grep\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^test_\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"meth\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"send\",{\"type\":\"sym\",\"children\":[\"undef_method\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"meth\"]},\"to_sym\"]}]}]}]}","id":"c668bf77-b9d2-4aaa-9a9a-172f6bc6b24e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":37,"raw_source":"def shift\n      token = @tokens[@offset]\n\n      return unless token\n\n      @offset += 1\n\n      if @line_number\n        @line_number += @for_liquid_tag ? 1 : token.count(\"\\n\")\n      end\n\n      token\n    end","complexity_score":11.55,"ast_json":"{\"type\":\"def\",\"children\":[\"shift\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@offset\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@offset\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@line_number\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@line_number\"]},\"+\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_liquid_tag\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}","id":"0ec45c08-845b-4e84-baea-d6dfed722631"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":85,"raw_source":"def mkcol(path, opts = {}, &bk)     route 'MKCOL',     path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mkcol\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"MKCOL\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"da238389-5789-46a9-86ca-91b44d033643"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":376,"raw_source":"def nibble(c)\n    case true\n    when ?0 <= c && c <= ?9 then c.ord - ?0.ord\n    when ?a <= c && c <= ?z then c.ord - ?a.ord + 10\n    when ?A <= c && c <= ?Z then c.ord - ?A.ord + 10\n    else\n      raise Error, \"invalid hex code #{c}\"\n    end\n  end","complexity_score":33.1,"ast_json":"{\"type\":\"def\",\"children\":[\"nibble\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"0\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"9\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"0\"]},\"ord\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"z\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"ord\"]}]},\"+\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"ord\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},\"ord\"]}]},\"+\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid hex code \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]}]}]}","id":"0f556191-9e93-4704-b602-1934b5eadb18"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1861,"raw_source":"def setup_protection(builder)\n        return unless protection?\n\n        options = Hash === protection ? protection.dup : {}\n        options = {\n          img_src: \"'self' data:\",\n          font_src: \"'self'\"\n        }.merge options\n\n        protect_session = options.fetch(:session) { sessions? }\n        options[:without_session] = !protect_session\n\n        options[:reaction] ||= :drop_session\n\n        builder.use Rack::Protection, options\n      end","complexity_score":17.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_protection\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protection?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"protection\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protection\"]},\"dup\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"img_src\"]},{\"type\":\"str\",\"children\":[\"'self' data:\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"font_src\"]},{\"type\":\"str\",\"children\":[\"'self'\"]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"protect_session\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"session\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"sessions?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"without_session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"protect_session\"]},\"!\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"reaction\"]}]},{\"type\":\"sym\",\"children\":[\"drop_session\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Protection\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"a26fce38-3bd3-440b-813d-bce679a46a90"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":201,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.each.map(&:upcase)]\n        end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"each\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]}]}]}]}","id":"d69fcfca-fe49-40e2-81c7-b95a61dfb51c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":72,"raw_source":"def get(url)\n      Timeout.timeout(1) { get_url(\"#{protocol}://127.0.0.1:#{port}#{url}\") }\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"get_url\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protocol\"]}]},{\"type\":\"str\",\"children\":[\"://127.0.0.1:\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]}]}]}","id":"f2ea5989-24cb-4eef-abb3-2f3f34202b5a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":1523,"raw_source":"def authorize(username, password)\n          username == \"foo\" && password == \"bar\"\n        end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"authorize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"username\"]},{\"type\":\"arg\",\"children\":[\"password\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"username\"]},\"==\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"password\"]},\"==\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}","id":"f2bbc32e-8a09-4549-9278-44ed3120b46d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":213,"raw_source":"def test_hierachical_data\n    assigns = { 'hash' => { \"name\" => 'tobi' } }\n    assert_template_result(\"tobi\", \"{{ hash.name }}\", assigns)\n    assert_template_result(\"tobi\", '{{ hash[\"name\"] }}', assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hierachical_data\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"tobi\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"tobi\"]},{\"type\":\"str\",\"children\":[\"{{ hash.name }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"tobi\"]},{\"type\":\"str\",\"children\":[\"{{ hash[\\\"name\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"6c106410-2d14-4e3b-88c2-6880f715f7f8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":22,"raw_source":"def artificial_execution_time\n      sleep(Process.clock_getres(Process::CLOCK_MONOTONIC))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"artificial_execution_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"sleep\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"clock_getres\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"CLOCK_MONOTONIC\"]}]}]}]}","id":"0568df61-f508-4829-b883-90f59f5a47ee"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1882,"raw_source":"def setup_sessions(builder)\n        return unless sessions?\n\n        options = {}\n        options[:secret] = session_secret if session_secret?\n        options.merge! sessions.to_hash if sessions.respond_to? :to_hash\n        builder.use session_store, options\n      end","complexity_score":16.5,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_sessions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session_secret?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"secret\"]},{\"type\":\"send\",\"children\":[null,\"session_secret\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sessions\"]},\"to_hash\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"send\",\"children\":[null,\"session_store\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"122c5e4a-4f89-4629-8f25-45b8c187a2cc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":246,"raw_source":"def test_case_when_comma\n    code = '{% case condition %}{% when 1, 2, 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 2 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 3 })\n    assert_template_result(' its 4 ', code, { 'condition' => 4 })\n    assert_template_result('', code, { 'condition' => 5 })\n\n    code = '{% case condition %}{% when 1, \"string\", null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 'string' })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => nil })\n    assert_template_result('', code, { 'condition' => 'something else' })\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_comma\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, 2, 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 4 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, \\\"string\\\", null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"something else\"]}]}]}]}]}]}","id":"b265114b-cd19-49d9-bcc3-08039582ca11"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":113,"raw_source":"def test_limiting_with_invalid_limit\n    assigns  = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    template = <<-MKUP\n      {% for i in array limit: true offset: 1 %}\n        {{ i }}\n      {% endfor %}\n    MKUP\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      Template.parse(template).render!(assigns)\n    end\n    assert_equal(\"Liquid error: invalid integer\", exception.message)\n  end","complexity_score":11.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting_with_invalid_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {% for i in array limit: true offset: 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"        {{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% endfor %}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"fe1478f5-c0e6-4225-bd9d-554574f9d28e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":76,"raw_source":"def self.raise_missing_tag_terminator(token, parse_context)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_termination\", token: token, tag_end: TagEnd.inspect)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_missing_tag_terminator\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_termination\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag_end\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TagEnd\"]},\"inspect\"]}]}]}]}]}]}","id":"d88c38ab-d80e-4469-92e8-2391c64d4e19"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":799,"raw_source":"def markaby(template = nil, options = {}, locals = {}, &block)\n      render_ruby(:mab, template, options, locals, &block)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"markaby\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"mab\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"ea75fb91-3fad-45d3-a04a-5acfed593a14"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":257,"raw_source":"def invoke_hook(name, *args)\n        @extensions.each { |e| e.send(name, *args) if e.respond_to?(name) }\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_hook\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},null]}]}]}","id":"1c475310-e7ee-4c8f-a34d-936d4ed6d568"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":108,"raw_source":"private def parse_liquid_tag(markup, parse_context)\n      liquid_tag_tokenizer = parse_context.new_tokenizer(\n        markup, start_line_number: parse_context.line_number, for_liquid_tag: true\n      )\n      parse_for_liquid_tag(liquid_tag_tokenizer, parse_context) do |end_tag_name, _end_tag_markup|\n        if end_tag_name\n          BlockBody.unknown_tag_in_liquid_tag(end_tag_name, parse_context)\n        end\n      end\n    end","complexity_score":8.9,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_liquid_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"liquid_tag_tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"for_liquid_tag\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"liquid_tag_tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"end_tag_name\"]},{\"type\":\"arg\",\"children\":[\"_end_tag_markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"unknown_tag_in_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},null]}]}]}]}]}","id":"3e83d972-d499-43a2-9a45-d9eb9496623a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":208,"raw_source":"def enum_not_open_for_reading(*)\n        not_open_for_reading if block_given?\n        enum_for(:not_open_for_reading)\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enum_not_open_for_reading\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"not_open_for_reading\"]},null]},{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"sym\",\"children\":[\"not_open_for_reading\"]}]}]}]}","id":"13fecc26-ffd2-4477-822a-983159dfd54c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":58,"raw_source":"def test_nested_blocks_are_blank_but_only_if_all_children_are\n    assert_template_result(\"\", wrap(wrap(\" \")))\n    assert_template_result(\n      \"\\n       but this is not \" * (N + 1),\n      wrap('{% if true %} {% comment %} this is blank {% endcomment %} {% endif %}\n      {% if true %} but this is not {% endif %}'),\n    )\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_blocks_are_blank_but_only_if_all_children_are\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n       but this is not \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %} {% comment %} this is blank {% endcomment %} {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% if true %} but this is not {% endif %}\"]}]}]}]}]}]}","id":"e07c14f2-eaf9-44f2-92e4-88777c428163"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":28,"raw_source":"def new_isolated_subcontext\n      new_context = super\n      new_context.profiler = profiler\n      new_context\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_isolated_subcontext\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"new_context\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_context\"]},\"profiler=\",{\"type\":\"send\",\"children\":[null,\"profiler\"]}]},{\"type\":\"lvar\",\"children\":[\"new_context\"]}]}]}","id":"3acd15a9-3861-4db7-82bf-3a34ab6d0316"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":13,"raw_source":"def test_raise_on_single_close_bracet\n    assert_raises(SyntaxError) do\n      Template.parse(\"text {{method} oh nos!\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_single_close_bracet\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"text {{method} oh nos!\"]}]}]}]}","id":"a901cd00-c8c0-49b5-b715-158119a4b7ab"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":220,"raw_source":"def test_profiling_supports_self_time\n    t = Template.parse(\"{% for item in collection %} {{ item }} {% endfor %}\", profile: true)\n    collection = [\n      TestDrop.new(\"one\"),\n      TestDrop.new(\"two\"),\n    ]\n    output = t.render!(\"collection\" => collection)\n    assert_equal(\" one  two \", output)\n\n    leaf = t.profiler[0].children[0]\n    assert_operator(leaf.self_time, :>, 0.0)\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_self_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in collection %} {{ item }} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"two\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"collection\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" one  two \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"leaf\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"leaf\"]},\"self_time\"]},{\"type\":\"sym\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[0.0]}]}]}]}","id":"a9a92b7b-6a9e-465d-a8dc-7feba4bd9aee"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":491,"raw_source":"def test_map_calls_to_liquid\n    t = TestThing.new\n    assert_template_result(\"woot: 1\", '{{ foo | map: \"whatever\" }}', { \"foo\" => [t] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"woot: 1\"]},{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"whatever\\\" }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]}]}]}","id":"ff529506-4120-4cff-9b0c-6d7578b5ed17"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":178,"raw_source":"def test_pause_resume_limit\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:1 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      7\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:1 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      7\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"84df82bc-372c-45b7-8b4d-f1d658e91e9e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":572,"raw_source":"def test_new_isolated_subcontext_inherits_filters\n    my_filter = Module.new do\n      def my_filter(*)\n        'my filter result'\n      end\n    end\n\n    super_context = Context.new\n    super_context.add_filters([my_filter])\n    subcontext    = super_context.new_isolated_subcontext\n    template      = Template.parse('{{ 123 | my_filter }}')\n    assert_equal('my filter result', template.render(subcontext))\n  end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"my_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"my filter result\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"add_filters\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"my_filter\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 123 | my_filter }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my filter result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"subcontext\"]}]}]}]}]}","id":"9a6960c3-343c-4f7f-ad4e-2732f908728b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/content_for_spec.rb","start_line":17,"raw_source":"def render(engine, template)\n    subject.send(:render, engine, template, :layout => false).gsub(/\\s/, '')\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"subject\"]},\"send\",{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"false\",\"children\":[]}]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}","id":"891384b4-575e-4cf6-8ccc-8469bba8d843"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":101,"raw_source":"def register_filter(filter)\n      @strainer_template_class_cache.clear\n      @strainer_template.add_filter(filter)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"clear\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]}]}]}","id":"08113efc-7483-4a69-9fb2-dbecd91f814a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":178,"raw_source":"def base64_url_safe_encode(input)\n      Base64.urlsafe_encode64(Utils.to_s(input))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_url_safe_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_encode64\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}","id":"45574252-b8a7-47b3-b688-699a34759811"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":42,"raw_source":"def test_if_or_with_operators\n    assert_template_result(' YES ', '{% if a == true or b == true %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result(' YES ', '{% if a == true or b == false %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result('', '{% if a == false or b == false %} YES {% endif %}', { 'a' => true, 'b' => true })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_or_with_operators\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a == true or b == true %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a == true or b == false %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a == false or b == false %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}","id":"9a9580b2-4e59-4898-b6fd-1a63ce6d872a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":90,"raw_source":"def strict_parse(markup)\n      p = @parse_context.new_parser(markup)\n      @variable_name = p.consume(:id)\n      raise SyntaxError, options[:locale].t(\"errors.syntax.for_invalid_in\") unless p.id?('in')\n\n      collection_name  = p.expression\n      @collection_name = parse_expression(collection_name)\n\n      @name     = \"#{@variable_name}-#{collection_name}\"\n      @reversed = p.id?('reversed')\n\n      while p.look(:comma) || p.look(:id)\n        p.consume?(:comma)\n        unless (attribute = p.id?('limit') || p.id?('offset'))\n          raise SyntaxError, options[:locale].t(\"errors.syntax.for_invalid_attribute\")\n        end\n        p.consume(:colon)\n        set_attribute(attribute, p.expression)\n      end\n      p.consume(:end_of_string)\n    end","complexity_score":41.7,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"in\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for_invalid_in\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@reversed\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"reversed\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"attribute\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"limit\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"offset\"]}]}]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for_invalid_attribute\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]},{\"type\":\"send\",\"children\":[null,\"set_attribute\",{\"type\":\"lvar\",\"children\":[\"attribute\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]}]}]}","id":"47f7b48a-da69-439a-b62f-ed9836537a19"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":189,"raw_source":"def test_exceptions_propagate\n    assert_raises(Exception) do\n      template = Liquid::Template.parse('{{ errors.exception }}')\n      template.render('errors' => ErrorDrop.new)\n    end\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_exceptions_propagate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ errors.exception }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"9e54d0dc-ae3e-4eb9-ba5d-d21eb6187842"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":210,"raw_source":"def configure_options(options)\n      if (profiling = options[:profile])\n        raise \"Profiler not loaded, require 'liquid/profiler' first\" unless defined?(Liquid::Profiler)\n      end\n\n      @options      = options\n      @profiling    = profiling\n      @line_numbers = options[:line_numbers] || @profiling\n      parse_context = if options.is_a?(ParseContext)\n        options\n      else\n        opts = options.key?(:environment) ? options : options.merge(environment: @environment)\n        ParseContext.new(opts)\n      end\n\n      @warnings = parse_context.warnings\n      parse_context\n    end","complexity_score":21.5,"ast_json":"{\"type\":\"def\",\"children\":[\"configure_options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"profiling\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"profile\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Profiler\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"Profiler not loaded, require 'liquid/profiler' first\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@profiling\",{\"type\":\"lvar\",\"children\":[\"profiling\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_numbers\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"line_numbers\"]}]},{\"type\":\"ivar\",\"children\":[\"@profiling\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"ParseContext\"]}]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"environment\"]}]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"opts\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@warnings\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"warnings\"]}]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}","id":"add2f4f1-0784-4a7d-8906-530cab49c182"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":67,"raw_source":"def test_assigns_are_blank\n    assert_template_result(\"\", wrap(' {% assign foo = \"bar\" %} '))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigns_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = \\\"bar\\\" %} \"]}]}]}]}","id":"6ea77c31-308b-4ef3-b80e-94da8be4b8d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":770,"raw_source":"def first(array)\n      array.first if array.respond_to?(:first)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"first\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"first\"]},null]}]}","id":"da8c3f69-f440-4e37-b32a-247d8110dc35"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":9,"raw_source":"def test_empty\n    assert_equal([], ''.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"46305530-9e6d-4706-b818-0f0a1fc849b5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2153,"raw_source":"def self.new(base = Base, &block)\n    base = Class.new(base)\n    base.class_eval(&block) if block_given?\n    base\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[null,\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"base\"]}]}]}","id":"72796c5d-6979-4fa7-a856-f1e27e54d900"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":48,"raw_source":"def idempotent?\n            _idempotent? or propfind? or move? or unlock? # or lock?\n          end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_idempotent?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]},{\"type\":\"send\",\"children\":[null,\"move?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlock?\"]}]}]}","id":"1b6d60ef-99f6-4c7d-9ff4-a6809153343f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":249,"raw_source":"def test_recoursive_array_notation\n    assigns = { \"test\" => { 'test' => [1, 2, 3, 4, 5] } }\n    assert_template_result(\"1\", \"{{ test.test[0] }}\", assigns)\n\n    assigns = { \"test\" => [{ 'test' => 'worked' }] }\n    assert_template_result(\"worked\", \"{{ test[0].test }}\", assigns)\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recoursive_array_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.test[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test[0].test }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"de2f2298-70e1-4b97-8c84-46b69388d650"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":118,"raw_source":"def config_file(*paths)\n      Dir.chdir(root || '.') do\n        paths.each do |pattern|\n          Dir.glob(pattern) do |file|\n            raise UnsupportedConfigType unless ['.yml', '.yaml', '.erb'].include?(File.extname(file))\n\n            logger.info \"loading config file '#{file}'\" if logging? && respond_to?(:logger)\n            document = ERB.new(File.read(file)).result\n            yaml = YAML.respond_to?(:unsafe_load) ? YAML.unsafe_load(document) : YAML.load(document)\n            config = config_for_env(yaml)\n            config.each_pair { |key, value| set(key, value) }\n          end\n        end\n      end\n    end","complexity_score":44.5,"ast_json":"{\"type\":\"def\",\"children\":[\"config_file\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"paths\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"chdir\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"str\",\"children\":[\".\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"glob\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\".yml\"]},{\"type\":\"str\",\"children\":[\".yaml\"]},{\"type\":\"str\",\"children\":[\".erb\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"UnsupportedConfigType\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging?\"]},{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logger\"]},\"info\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"loading config file '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"document\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ERB\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"yaml\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"unsafe_load\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"unsafe_load\",{\"type\":\"lvar\",\"children\":[\"document\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"document\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"config\",{\"type\":\"send\",\"children\":[null,\"config_for_env\",{\"type\":\"lvar\",\"children\":[\"yaml\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"config\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}]}]}","id":"2177cbfa-98af-4bef-b226-e91d2740c96d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":48,"raw_source":"def test_comparison_of_strings_containing_and_or_or\n    awful_markup = \"a == 'and' and b == 'or' and c == 'foo and bar' and d == 'bar or baz' and e == 'foo' and foo and bar\"\n    assigns      = { 'a' => 'and', 'b' => 'or', 'c' => 'foo and bar', 'd' => 'bar or baz', 'e' => 'foo', 'foo' => true, 'bar' => true }\n    assert_template_result(' YES ', \"{% if #{awful_markup} %} YES {% endif %}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparison_of_strings_containing_and_or_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"awful_markup\",{\"type\":\"str\",\"children\":[\"a == 'and' and b == 'or' and c == 'foo and bar' and d == 'bar or baz' and e == 'foo' and foo and bar\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"and\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"or\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"foo and bar\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"bar or baz\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"e\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"awful_markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"2c66c43d-335d-4ad2-b4e9-8161ac690eb0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":119,"raw_source":"def merge(new_scopes)\n      @scopes[0].merge!(new_scopes)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"new_scopes\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"new_scopes\"]}]}]}","id":"c2b0894e-13cb-4dd5-a71e-5d416979698a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":186,"raw_source":"def test_pre_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true %}\n          yes\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false %}\n          no\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"6d668f42-321b-496c-a5b1-4034b9fe3319"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":479,"raw_source":"def each(&front)\n        @front = front\n        @scheduler.defer do\n          begin\n            @back.call(self)\n          rescue Exception => e\n            @scheduler.schedule { raise e }\n          ensure\n            close unless @keep_open\n          end\n        end\n      end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"front\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@front\",{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"defer\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@back\"]},\"call\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@keep_open\"]},null,{\"type\":\"send\",\"children\":[null,\"close\"]}]}]}]}]}]}]}","id":"963a40bc-116e-404f-852e-0d7388a8186f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":105,"raw_source":"def test_compact\n    # Test strings\n    assert_template_result(\n      \"a b c\",\n      \"{{words | compact | join}}\",\n      { \"words\" => ['a', nil, 'b', nil, 'c'] },\n    )\n\n    # Test hashes\n    assert_template_result(\n      \"A C\",\n      \"{{hashes | compact: 'a' | map: 'a' | join}}\",\n      { \"hashes\" => [{ \"a\" => \"A\" }, { \"a\" => nil }, { \"a\" => \"C\" }] },\n    )\n\n    # Test objects\n    @context['objects'] = [TestObject.new('A'), TestObject.new(nil), TestObject.new('C')]\n    assert_equal('A C', Template.parse(\"{{objects | compact: 'a' | map: 'a' | join}}\").render(@context))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a b c\"]},{\"type\":\"str\",\"children\":[\"{{words | compact | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A C\"]},{\"type\":\"str\",\"children\":[\"{{hashes | compact: 'a' | map: 'a' | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hashes\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"objects\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"C\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{objects | compact: 'a' | map: 'a' | join}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}","id":"1097edbb-8017-45ea-8668-5a9d46512534"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/xss_header.rb","start_line":19,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['x-xss-protection']       ||= \"1; mode=#{options[:xss_mode]}\" if html? headers\n        headers['x-content-type-options'] ||= 'nosniff'                       if options[:nosniff]\n        [status, headers, body]\n      end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-xss-protection\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"1; mode=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"xss_mode\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nosniff\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-content-type-options\"]}]},{\"type\":\"str\",\"children\":[\"nosniff\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"5ac76f8e-0aaf-4db4-8278-0ee433d92649"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/echo.rb","start_line":24,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      @variable = Variable.new(markup, parse_context)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}","id":"540cae28-606f-4db7-8c5d-52bc576d7cff"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":34,"raw_source":"def initialize(tag_name, markup, parse_context)\n      @tag_name      = tag_name\n      @markup        = markup\n      @parse_context = parse_context\n      @line_number   = parse_context.line_number\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tag_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@markup\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]}]}]}","id":"ab83457e-a443-4c28-8e53-a25de19318c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":67,"raw_source":"def strainer\n      @strainer ||= @environment.create_strainer(self, @filters)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strainer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@strainer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"self\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@filters\"]}]}]}]}","id":"0bac42ce-1109-45a4-b69e-4a5376e049a8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":261,"raw_source":"def call(env)\n      env['sinatra.commonlogger'] ? @app.call(env) : super\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.commonlogger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"1740d01b-4e48-462b-969b-abcf8e48447a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":592,"raw_source":"def last_modified(time)\n      return unless time\n\n      time = time_for time\n      response['Last-Modified'] = time.httpdate\n      return if env['HTTP_IF_NONE_MATCH']\n\n      if (status == 200) && env['HTTP_IF_MODIFIED_SINCE']\n        # compare based on seconds since epoch\n        since = Time.httpdate(env['HTTP_IF_MODIFIED_SINCE']).to_i\n        halt 304 if since >= time.to_i\n      end\n\n      if (success? || (status == 412)) && env['HTTP_IF_UNMODIFIED_SINCE']\n        # compare based on seconds since epoch\n        since = Time.httpdate(env['HTTP_IF_UNMODIFIED_SINCE']).to_i\n        halt 412 if since < time.to_i\n      end\n    rescue ArgumentError\n    end","complexity_score":60.73,"ast_json":"{\"type\":\"def\",\"children\":[\"last_modified\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"time\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[null,\"time_for\",{\"type\":\"lvar\",\"children\":[\"time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Last-Modified\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"httpdate\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_NONE_MATCH\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[200]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MODIFIED_SINCE\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"since\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"httpdate\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MODIFIED_SINCE\"]}]}]},\"to_i\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"since\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[304]}]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"success?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[412]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_UNMODIFIED_SINCE\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"since\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"httpdate\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_UNMODIFIED_SINCE\"]}]}]},\"to_i\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"since\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[412]}]},null]}]},null]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null,null]},null]}]}","id":"66a3ca1c-42ce-4595-8c7c-b21a4d9b0d2b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":23,"raw_source":"def test_doc_tag_body_content\n    doc_content = \"  Documentation content\\n  @param {string} foo - test\\n\"\n    template_source = \"{% doc %}#{doc_content}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(doc_content, doc_tag.nodelist.first.to_s)\n  end","complexity_score":17.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_body_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc_content\",{\"type\":\"str\",\"children\":[\"  Documentation content\\n  @param {string} foo - test\\n\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"doc_content\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]},\"to_s\"]}]}]}]}","id":"845b68fa-9418-4933-bb98-5adb101774c6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":190,"raw_source":"def test_tablerow_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) %}{{ test }}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) %}{{ test }}{% endtablerow %}\"]}]}]}]}","id":"9cd37f25-dea4-4467-b425-c0a495221e54"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":191,"raw_source":"def test_table_row_renders_correct_error_message_for_invalid_parameters\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) limit:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) offset:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): invalid integer\",\n      '{% tablerow n in (1...10) cols:true %} {{n}} {% endtablerow %}',\n      render_errors: true,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_renders_correct_error_message_for_invalid_parameters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) limit:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) offset:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): invalid integer\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...10) cols:true %} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}","id":"c8a54230-d292-47e1-adbb-2d633f0c952e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":5,"raw_source":"def self.slice_collection(collection, from, to)\n      if (from != 0 || !to.nil?) && collection.respond_to?(:load_slice)\n        collection.load_slice(from, to)\n      else\n        slice_collection_using_each(collection, from, to)\n      end\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"slice_collection\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]},{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"!=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"nil?\"]},\"!\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"load_slice\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"load_slice\",{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]},{\"type\":\"send\",\"children\":[null,\"slice_collection_using_each\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]}]}","id":"68df7858-7226-4708-993a-33bf5c2a46d6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":216,"raw_source":"def test_pause_resume_big_offset\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = '{%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 offset:1000 %}{{i}}{%endfor%}'\n    expected = '123\n      next\n      456\n      next\n      '\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_big_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 offset:1000 %}{{i}}{%endfor%}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"b8071691-8530-45fa-9270-1730db74adb4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":123,"raw_source":"def mock_app(base = Sinatra::Base, &block)\n      inner = nil\n      @app  = Sinatra.new(base) do\n        inner = self\n        class_eval(&block)\n      end\n      @settings = inner\n      app\n    end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@settings\",{\"type\":\"lvar\",\"children\":[\"inner\"]}]},{\"type\":\"send\",\"children\":[null,\"app\"]}]}]}","id":"06d1f1a5-7fb6-48a5-902c-f5d1db45a992"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1732,"raw_source":"def define_singleton(name, content = Proc.new)\n        singleton_class.class_eval do\n          undef_method(name) if method_defined? name\n          String === content ? class_eval(\"def #{name}() #{content}; end\") : define_method(name, &content)\n        end\n      end","complexity_score":32.3,"ast_json":"{\"type\":\"def\",\"children\":[\"define_singleton\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"optarg\",\"children\":[\"content\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},\"new\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"singleton_class\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"undef_method\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"content\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"def \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\"() \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]}]},{\"type\":\"str\",\"children\":[\"; end\"]}]}]},{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]}]}]}]}]}]}]}","id":"f4408e51-4856-416a-bfd9-d922b1de147f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":595,"raw_source":"def test_disables_nested_tags\n    context = Context.new\n    context.with_disabled_tags([\"foo\"]) do\n      context.with_disabled_tags([\"foo\"]) do\n        assert_equal(true, context.tag_disabled?(\"foo\"))\n        assert_equal(false, context.tag_disabled?(\"bar\"))\n      end\n      context.with_disabled_tags([\"bar\"]) do\n        assert_equal(true, context.tag_disabled?(\"foo\"))\n        assert_equal(true, context.tag_disabled?(\"bar\"))\n        context.with_disabled_tags([\"foo\"]) do\n          assert_equal(true, context.tag_disabled?(\"foo\"))\n          assert_equal(true, context.tag_disabled?(\"bar\"))\n        end\n      end\n      assert_equal(true, context.tag_disabled?(\"foo\"))\n      assert_equal(false, context.tag_disabled?(\"bar\"))\n    end\n  end","complexity_score":35.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disables_nested_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]}","id":"13db13f9-14ae-4f45-b69d-61738b686dbb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":107,"raw_source":"def test_parsing_warn_with_line_numbers_adds_numbers_to_lexer_errors\n    template = Liquid::Template.parse(\n      '\n        foobar\n\n        {% if 1 =! 2 %}ok{% endif %}\n\n        bla\n            ',\n      error_mode: :warn,\n      line_numbers: true,\n    )\n\n    assert_equal(\n      ['Liquid syntax error (line 4): Unexpected character = in \"1 =! 2\"'],\n      template.warnings.map(&:message),\n    )\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_warn_with_line_numbers_adds_numbers_to_lexer_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        {% if 1 =! 2 %}ok{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        bla\\n\"]},{\"type\":\"str\",\"children\":[\"            \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unexpected character = in \\\"1 =! 2\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"message\"]}]}]}]}]}]}","id":"30137f5f-ac2a-4b00-acde-bb9ba51de5ac"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":195,"raw_source":"def unmasked_token?(token)\n        token.length == TOKEN_LENGTH\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unmasked_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"TOKEN_LENGTH\"]}]}]}","id":"140de564-9d90-43ed-ad10-ce6cefaf3bd9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":22,"raw_source":"def self.raises pattern, mtype = :sinatra, mopts = {}\n    it \"does not compile #{pattern}\" do\n      assert_raises(Mustermann::CompileError, %Q{Pattern \"#{pattern}\" compiles but it should not}) do\n        mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      end\n    end\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raises\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"does not compile \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"CompileError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Pattern \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\" compiles but it should not\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]}]}]}","id":"8ea9dbb5-8412-426b-bfbe-0a95d50f75e7"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":65,"raw_source":"def run\n    each_test do |liquid, layout, assigns, page_template, template_name|\n      compile_and_render(liquid, layout, assigns, page_template, template_name)\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_test\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"liquid\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[null,\"compile_and_render\",{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]}]}","id":"ab79c711-f678-4a22-a42f-90ef9ac8682f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":31,"raw_source":"def unknown_tag(tag, _markup, _tokenizer)\n      case tag\n      when 'else', 'end'\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unexpected_outer_tag\", tag: tag)\n      else\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unknown_tag\", tag: tag)\n      end\n    end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"_markup\"]},{\"type\":\"arg\",\"children\":[\"_tokenizer\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"end\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unexpected_outer_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unknown_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]}]}","id":"dd462e85-0d04-4794-b442-bbe4b7e8c157"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":132,"raw_source":"def each_key(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each_key(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_key\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each_key\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"8c99cdf5-8e1b-4981-8d20-fca063291718"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":75,"raw_source":"def replay(object)\n      recorded_methods.each { |m, a, b| object.send(m, *a, &b) }\n    end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"replay\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"recorded_methods\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]},{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"m\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}","id":"d9887c59-ba76-45ee-8237-520c22d8fe95"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":166,"raw_source":"def has_value?(value)\n        response_cookies.value? value or request_cookies.value? value\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"has_value?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"value?\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"value?\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"51f2cb86-26c6-4051-ad82-f4825aeaf215"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":225,"raw_source":"def rehash\n        response_cookies.rehash\n        request_cookies.rehash\n        self\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"rehash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"rehash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"rehash\"]},{\"type\":\"self\",\"children\":[]}]}]}","id":"bcfe14e8-7033-4788-b9da-2ff8bd17d6d2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":61,"raw_source":"def self_time\n        @self_time ||= begin\n          total_children_time = 0.0\n          @children.each do |child|\n            total_children_time += child.total_time\n          end\n          @total_time - total_children_time\n        end\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"self_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@self_time\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"total_children_time\",{\"type\":\"float\",\"children\":[0.0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"total_children_time\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"total_time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@total_time\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"total_children_time\"]}]}]}]}]}","id":"f47493e4-537e-4b90-9a5d-b9e3f2ef4e92"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":183,"raw_source":"def test_tablerow_offset\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) offset: test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) offset: test %}{% endtablerow %}\"]}]}]}]}","id":"2c97b5b6-2811-4446-9df7-3aa5fe41c44c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":92,"raw_source":"def test_string_double_quoted\n    var = create_variable(%( 'hello' ))\n    assert_equal('hello', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_double_quoted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'hello' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"7e186d7a-88f4-4dce-a989-38a85a37d45e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":118,"raw_source":"def test_string_with_special_chars\n    var = create_variable(%( 'hello! $!@.;\"ddasd\" ' ))\n    assert_equal('hello! $!@.;\"ddasd\" ', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_with_special_chars\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'hello! $!@.;\\\"ddasd\\\" ' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello! $!@.;\\\"ddasd\\\" \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"4143999e-0b23-4c66-9544-a4bf43db3f45"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":311,"raw_source":"def test_sort_with_nils\n    assert_equal([1, 2, 3, 4, nil], @filters.sort([nil, 4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }, {}], @filters.sort([{ \"a\" => 4 }, { \"a\" => 3 }, {}, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_with_nils\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"cb0b9a29-03ae-4d0a-8012-0e12ae48f64f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":174,"raw_source":"def body=(value)\n      value = value.body while Rack::Response === value\n      @body = String === value ? [value.to_str] : value\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"body=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Response\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"body\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_str\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}","id":"50e72bc7-9102-4fbf-ad1d-5166b5041f32"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/response_test.rb","start_line":6,"raw_source":"def assert_same_body(a, b)\n    assert_equal a.to_enum(:each).to_a, b.to_enum(:each).to_a\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_same_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_enum\",{\"type\":\"sym\",\"children\":[\"each\"]}]},\"to_a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_enum\",{\"type\":\"sym\",\"children\":[\"each\"]}]},\"to_a\"]}]}]}","id":"88019d23-a3cf-447a-b778-fb07b4440cf8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":74,"raw_source":"def test_profiling_includes_line_numbers_of_included_partials\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    included_children = t.profiler[0].children\n\n    # {% assign template_name = 'a_template' %}\n    assert_equal(1, included_children[0].line_number)\n    # {{ template_name }}\n    assert_equal(2, included_children[1].line_number)\n  end","complexity_score":15.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_includes_line_numbers_of_included_partials\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"included_children\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"included_children\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"included_children\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"line_number\"]}]}]}]}","id":"f5010613-f25b-473e-9c8f-c58e842d6d09"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1518,"raw_source":"def public=(value)\n        warn_for_deprecation ':public is no longer used to avoid overloading Module#public, use :public_folder or :public_dir instead'\n        set(:public_folder, value)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"public=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn_for_deprecation\",{\"type\":\"str\",\"children\":[\":public is no longer used to avoid overloading Module#public, use :public_folder or :public_dir instead\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"public_folder\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"ed93edda-a03b-45d5-b9f3-2d89189ce56d"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":6,"raw_source":"def initialize(tag_name, markup, options)\n    super\n\n    if markup =~ Syntax\n      @collection_name = Regexp.last_match(1)\n      @page_size       = if Regexp.last_match(2)\n        Regexp.last_match(3).to_i\n      else\n        20\n      end\n\n      @attributes = { 'window_size' => 3 }\n      markup.scan(Liquid::TagAttributes) do |key, value|\n        @attributes[key] = value\n      end\n    else\n      raise SyntaxError, \"Syntax Error in tag 'paginate' - Valid syntax: paginate [collection] by number\"\n    end\n  end","complexity_score":18.55,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@page_size\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"to_i\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"window_size\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"str\",\"children\":[\"Syntax Error in tag 'paginate' - Valid syntax: paginate [collection] by number\"]}]}]}]}]}","id":"0060814b-2364-4b53-9072-e2fd5b20b7af"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":108,"raw_source":"def invoke(method, *args)\n      strainer.invoke(method, *args).to_liquid\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strainer\"]},\"invoke\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},\"to_liquid\"]}]}","id":"35be4ebc-d31c-48e4-8530-e0036fcdb962"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":148,"raw_source":"def content_for?(key)\n      content_blocks[key.to_sym].any?\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"content_for?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"any?\"]}]}","id":"5355c839-c121-4378-b500-34c06675f7df"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":149,"raw_source":"def test_single_line_post_tag\n    text     = '<p> {% if true -%} yes {% endif -%} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {% if false -%} no {% endif -%} </p>'\n    expected = '<p> </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_post_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if true -%} yes {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if false -%} no {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"2601947c-7ee4-4791-8eed-170a7745aa5f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":182,"raw_source":"def rewind\n        @pos = @lineno = 0\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rewind\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@pos\",{\"type\":\"ivasgn\",\"children\":[\"@lineno\",{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"288e8a8b-725d-45b8-b0ad-591abb5c1c6b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":559,"raw_source":"def test_new_isolated_subcontext_inherits_static_registers\n    super_context = Context.build(registers: { my_register: :my_value })\n    subcontext    = super_context.new_isolated_subcontext\n    assert_equal(:my_value, subcontext.registers[:my_register])\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}","id":"5319334c-52e0-4839-a29b-51ce7fbb273e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":13,"raw_source":"def test_quote\n    assert_equal(['\"arg 1\"'], '\"arg 1\"'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quote\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"arg 1\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"arg 1\\\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"ea92a557-894a-4c50-a57f-d7976b9c4f39"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":67,"raw_source":"def test_assign_score_exceeding_limit_from_composite_object\n    t = Template.parse(\"{% assign foo = 'aaaa' | reverse %}\")\n\n    t.resource_limits.assign_score_limit = 3\n    assert_equal(\"Liquid error: Memory limits exceeded\", t.render)\n    assert(t.resource_limits.reached?)\n\n    t.resource_limits.assign_score_limit = 5\n    assert_equal(\"\", t.render!)\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_exceeding_limit_from_composite_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign foo = 'aaaa' | reverse %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Memory limits exceeded\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"reached?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]}]}]}]}","id":"68903ebb-792b-4330-883f-f7725fa6bd6b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":227,"raw_source":"def rendering_method(engine)\n      return [engine] if Sinatra::Templates.method_defined? engine\n      return [:mab] if engine.to_sym == :markaby\n\n      %i[render engine]\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"rendering_method\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Templates\"]},\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"markaby\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"mab\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"sym\",\"children\":[\"engine\"]}]}]}]}","id":"1fbc6c57-c991-4530-a0f9-b36683ae211f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":206,"raw_source":"def ignore?\n        !!@ignore\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"ignore?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ignore\"]},\"!\"]},\"!\"]}]}","id":"4e468123-24c0-4ddc-8b37-106e7a6c96ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":370,"raw_source":"def test_for_parentloop_nil_when_not_present\n    assert_template_result(\n      '.1 .2 ',\n      '{% for inner in outer %}' \\\n      '{{ forloop.parentloop.index }}.{{ forloop.index }} ' \\\n      '{% endfor %}',\n      { 'outer' => [[1, 1, 1], [1, 1, 1]] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_parentloop_nil_when_not_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".1 .2 \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for inner in outer %}\"]},{\"type\":\"str\",\"children\":[\"{{ forloop.parentloop.index }}.{{ forloop.index }} \"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"311effe8-20ee-4b03-a4bf-ce6efa54d65b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":199,"raw_source":"def tok(s)\n    case s[0]\n    when ?{  then ['{', s[0,1], s[0,1]]\n    when ?}  then ['}', s[0,1], s[0,1]]\n    when ?:  then [':', s[0,1], s[0,1]]\n    when ?,  then [',', s[0,1], s[0,1]]\n    when ?[  then ['[', s[0,1], s[0,1]]\n    when ?]  then [']', s[0,1], s[0,1]]\n    when ?n  then nulltok(s)\n    when ?t  then truetok(s)\n    when ?f  then falsetok(s)\n    when ?\"  then strtok(s)\n    when Spc then [:space, s[0,1], s[0,1]]\n    when ?\\t then [:space, s[0,1], s[0,1]]\n    when ?\\n then [:space, s[0,1], s[0,1]]\n    when ?\\r then [:space, s[0,1], s[0,1]]\n    else          numtok(s)\n    end\n  end","complexity_score":54.3,"ast_json":"{\"type\":\"def\",\"children\":[\"tok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"}\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"}\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"]\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"]\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"n\"]},{\"type\":\"send\",\"children\":[null,\"nulltok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"t\"]},{\"type\":\"send\",\"children\":[null,\"truetok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[null,\"falsetok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"send\",\"children\":[null,\"strtok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Spc\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\t\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\r\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"space\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"numtok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]}]}","id":"59b62a56-35c6-4644-a6d6-c5d51e08d29e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":67,"raw_source":"def evaluate(context = deprecated_default_context)\n      condition = self\n      result = nil\n      loop do\n        result = interpret_condition(condition.left, condition.right, condition.operator, context)\n\n        case condition.child_relation\n        when :or\n          break if Liquid::Utils.to_liquid_value(result)\n        when :and\n          break unless Liquid::Utils.to_liquid_value(result)\n        else\n          break\n        end\n        condition = condition.child_condition\n      end\n      result\n    end","complexity_score":25.6,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[null,\"deprecated_default_context\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"interpret_condition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"left\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"operator\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"child_relation\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"or\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"break\",\"children\":[]},null]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"and\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},null,{\"type\":\"break\",\"children\":[]}]}]},{\"type\":\"break\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"child_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"78c2de13-9ab0-418d-ad37-5f7b734960f1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":343,"raw_source":"def register(*extensions, &block)\n        start_registering_extension\n        result = super\n        stop_registering_extension\n        result\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"start_registering_extension\"]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"stop_registering_extension\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"9fe8f3ef-5d95-4225-b92a-01b10c8f036d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":84,"raw_source":"def each\n    yield 1\n    yield 2\n    yield 3\n  end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]}","id":"5cbe61da-08af-46a1-8b60-6fed8fe2904a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/quiet_logger.rb","start_line":48,"raw_source":"def log(env, *)\n            super unless env['PATH_INFO'] =~ QUIET_LOGGER_REGEX\n          end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"=~\",{\"type\":\"const\",\"children\":[null,\"QUIET_LOGGER_REGEX\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"e3b68d22-fa78-4377-9ce3-19961ed9212f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":73,"raw_source":"def test_hash_scoping\n    assert_template_result('worked', \"{{ test.test }}\", { 'test' => { 'test' => 'worked' } })\n    assert_template_result('worked', \"{{ test . test }}\", { 'test' => { 'test' => 'worked' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_scoping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test.test }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{ test . test }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]}]}]}]}]}","id":"7ec694d3-a1a7-48ea-a66a-7c5ea63dc8ff"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":83,"raw_source":"def link(*urls)\n      opts          = urls.last.respond_to?(:to_hash) ? urls.pop : {}\n      opts[:rel]    = urls.shift unless urls.first.respond_to? :to_str\n      options       = opts.map { |k, v| \" #{k}=#{v.to_s.inspect}\" }\n      html_pattern  = \"<link href=\\\"%s\\\"#{options.join} />\"\n      http_pattern  = ['<%s>', *options].join ';'\n      link          = (response['Link'] ||= '')\n\n      link = response['Link'] = +link\n\n      urls.map do |url|\n        link << \",\" unless link.empty?\n        link << (http_pattern % url)\n        html_pattern % url\n      end.join\n    end","complexity_score":38.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"urls\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"first\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"rel\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"shift\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"to_s\"]},\"inspect\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"html_pattern\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<link href=\\\"%s\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"join\"]}]},{\"type\":\"str\",\"children\":[\" />\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"http_pattern\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<%s>\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\";\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"link\",{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Link\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"link\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Link\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"+@\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"<<\",{\"type\":\"str\",\"children\":[\",\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"link\"]},\"<<\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html_pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]}]},\"join\"]}]}]}","id":"1ff05b5f-1ec9-43a0-8ed3-8df63b3d6159"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":239,"raw_source":"def test_render_with\n    assert_equal(\n      [\"test\"],\n      visit(%({% render \"hai\" with test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_with\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% render \\\"hai\\\" with test %}\"]}]}]}]}","id":"53fc78a1-e8a1-4d55-be90-88636f54f2ba"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":89,"raw_source":"def test_strainer_uses_a_class_cache_to_avoid_method_cache_invalidation\n    a = Module.new\n    b = Module.new\n\n    strainer = @environment.create_strainer(@context, [a, b])\n\n    assert_kind_of(StrainerTemplate, strainer)\n    assert_kind_of(a, strainer)\n    assert_kind_of(b, strainer)\n    assert_kind_of(Liquid::StandardFilters, strainer)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_uses_a_class_cache_to_avoid_method_cache_invalidation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"b\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[null,\"StrainerTemplate\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"lvar\",\"children\":[\"b\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StandardFilters\"]},{\"type\":\"lvar\",\"children\":[\"strainer\"]}]}]}]}","id":"02e44c9b-e907-4604-9582-7768ac70b8fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":94,"raw_source":"def compile_and_render(template, layout, assigns, page_template, template_file)\n    compiled_test = compile_test(template, layout, assigns, page_template, template_file)\n    render_layout(compiled_test[:tmpl], compiled_test[:layout], compiled_test[:assigns])\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_and_render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled_test\",{\"type\":\"send\",\"children\":[null,\"compile_test\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]},{\"type\":\"send\",\"children\":[null,\"render_layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tmpl\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled_test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assigns\"]}]}]}]}]}","id":"b4e84a14-8cc6-4073-8bf6-edaa01ae400c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":15,"raw_source":"def test_jump\n    p = new_parser(\"wat: 7\")\n    p.jump(2)\n    assert_equal('7', p.consume(:number))\n  end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_jump\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"jump\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}","id":"557732cc-c4d8-4e10-8480-f50017aad614"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1853,"raw_source":"def setup_custom_logger(builder)\n        if logging.respond_to? :to_int\n          builder.use Sinatra::Middleware::Logger, logging\n        else\n          builder.use Sinatra::Middleware::Logger\n        end\n      end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_custom_logger\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_int\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Middleware\"]},\"Logger\"]},{\"type\":\"send\",\"children\":[null,\"logging\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Middleware\"]},\"Logger\"]}]}]}]}","id":"598b205a-d1f3-4d87-9767-8921217a2154"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":155,"raw_source":"def test_for_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) %}{{ test }}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) %}{{ test }}{% endfor %}\"]}]}]}]}","id":"b653b3dd-3b45-427e-b8ee-2debd2b8dfc3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":75,"raw_source":"def parse_body(body, tokens)\n      if parse_context.depth >= MAX_DEPTH\n        raise StackLevelError, \"Nesting too deep\"\n      end\n      parse_context.depth += 1\n      begin\n        body.parse(tokens, parse_context) do |end_tag_name, end_tag_params|\n          @blank &&= body.blank?\n\n          return false if end_tag_name == block_delimiter\n          raise_tag_never_closed(block_name) unless end_tag_name\n\n          # this tag is not registered with the system\n          # pass it to the current block for special handling or error reporting\n          unknown_tag(end_tag_name, end_tag_params, tokens)\n        end\n      ensure\n        parse_context.depth -= 1\n      end\n\n      true\n    end","complexity_score":22.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"MAX_DEPTH\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokens\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"end_tag_name\"]},{\"type\":\"arg\",\"children\":[\"end_tag_params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"blank?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},null,{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"unknown_tag\",{\"type\":\"lvar\",\"children\":[\"end_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"end_tag_params\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"true\",\"children\":[]}]}]}","id":"7d9d9d7e-36d7-4246-a502-5d7f771ee29f"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":4,"raw_source":"def money_with_currency(money)\n    return '' if money.nil?\n    format(\"$ %.2f USD\", money / 100.0)\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"money_with_currency\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"money\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$ %.2f USD\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}","id":"2f256670-7f0d-46c9-9768-6c5bbcaea4fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":40,"raw_source":"def parse(tokens)\n      if parse_body(@for_block, tokens)\n        parse_body(@else_block, tokens)\n      end\n      if blank?\n        @else_block&.remove_blank_strings\n        @for_block.remove_blank_strings\n      end\n      @else_block&.freeze\n      @for_block.freeze\n    end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@for_block\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@else_block\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"remove_blank_strings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"remove_blank_strings\"]}]},null]},{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"freeze\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"freeze\"]}]}]}","id":"e323c6e0-0be1-445b-bf20-c8a4e8e1bba7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":84,"raw_source":"def test_recursively_rendered_template_does_not_produce_endless_loop\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('loop' => '{% render \"loop\" %}'),\n    )\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse('{% render \"loop\" %}', environment: env).render!\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recursively_rendered_template_does_not_produce_endless_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"loop\\\" %}\"]}]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"loop\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}","id":"fdd5fcf1-9173-406d-ac4a-575f35132e81"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":557,"raw_source":"def compact(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      if property.nil?\n        ary.compact\n      elsif ary.empty? # The next two cases assume a non-empty array.\n        []\n      else\n        ary.reject do |item|\n          item[property].nil?\n        rescue TypeError\n          raise_property_error(property)\n        rescue NoMethodError\n          return nil unless item.respond_to?(:[])\n          raise\n        end\n      end\n    end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"compact\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},\"nil?\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}]}","id":"34b31797-fed6-411e-a746-af613d08678f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":37,"raw_source":"def call(env)\n      env['PATH_INFO'] = env['PATH_INFO'].downcase\n      super\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"downcase\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"c7f5890e-3f19-41b5-a506-8346fda7f864"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":39,"raw_source":"def test_no_instance_eval_later_in_chain\n    text     = %( {{ '1+1' | add_one | instance_eval }} )\n    expected = %( 1+1 + 1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: SecurityFilter))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval_later_in_chain\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | add_one | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 + 1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"const\",\"children\":[null,\"SecurityFilter\"]}]}]}]}]}]}]}","id":"69229488-cfab-4396-9720-2f0ed02f94b8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":673,"raw_source":"def test_lstrip\n    assert_template_result('ab c  ', \"{{ source | lstrip }}\", { 'source' => \" ab c  \" })\n    assert_template_result(\"ab c  \\n \\t\", \"{{ source | lstrip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lstrip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c  \"]},{\"type\":\"str\",\"children\":[\"{{ source | lstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"ab c  \\n \\t\"]},{\"type\":\"str\",\"children\":[\"{{ source | lstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}","id":"733a5422-e9d6-4950-8ad8-a4aac1f392a7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":96,"raw_source":"def domain_match?(host)\n        return false if host.nil?\n        return false if host.start_with?(DOT)\n\n        @domain_hosts.any? { |domain_host| host.match?(domain_host) }\n      end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"domain_match?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"domain_host\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"domain_host\"]}]}]}]}]}","id":"07b6e921-770a-4eaf-a648-6c7551019ab2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1610,"raw_source":"def run!(options = {}, &block)\n        unless defined?(Rackup::Handler)\n          rackup_warning = <<~MISSING_RACKUP\n            Sinatra could not start, the required gems weren't found!\n\n            Add them to your bundle with:\n\n                bundle add rackup puma\n\n            or install them with:\n\n                gem install rackup puma\n\n          MISSING_RACKUP\n          warn rackup_warning\n          exit 1\n        end\n\n        return if running?\n\n        set options\n        handler         = Rackup::Handler.pick(server)\n        handler_name    = handler.name.gsub(/.*::/, '')\n        server_settings = settings.respond_to?(:server_settings) ? settings.server_settings : {}\n        server_settings.merge!(Port: port, Host: bind)\n\n        begin\n          start_server(handler, server_settings, handler_name, &block)\n        rescue Errno::EADDRINUSE\n          warn \"== Someone is already performing on port #{port}!\"\n          raise\n        ensure\n          quit!\n        end\n      end","complexity_score":33.25,"ast_json":"{\"type\":\"def\",\"children\":[\"run!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rackup\"]},\"Handler\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"rackup_warning\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra could not start, the required gems weren't found!\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Add them to your bundle with:\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    bundle add rackup puma\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"or install them with:\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    gem install rackup puma\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"rackup_warning\"]}]},{\"type\":\"send\",\"children\":[null,\"exit\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rackup\"]},\"Handler\"]},\"pick\",{\"type\":\"send\",\"children\":[null,\"server\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"handler_name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler\"]},\"name\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*::\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"server_settings\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"server_settings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"server_settings\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server_settings\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"Port\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"Host\"]},{\"type\":\"send\",\"children\":[null,\"bind\"]}]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"start_server\",{\"type\":\"lvar\",\"children\":[\"handler\"]},{\"type\":\"lvar\",\"children\":[\"server_settings\"]},{\"type\":\"lvar\",\"children\":[\"handler_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"EADDRINUSE\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"== Someone is already performing on port \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\"!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"quit!\"]}]}]}]}]}","id":"b59a1afb-4ec3-4a73-89ea-88a0dd1111ef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":328,"raw_source":"def compile(pattern, conditions, default_pattern = nil)\n        if pattern.respond_to? :to_hash\n          conditions = conditions.merge pattern.to_hash\n          pattern = nil\n        end\n        base_pattern = @pattern\n        base_conditions = @conditions\n        pattern ||= default_pattern\n        [prefixed_path(base_pattern, pattern),\n         (base_conditions || {}).merge(conditions)]\n      end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"conditions\"]},{\"type\":\"optarg\",\"children\":[\"default_pattern\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"conditions\"]},\"merge\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"to_hash\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"base_pattern\",{\"type\":\"ivar\",\"children\":[\"@pattern\"]}]},{\"type\":\"lvasgn\",\"children\":[\"base_conditions\",{\"type\":\"ivar\",\"children\":[\"@conditions\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"default_pattern\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prefixed_path\",{\"type\":\"lvar\",\"children\":[\"base_pattern\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_conditions\"]},{\"type\":\"hash\",\"children\":[]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]}]}]}","id":"057f143e-3d86-4f9f-92db-2df6a6839c01"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1693,"raw_source":"def start_server(handler, server_settings, handler_name)\n        # Ensure we initialize middleware before startup, to match standard Rack\n        # behavior, by ensuring an instance exists:\n        prototype\n        # Run the instance we created:\n        handler.run(self, **server_settings) do |server|\n          unless suppress_messages?\n            warn \"== Sinatra (v#{Sinatra::VERSION}) has taken the stage on #{port} for #{environment} with backup from #{handler_name}\"\n          end\n\n          setup_traps\n          set :running_server, server\n          set :handler_name,   handler_name\n          server.threaded = settings.threaded if server.respond_to? :threaded=\n          on_start_callback.call unless on_start_callback.nil?\n          yield server if block_given?\n        end\n      end","complexity_score":30.1,"ast_json":"{\"type\":\"def\",\"children\":[\"start_server\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"handler\"]},{\"type\":\"arg\",\"children\":[\"server_settings\"]},{\"type\":\"arg\",\"children\":[\"handler_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prototype\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler\"]},\"run\",{\"type\":\"self\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server_settings\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"suppress_messages?\"]},null,{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"== Sinatra (v\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"VERSION\"]}]},{\"type\":\"str\",\"children\":[\") has taken the stage on \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\" for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]}]},{\"type\":\"str\",\"children\":[\" with backup from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handler_name\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"setup_traps\"]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"running_server\"]},{\"type\":\"lvar\",\"children\":[\"server\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"handler_name\"]},{\"type\":\"lvar\",\"children\":[\"handler_name\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"threaded=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"threaded=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"threaded\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_start_callback\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_start_callback\"]},\"call\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]}]},null]}]}]}]}]}","id":"3e75d666-10fc-41ee-8438-e6ecb25a0bce"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1251,"raw_source":"def test_sum_without_property_calls_to_liquid\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sum }}').render(\"foo\" => [t])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_without_property_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sum }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}","id":"c76e024c-e629-4a5d-8e86-000cf63b02d8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":44,"raw_source":"def safe?\n            _safe? or propfind?\n          end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_safe?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]}]}","id":"974c2036-ecdf-441e-a7eb-dc13e598e4fd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":118,"raw_source":"def test_render_tag_doesnt_cache_partials_across_renders\n    file_system = StubFileSystem.new('snippet' => 'my message')\n\n    assert_equal(\n      'my message',\n      Template.parse('{% include \"snippet\" %}').render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.file_read_count)\n\n    assert_equal(\n      'my message',\n      Template.parse('{% include \"snippet\" %}').render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(2, file_system.file_read_count)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_doesnt_cache_partials_across_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"my message\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}","id":"eba023b5-d0ae-408c-a2e8-4b10d85e1258"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":221,"raw_source":"def rassoc(value)\n        to_hash.rassoc(value)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"rassoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"rassoc\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}","id":"e53d06bf-13a5-4f05-9954-51a5660eefc7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1057,"raw_source":"def filter!(type, base = settings, &block)\n      filter!(type, base.superclass, &block) if base.superclass.respond_to?(:filters)\n      base.filters[type].each do |args|\n        result = process_route(*args)\n        block.call(result) if block_given?\n      end\n    end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"filter!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},null]}]}]}]}]}","id":"1ac5d02b-24f9-47f9-9662-5e271b6bd01c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":66,"raw_source":"def forwarded?\n      !forwarded_authority.nil?\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"forwarded?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"forwarded_authority\"]},\"nil?\"]},\"!\"]}]}","id":"3c59cee0-aa61-477e-9d76-691fd4ba2c11"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":63,"raw_source":"def test_add_filter_does_not_raise_when_module_overrides_previously_registered_method\n    with_global_filter do\n      context = Context.new\n      context.add_filters([PublicMethodOverrideFilter])\n      strainer = context.strainer\n      assert(strainer.class.send(:filter_methods).include?('public_filter'))\n    end\n  end","complexity_score":17.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_does_not_raise_when_module_overrides_previously_registered_method\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strainer\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"filter_methods\"]}]},\"include?\",{\"type\":\"str\",\"children\":[\"public_filter\"]}]}]}]}]}]}","id":"c5b30bd0-a886-4af4-91c7-8ce297832aa2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":551,"raw_source":"def test_map_returns_empty_on_2d_input_array\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.map(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_returns_empty_on_2d_input_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}","id":"25f9f780-5507-47bf-8e62-7b7a6df4d592"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":137,"raw_source":"def test_catchall_integer_argument_drop\n    output = Liquid::Template.parse(' {{ product.catchall[8] }} ').render!('product' => ProductDrop.new)\n    assert_equal(' catchall_method: 8 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_catchall_integer_argument_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.catchall[8] }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" catchall_method: 8 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"a83fcbc1-2516-47f4-b2c0-e0c4dae142a0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":86,"raw_source":"def params\n      super\n    rescue Rack::Utils::ParameterTypeError, Rack::Utils::InvalidParameterError => e\n      raise BadRequest, \"Invalid query parameters: #{Rack::Utils.escape_html(e.message)}\"\n    rescue EOFError => e\n      raise BadRequest, \"Invalid multipart/form-data: #{Rack::Utils.escape_html(e.message)}\"\n    end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"params\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"ParameterTypeError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"InvalidParameterError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"BadRequest\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid query parameters: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"BadRequest\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid multipart/form-data: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}]}]},null]}]}","id":"5001202c-fffd-4cd3-8091-444403a83a5c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":196,"raw_source":"def test_default_exception_renderer_with_internal_error\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.runtime_error }}', line_numbers: true)\n\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: Liquid error (line 1): internal', output)\n    assert_equal([Liquid::InternalError], template.errors.map(&:class))\n  end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_exception_renderer_with_internal_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.runtime_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: Liquid error (line 1): internal\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}","id":"c06de403-ac04-42dd-953f-c7192fae7123"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":94,"raw_source":"def record_when_condition(markup)\n      body = new_body\n\n      while markup\n        unless markup =~ WhenSyntax\n          raise SyntaxError, options[:locale].t(\"errors.syntax.case_invalid_when\")\n        end\n\n        markup = Regexp.last_match(2)\n\n        block = Condition.new(@left, '==', Condition.parse_expression(parse_context, Regexp.last_match(1)))\n        block.attach(body)\n        @blocks << block\n      end\n    end","complexity_score":24.4,"ast_json":"{\"type\":\"def\",\"children\":[\"record_when_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"WhenSyntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case_invalid_when\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@left\"]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[null,\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"dcaeec7e-a677-4f9a-915f-0388acc0cc1a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":156,"raw_source":"def next_tag_token_with_start(start)\n      @ss.skip_until(TAG_END)\n      @source.byteslice(start, @ss.pos - start)\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"next_tag_token_with_start\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_END\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]}]}","id":"666f99a0-ad05-4268-8150-8e4fcdcfc4dc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":106,"raw_source":"def test_not_nil\n    text = ' {% if var != nil %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 1 })\n\n    text = ' {% if var != null %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 1 })\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_not_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var != nil %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var != null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}","id":"d0c647c7-fa76-4630-8cd6-0a02dfb7572b"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":26,"raw_source":"def visit(context = nil)\n      children.map do |node|\n        item, new_context = @callbacks[node.class].call(node, context)\n        [\n          item,\n          ParseTreeVisitor.for(node, @callbacks).visit(new_context || context),\n        ]\n      end\n    end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"context\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"item\"]},{\"type\":\"lvasgn\",\"children\":[\"new_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"ivar\",\"children\":[\"@callbacks\"]}]},\"visit\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}]}]}","id":"a3baaac7-62b2-4ccf-80a5-9f3fbb9496f7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/capture_spec.rb","start_line":17,"raw_source":"def render(engine, template)\n    subject.send(:render, engine, template.to_sym).strip.gsub(/\\s+/, ' ')\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"subject\"]},\"send\",{\"type\":\"sym\",\"children\":[\"render\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"to_sym\"]}]},\"strip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\" \"]}]}]}","id":"0692e8c6-15c0-40e4-8788-5cd0b0d52db1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":327,"raw_source":"def rstrip(input)\n      input = Utils.to_s(input)\n      input.rstrip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rstrip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"rstrip\"]}]}]}","id":"1350bc5b-a7d2-4e60-bbab-a2389a9eb8a3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":44,"raw_source":"def lax_parse(markup)\n      @filters = []\n      return unless markup =~ MarkupWithQuotedFragment\n\n      name_markup   = Regexp.last_match(1)\n      filter_markup = Regexp.last_match(2)\n      @name         = parse_context.parse_expression(name_markup)\n      if filter_markup =~ FilterMarkupRegex\n        filters = Regexp.last_match(1).scan(FilterParser)\n        filters.each do |f|\n          next unless f =~ /\\w+/\n          filtername = Regexp.last_match(0)\n          filterargs = f.scan(FilterArgsRegex).flatten\n          @filters << parse_filter_expressions(filtername, filterargs)\n        end\n      end\n    end","complexity_score":31.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"MarkupWithQuotedFragment\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"name_markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filter_markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"name_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"FilterMarkupRegex\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filters\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"FilterParser\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\w+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"filtername\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"FilterArgsRegex\"]}]},\"flatten\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"parse_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"filtername\"]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}]}]}]},null]}]}]}","id":"51af6c43-3f0a-4183-bd77-5c35bee57dcf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":159,"raw_source":"def from_environment_key(hash)\n      hash[environment.to_s] || hash[environment.to_sym] || {}\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"from_environment_key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_sym\"]}]}]},{\"type\":\"hash\",\"children\":[]}]}]}","id":"ad2fb75d-a11e-4f86-a6ee-6a682be95b48"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":59,"raw_source":"def register_tag(name, klass)\n        Deprecations.warn(\"Template.register_tag\", \"Environment#register_tag\")\n        Environment.default.register_tag(name, klass)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"register_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.register_tag\"]},{\"type\":\"str\",\"children\":[\"Environment#register_tag\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"register_tag\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]}","id":"f548387d-f11c-4371-a238-83148b9eaad1"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":8,"raw_source":"def highlight_active_tag(tag, css_class = 'active')\n    if @context['current_tags'].include?(tag)\n      \"<span class=\\\"#{css_class}\\\">#{tag}</span>\"\n    else\n      tag\n    end\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"highlight_active_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"optarg\",\"children\":[\"css_class\",{\"type\":\"str\",\"children\":[\"active\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"css_class\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}","id":"f563faa0-cecc-44f3-a315-ccdc2591a369"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1008,"raw_source":"def nil_safe_compare(a, b)\n      result = a <=> b\n\n      if result\n        result\n      elsif a.nil?\n        1\n      elsif b.nil?\n        -1\n      else\n        raise Liquid::ArgumentError, \"cannot sort values of incompatible types\"\n      end\n    end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nil_safe_compare\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"<=>\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[-1]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot sort values of incompatible types\"]}]}]}]}]}]}]}","id":"0ef50ff5-57f4-4b38-a242-f12c8e359e3a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":359,"raw_source":"def respond_to?(method, include_private = false)\n        super || base.respond_to?(method, include_private)\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"optarg\",\"children\":[\"include_private\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"include_private\"]}]}]}]}","id":"c8433d76-2087-4380-8605-a26e14fcb10a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":46,"raw_source":"def test_strainer_argument_error_contains_backtrace\n    strainer = @environment.create_strainer(@context)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      strainer.invoke(\"public_filter\", 1)\n    end\n\n    assert_match(\n      /\\ALiquid error: wrong number of arguments \\((1 for 0|given 1, expected 0)\\)\\z/,\n      exception.message,\n    )\n\n    source = AccessScopeFilters.instance_method(:public_filter).source_location\n    assert_equal(source[0..1].map(&:to_s), exception.backtrace[0].split(':')[0..1])\n  end","complexity_score":24.03,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_argument_error_contains_backtrace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\ALiquid error: wrong number of arguments \\\\((1 for 0|given 1, expected 0)\\\\)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AccessScopeFilters\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"public_filter\"]}]},\"source_location\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"backtrace\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"split\",{\"type\":\"str\",\"children\":[\":\"]}]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}","id":"e16e0a37-b535-4969-8cb5-a527efa60589"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":437,"raw_source":"def test_uniq_empty_array\n    assert_equal([], @filters.uniq([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}","id":"7576468f-bdc8-48aa-bbc6-2ce363ab3328"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":505,"raw_source":"def test_raw_output\n    whitespace = '        '\n    text       = <<-END_TEMPLATE\n      <div>\n        {% raw %}\n          {%- if true -%}\n            <p>\n              {{- 'John' -}}\n            </p>\n          {%- endif -%}\n        {% endraw %}\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n      #{whitespace}\n                {%- if true -%}\n                  <p>\n                    {{- 'John' -}}\n                  </p>\n                {%- endif -%}\n      #{whitespace}\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raw_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"        \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        {% endraw %}\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"8302dbc7-e6be-437b-bb04-ec6244fa38ec"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":79,"raw_source":"def stream(*)\n      stream = super\n      stream.extend Stream\n      stream.app = self\n      env['async.close'].callback { stream.close } if env.key? 'async.close'\n      stream\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"stream\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"app=\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"key?\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"stream\"]},\"close\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"stream\"]}]}]}","id":"a9c979b1-7d84-42a9-b5f5-13390b3e4468"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":280,"raw_source":"def to_s\n        to_hash.to_s\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"to_s\"]}]}","id":"880a5027-a0c3-4cec-bf07-69a1fb4eefc7"}

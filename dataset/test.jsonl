{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":32,"raw_source":"def test_block_tag_disabling_nested_tag\n    with_disableable_tags do\n      with_custom_tag('disable', DisableCustom) do\n        output = Template.parse('{% disable %}{% custom %};{% custom2 %}{% enddisable %}').render\n        assert_equal('Liquid error: custom usage is not allowed in this context;custom2', output)\n      end\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_block_tag_disabling_nested_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_disableable_tags\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"disable\"]},{\"type\":\"const\",\"children\":[null,\"DisableCustom\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% disable %}{% custom %};{% custom2 %}{% enddisable %}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: custom usage is not allowed in this context;custom2\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}","id":"a4a8535a-35fa-42fb-a9e4-aaa4cb4a856c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":64,"raw_source":"def handle(hash)\n        was = hash.dup\n        hash.replace escape(hash)\n        was\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"replace\",{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]},{\"type\":\"lvar\",\"children\":[\"was\"]}]}]}","id":"43811631-aee4-4dee-b5a3-bf4b965c32fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":94,"raw_source":"def test_assign_score_of_hash\n    assert_equal(1, assign_score_of({}))\n    assert_equal(5, assign_score_of('int' => 123))\n    assert_equal(12, assign_score_of('int' => 123, 'str' => 'abcd'))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"int\"]},{\"type\":\"int\",\"children\":[123]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[12]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"int\"]},{\"type\":\"int\",\"children\":[123]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"str\"]},{\"type\":\"str\",\"children\":[\"abcd\"]}]}]}]}]}]}]}","id":"8997429e-0649-4d5d-99dc-2f01bcd288d6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":142,"raw_source":"def watch(path, element)\n          watcher_for(path).elements << element\n        end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"watch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watcher_for\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"elements\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"element\"]}]}]}","id":"ae4b8022-8e47-4e23-a889-159ffe6fe4ec"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":8,"raw_source":"def test_add_filter_when_wrong_filter_class\n    c = Context.new\n    s = c.strainer\n    wrong_filter = ->(v) { v.reverse }\n\n    exception = assert_raises(TypeError) do\n      s.class.add_filter(wrong_filter)\n    end\n    assert_equal(exception.message, \"wrong argument type Proc (expected Module)\")\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_when_wrong_filter_class\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"strainer\"]}]},{\"type\":\"lvasgn\",\"children\":[\"wrong_filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"reverse\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"wrong_filter\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]},{\"type\":\"str\",\"children\":[\"wrong argument type Proc (expected Module)\"]}]}]}]}","id":"ae0104ec-febb-40db-bd2f-c661e5e7922e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":71,"raw_source":"def test_offset_and_limit\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3 offset:1 limit:6%} {{n}} {% endtablerow %}',\n      { 'numbers' => [0, 1, 2, 3, 4, 5, 6, 7] },\n    )\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_offset_and_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3 offset:1 limit:6%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}","id":"2748a8d2-5cfa-4f55-93c9-78d18cf9ac78"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":203,"raw_source":"def test_profiling_marks_children_of_if_blocks\n    t = Template.parse(\"{% if true %} {% increment test %} {{ test }} {% endif %}\", profile: true)\n    t.render!\n\n    assert_equal(1, t.profiler.length)\n    assert_equal(2, t.profiler[0].children.length)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_of_if_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %} {% increment test %} {{ test }} {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"length\"]}]}]}]}","id":"75ba6ef4-8e62-408c-9153-dd47d596fccd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":66,"raw_source":"def count\n    @count ||= 0\n    @count  += 1\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"count\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"4d918d56-2140-4d62-8c8c-2168f562ab70"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":385,"raw_source":"def test_sort_empty_array\n    assert_equal([], @filters.sort([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}","id":"d6c25986-b97d-4cfb-96fa-8942544924f4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":79,"raw_source":"def escape_hash(hash)\n        hash = hash.dup\n        hash.each { |k, v| hash[k] = escape(v) }\n        hash\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_hash\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"dup\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}","id":"2fcbd12d-6fd6-4ba1-9298-4e8cc11d4648"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":383,"raw_source":"def also_reload(*glob)\n        Dir[*glob].each { |path| Watcher::List.for(self).watch_file(path) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"also_reload\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"glob\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"glob\"]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]},\"watch_file\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}","id":"875a75da-9a02-4d79-917e-9ca394e81cd2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":147,"raw_source":"def replace(other_hash)\n      super(other_hash.is_a?(self.class) ? other_hash : self.class[other_hash])\n    end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other_hash\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"other_hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"other_hash\"]}]}]}]}]}","id":"6a82cb05-3135-419f-ba1c-210c3857d8a4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":112,"raw_source":"def test_or_condition\n    condition = Condition.new(1, '==', 2)\n    assert_equal(false, condition.evaluate(Context.new))\n\n    condition.or(Condition.new(2, '==', 1))\n\n    assert_equal(false, condition.evaluate(Context.new))\n\n    condition.or(Condition.new(1, '==', 1))\n\n    assert_equal(true, condition.evaluate(Context.new))\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_or_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"or\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"or\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}","id":"c932f2bc-660e-4a2a-86dc-7e79f861fc91"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":62,"raw_source":"def wait_for_output(read_io, matcher, timeout = wait_timeout)\n    return true if read_io.expect(matcher, timeout).to_a.any?\n\n    raise \"Waited for #{timeout} seconds, but received no output matching: \" \\\n          \"#{matcher.source}\"\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"wait_for_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"read_io\"]},{\"type\":\"arg\",\"children\":[\"matcher\"]},{\"type\":\"optarg\",\"children\":[\"timeout\",{\"type\":\"send\",\"children\":[null,\"wait_timeout\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"expect\",{\"type\":\"lvar\",\"children\":[\"matcher\"]},{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},\"to_a\"]},\"any?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Waited for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},{\"type\":\"str\",\"children\":[\" seconds, but received no output matching: \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matcher\"]},\"source\"]}]}]}]}]}]}]}","id":"7b63474d-595a-43f1-88ba-584321ea7b3f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":110,"raw_source":"def each\n        # that way body.each.map { ... } works\n        return self unless block_given?\n\n        super\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"a0f7467b-09e6-4d74-a10a-95b73243c702"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":197,"raw_source":"def test_add_item_in_outer_scope\n    @context['test'] = 'test'\n    @context.push\n    assert_equal('test', @context['test'])\n    @context.pop\n    assert_equal('test', @context['test'])\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_item_in_outer_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]}","id":"9852094d-5ffa-496f-b5eb-ca9105404844"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":29,"raw_source":"def test_id?\n    p = new_parser(\"wat 6 Peter Hegemon\")\n    assert_equal('wat', p.id?('wat'))\n    assert_equal(false, p.id?('endgame'))\n    assert_equal('6', p.consume(:number))\n    assert_equal('Peter', p.id?('Peter'))\n    assert_equal(false, p.id?('Achilles'))\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_id?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat 6 Peter Hegemon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"wat\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"endgame\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Peter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"Peter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"Achilles\"]}]}]}]}]}","id":"20edfdc8-951f-454d-953e-65833ccd818c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disabler.rb","start_line":6,"raw_source":"def render_to_output_buffer(context, output)\n        context.with_disabled_tags(self.class.disabled_tags) do\n          super\n        end\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"disabled_tags\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"618b27b7-470b-4cff-9941-01eddfcdd9c3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1797,"raw_source":"def compile!(verb, path, block, **options)\n        # Because of self.options.host\n        host_name(options.delete(:host)) if options.key?(:host)\n        # Pass Mustermann opts to compile()\n        route_mustermann_opts = options.key?(:mustermann_opts) ? options.delete(:mustermann_opts) : {}.freeze\n\n        options.each_pair { |option, args| send(option, *args) }\n\n        pattern                 = compile(path, route_mustermann_opts)\n        method_name             = \"#{verb} #{path}\"\n        unbound_method          = generate_method(method_name, &block)\n        conditions = @conditions\n        @conditions = []\n        wrapper = block.arity.zero? ?\n          proc { |a, _p| unbound_method.bind(a).call } :\n          proc { |a, p| unbound_method.bind(a).call(*p) }\n\n        [pattern, conditions, wrapper]\n      end","complexity_score":36.9,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"host\"]}]},{\"type\":\"send\",\"children\":[null,\"host_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"host\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"route_mustermann_opts\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[]},\"freeze\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"option\"]},{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"route_mustermann_opts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"method_name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"unbound_method\",{\"type\":\"send\",\"children\":[null,\"generate_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"ivar\",\"children\":[\"@conditions\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"wrapper\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"_p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unbound_method\"]},\"bind\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"call\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unbound_method\"]},\"bind\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"call\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]}]}]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"lvar\",\"children\":[\"wrapper\"]}]}]}]}","id":"f8c2c3f4-0be2-425b-a618-d97174aecd54"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":693,"raw_source":"def test_plus\n    assert_template_result(\"2\", \"{{ 1 | plus:1 }}\")\n    assert_template_result(\"2.0\", \"{{ '1' | plus:'1.0' }}\")\n\n    assert_template_result(\"5\", \"{{ price | plus:'2' }}\", { 'price' => NumberLikeThing.new(3) })\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_plus\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | plus:1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.0\"]},{\"type\":\"str\",\"children\":[\"{{ '1' | plus:'1.0' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | plus:'2' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}","id":"63f41368-8670-4e3f-a547-7062bee2c43c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":109,"raw_source":"def finish\n        yield self if block_given?\n        mime_type = @app.content_type ||\n                    @app.request.preferred_type(@map.keys)  ||\n                    @app.request.preferred_type             ||\n                    'text/html'\n        type = mime_type.split(/\\s*;\\s*/, 2).first\n        handlers = [@map[type], @generic[type[%r{^[^/]+}]], @default].compact\n        handlers.each do |block|\n          if (result = block.call(type))\n            @app.content_type mime_type\n            @app.halt result\n          end\n        end\n        @app.halt 500, 'Unknown template engine'\n      end","complexity_score":33.85,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"content_type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"request\"]},\"preferred_type\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"keys\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"request\"]},\"preferred_type\"]}]},{\"type\":\"str\",\"children\":[\"text/html\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*;\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"handlers\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@generic\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^/]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@default\"]}]},\"compact\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"handlers\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"content_type\",{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"halt\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"halt\",{\"type\":\"int\",\"children\":[500]},{\"type\":\"str\",\"children\":[\"Unknown template engine\"]}]}]}]}","id":"70b3cd32-db8f-4271-bfef-fddae67b12eb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":234,"raw_source":"def test_transform_keys\n    hash2 = @hash.transform_keys { |k| k.respond_to?(:upcase) ? k.upcase : k }\n\n    refute_equal @hash, hash2\n    refute_operator hash2, :key?, :a\n    refute_operator hash2, :key?, ?a\n    assert_equal :a, hash2[:A]\n    assert_equal :a, hash2[?A]\n  end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_keys\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"upcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"sym\",\"children\":[\"key?\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"A\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"A\"]}]}]}]}]}","id":"8428261a-d710-4d50-9ae0-52d424c08df0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":162,"raw_source":"def test_for_range\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..test) %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..test) %}{% endfor %}\"]}]}]}]}","id":"a0a4d56f-8c27-40a6-b9f5-b5ad957f729f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_kwarg_test.rb","start_line":16,"raw_source":"def test_can_parse_data_kwargs\n    with_global_filter(KwargFilter) do\n      assert_equal(\n        \"data-src='src' data-widths='100, 200'\",\n        Template.parse(\"{{ 'img' | html_tag: data-src: 'src', data-widths: '100, 200' }}\").render(nil, nil),\n      )\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_can_parse_data_kwargs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"KwargFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"data-src='src' data-widths='100, 200'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'img' | html_tag: data-src: 'src', data-widths: '100, 200' }}\"]}]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"49628d3f-18bc-40c9-9bb4-d75ca896c959"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disableable.rb","start_line":14,"raw_source":"def disabled_error(context)\n        # raise then rescue the exception so that the Context#exception_renderer can re-raise it\n        raise DisabledError, \"#{tag_name} #{parse_context[:locale].t('errors.disabled.tag')}\"\n      rescue DisabledError => exc\n        context.handle_error(exc, line_number)\n      end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"disabled_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"DisabledError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"tag_name\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.disabled.tag\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DisabledError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"send\",\"children\":[null,\"line_number\"]}]}]},null]}]}","id":"192dd052-02b5-473d-9c9d-0eb1805da4c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":56,"raw_source":"def test_assign_score_exceeding_resource_limit\n    t = Template.parse(\"{% assign foo = 42 %}{% assign bar = 23 %}\")\n    t.resource_limits.assign_score_limit = 1\n    assert_equal(\"Liquid error: Memory limits exceeded\", t.render)\n    assert(t.resource_limits.reached?)\n\n    t.resource_limits.assign_score_limit = 2\n    assert_equal(\"\", t.render!)\n    refute_nil(t.resource_limits.assign_score)\n  end","complexity_score":18.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_exceeding_resource_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign foo = 42 %}{% assign bar = 23 %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Memory limits exceeded\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"reached?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score_limit=\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"refute_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score\"]}]}]}]}","id":"8b6996df-a848-46cf-9224-d6d6c955936c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":262,"raw_source":"def test_reject\n    hash = @hash.reject { |k, v| v != :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n\n    hash2 = @hash.reject { |k, v| false }\n    assert_equal @hash, hash2\n    assert_instance_of Sinatra::IndifferentHash, hash2\n\n    enum = @hash.reject\n    assert_instance_of Enumerator, enum\n  end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"lvasgn\",\"children\":[\"enum\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Enumerator\"]},{\"type\":\"lvar\",\"children\":[\"enum\"]}]}]}]}","id":"02d4f203-3fe6-4702-a71e-32dc8c507ba6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":38,"raw_source":"def self.to_integer(num)\n      return num if num.is_a?(Integer)\n      num = num.to_s\n      begin\n        Integer(num)\n      rescue ::ArgumentError\n        raise Liquid::ArgumentError, \"invalid integer\"\n      end\n    end","complexity_score":7.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"num\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"num\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"num\"]},\"to_s\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"num\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]},null]}]}]}]}","id":"4fe8ab12-f22e-400a-a866-2d1244d4ba18"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":97,"raw_source":"def parse(source, options = {})\n      parse_context = configure_options(options)\n      source = source.to_s.to_str\n\n      unless source.valid_encoding?\n        raise TemplateEncodingError, parse_context.locale.t(\"errors.syntax.invalid_template_encoding\")\n      end\n\n      tokenizer     = parse_context.new_tokenizer(source, start_line_number: @line_numbers && 1)\n      @root         = Document.parse(tokenizer, parse_context)\n      self\n    end","complexity_score":17.63,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[null,\"configure_options\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"to_s\"]},\"to_str\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"TemplateEncodingError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.invalid_template_encoding\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@line_numbers\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@root\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Document\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"396122e9-f494-429e-90c1-82a82b454357"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":58,"raw_source":"def test_contains_binary_encoding_compatibility_with_utf8\n    assert_evaluates_true('ðŸ™ˆ'.b, 'contains', 'ðŸ™ˆ')\n    assert_evaluates_true('ðŸ™ˆ', 'contains', 'ðŸ™ˆ'.b)\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_binary_encoding_compatibility_with_utf8\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"ðŸ™ˆ\"]},\"b\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"ðŸ™ˆ\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"ðŸ™ˆ\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"ðŸ™ˆ\"]},\"b\"]}]}]}]}","id":"454b7041-e438-434c-93e2-fe84c0cfab54"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":139,"raw_source":"def test_should_allow_custom_proc_operator\n    Condition.operators['starts_with'] = proc { |_cond, left, right| left =~ /^#{right}/ }\n\n    assert_evaluates_true('bob', 'starts_with', 'b')\n    assert_evaluates_false('bob', 'starts_with', 'o')\n  ensure\n    Condition.operators.delete('starts_with')\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_should_allow_custom_proc_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_cond\"]},{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"starts_with\"]},{\"type\":\"str\",\"children\":[\"o\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"delete\",{\"type\":\"str\",\"children\":[\"starts_with\"]}]}]}]}","id":"9ca966d5-0046-4b3b-96e9-8af881fa6fc1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":46,"raw_source":"def test_zero_lqq_or_equal_one\n    text = ' {% if 0 >= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lqq_or_equal_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 >= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"092bd498-2974-4606-baa5-bac979c0d272"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":449,"raw_source":"def test_iterate_with_load_slice_returns_same_results_as_without\n    loader         = LoaderDrop.new([1, 2, 3, 4, 5])\n    loader_assigns = { 'items' => loader }\n    array_assigns  = { 'items' => [1, 2, 3, 4, 5] }\n    expected       = '34'\n    template       = '{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, loader_assigns)\n    assert_template_result(expected, template, array_assigns)\n  end","complexity_score":10.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_returns_same_results_as_without\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"loader_assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"array_assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"loader_assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"array_assigns\"]}]}]}]}","id":"d5fd744c-f6fa-47a2-90ec-f6b3e9c1c676"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":107,"raw_source":"def test_contains_with_string_left_operand_coerces_right_operand_to_string\n    assert_evaluates_true(' 1 ', 'contains', 1)\n    assert_evaluates_false(' 1 ', 'contains', 2)\n  end","complexity_score":2.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_with_string_left_operand_coerces_right_operand_to_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\" 1 \"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\" 1 \"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}","id":"c31a756c-2f13-437f-b95c-cf71bf28c82d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1422,"raw_source":"def layout(name = :layout, &block)\n        template name, &block\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"layout\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"5e4680d6-5101-4111-a103-f679bd5461bb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1474,"raw_source":"def mime_types(type)\n        type = mime_type type\n        if type =~ %r{^application/(xml|javascript)$}\n          [type, \"text/#{$1}\"]\n        elsif type =~ %r{^text/(xml|javascript)$}\n          [type, \"application/#{$1}\"]\n        else\n          [type]\n        end\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_types\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^application/(xml|javascript)$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"text/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^text/(xml|javascript)$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"application/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}]}]}","id":"a868c404-1386-4e29-883c-f6f118708ddb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":8,"raw_source":"def test_variable\n    var = create_variable('hello')\n    assert_equal(VariableLookup.new('hello'), var.name)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"55b26f84-ba2b-470b-9d8e-c147fba80bd3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2147,"raw_source":"def inspect\n      \"#<#{@instance.class} app_file=#{settings.app_file.inspect}>\"\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"#<\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@instance\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" app_file=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"app_file\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}","id":"792a3d85-9db3-4dbf-b9d3-cff5a3425730"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":63,"raw_source":"def get(*args, &block)      super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"645c53b9-3bd9-4f6f-9206-f9a313228c80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1330,"raw_source":"def extensions\n        if superclass.respond_to?(:extensions)\n          (@extensions + superclass.extensions).uniq\n        else\n          @extensions\n        end\n      end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"extensions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"extensions\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"extensions\"]}]}]},\"uniq\"]},{\"type\":\"ivar\",\"children\":[\"@extensions\"]}]}]}","id":"23f2bc32-0cc7-427f-9935-c7f5e930254d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":60,"raw_source":"def test_doc_tag_ignores_liquid_nodes\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% if true %}\n        {% if ... %}\n        {%- for ? -%}\n        {% while true %}\n        {%\n          unless if\n        %}\n        {% endcase %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_liquid_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if ... %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- for ? -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% while true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%\\n\"]},{\"type\":\"str\",\"children\":[\"    unless if\\n\"]},{\"type\":\"str\",\"children\":[\"  %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcase %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"1ade1eaf-1003-4cf4-afd3-3e8cb19ecb46"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":354,"raw_source":"def subst(u1, u2)\n    if Usurr1 <= u1 && u1 < Usurr2 && Usurr2 <= u2 && u2 < Usurr3\n      return ((u1-Usurr1)<<10) | (u2-Usurr2) + Usurrself\n    end\n    return Ucharerr\n  end","complexity_score":16.28,"ast_json":"{\"type\":\"def\",\"children\":[\"subst\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u1\"]},{\"type\":\"arg\",\"children\":[\"u2\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u1\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr2\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr2\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u2\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u2\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr3\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u1\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurr1\"]}]}]},\"<<\",{\"type\":\"int\",\"children\":[10]}]}]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u2\"]},\"-\",{\"type\":\"const\",\"children\":[null,\"Usurr2\"]}]}]},\"+\",{\"type\":\"const\",\"children\":[null,\"Usurrself\"]}]}]}]},null]},{\"type\":\"return\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Ucharerr\"]}]}]}]}","id":"7e27f163-3e63-455e-adca-894177ce8102"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/decrement.rb","start_line":33,"raw_source":"def render_to_output_buffer(context, output)\n      counter_environment = context.environments.first\n      value = counter_environment[@variable_name] || 0\n      value -= 1\n      counter_environment[@variable_name] = value\n      output << value.to_s\n      output\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"counter_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environments\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"value\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"dab29140-3a7b-455d-8185-f485e25995df"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":189,"raw_source":"def self.new(base, pattern, conditions = {}, &block)\n      Module.new do\n        # quelch uninitialized variable warnings, since these get used by compile method.\n        @pattern = nil\n        @conditions = nil\n        extend NamespacedMethods\n        include InstanceMethods\n        @base = base\n        @extensions = []\n        @errors = {}\n        @pattern, @conditions = compile(pattern, conditions)\n        @templates            = Hash.new { |_h, k| @base.templates[k] }\n        namespace = self\n        before { extend(@namespace = namespace) }\n        class_eval(&block)\n      end\n    end","complexity_score":40.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]},{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pattern\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"const\",\"children\":[null,\"NamespacedMethods\"]}]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"const\",\"children\":[null,\"InstanceMethods\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@base\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@extensions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pattern\"]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@templates\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@base\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"namespace\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"ivasgn\",\"children\":[\"@namespace\",{\"type\":\"lvar\",\"children\":[\"namespace\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"ad6fc1c9-90b1-45ba-a3d1-d5560ca0487b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":216,"raw_source":"def redirect_to(uri, *args)\n        redirect(\"#{@namespace.pattern}#{uri}\", *args)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect_to\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"redirect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@namespace\"]},\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}","id":"803927b4-46c6-4339-a362-e7fe34d9be19"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":492,"raw_source":"def <<(data)\n        @scheduler.schedule { @front.call(data.to_s) }\n        self\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<<\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@front\"]},\"call\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"cfa5883a-d0ca-45fd-863f-8e681133ab5a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":303,"raw_source":"def self.registered(klass)\n          klass.before { @hi = 'hi' }\n        end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@hi\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}","id":"60111dc2-6b94-492d-984c-b9d866a64b50"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":280,"raw_source":"def test_compact\n    hash_with_nil_values = @hash.merge({?z => nil})\n    compacted_hash = hash_with_nil_values.compact\n    assert_equal @hash, compacted_hash\n    assert_instance_of Sinatra::IndifferentHash, compacted_hash\n\n    empty_hash = Sinatra::IndifferentHash.new\n    compacted_hash = empty_hash.compact\n    assert_equal empty_hash, compacted_hash\n\n    non_empty_hash = Sinatra::IndifferentHash[a: :a]\n    compacted_hash = non_empty_hash.compact\n    assert_equal non_empty_hash, compacted_hash\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash_with_nil_values\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"z\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash_with_nil_values\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"empty_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"empty_hash\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"empty_hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"non_empty_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"compacted_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"non_empty_hash\"]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"non_empty_hash\"]},{\"type\":\"lvar\",\"children\":[\"compacted_hash\"]}]}]}]}","id":"7653f1d6-c53b-45b0-848b-83f3b7a8a704"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":44,"raw_source":"def test_unmatching_start_and_end\n    assert_equal([\"{{%}\"], tokenize('{{%}'))\n    assert_equal([\"{{%%%}}\"], tokenize('{{%%%}}'))\n    assert_equal([\"{%\", \"}}\"], tokenize('{%}}'))\n    assert_equal([\"{%%}\", \"}\"], tokenize('{%%}}'))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unmatching_start_and_end\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{%%%}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{%%%}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%\"]},{\"type\":\"str\",\"children\":[\"}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%%}\"]},{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%%}}\"]}]}]}]}]}","id":"f9a14e89-6ef6-449c-a42c-d393f1496f46"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":74,"raw_source":"def argument\n      str = +\"\"\n      # might be a keyword argument (identifier: expression)\n      if look(:id) && look(:colon, 1)\n        str << consume << consume << ' '\n      end\n\n      str << expression\n      str\n    end","complexity_score":15.83,"ast_json":"{\"type\":\"def\",\"children\":[\"argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]},{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"colon\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}","id":"b1917fd6-aa86-454a-9ede-13fda2a7f804"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":85,"raw_source":"def test_complex_elsif_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif 1 == 1 and 2 == test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_elsif_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif 1 == 1 and 2 == test %}{% endif %}\"]}]}]}]}","id":"83629f0d-cea7-474d-bfbc-f59ce803ba8b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":186,"raw_source":"def unmask_token(masked_token)\n        # Split the token into the one-time pad and the encrypted\n        # value and decrypt it\n        token_length = masked_token.length / 2\n        one_time_pad = masked_token[0...token_length]\n        encrypted_token = masked_token[token_length..]\n        xor_byte_strings(one_time_pad, encrypted_token)\n      end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"unmask_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"masked_token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token_length\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"length\"]},\"/\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"one_time_pad\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"[]\",{\"type\":\"erange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"token_length\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"encrypted_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"masked_token\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token_length\"]},null]}]}]},{\"type\":\"send\",\"children\":[null,\"xor_byte_strings\",{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},{\"type\":\"lvar\",\"children\":[\"encrypted_token\"]}]}]}]}","id":"a7090b91-9f60-4207-afd7-e43cd9018737"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":176,"raw_source":"def test_fetch_values\n    assert_raises(KeyError) { @hash.fetch_values(3, :d) }\n    assert_equal [:a, :b, 3, ?D], @hash.fetch_values(:a, ?b, 3, :d) { |k| k.upcase }\n  end","complexity_score":8.78,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch_values\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"str\",\"children\":[\"D\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch_values\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]}]}]}]}]}","id":"75a5af55-12c5-47e1-8179-3e733bf3ad32"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":42,"raw_source":"def self.[](*args)\n      new.merge!(Hash[*args])\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"c1d3e4b1-f327-4c42-a007-c937ca83ee82"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":46,"raw_source":"def default(*args)\n      args.map!(&method(:convert_key))\n\n      super(*args)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"a5d6b046-c31e-4ccf-9c25-2d82421eea06"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":195,"raw_source":"def find_variable(key, raise_on_not_found: true)\n      # This was changed from find() to find_index() because this is a very hot\n      # path and find_index() is optimized in MRI to reduce object allocation\n      index = @scopes.find_index { |s| s.key?(key) }\n\n      variable = if index\n        lookup_and_evaluate(@scopes[index], key, raise_on_not_found: raise_on_not_found)\n      else\n        try_variable_find_in_environments(key, raise_on_not_found: raise_on_not_found)\n      end\n\n      # update variable's context before invoking #to_liquid\n      variable.context = self if variable.respond_to?(:context=)\n\n      liquid_variable = variable.to_liquid\n\n      liquid_variable.context = self if variable != liquid_variable && liquid_variable.respond_to?(:context=)\n\n      liquid_variable\n    end","complexity_score":20.0,"ast_json":"{\"type\":\"def\",\"children\":[\"find_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwoptarg\",\"children\":[\"raise_on_not_found\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"index\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"find_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"index\"]},{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"try_variable_find_in_environments\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"context=\",{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"liquid_variable\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"to_liquid\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"!=\",{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]},\"context=\",{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"lvar\",\"children\":[\"liquid_variable\"]}]}]}","id":"1519ff32-36c0-44fc-afdc-31af56954b8a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/increment.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @variable_name = markup.strip\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]}]}]}","id":"9bd71f33-d3c0-44d9-aa37-60ec744df053"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":211,"raw_source":"def test_table_row_handles_interrupts\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td></tr>\\n\",\n      '{% tablerow n in (1...3) cols:2 %} {{n}} {% break %} {{n}} {% endtablerow %}',\n    )\n\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 3 </td></tr>\\n\",\n      '{% tablerow n in (1...3) cols:2 %} {{n}} {% continue %} {{n}} {% endtablerow %}',\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_handles_interrupts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...3) cols:2 %} {{n}} {% break %} {{n}} {% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 3 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in (1...3) cols:2 %} {{n}} {% continue %} {{n}} {% endtablerow %}\"]}]}]}]}","id":"501797ad-a28b-46b5-b3bf-4b922f3ff474"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":64,"raw_source":"def stylesheet(*urls)\n      urls << {} unless urls.last.respond_to? :to_hash\n      urls.last[:type] ||= mime_type(:css)\n      link(:stylesheet, *urls)\n    end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"stylesheet\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"urls\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"<<\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]},\"last\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"sym\",\"children\":[\"css\"]}]}]},{\"type\":\"send\",\"children\":[null,\"link\",{\"type\":\"sym\",\"children\":[\"stylesheet\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"urls\"]}]}]}]}]}","id":"8a197868-8891-4872-b919-1b30832ac715"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":82,"raw_source":"def deny(env)\n        warn env, \"attack prevented by #{self.class}\"\n        [options[:status], { 'content-type' => 'text/plain' }, [options[:message]]]\n      end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"deny\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"message\"]}]}]}]}]}]}","id":"77fc69cc-e2f5-4281-b9e7-5fa2e7c63519"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":844,"raw_source":"def render(engine, data, options = {}, locals = {}, &block)\n      # merge app-level options\n      engine_options = settings.respond_to?(engine) ? settings.send(engine) : {}\n      options.merge!(engine_options) { |_key, v1, _v2| v1 }\n\n      # extract generic options\n      locals          = options.delete(:locals) || locals         || {}\n      views           = options.delete(:views)  || settings.views || './views'\n      layout          = options[:layout]\n      layout          = false if layout.nil? && options.include?(:layout)\n      eat_errors      = layout.nil?\n      layout          = engine_options[:layout] if layout.nil? || (layout == true && engine_options[:layout] != false)\n      layout          = @default_layout         if layout.nil? || (layout == true)\n      layout_options  = options.delete(:layout_options) || {}\n      content_type    = options.delete(:default_content_type)\n      content_type    = options.delete(:content_type)   || content_type\n      layout_engine   = options.delete(:layout_engine)  || engine\n      scope           = options.delete(:scope)          || self\n      exclude_outvar  = options.delete(:exclude_outvar)\n      options.delete(:layout)\n\n      # set some defaults\n      options[:outvar] ||= '@_out_buf' unless exclude_outvar\n      options[:default_encoding] ||= settings.default_encoding\n\n      # compile and render template\n      begin\n        layout_was      = @default_layout\n        @default_layout = false\n        template        = compile_template(engine, data, options, views)\n        output          = template.render(scope, locals, &block)\n      ensure\n        @default_layout = layout_was\n      end\n\n      # render layout\n      if layout\n        extra_options = { views: views, layout: false, eat_errors: eat_errors, scope: scope }\n        options = options.merge(extra_options).merge!(layout_options)\n\n        catch(:layout_missing) { return render(layout_engine, layout, options, locals) { output } }\n      end\n\n      if content_type\n        # sass-embedded returns a frozen string\n        output = +output\n        output.extend(ContentTyped).content_type = content_type\n      end\n      output\n    end","complexity_score":96.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine_options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"engine_options\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_key\"]},{\"type\":\"arg\",\"children\":[\"v1\"]},{\"type\":\"arg\",\"children\":[\"_v2\"]}]},{\"type\":\"lvar\",\"children\":[\"v1\"]}]},{\"type\":\"lvasgn\",\"children\":[\"locals\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"locals\"]}]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"views\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"views\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"views\"]}]},{\"type\":\"str\",\"children\":[\"./views\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"eat_errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},\"!=\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"ivar\",\"children\":[\"@default_layout\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"layout_options\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout_options\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]},{\"type\":\"lvar\",\"children\":[\"content_type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout_engine\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout_engine\"]}]},{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"scope\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"scope\"]}]},{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exclude_outvar\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exclude_outvar\"]},null,{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"outvar\"]}]},{\"type\":\"str\",\"children\":[\"@_out_buf\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"default_encoding\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"layout_was\",{\"type\":\"ivar\",\"children\":[\"@default_layout\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[null,\"compile_template\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"scope\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"lvar\",\"children\":[\"layout_was\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"extra_options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"eat_errors\"]},{\"type\":\"lvar\",\"children\":[\"eat_errors\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"scope\"]},{\"type\":\"lvar\",\"children\":[\"scope\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"extra_options\"]}]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"layout_options\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"catch\",{\"type\":\"sym\",\"children\":[\"layout_missing\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"return\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"layout_engine\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content_type\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+@\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ContentTyped\"]}]},\"content_type=\",{\"type\":\"lvar\",\"children\":[\"content_type\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"b219d6d2-7fea-4fe6-bce0-bc384d3b08b1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":169,"raw_source":"def test_tablerow_in\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_in\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in test %}{% endtablerow %}\"]}]}]}]}","id":"ecf8a4d6-2875-4237-9a25-16b7a8e7b2fe"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":37,"raw_source":"def env\n    Thread.current[:last_env]\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"env\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_env\"]}]}]}","id":"0f1776f3-7a76-4f3a-ab46-f36be1310bfd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":105,"raw_source":"def start\n      IO.popen(command)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"start\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IO\"]},\"popen\",{\"type\":\"send\",\"children\":[null,\"command\"]}]}]}","id":"a48cece5-3e70-4801-b784-eb97d9c74302"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":759,"raw_source":"def haml(template, options = {}, locals = {}, &block)\n      render(:haml, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"haml\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"haml\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"22e51c0b-973f-49d7-bf92-223b34c8ba2a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":273,"raw_source":"def error(*codes, &block)\n        args  = Sinatra::Base.send(:compile!, 'ERROR', /.*/, block)\n        codes = codes.map { |c| Array(c) }.flatten\n        codes << Exception if codes.empty?\n        codes << Sinatra::NotFound if codes.include?(404)\n\n        codes.each do |c|\n          errors = @errors[c] ||= []\n          errors << args\n        end\n      end","complexity_score":20.6,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"send\",{\"type\":\"sym\",\"children\":[\"compile!\"]},{\"type\":\"str\",\"children\":[\"ERROR\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"codes\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},\"flatten\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"include?\",{\"type\":\"int\",\"children\":[404]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"errors\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"errors\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}","id":"5fb65504-fcab-44f3-bb92-f1597bb95481"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":76,"raw_source":"def initialize\n      @tags = Tags::STANDARD_TAGS.dup\n      @error_mode = :lax\n      @strainer_template = Class.new(StrainerTemplate).tap do |klass|\n        klass.add_filter(StandardFilters)\n      end\n      @exception_renderer = ->(exception) { exception }\n      @file_system = BlankFileSystem.new\n      @default_resource_limits = Const::EMPTY_HASH\n      @strainer_template_class_cache = {}\n    end","complexity_score":14.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tags\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tags\"]},\"STANDARD_TAGS\"]},\"dup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer_template\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"StrainerTemplate\"]}]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"add_filter\",{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"exception\"]}]},{\"type\":\"lvar\",\"children\":[\"exception\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlankFileSystem\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@default_resource_limits\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_HASH\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@strainer_template_class_cache\",{\"type\":\"hash\",\"children\":[]}]}]}]}","id":"2af08aa1-4b40-451a-a456-220e07d8273d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":129,"raw_source":"def test_single_line_outer_tag\n    text     = '<p> {%- if true %} yes {% endif -%} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {%- if false %} no {% endif -%} </p>'\n    expected = '<p></p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_outer_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if true %} yes {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if false %} no {% endif -%} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p></p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"cd59bc46-0da7-43de-8f02-96bb526a1413"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":51,"raw_source":"def file_system\n        Environment.default.file_system\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"file_system\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"file_system\"]}]}","id":"876e748b-d33c-4706-9750-f09f532e35d7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":127,"raw_source":"def test_limiting_with_invalid_offset\n    assigns  = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    template = <<-MKUP\n      {% for i in array limit: 1 offset: true %}\n        {{ i }}\n      {% endfor %}\n    MKUP\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      Template.parse(template).render!(assigns)\n    end\n    assert_equal(\"Liquid error: invalid integer\", exception.message)\n  end","complexity_score":11.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting_with_invalid_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {% for i in array limit: 1 offset: true %}\\n\"]},{\"type\":\"str\",\"children\":[\"        {{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"      {% endfor %}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"c63a3983-f1b3-4c2a-891b-d22859b72daa"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":124,"raw_source":"def random_string(secure = defined? SecureRandom)\n        secure ? SecureRandom.hex(16) : '%032x' % rand((2**128) - 1)\n      rescue NotImplementedError\n        random_string false\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"random_string\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"secure\",{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]}]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"secure\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]},\"hex\",{\"type\":\"int\",\"children\":[16]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"%032x\"]},\"%\",{\"type\":\"send\",\"children\":[null,\"rand\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"**\",{\"type\":\"int\",\"children\":[128]}]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"random_string\",{\"type\":\"false\",\"children\":[]}]}]},null]}]}","id":"87273e95-fa6c-4857-9bfb-f867330faa0a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":224,"raw_source":"def per_form_token(session, path, method)\n        token_hmac(session, \"#{path}##{method.downcase}\")\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"per_form_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"token_hmac\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"str\",\"children\":[\"#\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"downcase\"]}]}]}]}]}","id":"1821f8d9-7926-4326-b893-2c8c51e0cd23"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":94,"raw_source":"def assoc(key)\n          to_hash.assoc(key.to_s)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"assoc\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}","id":"23b39bab-9766-43d8-8e0e-3b280933f6a3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":10,"raw_source":"def test_flattened_constructor\n    hash = Sinatra::IndifferentHash[:a, 1, ?b, 2]\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_flattened_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}","id":"c2cc9c12-812c-40ea-bd83-dd8e9994b940"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":46,"raw_source":"def test_does_not_permanently_add_filters_to_symbol_table\n    current_symbols = Symbol.all_symbols\n\n    # MRI imprecisely marks objects found on the C stack, which can result\n    # in uninitialized memory being marked. This can even result in the test failing\n    # deterministically for a given compilation of ruby. Using a separate thread will\n    # keep these writes of the symbol pointer on a separate stack that will be garbage\n    # collected after Thread#join.\n    Thread.new do\n      test = %( {{ \"some_string\" | a_bad_filter }} )\n      Template.parse(test).render!\n      nil\n    end.join\n\n    GC.start\n\n    assert_equal([], (Symbol.all_symbols - current_symbols))\n  end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_permanently_add_filters_to_symbol_table\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"current_symbols\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"test\",{\"type\":\"str\",\"children\":[\" {{ \\\"some_string\\\" | a_bad_filter }} \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"render!\"]},{\"type\":\"nil\",\"children\":[]}]}]},\"join\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"GC\"]},\"start\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"current_symbols\"]}]}]}]}]}]}","id":"155c7e34-237a-4b20-9dfd-6d5f4d9c0ac6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":482,"raw_source":"def hexenc4(t, u)\n    t.putc(Hex[(u>>12)&0xf])\n    t.putc(Hex[(u>>8)&0xf])\n    t.putc(Hex[(u>>4)&0xf])\n    t.putc(Hex[u&0xf])\n  end","complexity_score":22.15,"ast_json":"{\"type\":\"def\",\"children\":[\"hexenc4\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]},{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[8]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[4]}]}]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hex\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[15]}]}]}]}]}]}","id":"fa7dff73-96e8-419a-9451-c1ed7a2cfeb7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":188,"raw_source":"def update\n        @mtime = File.mtime(path)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"update\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@mtime\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}","id":"d2535a15-587d-41f0-810f-7da22650d1dc"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":72,"raw_source":"def rindex0\n      @length - @index - 1\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}","id":"34899801-5339-4241-b30b-fd59b06f223e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":36,"raw_source":"def test_for_reversed\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result('321', '{%for item in array reversed %}{{item}}{%endfor%}', assigns)\n  end","complexity_score":2.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_reversed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"321\"]},{\"type\":\"str\",\"children\":[\"{%for item in array reversed %}{{item}}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"ee1f4e89-e088-46b7-8cd0-5cdb6d6f8c48"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":36,"raw_source":"def initialize(server, port, async)\n      @installed, @pipe, @server, @port = nil, nil, server, port\n      ENV['PUMA_MIN_THREADS'] = '1' if server == 'puma'\n      if async\n        Server.all_async << self\n      else\n        Server.all << self\n      end\n    end","complexity_score":13.9,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"port\"]},{\"type\":\"arg\",\"children\":[\"async\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@installed\"]},{\"type\":\"ivasgn\",\"children\":[\"@pipe\"]},{\"type\":\"ivasgn\",\"children\":[\"@server\"]},{\"type\":\"ivasgn\",\"children\":[\"@port\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"lvar\",\"children\":[\"port\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"==\",{\"type\":\"str\",\"children\":[\"puma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PUMA_MIN_THREADS\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"async\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all_async\"]},\"<<\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all\"]},\"<<\",{\"type\":\"self\",\"children\":[]}]}]}]}]}","id":"d88b7c66-8691-4981-9652-ae99da74316b"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":147,"raw_source":"def next_tag_token\n      start = @ss.pos - 2\n      if (len = @ss.skip_until(TAG_END))\n        @source.byteslice(start, len + 2)\n      else\n        \"{%\"\n      end\n    end","complexity_score":9.28,"ast_json":"{\"type\":\"def\",\"children\":[\"next_tag_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"len\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_END\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"len\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"str\",\"children\":[\"{%\"]}]}]}]}","id":"9a602b1e-4877-458e-8f52-b076390b83bb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":79,"raw_source":"def last\n      @index == @length - 1\n    end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"061aa46e-7835-4978-af55-880b47977cdb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":879,"raw_source":"def ceil(input)\n      Utils.to_number(input).ceil.to_i\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"ceil\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"ceil\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}","id":"98ada344-2a6e-4fdc-9d90-8bf71811f8ba"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":50,"raw_source":"def invoke(method, *args)\n      if self.class.invokable?(method)\n        send(method, *args)\n      elsif @context.strict_filters\n        raise Liquid::UndefinedFilter, \"undefined filter #{method}\"\n      else\n        args.first\n      end\n    rescue ::ArgumentError => e\n      raise Liquid::ArgumentError, e.message, e.backtrace\n    end","complexity_score":17.9,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"invokable?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"strict_filters\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedFilter\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined filter \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"backtrace\"]}]}]},null]}]}","id":"bf115bb4-575f-46fe-943d-5d30e5255212"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":135,"raw_source":"def test_incomplete_expression\n    with_error_mode(:lax) do\n      assert_template_result(\"false\", \"{{ false - }}\")\n      assert_template_result(\"false\", \"{{ false > }}\")\n      assert_template_result(\"false\", \"{{ false < }}\")\n      assert_template_result(\"false\", \"{{ false = }}\")\n      assert_template_result(\"false\", \"{{ false ! }}\")\n      assert_template_result(\"false\", \"{{ false 1 }}\")\n      assert_template_result(\"false\", \"{{ false a }}\")\n\n      assert_template_result(\"false\", \"{% liquid assign foo = false -\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false >\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false <\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false =\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false !\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false 1\\n%}{{ foo }}\")\n      assert_template_result(\"false\", \"{% liquid assign foo = false a\\n%}{{ foo }}\")\n    end\n  end","complexity_score":18.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_incomplete_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false - }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false > }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false < }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false = }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false ! }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false a }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false -\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false >\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false <\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false =\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false !\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false 1\\n%}{{ foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% liquid assign foo = false a\\n%}{{ foo }}\"]}]}]}]}]}","id":"b593dd77-3f0a-4fdc-b71c-5c6401354ac6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":17,"raw_source":"def initialize(\n      source:,\n      string_scanner:,\n      line_numbers: false,\n      line_number: nil,\n      for_liquid_tag: false\n    )\n      @line_number = line_number || (line_numbers ? 1 : nil)\n      @for_liquid_tag = for_liquid_tag\n      @source = source.to_s.to_str\n      @offset = 0\n      @tokens = []\n\n      if @source\n        @ss = string_scanner\n        @ss.string = @source\n        tokenize\n      end\n    end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"source\"]},{\"type\":\"kwarg\",\"children\":[\"string_scanner\"]},{\"type\":\"kwoptarg\",\"children\":[\"line_numbers\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"for_liquid_tag\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_number\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_numbers\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"nil\",\"children\":[]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"for_liquid_tag\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@source\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"source\"]},\"to_s\"]},\"to_str\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@offset\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@ss\",{\"type\":\"lvar\",\"children\":[\"string_scanner\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string=\",{\"type\":\"ivar\",\"children\":[\"@source\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\"]}]},null]}]}]}","id":"bb67d602-dff7-4d37-b9fe-9c30e69274d4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":221,"raw_source":"def for(template_name)\n    @count += 1\n    template = Liquid::Template.new\n    template.name = \"some/path/\" + template_name\n    template\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"some/path/\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}","id":"1c6cade0-0880-4a57-b50f-8986b650cd38"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":85,"raw_source":"def render(context)\n      obj = context.evaluate(@name)\n\n      @filters.each do |filter_name, filter_args, filter_kwargs|\n        filter_args = evaluate_filter_expressions(context, filter_args, filter_kwargs)\n        obj = context.invoke(filter_name, obj, *filter_args)\n      end\n\n      context.apply_global_filter(obj)\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter_name\"]},{\"type\":\"arg\",\"children\":[\"filter_args\"]},{\"type\":\"arg\",\"children\":[\"filter_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter_args\",{\"type\":\"send\",\"children\":[null,\"evaluate_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"filter_args\"]},{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"lvar\",\"children\":[\"filter_name\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}","id":"e683cbe1-2022-4a46-b2ec-82abd40863a6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":83,"raw_source":"def parse(source, options = {})\n        environment = options[:environment] || Environment.default\n        new(environment: environment).parse(source, options)\n      end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"environment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"e7343f12-2916-4221-8b71-3dbdefda1b85"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":375,"raw_source":"def logger\n      request.logger\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"logger\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"logger\"]}]}","id":"f9248e22-99ab-4dfe-90c3-5bd44eda168d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":371,"raw_source":"def surrogate?(u)\n    Usurr1 <= u && u < Usurr3\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"surrogate?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Usurr1\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"u\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Usurr3\"]}]}]}]}","id":"bd89c137-d1c7-472d-8a99-897ce4cae3a1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":67,"raw_source":"def tokenize_line_numbers(source)\n    tokenizer    = new_tokenizer(source, start_line_number: 1)\n    line_numbers = []\n    loop do\n      line_number = tokenizer.line_number\n      if tokenizer.send(:shift)\n        line_numbers << line_number\n      else\n        break\n      end\n    end\n    line_numbers\n  end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize_line_numbers\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[null,\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"line_numbers\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line_numbers\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"break\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"line_numbers\"]}]}]}","id":"1a805ecf-5236-4fce-bb0a-5ea4108e6bd9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":40,"raw_source":"def safe?(env)\n        %w[GET HEAD OPTIONS TRACE].include? env['REQUEST_METHOD']\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"GET\"]},{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]},{\"type\":\"str\",\"children\":[\"TRACE\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]}]}]}","id":"e2c3cbfc-0609-4880-a05d-7f933725f9dc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":54,"raw_source":"def textparse(ts)\n    if ts.length < 0\n      raise Error, 'empty'\n    end\n\n    typ, _, val = ts[0]\n    case typ\n    when '{' then objparse(ts)\n    when '[' then arrparse(ts)\n    else\n      raise Error, \"unexpected #{val.inspect}\"\n    end\n  end","complexity_score":17.3,"ast_json":"{\"type\":\"def\",\"children\":[\"textparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"empty\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[null,\"objparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[null,\"arrparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]}]}]}]}]}]}","id":"84d5a525-1a13-48d3-983f-519b5fd52958"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":244,"raw_source":"def test_select\n    hash = @hash.select { |k, v| v == :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n\n    hash2 = @hash.select { |k, v| true }\n    assert_equal @hash, hash2\n    assert_instance_of Sinatra::IndifferentHash, hash2\n\n    enum = @hash.select\n    assert_instance_of Enumerator, enum\n  end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_select\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"lvasgn\",\"children\":[\"enum\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Enumerator\"]},{\"type\":\"lvar\",\"children\":[\"enum\"]}]}]}]}","id":"c00c39fc-d961-4037-8f20-e75733c8b2bc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":240,"raw_source":"def test_url_encode\n    assert_equal('foo%2B1%40example.com', @filters.url_encode('foo+1@example.com'))\n    assert_equal('1', @filters.url_encode(1))\n    assert_equal('2001-02-03', @filters.url_encode(Date.new(2001, 2, 3)))\n    assert_nil(@filters.url_encode(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_url_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo%2B1%40example.com\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"str\",\"children\":[\"foo+1@example.com\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"debd6094-aa8e-4208-ba40-60594ac0209f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":46,"raw_source":"def reset\n      @reached_limit = false\n      @last_capture_length = nil\n      @render_score = @assign_score = 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"reset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reached_limit\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@render_score\",{\"type\":\"ivasgn\",\"children\":[\"@assign_score\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}","id":"057c0673-2cfa-420d-aa1f-ff362cbaf7a3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":64,"raw_source":"def block_types(nodelist)\n    nodelist.collect(&:class)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"block_types\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"nodelist\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"nodelist\"]},\"collect\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}","id":"23064599-4da0-45d5-842c-bd0fabe3ffaf"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":38,"raw_source":"def children\n      @node.respond_to?(:nodelist) ? Array(@node.nodelist) : Const::EMPTY_ARRAY\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"nodelist\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]}","id":"887c771c-b1bc-4d58-a718-1e591646ff41"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":94,"raw_source":"def test_variables\n    @context['string'] = 'string'\n    assert_equal('string', @context['string'])\n\n    @context['num'] = 5\n    assert_equal(5, @context['num'])\n\n    @context['time'] = Time.parse('2006-06-06 12:00:00')\n    assert_equal(Time.parse('2006-06-06 12:00:00'), @context['time'])\n\n    @context['date'] = Date.today\n    assert_equal(Date.today, @context['date'])\n\n    now = Time.now\n    @context['datetime'] = now\n    assert_equal(now, @context['datetime'])\n\n    @context['bool'] = true\n    assert_equal(true, @context['bool'])\n\n    @context['bool'] = false\n    assert_equal(false, @context['bool'])\n\n    @context['nil'] = nil\n    assert_nil(@context['nil'])\n    assert_nil(@context['nil'])\n  end","complexity_score":34.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"num\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"num\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"time\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-06 12:00:00\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-06 12:00:00\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"date\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"date\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"now\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"datetime\"]},{\"type\":\"lvar\",\"children\":[\"now\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"now\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"datetime\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"bool\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"bool\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"bool\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"bool\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"nil\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nil\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nil\"]}]}]}]}]}","id":"33b13026-7190-44f4-9bf1-24f90001185b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":114,"raw_source":"def test_link_to\n    text     = %( {{ 'Typo' | link_to: 'http://typo.leetsoft.com' }} )\n    expected = %( <a href=\"http://typo.leetsoft.com\">Typo</a> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_link_to\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ 'Typo' | link_to: 'http://typo.leetsoft.com' }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <a href=\\\"http://typo.leetsoft.com\\\">Typo</a> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"54c3bf2e-6739-4a7f-b6cc-f765796db292"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":217,"raw_source":"def test_include_tag_doesnt_cache_partials_across_renders\n    file_system = CountingFileSystem.new\n    assert_equal(\n      'from CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.count)\n\n    assert_equal(\n      'from CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(2, file_system.count)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_doesnt_cache_partials_across_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CountingFileSystem\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]}]}]}","id":"d59685ed-919c-4910-bbb4-24d0b320c863"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":13,"raw_source":"def initialize(markup, string_scanner = StringScanner.new(\"\"), cache = nil)\n      lookups = markup.scan(VariableParser)\n\n      name = lookups.shift\n      if name&.start_with?('[') && name&.end_with?(']')\n        name = Expression.parse(\n          name[1..-2],\n          string_scanner,\n          cache,\n        )\n      end\n      @name = name\n\n      @lookups       = lookups\n      @command_flags = 0\n\n      @lookups.each_index do |i|\n        lookup = lookups[i]\n        if lookup&.start_with?('[') && lookup&.end_with?(']')\n          lookups[i] = Expression.parse(\n            lookup[1..-2],\n            string_scanner,\n            cache,\n          )\n        elsif COMMAND_METHODS.include?(lookup)\n          @command_flags |= 1 << i\n        end\n      end\n    end","complexity_score":38.65,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookups\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"shift\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"[\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@lookups\",{\"type\":\"lvar\",\"children\":[\"lookups\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@command_flags\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"each_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"i\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookup\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"[\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookups\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"COMMAND_METHODS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"lookup\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@command_flags\"]},\"|\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]},null]}]}]}]}]}]}","id":"4a5c3a37-f86d-4694-9701-4a2b2d8a7ed2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":137,"raw_source":"def stack(new_scope = {})\n      push(new_scope)\n      yield\n    ensure\n      pop\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"stack\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"new_scope\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"push\",{\"type\":\"lvar\",\"children\":[\"new_scope\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"pop\"]}]}]}","id":"87a35ea6-fe65-4ede-8702-d998d2316efa"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":121,"raw_source":"def children\n        [@node.left] + @node.blocks\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"left\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"blocks\"]}]}]}","id":"1cff635f-5a91-4253-a113-9812b82f19d5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":227,"raw_source":"def test_doc_tag_blank_with_whitespace_only\n    template_source = \"{% doc %}    {% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(false, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_whitespace_only\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}    {% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}","id":"d27ee514-240b-4913-8339-dd61e21863d4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":42,"raw_source":"def test_open_tags_in_comment\n    assert_template_result('', <<~LIQUID.chomp)\n      {% comment %}\n        {% assign a = 123 {% comment %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% assign foo = \"1\"\n        {% endcomment %}\n      LIQUID\n    end\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% comment %}\n            {% invalid\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n        {% {{ {%- endcomment %}\n      LIQUID\n    end\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_open_tags_in_comment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign a = 123 {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = \\\"1\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% invalid\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% {{ {%- endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}","id":"7b99aa1d-72ca-48d1-8cd3-fcb98c9cbb6d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":158,"raw_source":"def test_strict_error_messages\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ', error_mode: :strict)\n    end\n    assert_equal('Liquid syntax error: Unexpected character = in \"1 =! 2\"', err.message)\n\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse('{{%%%}}', error_mode: :strict)\n    end\n    assert_equal('Liquid syntax error: Unexpected character % in \"{{%%%}}\"', err.message)\n  end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strict_error_messages\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Unexpected character = in \\\"1 =! 2\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{%%%}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]}]}]}","id":"0a020723-04ac-46de-9350-30db800006c0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":297,"raw_source":"def warn(message)\n        super \"#{caller.first[/^[^:]:\\d+:/]} warning: #{message}\"\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\"]},\"first\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^:]:\\\\d+:\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\" warning: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}]}","id":"988b77e9-0a8a-4174-b012-453566a017ce"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":41,"raw_source":"def test_assignment\n    hash = Sinatra::IndifferentHash.new\n    hash[:a] = :a\n    hash[?b] = :b\n    hash[3] = 3\n    hash[:simple_nested] = { :a=>:a, ?b=>:b }\n\n    assert_equal :a, hash[?a]\n    assert_equal :b, hash[?b]\n    assert_equal 3, hash[3]\n    assert_equal({ ?a=>:a, ?b=>:b }, hash['simple_nested'])\n    assert_nil hash[?d]\n  end","complexity_score":18.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assignment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]}","id":"fb84fd66-cd21-491d-bc36-17578bca3374"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":197,"raw_source":"def test_pause_resume_big_limit\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit:1000 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      7890\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume_big_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit:1000 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      7890\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"290f13d2-04f2-4103-8713-a5f6a49a266d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1138,"raw_source":"def route_missing\n      raise NotFound unless @app\n\n      forward\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"route_missing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotFound\"]}]}]},{\"type\":\"send\",\"children\":[null,\"forward\"]}]}]}","id":"e884bfac-cd60-4f28-add4-8e4953944e8e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1206,"raw_source":"def test_sum_with_numeric_strings\n    input = [1, 2, \"3\", \"4\"]\n\n    assert_equal(10, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_numeric_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"str\",\"children\":[\"4\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}","id":"e567ec09-e31b-471c-bcf8-9a397cb27aff"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":76,"raw_source":"def test_var_and_long_string_are_equal_backwards\n    text = \" {% if 'hello there!' == var %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_and_long_string_are_equal_backwards\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'hello there!' == var %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}","id":"5fb87577-cf69-43dc-9893-14213b25b9e2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/builder_test.rb","start_line":7,"raw_source":"def builder_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"builder_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"57b640a7-e72f-45e5-b47b-6df6d3bfcf56"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1553,"raw_source":"def link(path, opts = {}, &block)    route 'LINK',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"LINK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"7611e3b5-d145-4632-be15-daacf9470583"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":20,"raw_source":"def erubi?\n      @current_engine == :erubi or\n        (erb? && Tilt[:erb] == Tilt::ErubiTemplate)\n    end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"erubi?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_engine\"]},\"==\",{\"type\":\"sym\",\"children\":[\"erubi\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"erb?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"erb\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"ErubiTemplate\"]}]}]}]}]}]}","id":"c06359b7-e3f6-4953-a6ab-8da0084226d9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":42,"raw_source":"def call(env)\n        env['foo.bar'] = 42\n        app.call(env)\n      end","complexity_score":3.45,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"foo.bar\"]},{\"type\":\"int\",\"children\":[42]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"499340b8-a92f-42f0-8ce7-0e7647c433fb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/ip_spoofing.rb","start_line":16,"raw_source":"def accepts?(env)\n        return true unless env.include? 'HTTP_X_FORWARDED_FOR'\n\n        ips = env['HTTP_X_FORWARDED_FOR'].split(',').map(&:strip)\n        return false if env.include?('HTTP_CLIENT_IP') && (!ips.include? env['HTTP_CLIENT_IP'])\n        return false if env.include?('HTTP_X_REAL_IP') && (!ips.include? env['HTTP_X_REAL_IP'])\n\n        true\n      end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_X_FORWARDED_FOR\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"ips\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_FORWARDED_FOR\"]}]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_CLIENT_IP\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ips\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_CLIENT_IP\"]}]}]},\"!\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_X_REAL_IP\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ips\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_REAL_IP\"]}]}]},\"!\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"true\",\"children\":[]}]}]}","id":"adc50fa6-2c2d-4cfc-88e9-bae19a6aba1f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":263,"raw_source":"def truncatewords(input, words = 15, truncate_string = \"...\")\n      return if input.nil?\n      input = Utils.to_s(input)\n      words = Utils.to_integer(words)\n      words = 1 if words <= 0\n\n      wordlist = begin\n        input.split(\" \", words + 1)\n      rescue RangeError\n        # integer too big for String#split, but we can semantically assume no truncation is needed\n        return input if words + 1 > MAX_I32\n        raise # unexpected error\n      end\n      return input if wordlist.length <= words\n\n      wordlist.pop\n      truncate_string = Utils.to_s(truncate_string)\n      wordlist.join(\" \").concat(truncate_string)\n    end","complexity_score":29.78,"ast_json":"{\"type\":\"def\",\"children\":[\"truncatewords\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"words\",{\"type\":\"int\",\"children\":[15]}]},{\"type\":\"optarg\",\"children\":[\"truncate_string\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"words\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"words\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"<=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"words\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"wordlist\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"split\",{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"words\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},\">\",{\"type\":\"const\",\"children\":[null,\"MAX_I32\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"length\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"words\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"pop\"]},{\"type\":\"lvasgn\",\"children\":[\"truncate_string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"wordlist\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]}]}","id":"a6fd2542-e625-4a6d-b8bd-970d389a596c"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/comment_form.rb","start_line":17,"raw_source":"def render_to_output_buffer(context, output)\n    article = context[@variable_name]\n\n    context.stack do\n      context['form'] = {\n        'posted_successfully?' => context.registers[:posted_successfully],\n        'errors' => context['comment.errors'],\n        'author' => context['comment.author'],\n        'email' => context['comment.email'],\n        'body' => context['comment.body'],\n      }\n\n      output << wrap_in_form(article, render_all(@nodelist, context, output))\n      output\n    end\n  end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"article\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"form\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"posted_successfully?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"posted_successfully\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.errors\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"author\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.author\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"email\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.email\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"comment.body\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"wrap_in_form\",{\"type\":\"lvar\",\"children\":[\"article\"]},{\"type\":\"send\",\"children\":[null,\"render_all\",{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}","id":"1400bb81-dee5-4df9-ba7f-503cdc676d1d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":89,"raw_source":"def test_raw_is_not_blank\n    assert_template_result(\"  \" * (N + 1), wrap(\" {% raw %} {% endraw %}\"))\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raw_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% raw %} {% endraw %}\"]}]}]}]}","id":"9c709f43-f469-4c35-99a1-59fe64fa16bc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":210,"raw_source":"def test_base64_url_safe_encode\n    assert_equal(\n      'YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8',\n      @filters.base64_url_safe_encode('abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\|'),\n    )\n    assert_equal('', @filters.base64_url_safe_encode(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_url_safe_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_encode\",{\"type\":\"str\",\"children\":[\"abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\\\|\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"5705f8c9-03b6-4f80-9057-0a02278a69dd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":18,"raw_source":"def test_get_missing_key\n    static_register = Registers.new\n\n    assert_nil(static_register[:missing])\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_get_missing_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"missing\"]}]}]}]}]}","id":"15161c27-dcc8-4027-85f2-2eb11d2acb89"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":218,"raw_source":"def test_include\n    assert_equal(\n      [\"test\"],\n      visit(%({% include test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include test %}\"]}]}]}]}","id":"008d9458-bd22-43d3-9952-a99b5ef4571a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":253,"raw_source":"def try_variable_find_in_environments(key, raise_on_not_found:)\n      @environments.each do |environment|\n        found_variable = lookup_and_evaluate(environment, key, raise_on_not_found: raise_on_not_found)\n        if !found_variable.nil? || @strict_variables && raise_on_not_found\n          return found_variable\n        end\n      end\n      @static_environments.each do |environment|\n        found_variable = lookup_and_evaluate(environment, key, raise_on_not_found: raise_on_not_found)\n        if !found_variable.nil? || @strict_variables && raise_on_not_found\n          return found_variable\n        end\n      end\n      nil\n    end","complexity_score":21.8,"ast_json":"{\"type\":\"def\",\"children\":[\"try_variable_find_in_environments\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwarg\",\"children\":[\"raise_on_not_found\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found_variable\",{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]},\"nil?\"]},\"!\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]}]},null]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static_environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found_variable\",{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]},\"nil?\"]},\"!\"]},{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found_variable\"]}]},null]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"d72ea65e-0c81-481a-bbf6-74fe1370478b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":29,"raw_source":"def self.setup(&block)     setup_blocks    << block  end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"setup\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"setup_blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}","id":"516505ed-b00e-468a-b536-080c989a8e53"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":164,"raw_source":"def transform_keys!\n      super\n      super(&method(:convert_key))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_keys!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"super\",\"children\":[{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]}]}]}","id":"fec60cf8-b0ac-4cf6-884d-5b9671c185c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":60,"raw_source":"def assert_usage_increment(name, times: 1)\n      old_method = Liquid::Usage.method(:increment)\n      calls = 0\n      begin\n        Liquid::Usage.singleton_class.send(:remove_method, :increment)\n        Liquid::Usage.define_singleton_method(:increment) do |got_name|\n          calls += 1 if got_name == name\n          old_method.call(got_name)\n        end\n        yield\n      ensure\n        Liquid::Usage.singleton_class.send(:remove_method, :increment)\n        Liquid::Usage.define_singleton_method(:increment, old_method)\n      end\n      assert_equal(times, calls, \"Number of calls to Usage.increment with #{name.inspect}\")\n    end","complexity_score":26.15,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_usage_increment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"kwoptarg\",\"children\":[\"times\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_method\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"method\",{\"type\":\"sym\",\"children\":[\"increment\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"calls\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_method\"]},{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"got_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"got_name\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"calls\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_method\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"got_name\"]}]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_method\"]},{\"type\":\"sym\",\"children\":[\"increment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Usage\"]},\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"increment\"]},{\"type\":\"lvar\",\"children\":[\"old_method\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"times\"]},{\"type\":\"lvar\",\"children\":[\"calls\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Number of calls to Usage.increment with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"inspect\"]}]}]}]}]}]}","id":"f3fbb9f0-b9e7-46c2-9c84-d87db8beab0c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":37,"raw_source":"def raise_limits_reached\n      @reached_limit = true\n      raise MemoryError, \"Memory limits exceeded\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_limits_reached\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reached_limit\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"MemoryError\"]},{\"type\":\"str\",\"children\":[\"Memory limits exceeded\"]}]}]}]}","id":"7b8f02b6-4bdb-441a-8e70-c19a83ca1754"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":98,"raw_source":"def assert_status(expected)\n    assert_equal Integer(expected), Integer(status)\n  end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_status\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expected\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"lvar\",\"children\":[\"expected\"]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[null,\"status\"]}]}]}]}","id":"b406b172-1b86-4d9a-af29-42fc3dff524c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":207,"raw_source":"def merge(other, &block)\n        to_hash.merge(other, &block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"other\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"da12263d-3212-4d25-b8d6-d037acd3b6e9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":520,"raw_source":"def test_new_isolated_subcontext_does_not_inherit_variables\n    super_context = Context.new\n    super_context['my_variable'] = 'some value'\n    subcontext = super_context.new_isolated_subcontext\n\n    assert_nil(subcontext['my_variable'])\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_does_not_inherit_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"my_variable\"]},{\"type\":\"str\",\"children\":[\"some value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"[]\",{\"type\":\"str\",\"children\":[\"my_variable\"]}]}]}]}]}","id":"98de1ce8-2ce3-48f2-b581-546028cd8e74"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1836,"raw_source":"def setup_logging(builder)\n        if logging?\n          setup_common_logger(builder)\n          setup_custom_logger(builder)\n        elsif logging == false\n          setup_null_logger(builder)\n        end\n      end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_logging\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"setup_common_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_custom_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"logging\"]},\"==\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"setup_null_logger\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},null]}]}]}","id":"c8572a21-7661-4d77-93da-d9ab70551e18"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":199,"raw_source":"def masked_token?(token)\n        token.length == TOKEN_LENGTH * 2\n      end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"masked_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TOKEN_LENGTH\"]},\"*\",{\"type\":\"int\",\"children\":[2]}]}]}]}","id":"9f3f9b2a-0657-47df-90c4-0de6e7e23d68"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":8,"raw_source":"def evaluate(scope, locals={}, &block)\n    inner = block ? block.call : ''\n    data + inner\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"scope\"]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"data\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"inner\"]}]}]}]}","id":"dd924500-56a7-48c8-98d8-6bcb284ba10f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":754,"raw_source":"def date(input, format)\n      str_format = Utils.to_s(format)\n      return input if str_format.empty?\n\n      return input unless (date = Utils.to_date(input))\n\n      date.strftime(str_format)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"date\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"format\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str_format\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"format\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str_format\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_date\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"date\"]},\"strftime\",{\"type\":\"lvar\",\"children\":[\"str_format\"]}]}]}]}","id":"f9fb95bf-791f-47ca-a87c-2fc93b2dbd1a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":107,"raw_source":"def assert_include(str, substr)\n    assert str.include?(substr), \"expected #{str.inspect} to include #{substr.inspect}\"\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_include\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"arg\",\"children\":[\"substr\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"substr\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to include \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"substr\"]},\"inspect\"]}]}]}]}]}","id":"3d0026bd-1d16-464d-a30e-b02b8a88df65"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":27,"raw_source":"def test_calculate_line_numbers_per_token_with_profiling\n    assert_equal([1],       tokenize_line_numbers(\"{{funk}}\"))\n    assert_equal([1, 1, 1], tokenize_line_numbers(\" {{funk}} \"))\n    assert_equal([1, 2, 2], tokenize_line_numbers(\"\\n{{funk}}\\n\"))\n    assert_equal([1, 1, 3], tokenize_line_numbers(\" {{\\n funk \\n}} \"))\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_calculate_line_numbers_per_token_with_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\" {{funk}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\"\\n{{funk}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"tokenize_line_numbers\",{\"type\":\"str\",\"children\":[\" {{\\n funk \\n}} \"]}]}]}]}]}","id":"725ca627-2942-4c1f-9565-dec229308475"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":295,"raw_source":"def body(value = nil, &block)\n      if block_given?\n        def block.each; yield(call) end\n        response.body = block\n      elsif value\n        unless request.head? || value.is_a?(Rack::Files::BaseIterator) || value.is_a?(Stream)\n          headers.delete 'content-length'\n        end\n        response.body = value\n      else\n        response.body\n      end\n    end","complexity_score":24.7,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"defs\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"call\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"head?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Files\"]},\"BaseIterator\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-length\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body\"]}]}]}]}","id":"08503bb7-7d1f-4d5e-a127-9ca535087e44"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":36,"raw_source":"def test_if_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if test %}{% endif %}\"]}]}]}]}","id":"2cb535b7-3f7e-466c-92b0-dbde950ee490"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":180,"raw_source":"def test_scope_though_proc\n    assert_equal('1', Liquid::Template.parse('{{ s }}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }))\n    assert_equal('2', Liquid::Template.parse('{%for i in dummy%}{{ s }}{%endfor%}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }, 'dummy' => [1]))\n    assert_equal('3', Liquid::Template.parse('{%for i in dummy%}{%for i in dummy%}{{ s }}{%endfor%}{%endfor%}').render!('context' => ContextDrop.new, 's' => proc { |c| c['context.scopes'] }, 'dummy' => [1]))\n  end","complexity_score":28.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_though_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ s }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{{ s }}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{%for i in dummy%}{{ s }}{%endfor%}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"context.scopes\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}","id":"5254bf6e-814a-4653-835c-a1c2d3f2604e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":709,"raw_source":"def newline_to_br(input)\n      input = Utils.to_s(input)\n      input.gsub(/\\r?\\n/, \"<br />\\n\")\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"newline_to_br\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\r?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"<br />\\n\"]}]}]}]}","id":"84d47074-af45-4ea7-8363-6d2b7890120b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":40,"raw_source":"def test_local_filter\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n\n    assert_equal(' 1000$ ', Template.parse(\"{{var | money}}\").render(@context))\n  end","complexity_score":5.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}","id":"c560382d-7c8e-4657-986e-ebb8907efbed"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":26,"raw_source":"def test_cycle_with_variables_inside_for_loop\n    template = <<~LIQUID\n      {%- assign a = 1 -%}\n      {%- assign b = 2 -%}\n      {%- assign c = 3 -%}\n      {%- for i in (1..3) -%}\n        {% cycle a, b, c %}\n      {%- endfor -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_with_variables_inside_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign a = 1 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- assign b = 2 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- assign c = 3 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% cycle a, b, c %}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endfor -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"8ae61e08-631e-44e3-8ba7-28ad213fc176"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":389,"raw_source":"def dont_reload(*glob)\n        Dir[*glob].each { |path| Watcher::List.for(self).ignore(path) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"dont_reload\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"glob\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"glob\"]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]},\"ignore\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}","id":"aac38ff9-4ff1-4968-945b-d89380618539"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":147,"raw_source":"def printf(format, *args)\n        print(format.to_s % args)\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"printf\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"format\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"to_s\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}","id":"ff334c6a-d60b-4e44-9f5c-8ef215fc16a8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1577,"raw_source":"def test?;        environment == :test        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"test\"]}]}]}","id":"b9b91214-7636-42da-ac0f-407c9cb5d29a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":33,"raw_source":"def liquid_method_missing(method)\n      return nil unless @context&.strict_variables\n      raise Liquid::UndefinedDropMethod, \"undefined method #{method}\"\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"strict_variables\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedDropMethod\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined method \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}]}","id":"858443de-fd7d-4dad-92ad-941a01a0ccc1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":174,"raw_source":"def test_scope\n    assert_equal('1', Liquid::Template.parse('{{ context.scopes }}').render!('context' => ContextDrop.new))\n    assert_equal('2', Liquid::Template.parse('{%for i in dummy%}{{ context.scopes }}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('3', Liquid::Template.parse('{%for i in dummy%}{%for i in dummy%}{{ context.scopes }}{%endfor%}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n  end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ context.scopes }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{{ context.scopes }}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for i in dummy%}{%for i in dummy%}{{ context.scopes }}{%endfor%}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}","id":"8f494eac-c130-4cd0-a7e4-d9f26c8b6e56"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":33,"raw_source":"def mock_app(&block)\n    super do\n      class_eval(&block)\n    end\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"561e4a4d-4108-48bd-be04-53a335eeb298"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":23,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @blocks = []\n      push_block('if', markup)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@blocks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"push_block\",{\"type\":\"str\",\"children\":[\"if\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}","id":"bfa75491-9f8a-4562-b155-8685a7c262a6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":94,"raw_source":"def self.rescue_render_node(context, output, line_number, exc, blank_tag)\n      case exc\n      when MemoryError\n        raise\n      when UndefinedVariable, UndefinedDropMethod, UndefinedFilter\n        context.handle_error(exc, line_number)\n      else\n        error_message = context.handle_error(exc, line_number)\n        unless blank_tag # conditional for backwards compatibility\n          output << error_message\n        end\n      end\n    end","complexity_score":10.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"rescue_render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"line_number\"]},{\"type\":\"arg\",\"children\":[\"exc\"]},{\"type\":\"arg\",\"children\":[\"blank_tag\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MemoryError\"]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"UndefinedVariable\"]},{\"type\":\"const\",\"children\":[null,\"UndefinedDropMethod\"]},{\"type\":\"const\",\"children\":[null,\"UndefinedFilter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error_message\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blank_tag\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"error_message\"]}]}]}]}]}]}","id":"73c40977-3dde-4ece-a6e0-27e2bd687722"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":824,"raw_source":"def test_prepend\n    assigns = { 'a' => 'bc', 'b' => 'a' }\n    assert_template_result('abc', \"{{ a | prepend: 'a'}}\", assigns)\n    assert_template_result('abc', \"{{ a | prepend: b}}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_prepend\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"bc\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ a | prepend: 'a'}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ a | prepend: b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"1603a624-91a6-44f4-8e39-d8aaaa062378"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":313,"raw_source":"def test_including_via_variable_value\n    assert_template_result(\n      \"from TestFileSystem\",\n      \"{% assign page = 'pick_a_source' %}{% include page %}\",\n      partials: { \"pick_a_source\" => \"from TestFileSystem\" },\n    )\n\n    partials = { \"product\" => \"Product: {{ product.title }} \" }\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% assign page = 'product' %}{% include page %}\",\n      { \"product\" => { 'title' => 'Draft 151cm' } },\n      partials: partials,\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% assign page = 'product' %}{% include page for foo %}\",\n      { \"foo\" => { 'title' => 'Draft 151cm' } },\n      partials: partials,\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_including_via_variable_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"from TestFileSystem\"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'pick_a_source' %}{% include page %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"pick_a_source\"]},{\"type\":\"str\",\"children\":[\"from TestFileSystem\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'product' %}{% include page %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% assign page = 'product' %}{% include page for foo %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}","id":"8d0909a7-052c-43c0-bef3-b39fc5fb4218"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":55,"raw_source":"def test_quirky_negative_sign_expression_markup\n    result = Expression.parse(\"-\", nil)\n    assert(result.is_a?(VariableLookup))\n    assert_equal(\"-\", result.name)\n\n    # for this template, the expression markup is \"-\"\n    assert_template_result(\n      \"\",\n      \"{{ - 'theme.css' - }}\",\n    )\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quirky_negative_sign_expression_markup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ - 'theme.css' - }}\"]}]}]}]}","id":"88bd1822-9c4a-4037-82ef-aee4c631ceac"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":112,"raw_source":"def resolve_encoder_action(object, encoder)\n      %i[encode generate].each do |method|\n        return encoder.send(method, object) if encoder.respond_to? method\n      end\n      raise \"#{encoder} does not respond to #generate nor #encode\" unless encoder.is_a? Symbol\n\n      object.__send__(encoder)\n    end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_encoder_action\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]},{\"type\":\"arg\",\"children\":[\"encoder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"encode\"]},{\"type\":\"sym\",\"children\":[\"generate\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Symbol\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"encoder\"]}]},{\"type\":\"str\",\"children\":[\" does not respond to #generate nor #encode\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"__send__\",{\"type\":\"lvar\",\"children\":[\"encoder\"]}]}]}]}","id":"ab5697b1-be95-4403-a7a1-0bfe06bc48fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":199,"raw_source":"def test_doc_tag_blank_with_empty_content\n    template_source = \"{% doc %}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(true, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_empty_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}","id":"3ed4e2ba-28ad-4b25-bebc-e71a1e522456"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":27,"raw_source":"def self.default_reaction(reaction)\n        alias_method(:default_reaction, reaction)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"default_reaction\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"reaction\"]}]},{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"default_reaction\"]},{\"type\":\"lvar\",\"children\":[\"reaction\"]}]}]}","id":"8852c338-209e-4622-b708-7a41df473742"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":238,"raw_source":"def setup_close(env, _status, _headers, body)\n      return unless body.respond_to?(:close) && env.include?('async.close')\n\n      env['async.close'].callback { body.close }\n      env['async.close'].errback { body.close }\n    end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_close\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"_status\"]},{\"type\":\"arg\",\"children\":[\"_headers\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"close\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"async.close\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.close\"]}]},\"errback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]}]}]}]}","id":"98655fac-9f38-474b-a60f-e35207fe86ab"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":176,"raw_source":"def test_tablerow_limit\n    assert_equal(\n      [\"test\"],\n      visit(%({% tablerow x in (1..5) limit: test %}{% endtablerow %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% tablerow x in (1..5) limit: test %}{% endtablerow %}\"]}]}]}]}","id":"5b6df56c-6a08-4f60-b4f6-132832f9b2c5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":370,"raw_source":"def session\n      request.session\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"session\"]}]}","id":"61802891-30e9-46ac-b03a-ec8e1bec336c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":36,"raw_source":"def initialize(*)\n        super\n\n        modes       = Array options[:escape]\n        @escaper    = options[:escaper]\n        @html       = modes.include? :html\n        @javascript = modes.include? :javascript\n        @url        = modes.include? :url\n\n        return unless @javascript && (!@escaper.respond_to? :escape_javascript)\n\n        raise('Use EscapeUtils for JavaScript escaping.')\n      end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"modes\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"escape\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@escaper\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"escaper\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"html\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@javascript\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"javascript\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@url\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"modes\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"url\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@javascript\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"escape_javascript\"]}]},\"!\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"Use EscapeUtils for JavaScript escaping.\"]}]}]}]}","id":"d7e69317-15e2-498e-b44b-d6bfba7b01d2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":2045,"raw_source":"def self.included(base)\n        base.extend(ClassMethods)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ClassMethods\"]}]}]}","id":"9b160bce-b0bb-41d9-8b99-dac082a5d057"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":81,"raw_source":"def webrick?\n      name.to_s == \"webrick\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"webrick?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"webrick\"]}]}]}","id":"67c5e489-a875-4e4e-afe7-006ec0e0b05d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markdown_test.rb","start_line":4,"raw_source":"def markdown_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"markdown_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"98808358-eaef-4bf5-9823-2a6815f40485"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":110,"raw_source":"def register_filters(filters)\n      @strainer_template_class_cache.clear\n      filters.each { |f| @strainer_template.add_filter(f) }\n      self\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filters\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filters\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"clear\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"f\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"b3dc23d9-f655-46f7-8b54-2046bbec7097"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":996,"raw_source":"def call!(env) # :nodoc:\n      @env      = env\n      @params   = IndifferentHash.new\n      @request  = Request.new(env)\n      @response = Response.new\n      @pinned_response = nil\n      template_cache.clear if settings.reload_templates\n\n      invoke { dispatch! }\n      invoke { error_block!(response.status) } unless @env['sinatra.error']\n\n      unless @response['content-type']\n        if Array === body && body[0].respond_to?(:content_type)\n          content_type body[0].content_type\n        elsif (default = settings.default_content_type)\n          content_type default\n        end\n      end\n\n      @response.finish\n    end","complexity_score":49.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@env\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Response\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"reload_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"clear\"]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"dispatch!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]}]},null,{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},null,{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"content_type\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_content_type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"default\"]}]},null]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"finish\"]}]}]}","id":"e9245c96-2045-4220-b6ec-8bdbe242fd01"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":98,"raw_source":"def test_nil\n    text = ' {% if var == nil %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => nil })\n\n    text = ' {% if var == null %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => nil })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == nil %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"9805e102-c3f6-4ed7-9561-e7f64f4a997c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":207,"raw_source":"def test_include_tag_caches_second_read_of_same_partial\n    file_system = CountingFileSystem.new\n    environment = Liquid::Environment.build(file_system: file_system)\n    assert_equal(\n      'from CountingFileSystemfrom CountingFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}{% include 'pick_a_source' %}\", environment: environment).render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.count)\n  end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_caches_second_read_of_same_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CountingFileSystem\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from CountingFileSystemfrom CountingFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}{% include 'pick_a_source' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"count\"]}]}]}]}","id":"dda299d5-ba8f-40f5-aaa4-b7a21efbc37f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":15,"raw_source":"def consume(type = nil)\n      token = @tokens[@p]\n      if type && token[0] != type\n        raise SyntaxError, \"Expected #{type} but found #{@tokens[@p].first}\"\n      end\n      @p += 1\n      token[1]\n    end","complexity_score":14.9,"ast_json":"{\"type\":\"def\",\"children\":[\"consume\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"type\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"!=\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\" but found \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]},\"first\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"38ba9d24-5faa-462d-946a-f473c45b2231"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":277,"raw_source":"def test_pre_and_post_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true %}\n          yes\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false %}\n          no\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_and_post_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"b14cb8aa-0d4b-420b-836a-f323fbefc273"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":85,"raw_source":"def test_multiple_variable_piping_with_args\n    text     = %! {{ car.gm | add_smiley : ':-(' | add_smiley : ':-('}} !\n    expected = %| bad :-( :-( |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_variable_piping_with_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley : ':-(' | add_smiley : ':-('}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-( :-( \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"4e8a78c7-c632-41d3-9bf1-6448e5bb2ac1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":145,"raw_source":"def test_delete\n    @hash.delete(:a)\n    @hash.delete(?b)\n    assert_nil @hash[:a]\n    assert_nil @hash[?b]\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delete\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"delete\",{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}","id":"75175187-23b7-4eb3-a8c9-1cb7fa279829"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":39,"raw_source":"def write_app_file(options={})\n    options[:routes] ||= ['get(\"/foo\") { erb :foo }']\n    options[:inline_templates] ||= nil\n    options[:extensions] ||= []\n    options[:middlewares] ||= []\n    options[:filters] ||= []\n    options[:errors] ||= {}\n    options[:name] ||= app_name\n    options[:enable_reloader] = true unless options[:enable_reloader] === false\n    options[:parent] ||= 'Sinatra::Base'\n\n    update_file(app_file_path) do |f|\n      template_path = File.expand_path('reloader/app.rb.erb', __dir__)\n      template = Tilt.new(template_path, nil, :trim => '<>')\n      f.write template.render(Object.new, options)\n    end\n  end","complexity_score":19.9,"ast_json":"{\"type\":\"def\",\"children\":[\"write_app_file\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"routes\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"get(\\\"/foo\\\") { erb :foo }\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"extensions\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"middlewares\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"errors\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"app_name\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"enable_reloader\"]}]},\"===\",{\"type\":\"false\",\"children\":[]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"enable_reloader\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"parent\"]}]},{\"type\":\"str\",\"children\":[\"Sinatra::Base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"update_file\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_path\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"reloader/app.rb.erb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"template_path\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"trim\"]},{\"type\":\"str\",\"children\":[\"<>\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"f\"]},\"write\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Object\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}]}","id":"bc68b600-ccf8-42f5-bdaa-4140dfa3b13a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":99,"raw_source":"def test_variable_piping_with_variable_args\n    text     = %( {{ car.gm | add_tag : 'span', car.bmw}} )\n    expected = %( <span id=\"good\">bad</span> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_variable_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_tag : 'span', car.bmw}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <span id=\\\"good\\\">bad</span> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"c3367270-81a4-4121-90cd-0f92b9f37ca2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":95,"raw_source":"def test_unanchored_filter_arguments\n    with_error_mode(:lax) do\n      assert_template_result('hi', \"{{ 'hi there' | split$$$:' ' | first }}\")\n\n      assert_template_result('x', \"{{ 'X' | downcase) }}\")\n\n      # After the messed up quotes a filter without parameters (reverse) should work\n      # but one with parameters (remove) shouldn't be detected.\n      assert_template_result('here',  \"{{ 'hi there' | split:\\\"t\\\"\\\" | reverse | first}}\")\n      assert_template_result('hi ', \"{{ 'hi there' | split:\\\"t\\\"\\\" | remove:\\\"i\\\" | first}}\")\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unanchored_filter_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split$$$:' ' | first }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"{{ 'X' | downcase) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"here\"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split:\\\"t\\\"\\\" | reverse | first}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hi \"]},{\"type\":\"str\",\"children\":[\"{{ 'hi there' | split:\\\"t\\\"\\\" | remove:\\\"i\\\" | first}}\"]}]}]}]}]}","id":"e20de368-aa21-418b-8aa3-2cf28cf8547b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":8,"raw_source":"def test_tag\n    tag = Tag.parse('tag', \"\", new_tokenizer, ParseContext.new)\n    assert_equal('liquid::tag', tag.name)\n    assert_equal('', tag.render(Context.new))\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"liquid::tag\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"render\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}","id":"ef9a16e8-32c4-4199-9cdb-bd3add4ab7e4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":155,"raw_source":"def test_default_context_is_deprecated\n    if Gem::Version.new(Liquid::VERSION) >= Gem::Version.new('6.0.0')\n      flunk(\"Condition#evaluate without a context argument is to be removed\")\n    end\n\n    _out, err = capture_io do\n      assert_equal(true, Condition.new(1, '==', 1).evaluate)\n    end\n\n    expected = \"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\" \\\n      \" and will be removed from Liquid 6.0.0.\"\n    assert_includes(err.lines.map(&:strip), expected)\n  end","complexity_score":21.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_context_is_deprecated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"6.0.0\"]}]}]},{\"type\":\"send\",\"children\":[null,\"flunk\",{\"type\":\"str\",\"children\":[\"Condition#evaluate without a context argument is to be removed\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"_out\"]},{\"type\":\"lvasgn\",\"children\":[\"err\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"capture_io\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},\"evaluate\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"DEPRECATION WARNING: Condition#evaluate without a context argument is deprecated\"]},{\"type\":\"str\",\"children\":[\" and will be removed from Liquid 6.0.0.\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"lines\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]},{\"type\":\"lvar\",\"children\":[\"expected\"]}]}]}]}","id":"ea911dd3-b2ed-44c8-af06-8b5e4f136303"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":538,"raw_source":"def test_bug_compatible_pre_trim\n    template = Liquid::Template.parse(\"\\n {%- raw %}{% endraw %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"\\n\", template.render)\n\n    template = Liquid::Template.parse(\"\\n {%- if true %}{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"\\n\", template.render)\n\n    template = Liquid::Template.parse(\"{{ 'B' }} \\n{%- if true %}C{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B C\", template.render)\n\n    template = Liquid::Template.parse(\"B\\n {%- raw %}{% endraw %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B\", template.render)\n\n    template = Liquid::Template.parse(\"B\\n {%- if true %}{% endif %}\", bug_compatible_whitespace_trimming: true)\n    assert_equal(\"B\", template.render)\n  end","complexity_score":21.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bug_compatible_pre_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"\\n {%- raw %}{% endraw %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"\\n {%- if true %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'B' }} \\n{%- if true %}C{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"B\\n {%- raw %}{% endraw %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"B\\n {%- if true %}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"bug_compatible_whitespace_trimming\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}","id":"8f9ccfb4-20ae-49a4-ae6e-eafd946013f0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":665,"raw_source":"def append(input, string)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      input + string\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"append\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]}]}","id":"29a471a6-841e-482e-b5d4-ae9f910fc624"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/strict_transport.rb","start_line":25,"raw_source":"def strict_transport\n        @strict_transport ||= begin\n          strict_transport = \"max-age=#{options[:max_age]}\"\n          strict_transport += '; includeSubDomains' if options[:include_subdomains]\n          strict_transport += '; preload' if options[:preload]\n          strict_transport.to_str\n        end\n      end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_transport\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@strict_transport\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"max-age=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"max_age\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"include_subdomains\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\"]},\"+\",{\"type\":\"str\",\"children\":[\"; includeSubDomains\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"preload\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strict_transport\"]},\"+\",{\"type\":\"str\",\"children\":[\"; preload\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strict_transport\"]},\"to_str\"]}]}]}]}","id":"c8f291ae-735b-4603-a32d-ce4cf74003ba"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":12,"raw_source":"def parse(tokens)\n      @body = new_body\n      while parse_body(@body, tokens)\n      end\n      @body.freeze\n    end","complexity_score":5.1,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"ivar\",\"children\":[\"@body\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"freeze\"]}]}]}","id":"e268e810-d4c4-459c-bb63-cf52e35a8b9a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":34,"raw_source":"def test_default_assignment\n    hash = Sinatra::IndifferentHash.new\n    hash.default = { :a=>1, ?b=>2 }\n    assert_equal({ ?a=>1, ?b=>2 }, hash.default)\n    assert_equal({ ?a=>1, ?b=>2 }, hash[:a])\n  end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_assignment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default=\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}","id":"45041f1c-db57-4c07-86bd-eea67ddb4ed7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/asciidoctor_test.rb","start_line":7,"raw_source":"def asciidoc_app(&block)\n      mock_app do\n        set :views, __dir__ + '/views'\n        get('/', &block)\n      end\n      get '/'\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"asciidoc_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"5543c076-4132-4085-874b-e2e837c80731"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":34,"raw_source":"def registers\n    \"{#{@value.inspect}=>#{@context.registers[@value].inspect}}\"\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@value\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"=>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@value\"]}]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"}\"]}]}]}","id":"0906475c-f808-4198-a141-60d7770bdad3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":65,"raw_source":"def test_for_with_variable\n    assert_template_result(' 1  2  3 ', '{%for item in array%} {{item}} {%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('123', '{%for item in array%}{{item}}{%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('123', '{% for item in array %}{{item}}{% endfor %}', { 'array' => [1, 2, 3] })\n    assert_template_result('abcd', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', 'b', 'c', 'd'] })\n    assert_template_result('a b c', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', ' ', 'b', ' ', 'c'] })\n    assert_template_result('abc', '{%for item in array%}{{item}}{%endfor%}', { 'array' => ['a', '', 'b', '', 'c'] })\n  end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% for item in array %}{{item}}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abcd\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a b c\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{{item}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}]}","id":"de5beddc-d092-45fb-b785-eed2f1969aa2"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":72,"raw_source":"def render\n    @compiled_tests.each do |test|\n      tmpl    = test[:tmpl]\n      assigns = test[:assigns]\n      layout  = test[:layout]\n\n      if layout\n        assigns['content_for_layout'] = tmpl.render!(assigns)\n        layout.render!(assigns)\n      else\n        tmpl.render!(assigns)\n      end\n    end\n  end","complexity_score":15.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tmpl\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assigns\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content_for_layout\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}","id":"b86e2878-9cc8-4997-9547-b26afc0f96dc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":115,"raw_source":"def test_doc_tag_ignores_unclosed_assign\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% assign foo = \"1\"\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_unclosed_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = \\\"1\\\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"267d13a2-06c1-491c-a31a-7f87c112b23e"}

{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":118,"raw_source":"def test_slice_on_arrays\n    input = 'foobar'.split(//)\n    assert_equal(%w(o o b), @filters.slice(input, 1, 3))\n    assert_equal(%w(o o b a r), @filters.slice(input, 1, 1000))\n    assert_equal(%w(), @filters.slice(input, 1, 0))\n    assert_equal(%w(o), @filters.slice(input, 1, 1))\n    assert_equal(%w(b a r), @filters.slice(input, 3, 3))\n    assert_equal(%w(a r), @filters.slice(input, -2, 2))\n    assert_equal(%w(a r), @filters.slice(input, -2, 1000))\n    assert_equal(%w(r), @filters.slice(input, -1))\n    assert_equal(%w(), @filters.slice(input, 100, 10))\n    assert_equal(%w(), @filters.slice(input, -100, 10))\n    assert_equal([], @filters.slice(input, 0, -(1 << 64)))\n    assert_equal(input, @filters.slice(input, 0, 1 << 63))\n    assert_equal([], @filters.slice(input, 1 << 63, 6))\n    assert_equal([], @filters.slice(input, -(1 << 63), 6))\n  end","complexity_score":51.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice_on_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"r\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[-100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[64]}]}]},\"-@\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]},{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}","id":"5b705f0f-1286-4ea5-ab54-dc36de8474a7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":44,"raw_source":"def test_meaningless_parens_error\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        markup = \"a == 'foo' or (b == 'bar' and c == 'baz') or false\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_meaningless_parens_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"a == 'foo' or (b == 'bar' and c == 'baz') or false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}]}","id":"5304a842-7c0d-47f8-a43b-f182cd503a95"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":24,"raw_source":"def self.raise_syntax_error(parse_context)\n      raise Liquid::SyntaxError, parse_context.locale.t('errors.syntax.assign')\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.assign\"]}]}]}]}","id":"064a95a0-6561-4441-a0ad-4690c669e2e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":8,"raw_source":"def initialize(options = Const::EMPTY_HASH)\n      @environment = options.fetch(:environment, Environment.default)\n      @template_options = options ? options.dup : {}\n\n      @locale   = @template_options[:locale] ||= I18n.new\n      @warnings = []\n\n      # constructing new StringScanner in Lexer, Tokenizer, etc is expensive\n      # This StringScanner will be shared by all of them\n      @string_scanner = StringScanner.new(\"\")\n\n      @expression_cache = if options[:expression_cache].nil?\n        {}\n      elsif options[:expression_cache].respond_to?(:[]) && options[:expression_cache].respond_to?(:[]=)\n        options[:expression_cache]\n      elsif options[:expression_cache]\n        {}\n      end\n\n      self.depth   = 0\n      self.partial = false\n    end","complexity_score":29.5,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_HASH\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_options\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"dup\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@locale\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@warnings\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@expression_cache\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"nil?\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"expression_cache\"]}]},{\"type\":\"hash\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"depth=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"partial=\",{\"type\":\"false\",\"children\":[]}]}]}]}","id":"3f4930bf-d951-447d-a408-239e8742310b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":408,"raw_source":"def test_lambda_as_variable\n    @context['dynamic'] = proc { 'Hello' }\n\n    assert_equal('Hello', @context['dynamic'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}","id":"46d57abd-8364-485e-894a-811ddba96d38"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":542,"raw_source":"def test_new_isolated_subcontext_inherits_exception_renderer\n    super_context = Context.new\n    super_context.exception_renderer = ->(_e) { 'my exception message' }\n    subcontext = super_context.new_isolated_subcontext\n    assert_equal('my exception message', subcontext.handle_error(Liquid::Error.new))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"exception_renderer=\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_e\"]}]},{\"type\":\"str\",\"children\":[\"my exception message\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my exception message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"handle_error\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]},\"new\"]}]}]}]}]}","id":"8d1bb740-5263-4ba7-b5ea-3bde0d515de9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":219,"raw_source":"def test_keywords\n    assert_template_result(\"pass\", \"{% if true == expect %}pass{% endif %}\", { \"expect\" => true })\n    assert_template_result(\"pass\", \"{% if false == expect %}pass{% endif %}\", { \"expect\" => false })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_keywords\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if true == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if false == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}","id":"e9746da2-1d16-4305-a55b-c29051c8bf0a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":33,"raw_source":"def error_mode\n        Environment.default.error_mode\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"error_mode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"error_mode\"]}]}","id":"9f92b265-d8cb-4352-8ba7-c0483a7b0d4b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":236,"raw_source":"def compile!(verb, path, block, **options)\n      options[:provides] ||= respond_to if respond_to\n      super\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to\"]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"provides\"]}]},{\"type\":\"send\",\"children\":[null,\"respond_to\"]}]},null]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"76f99f96-1e27-4750-b322-231f9e29a30e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":6,"raw_source":"def test_tokenize_strings\n    assert_equal([' '], tokenize(' '))\n    assert_equal(['hello world'], tokenize('hello world'))\n    assert_equal(['{}'], tokenize('{}'))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"hello world\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"hello world\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{}\"]}]}]}]}]}","id":"0cd70b5c-fca0-4f89-a066-438b51e1f7c1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":54,"raw_source":"def read_template_file(template_path)\n      full_path = full_path(template_path)\n      raise FileSystemError, \"No such template '#{template_path}'\" unless File.exist?(full_path)\n\n      File.read(full_path)\n    end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"full_path\",{\"type\":\"send\",\"children\":[null,\"full_path\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"No such template '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]}]}","id":"22e6d065-2340-4702-9054-6d6a8cd11afa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":106,"raw_source":"def test_multiple_pipings\n    assigns = { 'best_cars' => 'bmw' }\n    text     = %( {{ best_cars | cite_funny | paragraph }} )\n    expected = %( <p>LOL: bmw</p> )\n\n    assert_equal(expected, Template.parse(text).render!(assigns, filters: [FunnyFilter]))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_pipings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"best_cars\"]},{\"type\":\"str\",\"children\":[\"bmw\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ best_cars | cite_funny | paragraph }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <p>LOL: bmw</p> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"2099b966-ca66-4a57-9056-a955a0e1f6a6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":56,"raw_source":"def test_render_ignores_raw_strings_when_profiling\n    t = Template.parse(\"This is raw string\\nstuff\\nNewline\", profile: true)\n    t.render!\n\n    assert_equal(0, t.profiler.length)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_ignores_raw_strings_when_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is raw string\\nstuff\\nNewline\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]}]}]}","id":"2a2a0e45-f34b-498f-ac76-65bedaeae49a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":73,"raw_source":"def schedule!(*)      @schedule.pop.call until @schedule.empty? end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"schedule!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@schedule\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@schedule\"]},\"pop\"]},\"call\"]}]}]}","id":"fa498882-b0ba-4157-95f7-334034a4b5c6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":22,"raw_source":"def test_open_tag_in_raw\n    assert_template_result(' Foobar {% invalid ', '{% raw %} Foobar {% invalid {% endraw %}')\n    assert_template_result(' Foobar invalid %} ', '{% raw %} Foobar invalid %} {% endraw %}')\n    assert_template_result(' Foobar {{ invalid ', '{% raw %} Foobar {{ invalid {% endraw %}')\n    assert_template_result(' Foobar invalid }} ', '{% raw %} Foobar invalid }} {% endraw %}')\n    assert_template_result(' Foobar {% invalid {% {% endraw ', '{% raw %} Foobar {% invalid {% {% endraw {% endraw %}')\n    assert_template_result(' Foobar {% {% {% ', '{% raw %} Foobar {% {% {% {% endraw %}')\n    assert_template_result(' test {% raw %} {% endraw %}', '{% raw %} test {% raw %} {% {% endraw %}endraw %}')\n    assert_template_result(' Foobar {{ invalid 1', '{% raw %} Foobar {{ invalid {% endraw %}{{ 1 }}')\n    assert_template_result(' Foobar {% foo {% bar %}', '{% raw %} Foobar {% foo {% bar %}{% endraw %}')\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_open_tag_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% invalid \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% invalid {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar invalid %} \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar invalid %} {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {{ invalid \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {{ invalid {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar invalid }} \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar invalid }} {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% invalid {% {% endraw \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% invalid {% {% endraw {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% {% {% \"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% {% {% {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" test {% raw %} {% endraw %}\"]},{\"type\":\"str\",\"children\":[\"{% raw %} test {% raw %} {% {% endraw %}endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {{ invalid 1\"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {{ invalid {% endraw %}{{ 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" Foobar {% foo {% bar %}\"]},{\"type\":\"str\",\"children\":[\"{% raw %} Foobar {% foo {% bar %}{% endraw %}\"]}]}]}]}","id":"d760a222-1df1-4ed6-a0c2-7ab3f339f18e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":111,"raw_source":"def parse_binary_comparisons(p)\n      condition = parse_comparison(p)\n      first_condition = condition\n      while (op = p.id?('and') || p.id?('or'))\n        child_condition = parse_comparison(p)\n        condition.send(op, child_condition)\n        condition = child_condition\n      end\n      first_condition\n    end","complexity_score":15.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_binary_comparisons\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[null,\"parse_comparison\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"first_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"op\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"and\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"id?\",{\"type\":\"str\",\"children\":[\"or\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"child_condition\",{\"type\":\"send\",\"children\":[null,\"parse_comparison\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"child_condition\"]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"lvar\",\"children\":[\"child_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"first_condition\"]}]}]}","id":"d61d1492-f1f3-464c-baea-cf40b1fea3d1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":83,"raw_source":"def self.registered(base)\n      fail \"base should be BizzleApp\" unless base == BizzleApp\n      fail \"base should have already extended BizzleExtension\" unless base.respond_to?(:bizzle)\n      base.set :bizzle_option, 'bizzle!'\n    end","complexity_score":7.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"BizzleApp\"]}]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"base should be BizzleApp\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"bizzle\"]}]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"str\",\"children\":[\"base should have already extended BizzleExtension\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"bizzle_option\"]},{\"type\":\"str\",\"children\":[\"bizzle!\"]}]}]}]}","id":"d8cce464-b5ce-430a-b23b-5551b613c972"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":14,"raw_source":"def test_variable_render_calls_to_liquid\n    assert_template_result('foobar', '{{ foo }}', { 'foo' => ThingWithToLiquid.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_render_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]}","id":"c0a67634-2bf2-482b-867a-a17dd567bc53"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":52,"raw_source":"def with_capture\n      old_capture_length = @last_capture_length\n      begin\n        @last_capture_length = 0\n        yield\n      ensure\n        @last_capture_length = old_capture_length\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"with_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_capture_length\",{\"type\":\"ivar\",\"children\":[\"@last_capture_length\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"lvar\",\"children\":[\"old_capture_length\"]}]}]}]}]}]}","id":"f19477dd-b569-475a-bd3f-4d669b962c02"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":73,"raw_source":"def setup\n    @filters = Filters.new(Context.new)\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Filters\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}","id":"7bdf0b57-4c30-4371-b673-dea41aa879f0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/capture.rb","start_line":106,"raw_source":"def capture_later(&block)\n      engine = current_engine\n      proc { |*a| with_engine(engine) { @capture = capture(*a, &block) } }\n    end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"capture_later\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine\",{\"type\":\"send\",\"children\":[null,\"current_engine\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_engine\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@capture\",{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}]}","id":"f6e279ab-4cbd-4396-8365-081b5251ffce"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/content_for_spec.rb","start_line":202,"raw_source":"def body\n            last_response.body.gsub(/\\s/, '')\n          end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_response\"]},\"body\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}","id":"4d0cfb87-13b7-4b84-add3-5761be884edf"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":30,"raw_source":"def fetch(key, default = UNDEFINED, &block)\n      if @changes.key?(key)\n        @changes.fetch(key)\n      elsif default != UNDEFINED\n        if block_given?\n          @static.fetch(key, &block)\n        else\n          @static.fetch(key, default)\n        end\n      else\n        @static.fetch(key, &block)\n      end\n    end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"default\",{\"type\":\"const\",\"children\":[null,\"UNDEFINED\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"default\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"UNDEFINED\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"1a20ac4e-ce65-48c1-9ace-8b4546523c65"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1131,"raw_source":"def test_where_non_boolean_value\n    input = [\n      { \"message\" => \"Bonjour!\", \"language\" => \"French\" },\n      { \"message\" => \"Hello!\", \"language\" => \"English\" },\n      { \"message\" => \"Hallo!\", \"language\" => \"German\" },\n    ]\n\n    assert_equal([{ \"message\" => \"Bonjour!\", \"language\" => \"French\" }], @filters.where(input, \"language\", \"French\"))\n    assert_equal([{ \"message\" => \"Hallo!\", \"language\" => \"German\" }], @filters.where(input, \"language\", \"German\"))\n    assert_equal([{ \"message\" => \"Hello!\", \"language\" => \"English\" }], @filters.where(input, \"language\", \"English\"))\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_non_boolean_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Bonjour!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hello!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hallo!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Bonjour!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"French\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hallo!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"German\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"Hello!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"language\"]},{\"type\":\"str\",\"children\":[\"English\"]}]}]}]}]}","id":"2ae16d7e-26c2-4194-87f1-b8c2f5313151"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":275,"raw_source":"def test_reject!\n    @hash.reject! { |k, v| v != :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}","id":"25401695-94c2-40e0-bfcd-0b1729ec6557"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":134,"raw_source":"def test_doc_tag_captures_token_before_enddoc\n    template_source = \"{% doc %}{{ incomplete{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(\"{{ incomplete\", doc_tag.nodelist.first.to_s)\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_captures_token_before_enddoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{{ incomplete{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"{{ incomplete\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]},\"to_s\"]}]}]}]}","id":"4ff3cfe6-a12b-4259-aeab-a3c475e5e789"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":191,"raw_source":"def content_blocks\n      @content_blocks ||= Hash.new { |h, k| h[k] = [] }\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"content_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@content_blocks\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}","id":"bcc92c3f-624f-4b77-af76-03cbb853698e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":296,"raw_source":"def test_join_calls_to_liquid_on_each_element\n    drop = Class.new(Liquid::Drop) do\n      def to_liquid\n        'i did it'\n      end\n    end\n\n    assert_equal('i did it, i did it', @filters.join([drop.new, drop.new], \", \"))\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join_calls_to_liquid_on_each_element\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"i did it\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"i did it, i did it\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"new\"]}]},{\"type\":\"str\",\"children\":[\", \"]}]}]}]}]}","id":"b7967e3d-0af4-4683-af8d-db3bab15ffa6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":64,"raw_source":"def options(*args, &block)  super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"3f339e40-d101-473f-a4cb-2f7f9b0e2f93"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":16,"raw_source":"def [](key)\n      if @changes.key?(key)\n        @changes[key]\n      else\n        @static[key]\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"9386b1da-bd01-4b15-8858-6242acfa2676"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":85,"raw_source":"def escape_string(str)\n        str = @escaper.escape_url(str)        if @url\n        str = @escaper.escape_html(str)       if @html\n        str = @escaper.escape_javascript(str) if @javascript\n        str\n      end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_string\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@url\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_url\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@html\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_html\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@javascript\"]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@escaper\"]},\"escape_javascript\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}","id":"89e3e8e7-31c4-415e-86eb-626f3dc19640"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":35,"raw_source":"def id?(str)\n      token = @tokens[@p]\n      return false unless token && token[0] == :id\n      return false unless token[1] == str\n      @p += 1\n      token[1]\n    end","complexity_score":13.55,"ast_json":"{\"type\":\"def\",\"children\":[\"id?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"str\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"9a45e32a-9401-4030-af15-7f9a88c1bbe8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":88,"raw_source":"def host_permitted?(host)\n        exact_match?(host) || domain_match?(host) || ip_match?(host)\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"host_permitted?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"exact_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]},{\"type\":\"send\",\"children\":[null,\"domain_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},{\"type\":\"send\",\"children\":[null,\"ip_match?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]}]}","id":"18b49c37-2249-4996-ae7a-6519f595dd48"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":69,"raw_source":"def test_unrecognized_operator\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ')\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unrecognized_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]}]}]}]}]}","id":"48a6a559-1d4c-465c-8877-88e491766fa5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":155,"raw_source":"def puts(*args)\n        args.each { |arg| self << \"#{arg}\\n\" }\n        nil\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"puts\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arg\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arg\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"49ae2e67-262c-4f1f-9e7c-78d0dfa931b8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":447,"raw_source":"def reject(input, property, target_value = nil)\n      filter_array(input, property, target_value) { |ary, &block| ary.reject(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reject\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"9e3e766e-2b33-47e3-90d9-b90ab7d44042"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/sass_test.rb","start_line":7,"raw_source":"def sass_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"sass_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"20738b74-6c35-47c9-bcf4-785aac056100"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":334,"raw_source":"def request_cookies\n        @request.cookies.reject { |key, _value| deleted.include? key }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"request_cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"cookies\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"_value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"deleted\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"1f51a352-eef4-44aa-893d-30dd6b68f24c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":170,"raw_source":"def []=(key, value)\n      @scopes[0][key] = value\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}","id":"47b535f1-9c96-4583-940d-75a108af51d5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":23,"raw_source":"def test_one_lq_zero\n    text = ' {% if 1 > 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_one_lq_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 1 > 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"d9accf06-77c1-40ec-a576-cbed25cf51b9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":32,"raw_source":"def test_custom_template_filename_patterns\n    file_system = Liquid::LocalFileSystem.new(\"/some/path\", \"%s.html\")\n    assert_equal(\"/some/path/mypartial.html\", file_system.full_path(\"mypartial\"))\n    assert_equal(\"/some/path/dir/mypartial.html\", file_system.full_path(\"dir/mypartial\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_template_filename_patterns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"LocalFileSystem\"]},\"new\",{\"type\":\"str\",\"children\":[\"/some/path\"]},{\"type\":\"str\",\"children\":[\"%s.html\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/mypartial.html\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"mypartial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/dir/mypartial.html\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"dir/mypartial\"]}]}]}]}]}","id":"fc0fdcdc-d005-47de-a3e8-3eed2edf1f59"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":277,"raw_source":"def internal_error\n      # raise and catch to set backtrace and cause on exception\n      raise Liquid::InternalError, 'internal'\n    rescue Liquid::InternalError => exc\n      exc\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"internal_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]},{\"type\":\"str\",\"children\":[\"internal\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"exc\"]}]},null]}]}","id":"f2a5269d-a183-4e08-833f-aefff0bb39c8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1586,"raw_source":"def use(middleware, *args, &block)\n        @prototype = nil\n        @middleware << [middleware, args, block]\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@prototype\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@middleware\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"37e2cbf7-9780-45f2-b5b4-511ac685ba12"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":82,"raw_source":"def test_more_than_max_depth_nested_blocks_raises_exception\n    depth = Liquid::Block::MAX_DEPTH + 1\n    code  = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse(code).render!\n    end\n  end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_more_than_max_depth_nested_blocks_raises_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"render!\"]}]}]}]}","id":"9c7844d3-2df7-437e-8b9c-a9ebcd073d2b"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":89,"raw_source":"def render_layout(template, layout, assigns)\n    assigns['content_for_layout'] = template.render!(assigns)\n    layout&.render!(assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_layout\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content_for_layout\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"1d83134c-8c64-45b7-a6dc-56c505f3c676"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":141,"raw_source":"def test_length_query\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 4 %}true{% endif %}\",\n      { \"numbers\" => [1, 2, 3, 4] },\n    )\n\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 4 %}true{% endif %}\",\n      { \"numbers\" => { 1 => 1, 2 => 2, 3 => 3, 4 => 4 } },\n    )\n\n    assert_template_result(\n      \"true\",\n      \"{% if numbers.size == 1000 %}true{% endif %}\",\n      { \"numbers\" => { 1 => 1, 2 => 2, 3 => 3, 4 => 4, 'size' => 1000 } },\n    )\n  end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_length_query\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 4 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 4 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if numbers.size == 1000 %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"int\",\"children\":[1000]}]}]}]}]}]}]}]}","id":"a2bb0687-b602-4d1a-a2d3-fb8702dfa47d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":486,"raw_source":"def find_index(input, property, target_value = nil)\n      filter_array(input, property, target_value, nil) { |ary, &block| ary.find_index(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find_index\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"find_index\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"a9824469-a931-4ba8-b49c-804626fd1c40"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":22,"raw_source":"def test_if_else\n    assert_template_result(' YES ', '{% if false %} NO {% else %} YES {% endif %}')\n    assert_template_result(' YES ', '{% if true %} YES {% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% else %} NO {% endif %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if false %} NO {% else %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %} YES {% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% else %} NO {% endif %}\"]}]}]}]}","id":"b944fe40-b7a5-40ac-afb9-1a2293ab1835"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":181,"raw_source":"def test_local_filter_with_deprecated_syntax\n    assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, CanadianMoneyFilter))\n    assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, [CanadianMoneyFilter]))\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_filter_with_deprecated_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]}]}","id":"9c9233fb-96bf-4fdc-8034-4a8602b8213e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":497,"raw_source":"def callback(&block)\n        return yield if closed?\n\n        @callbacks << block\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"callback\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"68446ec7-8d86-47ad-b9eb-406a13afe1ba"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":17,"raw_source":"def test_literal_comparisons\n    assert_template_result(' NO ', '{% assign v = false %}{% if v %} YES {% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% assign v = nil %}{% if v == nil %} YES {% else %} NO {% endif %}')\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_literal_comparisons\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" NO \"]},{\"type\":\"str\",\"children\":[\"{% assign v = false %}{% if v %} YES {% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% assign v = nil %}{% if v == nil %} YES {% else %} NO {% endif %}\"]}]}]}]}","id":"e31a9b76-3855-4414-aa21-4b847a60b7e9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":86,"raw_source":"def test_profiling_render_tag\n    t = Template.parse(\"{% render 'a_template' %}\", profile: true)\n    t.render!\n\n    render_children = t.profiler[0].children\n    render_children.each do |timing|\n      assert_equal('a_template', timing.partial)\n    end\n    assert_equal([1, 2], render_children.map(&:line_number))\n  end","complexity_score":16.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_render_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"render_children\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"timing\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"partial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]}]}]}]}]}]}","id":"07e760d7-aaac-4ad5-b790-b5f49e61901d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":172,"raw_source":"def external_encoding\n        Encoding.find settings.default_encoding\n      rescue NameError\n        settings.default_encoding\n      end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"external_encoding\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Encoding\"]},\"find\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NameError\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]},null]}]}","id":"5c266e47-9ea3-4707-99f5-f18094c603d0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":328,"raw_source":"def uri(addr = nil, absolute = true, add_script_name = true)\n      return addr if addr.to_s =~ /\\A[a-z][a-z0-9+.\\-]*:/i\n\n      uri = [host = String.new]\n      if absolute\n        host << \"http#{'s' if request.secure?}://\"\n        host << if request.forwarded? || (request.port != (request.secure? ? 443 : 80))\n                  request.host_with_port\n                else\n                  request.host\n                end\n      end\n      uri << request.script_name.to_s if add_script_name\n      uri << (addr || request.path_info).to_s\n      File.join uri\n    end","complexity_score":53.9,"ast_json":"{\"type\":\"def\",\"children\":[\"uri\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"addr\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"absolute\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"add_script_name\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]},\"to_s\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A[a-z][a-z0-9+.\\\\-]*:\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"uri\",{\"type\":\"array\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"host\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"new\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"absolute\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"http\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"secure?\"]},{\"type\":\"str\",\"children\":[\"s\"]},null]}]},{\"type\":\"str\",\"children\":[\"://\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"forwarded?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"port\"]},\"!=\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"secure?\"]},{\"type\":\"int\",\"children\":[443]},{\"type\":\"int\",\"children\":[80]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host_with_port\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"add_script_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"script_name\"]},\"to_s\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"addr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"path_info\"]}]}]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]}]}","id":"89501520-9ca5-4146-b5e6-da5930be53c6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":87,"raw_source":"def test_cols_nil_constant_same_as_evaluated_nil_expression\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"<td class=\\\"col1\\\">false</td>\" \\\n      \"<td class=\\\"col2\\\">false</td>\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) cols:nil %}{{ tablerowloop.col_last }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) cols:var %}{{ tablerowloop.col_last }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cols_nil_constant_same_as_evaluated_nil_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">false</td>\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col2\\\">false</td>\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) cols:nil %}{{ tablerowloop.col_last }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) cols:var %}{{ tablerowloop.col_last }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"fad6e55d-e0ec-4078-bd2b-a239fabab0d0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":11,"raw_source":"def read_template_file(template_path)\n    PARTIALS[template_path] || template_path\n  end","complexity_score":2.1,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PARTIALS\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}","id":"87fa79dd-241d-4174-91d4-81a58a7f733b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":69,"raw_source":"def route(*args, &block)\n      options = Hash === args.last ? args.pop : {}\n      routes = [*args.pop]\n      args.each do |verb|\n        verb = verb.to_s.upcase if Symbol === verb\n        routes.each do |route|\n          super(verb, route, options, &block)\n        end\n      end\n    end","complexity_score":20.8,"ast_json":"{\"type\":\"def\",\"children\":[\"route\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"routes\",{\"type\":\"array\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"lvasgn\",\"children\":[\"verb\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},\"to_s\"]},\"upcase\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"routes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"route\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"route\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}]}","id":"5f13170a-5197-41a4-bf57-31019067d6bc"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/json_filter.rb","start_line":6,"raw_source":"def json(object)\n    JSON.dump(object.reject { |k, _v| k == \"collections\" })\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"json\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"JSON\"]},\"dump\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"==\",{\"type\":\"str\",\"children\":[\"collections\"]}]}]}]}]}","id":"9ad9a890-e62a-4348-8ede-74a4ae3e201c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1576,"raw_source":"def production?;  environment == :production  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"production?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"production\"]}]}]}","id":"af803fc6-271d-41e6-9e17-3cecdc3a2088"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":63,"raw_source":"def test_profiling_includes_line_numbers_of_liquid_nodes\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% increment test %}\", profile: true)\n    t.render!\n    assert_equal(2, t.profiler.length)\n\n    # {{ 'a string' | upcase }}\n    assert_equal(1, t.profiler[0].line_number)\n    # {{ increment test }}\n    assert_equal(2, t.profiler[1].line_number)\n  end","complexity_score":18.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_includes_line_numbers_of_liquid_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% increment test %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"line_number\"]}]}]}]}","id":"478a4d95-60fc-4697-ae87-a371ef9a7574"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":287,"raw_source":"def values\n        to_hash.values\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"values\"]}]}","id":"8d7afcc3-5254-410f-8460-b4dbec3e66e1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/form_token.rb","start_line":20,"raw_source":"def accepts?(env)\n        env['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest' or super\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_REQUESTED_WITH\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"XMLHttpRequest\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"206e76ff-33f7-4970-b715-6fa266fff78b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":339,"raw_source":"def test_sort_natural_with_nils\n    assert_equal([\"a\", \"B\", \"c\", \"D\", nil], @filters.sort_natural([nil, \"c\", \"D\", \"a\", \"B\"]))\n    assert_equal([{ \"a\" => \"a\" }, { \"a\" => \"B\" }, { \"a\" => \"c\" }, { \"a\" => \"D\" }, {}], @filters.sort_natural([{ \"a\" => \"D\" }, { \"a\" => \"c\" }, {}, { \"a\" => \"a\" }, { \"a\" => \"B\" }], \"a\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_with_nils\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"b6999605-3e5a-40b7-8aef-fae5b13c10d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":5,"raw_source":"def initialize(input)\n      ss = input.is_a?(StringScanner) ? input : StringScanner.new(input)\n      @tokens = Lexer.tokenize(ss)\n      @p      = 0 # pointer to current location\n    end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ss\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"StringScanner\"]}]},{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Lexer\"]},\"tokenize\",{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@p\",{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"ba620480-1e5f-47e4-ade9-26fd3cc3ba5d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1716,"raw_source":"def setup_traps\n        return unless traps?\n\n        at_exit { quit! }\n\n        %i[INT TERM].each do |signal|\n          old_handler = trap(signal) do\n            quit!\n            old_handler.call if old_handler.respond_to?(:call)\n          end\n        end\n\n        set :traps, false\n      end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_traps\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traps?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"at_exit\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"quit!\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"INT\"]},{\"type\":\"sym\",\"children\":[\"TERM\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"signal\"]}]},{\"type\":\"lvasgn\",\"children\":[\"old_handler\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"trap\",{\"type\":\"lvar\",\"children\":[\"signal\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"quit!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_handler\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"old_handler\"]},\"call\"]},null]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"traps\"]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"2b3dbeb0-3c6b-4eae-8b94-d51c54e7c2c6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":78,"raw_source":"def test_variable_piping_with_no_args\n    text     = %( {{ car.gm | add_smiley }} )\n    expected = %| bad :-) |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_no_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-) \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"bea20aaa-4e00-4c9e-8918-927008128069"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":48,"raw_source":"def include?(middleware)\n    @ins.any? { |m| middleware === m }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"include?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ins\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]}]}","id":"b03eb3a4-f36c-4f46-a5ae-0873be360337"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":50,"raw_source":"def new_body\n      parse_context.new_block_body\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"new_block_body\"]}]}","id":"78132869-e731-4da0-8209-543a71ddd735"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/liquid_test.rb","start_line":7,"raw_source":"def liquid_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"a530b993-7ed7-441e-82b0-d559a5f015f4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":164,"raw_source":"def test_doc_tag_whitespace_control\n    # Basic whitespace control\n    assert_template_result(\"Hello!\", \"      {%- doc -%}123{%- enddoc -%}Hello!\")\n    assert_template_result(\"Hello!\", \"{%- doc -%}123{%- enddoc -%}     Hello!\")\n    assert_template_result(\"Hello!\", \"      {%- doc -%}123{%- enddoc -%}     Hello!\")\n    assert_template_result(\"Hello!\", <<~LIQUID.chomp)\n      {%- doc %}Whitespace control!{% enddoc -%}\n      Hello!\n    LIQUID\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- doc -%}123{%- enddoc -%}Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"{%- doc -%}123{%- enddoc -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- doc -%}123{%- enddoc -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- doc %}Whitespace control!{% enddoc -%}\\n\"]},{\"type\":\"str\",\"children\":[\"Hello!\\n\"]}]},\"chomp\"]}]}]}]}","id":"9832d618-6adc-43bb-b51c-677e99f33413"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":125,"raw_source":"def mask_authenticity_token(session, path: nil, method: :post)\n        set_token(session)\n\n        token = if path && method\n                  per_form_token(session, path, method)\n                else\n                  global_token(session)\n                end\n\n        mask_token(token)\n      end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mask_authenticity_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"kwoptarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"method\",{\"type\":\"sym\",\"children\":[\"post\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"per_form_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[null,\"global_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"mask_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}","id":"5d3ad2af-5c1d-451f-a591-a88e551504d2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1047,"raw_source":"def test_where_with_empty_string_is_a_no_op\n    environment = { \"array\" => [\"alpha\", \"beta\", \"gamma\"] }\n    expected_output = \"alpha beta gamma\"\n    template = \"{{ array | where: '' | join: ' ' }}\"\n\n    assert_template_result(expected_output, template, environment)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_empty_string_is_a_no_op\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha beta gamma\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: '' | join: ' ' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}","id":"3dfb4094-e7ef-4f99-a47b-c6c3ebbd5397"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":40,"raw_source":"def render_to_output_buffer(context, output)\n      val = @from.render(context)\n      context.scopes.last[@to] = val\n      context.resource_limits.increment_assign_score(assign_score_of(val))\n      output\n    end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@from\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@to\"]},{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_assign_score\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"776dc9a6-8056-4853-9e16-f2fd6cf1e256"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":205,"raw_source":"def test_add_item_in_inner_scope\n    @context.push\n    @context['test'] = 'test'\n    assert_equal('test', @context['test'])\n    @context.pop\n    assert_nil(@context['test'])\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_item_in_inner_scope\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]}","id":"3591e3b0-d149-41de-a333-6834b2cc399a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":100,"raw_source":"def <<(data)\n        raise IOError, 'not opened for writing' if closed?\n\n        @transformer ||= nil\n        data = data.to_s\n        data = @transformer[data] if @transformer\n        @pos += data.bytesize\n        super(data)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"<<\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"IOError\"]},{\"type\":\"str\",\"children\":[\"not opened for writing\"]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@transformer\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"data\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},{\"type\":\"lvasgn\",\"children\":[\"data\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"data\"]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pos\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"bytesize\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]}","id":"2e12f303-fc8a-4c76-aef7-16a89ae186be"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":34,"raw_source":"def test_loops_are_blank\n    assert_template_result(\"\", wrap_in_for(\" \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_loops_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}","id":"0c669d12-407b-4645-b6aa-a72e151eba6e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":19,"raw_source":"def test_custom_block_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\n    klass1 = Class.new(Block) do\n      def render(*)\n        'hello'\n      end\n    end\n\n    with_custom_tag('blabla', klass1) do\n      template = Liquid::Template.parse(\"{% blabla %} bla {% endblabla %}\")\n\n      assert_equal('hello', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('hello', output)\n      assert_equal('hello', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n\n    klass2 = Class.new(klass1) do\n      def render(*)\n        'foo' + super + 'bar'\n      end\n    end\n\n    with_custom_tag('blabla', klass2) do\n      template = Liquid::Template.parse(\"{% blabla %} foo {% endblabla %}\")\n\n      assert_equal('foohellobar', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('foohellobar', output)\n      assert_equal('foohellobar', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n  end","complexity_score":42.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_block_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass1\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Block\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %} bla {% endblabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"klass2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %} foo {% endblabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]}]}]}","id":"e7071de1-fafe-45a5-973e-225701a46fef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1891,"raw_source":"def inherited(subclass)\n        subclass.reset!\n        subclass.set :app_file, caller_files.first unless subclass.app_file?\n        super\n      end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"reset!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"app_file?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"app_file\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"first\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"638bfffc-eda6-4149-afa1-9aa8da7d61e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":81,"raw_source":"def profile(template_name, &block)\n      # nested renders are done from a tag that already has a timing node\n      return yield if @current_children\n\n      root_children = @root_children\n      render_idx = root_children.length\n      begin\n        @current_children = root_children\n        profile_node(template_name, &block)\n      ensure\n        @current_children = nil\n        if (timing = root_children[render_idx])\n          @total_time += timing.total_time\n        end\n      end\n    end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"profile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@current_children\"]},{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"root_children\",{\"type\":\"ivar\",\"children\":[\"@root_children\"]}]},{\"type\":\"lvasgn\",\"children\":[\"render_idx\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"root_children\"]},\"length\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"lvar\",\"children\":[\"root_children\"]}]},{\"type\":\"send\",\"children\":[null,\"profile_node\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"root_children\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"render_idx\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@total_time\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"total_time\"]}]},null]}]}]}]}]}]}","id":"7cb9c36f-96c5-4410-9aa7-3bd4ed636e1e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":17,"raw_source":"def add_filter(filter)\n        return if include?(filter)\n\n        invokable_non_public_methods = (filter.private_instance_methods + filter.protected_instance_methods).select { |m| invokable?(m) }\n        if invokable_non_public_methods.any?\n          raise MethodOverrideError, \"Filter overrides registered public methods as non public: #{invokable_non_public_methods.join(', ')}\"\n        end\n\n        include(filter)\n\n        filter_methods.merge(filter.public_instance_methods.map(&:to_s))\n      end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"invokable_non_public_methods\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"private_instance_methods\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"protected_instance_methods\"]}]}]},\"select\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[null,\"invokable?\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invokable_non_public_methods\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"MethodOverrideError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Filter overrides registered public methods as non public: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invokable_non_public_methods\"]},\"join\",{\"type\":\"str\",\"children\":[\", \"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"merge\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter\"]},\"public_instance_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]}","id":"a51a0439-0272-41cd-91c1-25dec57e75ba"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":408,"raw_source":"def each\n      @each_called = true\n      @data.each { |el| yield el }\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@each_called\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@data\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]}]}]}]}]}","id":"dce56ee8-7ef4-4987-8c5c-f2b20386eab7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":27,"raw_source":"def test_double_quoted_words\n    assert_equal(['arg1', 'arg2', '\"arg 3\"'], 'arg1 arg2 \"arg 3\"'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_double_quoted_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"\\\"arg 3\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 \\\"arg 3\\\"\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"a68cef54-d22d-4e9b-874e-af0f0964409a"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":99,"raw_source":"def compile_all_tests\n    @compiled_tests = []\n    each_test do |liquid, layout, assigns, page_template, template_name|\n      @compiled_tests << compile_test(liquid, layout, assigns, page_template, template_name)\n    end\n    @compiled_tests\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_all_tests\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@compiled_tests\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_test\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"liquid\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"compile_test\",{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@compiled_tests\"]}]}]}","id":"3f2ce28b-3cd8-4906-9a22-ab608cbd21f6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":159,"raw_source":"def matches_params?(params)\n        return true if @params.empty?\n\n        params.all? { |k, v| !@params.key?(k) || @params[k] == v }\n      end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"matches_params?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]}","id":"fb419bc1-bcb2-48a2-8c6d-a6b0344d265e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":20,"raw_source":"def self.each(&block)\n      all.each(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"all\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"0a1ecf09-4234-43e8-9a6e-ac7053df044b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":75,"raw_source":"def test_symbol\n    var = create_variable(\"http://disney.com/logo.gif | image: 'med' \", error_mode: :lax)\n    assert_equal(VariableLookup.new('http://disney.com/logo.gif'), var.name)\n    assert_equal([['image', ['med']]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_symbol\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif | image: 'med' \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"image\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"med\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"69c15d6b-08cd-416b-8e0e-fc1ffe20c574"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":111,"raw_source":"def [](idx)\n      children[idx]\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"idx\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"idx\"]}]}]}","id":"bcefef96-ddb7-4920-86f2-42591083b971"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":32,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @from = @limit = nil\n      parse_with_selected_parser(markup)\n      @for_block = new_body\n      @else_block = nil\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"ivasgn\",\"children\":[\"@limit\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"parse_with_selected_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@for_block\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@else_block\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"6ae51efd-f76c-4f91-b893-a19e809a0458"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":688,"raw_source":"def test_newlines_to_br\n    assert_template_result(\"a<br />\\nb<br />\\nc\", \"{{ source | newline_to_br }}\", { 'source' => \"a\\nb\\nc\" })\n    assert_template_result(\"a<br />\\nb<br />\\nc\", \"{{ source | newline_to_br }}\", { 'source' => \"a\\r\\nb\\nc\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_newlines_to_br\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a<br />\\nb<br />\\nc\"]},{\"type\":\"str\",\"children\":[\"{{ source | newline_to_br }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\nb\\nc\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a<br />\\nb<br />\\nc\"]},{\"type\":\"str\",\"children\":[\"{{ source | newline_to_br }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\r\\nb\\nc\"]}]}]}]}]}]}","id":"405e500e-d664-4218-97dc-afb9275ae853"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/frame_options.rb","start_line":24,"raw_source":"def frame_options\n        @frame_options ||= begin\n          frame_options = options[:frame_options]\n          frame_options = options[:frame_options].to_s.upcase unless frame_options.respond_to? :to_str\n          frame_options.to_str\n        end\n      end","complexity_score":15.0,"ast_json":"{\"type\":\"def\",\"children\":[\"frame_options\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@frame_options\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"frame_options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame_options\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"frame_options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]},\"to_s\"]},\"upcase\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame_options\"]},\"to_str\"]}]}]}]}","id":"833ee0c7-b902-4971-8629-593494ed4b3b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":42,"raw_source":"def remove_bad_cookies(request, response)\n        return if bad_cookies.empty?\n\n        paths = cookie_paths(request.path)\n        bad_cookies.each do |name|\n          paths.each { |path| response.set_cookie name, empty_cookie(request.host, path) }\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_bad_cookies\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"request\"]},{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"paths\",{\"type\":\"send\",\"children\":[null,\"cookie_paths\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"set_cookie\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"send\",\"children\":[null,\"empty_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}]}]}]}","id":"cdf919ec-c0d2-47cc-a160-bb6cf55a827b"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":24,"raw_source":"def parse(tokens)\n      @body = +''\n      while (token = tokens.shift)\n        if token =~ BlockBody::FullTokenPossiblyInvalid && block_delimiter == Regexp.last_match(2)\n          parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n          @body << Regexp.last_match(1) if Regexp.last_match(1) != \"\"\n          return\n        end\n        @body << token unless token.empty?\n      end\n\n      raise_tag_never_closed(block_name)\n    end","complexity_score":34.3,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}","id":"0da4c7c3-52f7-44d6-8a3c-b3f6c50e4ff0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":70,"raw_source":"def move?\n        request_method == 'MOVE'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"move?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"MOVE\"]}]}]}","id":"fe1539ca-1d77-4870-8b1d-d289ff4eb7d0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2130,"raw_source":"def initialize(stack, instance)\n      @stack = stack\n      @instance = instance\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"stack\"]},{\"type\":\"arg\",\"children\":[\"instance\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@stack\",{\"type\":\"lvar\",\"children\":[\"stack\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@instance\",{\"type\":\"lvar\",\"children\":[\"instance\"]}]}]}]}","id":"db28a443-bd44-4bd6-a2d4-fa20310a3138"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1395,"raw_source":"def disable(*opts)\n        opts.each { |key| set(key, false) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"disable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"4684636d-c90a-4eed-9b1e-3c11d02b6b4e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":42,"raw_source":"def default_exception_renderer\n        Environment.default.exception_renderer\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"default_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"exception_renderer\"]}]}","id":"baa7f6fc-d997-4813-9270-05b8e9a78c53"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":21,"raw_source":"def read_template_file(template_path)\n      File.read(@path + '/' + template_path + '.liquid')\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@path\"]},\"+\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"+\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},\"+\",{\"type\":\"str\",\"children\":[\".liquid\"]}]}]}]}","id":"27b316dd-eea3-449a-93af-098ea94a1f7e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":8,"raw_source":"def test_default\n    assert_raises(FileSystemError) do\n      BlankFileSystem.new.read_template_file(\"dummy\")\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlankFileSystem\"]},\"new\"]},\"read_template_file\",{\"type\":\"str\",\"children\":[\"dummy\"]}]}]}]}","id":"f89ed134-eb89-4df3-85b7-6715332310cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":74,"raw_source":"def test_static_register_can_be_frozen\n    static_register = Registers.new(a: 1)\n\n    static_register.static.freeze\n\n    assert_raises(RuntimeError) do\n      static_register.static[:a] = \"foo\"\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static[:b] = \"foo\"\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static.delete(:a)\n    end\n\n    assert_raises(RuntimeError) do\n      static_register.static.delete(:c)\n    end\n  end","complexity_score":21.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_static_register_can_be_frozen\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"freeze\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"static\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}","id":"cdaa0d6b-fb08-471f-a261-1e6cfe7c4932"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":199,"raw_source":"def children\n        (super + [@node.limit, @node.from, @node.collection_name]).compact\n      end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"from\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"collection_name\"]}]}]}]},\"compact\"]}]}","id":"a4d3a28d-ce5f-4c8a-95c9-30c8c18cf4e3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":28,"raw_source":"def app_file\n      File.expand_path('integration/app.rb', __dir__)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"integration/app.rb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}","id":"c7158fd5-f1be-4f49-9a42-e910235c4513"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":386,"raw_source":"def test_drop_with_variable_called_only_once\n    @context['counter'] = CounterDrop.new\n\n    assert_equal(1, @context['counter.count'])\n    assert_equal(2, @context['counter.count'])\n    assert_equal(3, @context['counter.count'])\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_with_variable_called_only_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"counter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CounterDrop\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter.count\"]}]}]}]}]}","id":"a3509c2c-ea7d-484c-878d-b3323986fd56"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":71,"raw_source":"private def default_resource_limits=(limits)\n        Deprecations.warn(\"Template.default_resource_limits=\", \"Environment#default_resource_limits=\")\n        Environment.default.default_resource_limits = limits\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"default_resource_limits=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"limits\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.default_resource_limits=\"]},{\"type\":\"str\",\"children\":[\"Environment#default_resource_limits=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"default_resource_limits=\",{\"type\":\"lvar\",\"children\":[\"limits\"]}]}]}]}]}","id":"d9b42ef2-888b-4f98-aaed-0348fd648dc3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":54,"raw_source":"def test_comparison_of_expressions_starting_with_and_or_or\n    assigns = { 'order' => { 'items_count' => 0 }, 'android' => { 'name' => 'Roy' } }\n    assert_template_result(\n      \"YES\",\n      \"{% if android.name == 'Roy' %}YES{% endif %}\",\n      assigns,\n    )\n    assert_template_result(\n      \"YES\",\n      \"{% if order.items_count == 0 %}YES{% endif %}\",\n      assigns,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparison_of_expressions_starting_with_and_or_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"order\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items_count\"]},{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"android\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Roy\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YES\"]},{\"type\":\"str\",\"children\":[\"{% if android.name == 'Roy' %}YES{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YES\"]},{\"type\":\"str\",\"children\":[\"{% if order.items_count == 0 %}YES{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"739033fd-da34-40c3-a3e0-ed811149d2e8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":895,"raw_source":"def compile_template(engine, data, options, views)\n      eat_errors = options.delete :eat_errors\n      template = Tilt[engine]\n      raise \"Template engine not found: #{engine}\" if template.nil?\n\n      case data\n      when Symbol\n        template_cache.fetch engine, data, options, views do\n          body, path, line = settings.templates[data]\n          if body\n            body = body.call if body.respond_to?(:call)\n            template.new(path, line.to_i, options) { body }\n          else\n            found = false\n            @preferred_extension = engine.to_s\n            find_template(views, data, template) do |file|\n              path ||= file # keep the initial path rather than the last one\n              found = File.exist?(file)\n              if found\n                path = file\n                break\n              end\n            end\n            throw :layout_missing if eat_errors && !found\n            template.new(path, 1, options)\n          end\n        end\n      when Proc\n        compile_block_template(template, options, &data)\n      when String\n        template_cache.fetch engine, data, options, views do\n          compile_block_template(template, options) { data }\n        end\n      else\n        raise ArgumentError, \"Sorry, don't know how to render #{data.inspect}.\"\n      end\n    end","complexity_score":75.85,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"arg\",\"children\":[\"options\"]},{\"type\":\"arg\",\"children\":[\"views\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"eat_errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"eat_errors\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Template engine not found: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]}]}]}]},null]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\"]},{\"type\":\"lvasgn\",\"children\":[\"path\"]},{\"type\":\"lvasgn\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"data\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"call\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@preferred_extension\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"find_template\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"lvasgn\",\"children\":[\"found\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"break\",\"children\":[]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"eat_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"found\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"layout_missing\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},{\"type\":\"send\",\"children\":[null,\"compile_block_template\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"views\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"compile_block_template\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Sorry, don't know how to render \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\".\"]}]}]}]}]}]}","id":"7053e3b4-08f6-4a69-b873-3544b75641ec"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":683,"raw_source":"def test_strip_newlines\n    assert_template_result('abc', \"{{ source | strip_newlines }}\", { 'source' => \"a\\nb\\nc\" })\n    assert_template_result('abc', \"{{ source | strip_newlines }}\", { 'source' => \"a\\r\\nb\\nc\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_newlines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip_newlines }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\nb\\nc\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ source | strip_newlines }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"a\\r\\nb\\nc\"]}]}]}]}]}]}","id":"cacc424d-baca-4e6c-9ac4-735f6ca18010"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":77,"raw_source":"def test_lax_unrecognized_operator\n    template = Liquid::Template.parse(' {% if 1 =! 2 %}ok{% endif %} ', error_mode: :lax)\n    assert_equal(' Liquid error: Unknown operator =! ', template.render)\n    assert_equal(1, template.errors.size)\n    assert_equal(Liquid::ArgumentError, template.errors.first.class)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lax_unrecognized_operator\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% if 1 =! 2 %}ok{% endif %} \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: Unknown operator =! \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}","id":"85e5f78f-eb0c-4997-b8d8-914141f89fb7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":159,"raw_source":"def test_ignores_delimiter_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% if true %}\n          {% comment %}\n            {% commentXXXXX %}wut{% endcommentXXXXX %}\n          {% endcomment %}\n        {% endif %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ignores_delimiter_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% commentXXXXX %}wut{% endcommentXXXXX %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\\n\"]}]},\"chomp\"]}]}]}","id":"98a8df77-1477-4199-8619-60dd6df147ae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":160,"raw_source":"def test_uses_template_name_from_template_factory\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('some/path/my_partial', partial.name)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some/path/my_partial\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]}]}]}","id":"747484fb-27c8-43e7-a8c8-20c466e5f0a0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":95,"raw_source":"def test_rassoc\n    assert_nil @hash.rassoc(:d)\n    assert_equal [?a, :a], @hash.rassoc(:a)\n    assert_equal [?b, :b], @hash.rassoc(:b)\n    assert_equal ['simple_nested', { ?a=>:a, ?b=>:b }], @hash.rassoc(:a=>:a, ?b=>:b)\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rassoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"rassoc\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]}]}","id":"bae7981f-351d-4c3f-8e6a-f88dd84dd4c2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":58,"raw_source":"def self.test(name, &block)\n    define_method(test_name(name), &block)\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"send\",\"children\":[null,\"test_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"c9963698-a587-4dc6-a927-364c8053d1af"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":34,"raw_source":"def inherited(subclass)\n        super\n        subclass.instance_variable_set(:@filter_methods, @filter_methods.dup)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"instance_variable_set\",{\"type\":\"sym\",\"children\":[\"@filter_methods\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filter_methods\"]},\"dup\"]}]}]}]}","id":"e007f9ea-43f1-413f-b407-23de5e9dabff"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":378,"raw_source":"def test_cents_through_drop_nestedly\n    @context.merge(\"cents\" => { \"cents\" => CentsDrop.new })\n    assert_equal(100, @context['cents.cents.amount'])\n\n    @context.merge(\"cents\" => { \"cents\" => { \"cents\" => CentsDrop.new } })\n    assert_equal(100, @context['cents.cents.cents.amount'])\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents_through_drop_nestedly\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.amount\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.cents.amount\"]}]}]}]}]}","id":"2ed52e5e-f494-4fa7-9575-ae9c8755d0e0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/extensions_test.rb","start_line":45,"raw_source":"Sinatra::Base.register { def im_in_ur_anonymous_module; end }","complexity_score":2.0,"ast_json":"{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"register\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"im_in_ur_anonymous_module\",{\"type\":\"args\",\"children\":[]},null]}]}","id":"cc5e1012-8f98-4553-8645-ebf115152f66"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":184,"raw_source":"def test_dynamically_choosen_template\n    assert_template_result(\n      \"Test123\",\n      \"{% include template %}\",\n      { \"template\" => 'Test123' },\n      partials: { \"Test123\" => \"Test123\" },\n    )\n\n    assert_template_result(\n      \"Test321\",\n      \"{% include template %}\",\n      { \"template\" => 'Test321' },\n      partials: { \"Test321\" => \"Test321\" },\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm \",\n      \"{% include template for product %}\",\n      { \"template\" => 'product', 'product' => { 'title' => 'Draft 151cm' } },\n      partials: { \"product\" => \"Product: {{ product.title }} \" },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamically_choosen_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Test123\"]},{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"Test123\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Test123\"]},{\"type\":\"str\",\"children\":[\"Test123\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Test321\"]},{\"type\":\"str\",\"children\":[\"{% include template %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"Test321\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Test321\"]},{\"type\":\"str\",\"children\":[\"Test321\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm \"]},{\"type\":\"str\",\"children\":[\"{% include template for product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"str\",\"children\":[\"product\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"str\",\"children\":[\"Product: {{ product.title }} \"]}]}]}]}]}]}]}]}","id":"7c97c26e-aafd-4017-af37-cb77b0e84461"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":124,"raw_source":"def test_key\n    assert_nil @hash.key(:d)\n    assert_equal ?a, @hash.key(:a)\n    assert_equal 'simple_nested', @hash.key(:a=>:a, ?b=>:b)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"key\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]}]}","id":"9e85f790-629a-4ede-9ada-5a952bd5d1b7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":74,"raw_source":"def test_for_helpers\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result(\n      ' 1/3  2/3  3/3 ',\n      '{%for item in array%} {{forloop.index}}/{{forloop.length}} {%endfor%}',\n      assigns,\n    )\n    assert_template_result(' 1  2  3 ', '{%for item in array%} {{forloop.index}} {%endfor%}', assigns)\n    assert_template_result(' 0  1  2 ', '{%for item in array%} {{forloop.index0}} {%endfor%}', assigns)\n    assert_template_result(' 2  1  0 ', '{%for item in array%} {{forloop.rindex0}} {%endfor%}', assigns)\n    assert_template_result(' 3  2  1 ', '{%for item in array%} {{forloop.rindex}} {%endfor%}', assigns)\n    assert_template_result(' true  false  false ', '{%for item in array%} {{forloop.first}} {%endfor%}', assigns)\n    assert_template_result(' false  false  true ', '{%for item in array%} {{forloop.last}} {%endfor%}', assigns)\n  end","complexity_score":8.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_helpers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1/3  2/3  3/3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index}}/{{forloop.length}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0  1  2 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.index0}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 2  1  0 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.rindex0}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 3  2  1 \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.rindex}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" true  false  false \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.first}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" false  false  true \"]},{\"type\":\"str\",\"children\":[\"{%for item in array%} {{forloop.last}} {%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"f9a39d86-ed0d-4117-8eae-53a36d4ac0b2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":197,"raw_source":"def test_cycle\n    assert_equal(\n      [\"test\"],\n      visit(%({% cycle test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% cycle test %}\"]}]}]}]}","id":"95f225b1-ece7-4499-a8a1-d5483f2057c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":90,"raw_source":"def test_rendering_hash_with_custom_to_s_method_uses_custom_to_s\n    my_hash = Class.new(Hash) do\n      def to_s\n        \"kewl\"\n      end\n    end.new\n\n    assert_template_result(\"kewl\", \"{{ my_hash }}\", { \"my_hash\" => my_hash })\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rendering_hash_with_custom_to_s_method_uses_custom_to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"kewl\"]}]}]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"kewl\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"my_hash\"]}]}]}]}]}]}","id":"2352d944-dc97-4ceb-90cd-7b6a1debca94"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":127,"raw_source":"def test_case_else_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% else %}{{ test }}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_else_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% else %}{{ test }}{% endcase %}\"]}]}]}]}","id":"202f2a7d-102c-4b1f-89fc-cf3b9a0e1d44"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":402,"raw_source":"def test_whitespace_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}},\n          {{- '30' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John,30</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}},\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John,30</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"dab01c5d-4323-4c58-9717-5b3cdfef304c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":303,"raw_source":"def strip(input)\n      input = Utils.to_s(input)\n      input.strip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"strip\"]}]}]}","id":"1e078fd8-b7ca-44ec-8221-3d231c2a105d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":72,"raw_source":"def next_token\n      # possible states: :text, :tag, :variable\n      byte_a = @ss.peek_byte\n\n      if byte_a == OPEN_CURLEY\n        @ss.scan_byte\n\n        byte_b = @ss.peek_byte\n\n        if byte_b == PERCENTAGE\n          @ss.scan_byte\n          return next_tag_token\n        elsif byte_b == OPEN_CURLEY\n          @ss.scan_byte\n          return next_variable_token\n        end\n\n        @ss.pos -= 1\n      end\n\n      next_text_token\n    end","complexity_score":19.7,"ast_json":"{\"type\":\"def\",\"children\":[\"next_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"peek_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"PERCENTAGE\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_tag_token\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_variable_token\"]}]}]},null]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"next_text_token\"]}]}]}","id":"a09bd0c9-2782-4a5d-847e-66b65de3b2aa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1186,"raw_source":"def test_where_no_target_value\n    input = [\n      { \"foo\" => false },\n      { \"foo\" => true },\n      { \"foo\" => \"for sure\" },\n      { \"bar\" => true },\n    ]\n\n    assert_equal([{ \"foo\" => true }, { \"foo\" => \"for sure\" }], @filters.where(input, \"foo\"))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_no_target_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"for sure\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"for sure\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}","id":"729b0057-a8e4-49a2-a324-b16d2a041b78"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1495,"raw_source":"def after(path = /.*/, **options, &block)\n        add_filter(:after, path, **options, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"after\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"add_filter\",{\"type\":\"sym\",\"children\":[\"after\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"fda67dea-54a2-49be-8399-4153c739b5ca"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":141,"raw_source":"def evaluate_filter_expressions(context, filter_args, filter_kwargs)\n      parsed_args = filter_args.map { |expr| context.evaluate(expr) }\n      if filter_kwargs\n        parsed_kwargs = {}\n        filter_kwargs.each do |key, expr|\n          parsed_kwargs[key] = context.evaluate(expr)\n        end\n        parsed_args << parsed_kwargs\n      end\n      parsed_args\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate_filter_expressions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"filter_args\"]},{\"type\":\"arg\",\"children\":[\"filter_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_args\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_kwargs\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_kwargs\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parsed_kwargs\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parsed_args\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"parsed_kwargs\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"parsed_args\"]}]}]}","id":"d92b503a-7392-4ede-8668-9c30c07003fa"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":112,"raw_source":"def referrer(env)\n        ref = env['HTTP_REFERER'].to_s\n        return if !options[:allow_empty_referrer] && ref.empty?\n\n        URI.parse(ref).host || Request.new(env).host\n      rescue URI::InvalidURIError\n      end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"referrer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ref\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_REFERER\"]}]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_empty_referrer\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ref\"]},\"empty?\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"ref\"]}]},\"host\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"InvalidURIError\"]}]},null,null]},null]}]}","id":"33b10db2-3a85-4ab9-8c35-ec6369a5d6fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1197,"raw_source":"def test_sum_with_all_numbers\n    input = [1, 2]\n\n    assert_equal(3, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_all_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}","id":"b1fd3028-6fe7-4e97-9256-caf3a72e703c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":8,"raw_source":"def test_parsing_css\n    text = \" div { font-weight: bold; } \"\n    assert_equal(text, Template.parse(text).render!)\n  end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_css\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" div { font-weight: bold; } \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\"]}]}]}]}","id":"99b45a9e-8747-4d5a-9a0d-d89d401b09e8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":27,"raw_source":"def fixture(name)\n      File.join(File.expand_path(__dir__), \"fixtures\", name)\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"fixture\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},{\"type\":\"str\",\"children\":[\"fixtures\"]},{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}","id":"2dc93699-ab84-46db-8b68-fc1477190a42"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":440,"raw_source":"def strenc(s)\n    t = StringIO.new\n    t.putc(?\")\n    r = 0\n    while r < s.length\n      case s[r]\n      when ?\"  then t.print('\\\\\"')\n      when ?\\\\ then t.print('\\\\\\\\')\n      when ?\\b then t.print('\\\\b')\n      when ?\\f then t.print('\\\\f')\n      when ?\\n then t.print('\\\\n')\n      when ?\\r then t.print('\\\\r')\n      when ?\\t then t.print('\\\\t')\n      else\n        c = s[r]\n        case true\n        when Spc <= c && c <= ?~\n          t.putc(c)\n        when true\n          u, size = uchardec(s, r)\n          r += size - 1 # we add one more at the bottom of the loop\n          if u < 0x10000\n            t.print('\\\\u')\n            hexenc4(t, u)\n          else\n            u1, u2 = unsubst(u)\n            t.print('\\\\u')\n            hexenc4(t, u1)\n            t.print('\\\\u')\n            hexenc4(t, u2)\n          end\n        else\n          # invalid byte; skip it\n        end\n      end\n      r += 1\n    end\n    t.putc(?\")\n    t.string\n  end","complexity_score":80.8,"ast_json":"{\"type\":\"def\",\"children\":[\"strenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringIO\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\\\\"\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\\\\\\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\b\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\f\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\n\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\r\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\r\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"\\t\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\t\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Spc\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"<=\",{\"type\":\"str\",\"children\":[\"~\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u\"]},{\"type\":\"lvasgn\",\"children\":[\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"uchardec\",{\"type\":\"lvar\",\"children\":[\"s\"]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"size\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<\",{\"type\":\"int\",\"children\":[65536]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"u1\"]},{\"type\":\"lvasgn\",\"children\":[\"u2\"]}]},{\"type\":\"send\",\"children\":[null,\"unsubst\",{\"type\":\"lvar\",\"children\":[\"u\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"print\",{\"type\":\"str\",\"children\":[\"\\\\u\"]}]},{\"type\":\"send\",\"children\":[null,\"hexenc4\",{\"type\":\"lvar\",\"children\":[\"t\"]},{\"type\":\"lvar\",\"children\":[\"u2\"]}]}]}]}]}]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"putc\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"string\"]}]}]}","id":"f4603d0b-1fc9-43a7-8ad3-224d0c783c5e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":58,"raw_source":"def initialize(left = nil, operator = nil, right = nil)\n      @left     = left\n      @operator = operator\n      @right    = right\n\n      @child_relation  = nil\n      @child_condition = nil\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"left\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"operator\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"right\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@left\",{\"type\":\"lvar\",\"children\":[\"left\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@operator\",{\"type\":\"lvar\",\"children\":[\"operator\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@right\",{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"acf81b7e-818f-4965-93de-e772de8c74cd"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":999,"raw_source":"def raise_property_error(property)\n      raise Liquid::ArgumentError, \"cannot select the property '#{Utils.to_s(property)}'\"\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_property_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"cannot select the property '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}","id":"396c18e0-e9e9-4ccb-9017-cf3bc467e750"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":18,"raw_source":"def render_to_output_buffer(context, output)\n      return super unless context.profiler\n      context.profiler.profile(context.template_name) { super }\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"profile\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}]}","id":"c74639e6-e027-40dd-827b-33d78f7e9444"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":70,"raw_source":"def test_standard_tags\n    whitespace = '          '\n    text       = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true %}\n          yes\n          {% endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n                yes\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false %}\n          no\n          {% endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"          \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false %}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"58b4158d-0ec1-4a96-b35f-141787f658b7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":980,"raw_source":"def filter_array(input, property, target_value, default_value = [], &block)\n      ary = InputIterator.new(input, context)\n\n      return default_value if ary.empty?\n\n      block.call(ary) do |item|\n        if target_value.nil?\n          item[property]\n        else\n          item[property] == target_value\n        end\n      rescue TypeError\n        raise_property_error(property)\n      rescue NoMethodError\n        return nil unless item.respond_to?(:[])\n        raise\n      end\n    end","complexity_score":20.6,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_array\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"arg\",\"children\":[\"target_value\"]},{\"type\":\"optarg\",\"children\":[\"default_value\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"default_value\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"ary\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"target_value\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"target_value\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}","id":"68df5eba-3c4e-4190-ab11-b8362201b962"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":39,"raw_source":"def test_strainer_raises_argument_error\n    strainer = @environment.create_strainer(@context)\n    assert_raises(Liquid::ArgumentError) do\n      strainer.invoke(\"public_filter\", 1)\n    end\n  end","complexity_score":5.43,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_raises_argument_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"b978d537-a7ac-4dc6-8fd4-a894ab62f82e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":56,"raw_source":"def test_expression_with_whitespace_in_square_brackets\n    assert_template_result('result', \"{{ a[ 'b' ] }}\", { 'a' => { 'b' => 'result' } })\n    assert_template_result('result', \"{{ a[ [ 'b' ] ] }}\", { 'b' => 'c', 'a' => { 'c' => 'result' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_with_whitespace_in_square_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ a[ 'b' ] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ a[ [ 'b' ] ] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]}]}]}","id":"c852c5b2-e4b0-4cf9-8f42-da7ad47eac6e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":146,"raw_source":"def new_isolated_subcontext\n      check_overflow\n\n      self.class.build(\n        environment: @environment,\n        resource_limits: resource_limits,\n        static_environments: static_environments,\n        registers: Registers.new(registers),\n      ).tap do |subcontext|\n        subcontext.base_scope_depth   = base_scope_depth + 1\n        subcontext.exception_renderer = exception_renderer\n        subcontext.filters  = @filters\n        subcontext.strainer = nil\n        subcontext.errors   = errors\n        subcontext.warnings = warnings\n        subcontext.disabled_tags = @disabled_tags\n      end\n    end","complexity_score":26.35,"ast_json":"{\"type\":\"def\",\"children\":[\"new_isolated_subcontext\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"check_overflow\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[null,\"resource_limits\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"send\",\"children\":[null,\"static_environments\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"registers\"]}]}]}]}]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subcontext\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"base_scope_depth=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_scope_depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[null,\"exception_renderer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"filters=\",{\"type\":\"ivar\",\"children\":[\"@filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"strainer=\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"errors=\",{\"type\":\"send\",\"children\":[null,\"errors\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"warnings=\",{\"type\":\"send\",\"children\":[null,\"warnings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"disabled_tags=\",{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]}]}]}]}]}]}","id":"9c5a76dc-74f8-42bd-a943-f18628136db5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":70,"raw_source":"def safe?\n      get? || head? || options? || trace?\n    end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get?\"]},{\"type\":\"send\",\"children\":[null,\"head?\"]}]},{\"type\":\"send\",\"children\":[null,\"options?\"]}]},{\"type\":\"send\",\"children\":[null,\"trace?\"]}]}]}","id":"ee204ecf-ca6a-4a14-9bad-5cb569e7d886"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":71,"raw_source":"def default_pagination(paginate)\n    html = []\n    html << %(<span class=\"prev\">#{link_to(paginate['previous']['title'], paginate['previous']['url'])}</span>) if paginate['previous']\n\n    paginate['parts'].each do |part|\n      html << if part['is_link']\n        %(<span class=\"page\">#{link_to(part['title'], part['url'])}</span>)\n      elsif part['title'].to_i == paginate['current_page'].to_i\n        %(<span class=\"page current\">#{part['title']}</span>)\n      else\n        %(<span class=\"deco\">#{part['title']}</span>)\n      end\n    end\n\n    html << %(<span class=\"next\">#{link_to(paginate['next']['title'], paginate['next']['url'])}</span>) if paginate['next']\n    html.join(' ')\n  end","complexity_score":47.7,"ast_json":"{\"type\":\"def\",\"children\":[\"default_pagination\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"paginate\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"html\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"prev\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"previous\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"parts\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"part\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"is_link\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"page\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},\"to_i\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_page\"]}]},\"to_i\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"page current\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"deco\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<span class=\\\"next\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paginate\"]},\"[]\",{\"type\":\"str\",\"children\":[\"next\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"url\"]}]}]}]},{\"type\":\"str\",\"children\":[\"</span>\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"html\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}","id":"cc086990-d6c6-43ba-bd41-1fe4dae393d6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":145,"raw_source":"def test_dynamic_find_var_with_drop\n    assert_template_result(\n      'bar',\n      '{{ [list[settings.zero]] }}',\n      {\n        'list' => ['foo'],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'foo' => 'bar',\n      },\n    )\n\n    assert_template_result(\n      'foo',\n      '{{ [list[settings.zero][\"foo\"]] }}',\n      {\n        'list' => [{ 'foo' => 'bar' }],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'bar' => 'foo',\n      },\n    )\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_find_var_with_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ [list[settings.zero]] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ [list[settings.zero][\\\"foo\\\"]] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}]}","id":"9f108b80-800a-4e08-b574-dc1ed8eb23a4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":573,"raw_source":"def test_map_returns_input_with_no_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.map(foo, nil)\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_returns_input_with_no_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"c8fb6b7e-3d87-4911-af6f-675bdadf11cf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":160,"raw_source":"def eat(typ, ts)\n    if ts[0][0] != typ\n      raise Error, \"expected #{typ} (got #{ts[0].inspect})\"\n    end\n    ts[1..-1]\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"eat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"typ\"]},{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"!=\",{\"type\":\"lvar\",\"children\":[\"typ\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"expected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]}]},{\"type\":\"str\",\"children\":[\" (got \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}","id":"f78a75e7-0c0c-449d-8b66-37e802761610"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":97,"raw_source":"def to_handle(str)\n    result = str.dup\n    result.downcase!\n    result.delete!(\"'\\\"()[]\")\n    result.gsub!(/\\W+/, '-')\n    result.gsub!(/-+\\z/, '') if result[-1] == '-'\n    result.gsub!(/\\A-+/, '') if result[0] == '-'\n    result\n  end","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"to_handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"downcase!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"delete!\",{\"type\":\"str\",\"children\":[\"'\\\"()[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\W+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[-1]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"-+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A-+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"1f26882d-bba8-4eca-8779-a1f70dc7664b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":84,"raw_source":"def test_with_line_numbers_adds_numbers_to_parser_errors\n    source = <<~LIQUID\n      foobar\n\n      {% \"cat\" | foobar %}\n\n      bla\n    LIQUID\n    assert_match_syntax_error(/Liquid syntax error \\(line 3\\)/, source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_line_numbers_adds_numbers_to_parser_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% \\\"cat\\\" | foobar %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error \\\\(line 3\\\\)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"8319e56b-a607-4cc1-af6b-469ba26d1418"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":678,"raw_source":"def server_error?\n      status.between? 500, 599\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"server_error?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[500]},{\"type\":\"int\",\"children\":[599]}]}]}","id":"89f068a1-271a-4429-b220-d8a53c7cb031"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":12,"raw_source":"def test_capture_with_hyphen_in_variable_name\n    template_source = <<~END_TEMPLATE\n      {% capture this-thing %}Print this-thing{% endcapture -%}\n      {{ this-thing -}}\n    END_TEMPLATE\n    assert_template_result(\"Print this-thing\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_with_hyphen_in_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% capture this-thing %}Print this-thing{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ this-thing -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Print this-thing\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}","id":"c80bd635-0e4d-4317-b711-d9bf03e51f9c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":238,"raw_source":"def test_empty_string_value_access\n    assert_equal('', Liquid::Template.parse('{{ product[value] }}').render!('product' => ProductDrop.new, 'value' => ''))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_empty_string_value_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product[value] }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}]}","id":"17d8aa44-65c9-450c-8e0b-be50b20fd306"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":8,"raw_source":"def test_unexpected_end_tag\n    source = '{% if true %}{% endunless %}'\n    assert_match_syntax_error(\"Liquid syntax error (line 1): 'endunless' is not a valid delimiter for if tags. use endif\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_end_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% if true %}{% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): 'endunless' is not a valid delimiter for if tags. use endif\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"b58f1cb7-36ba-43a7-a002-9d393527126f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":71,"raw_source":"def setup_example_app(options={})\n    $example_app_counter ||= 0\n    $example_app_counter += 1\n\n    FileUtils.mkdir_p(tmp_dir)\n    write_app_file(options)\n    $LOADED_FEATURES.delete app_file_path\n    require app_file_path\n    self.app = app_const\n    app_const.enable :reloader\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_example_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$example_app_counter\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$example_app_counter\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FileUtils\"]},\"mkdir_p\",{\"type\":\"send\",\"children\":[null,\"tmp_dir\"]}]},{\"type\":\"send\",\"children\":[null,\"write_app_file\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$LOADED_FEATURES\"]},\"delete\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"send\",\"children\":[null,\"app_file_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"app=\",{\"type\":\"send\",\"children\":[null,\"app_const\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_const\"]},\"enable\",{\"type\":\"sym\",\"children\":[\"reloader\"]}]}]}]}","id":"c021f386-5039-4e09-a8d0-2609a297957f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":185,"raw_source":"def except(*keys)\n      keys.map!(&method(:convert_key))\n\n      self.class[super(*keys)]\n    end if Gem::Version.new(RUBY_VERSION) >= Gem::Version.new(\"3.0\")","complexity_score":4.4,"ast_json":"{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"3.0\"]}]}]},{\"type\":\"def\",\"children\":[\"except\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}]},null]}","id":"4dbe7aaf-2d8d-4068-b1db-14f68a0ae362"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":81,"raw_source":"def test_string_to_filter\n    var = create_variable(\"'http://disney.com/logo.gif' | image: 'med' \")\n    assert_equal('http://disney.com/logo.gif', var.name)\n    assert_equal([['image', ['med']]], var.filters)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_to_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"'http://disney.com/logo.gif' | image: 'med' \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"http://disney.com/logo.gif\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"image\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"med\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"dd82cce4-2245-49f3-bd50-750f3427398f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":276,"raw_source":"def to_a\n        to_hash.to_a\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_a\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"to_a\"]}]}","id":"217d8032-cbc5-4bb6-ab45-96afd80bb6fd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":41,"raw_source":"def test_standard_error\n    template = Liquid::Template.parse(' {{ errors.standard_error }} ')\n    assert_equal(' Liquid error: standard error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(StandardError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.standard_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: standard error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"StandardError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}","id":"91736ce7-4335-4a47-8b42-28835ddd79fc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":185,"raw_source":"def test_merge\n    # merge just calls merge!, which is already thoroughly tested\n    hash2 = @hash.merge(?a=>1, :q=>2) { |key, oldval, newval| \"#{oldval}*#{key}*#{newval}\" }\n\n    refute_equal @hash, hash2\n    assert_equal 'a*a*1', hash2[:a]\n    assert_equal 2, hash2[?q]\n  end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"oldval\"]},{\"type\":\"arg\",\"children\":[\"newval\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"oldval\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newval\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a*a*1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"q\"]}]}]}]}]}","id":"a415c9b8-9e80-49f8-8dae-f146d626e610"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/config_file_spec.rb","start_line":4,"raw_source":"def config_file(*args, &block)\n    mock_app do\n      register Sinatra::ConfigFile\n      set :root, File.expand_path('config_file', __dir__)\n      instance_eval(&block) if block\n      config_file(*args)\n    end\n  end","complexity_score":17.8,"ast_json":"{\"type\":\"def\",\"children\":[\"config_file\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"ConfigFile\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"config_file\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"config_file\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}","id":"e7e8eda0-6820-495d-9b6d-1a659e23a5aa"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":56,"raw_source":"def react(env)\n        result = send(options[:reaction], env)\n        result if (Array === result) && (result.size == 3)\n      end","complexity_score":12.43,"ast_json":"{\"type\":\"def\",\"children\":[\"react\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"reaction\"]}]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"size\"]},\"==\",{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]},null]}]}]}","id":"eaef055d-8c7a-4173-8ad1-6b906276099b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":359,"raw_source":"def not_found(body = nil)\n      error 404, body\n    end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"body\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"int\",\"children\":[404]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}","id":"a01f869f-7bd1-4ac3-be76-ac08ded5a143"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":99,"raw_source":"def clear\n        each_key { |k| delete(k) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"clear\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}","id":"5ddb6aa1-ad3d-4634-9755-00c0dcc1e0fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1263,"raw_source":"def test_sum_of_floats\n    input = [0.1, 0.2, 0.3]\n    assert_equal(0.6, @filters.sum(input))\n    assert_template_result(\"0.6\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_of_floats\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"float\",\"children\":[0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.6]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.6\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}","id":"a04aad2c-a675-4fe7-a98b-01f3bb96c104"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":12,"raw_source":"def test_simple_translate_string\n    assert_equal(\"less is more\", @i18n.translate(\"simple\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_translate_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"less is more\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"simple\"]}]}]}]}","id":"b953ec4a-b2fc-4239-98c8-f368b6398249"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":291,"raw_source":"def values_at(*list)\n        list.map { |k| self[k] }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"values_at\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"list\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}","id":"e52eb672-ef6e-409d-a6e9-43caa28aa63d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":22,"raw_source":"def test_dynamic_variable\n    assert_equal(\n      [\"test\", \"inlookup\"],\n      visit(%({{ test[inlookup] }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"inlookup\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test[inlookup] }}\"]}]}]}]}","id":"7783b6b8-d40d-44b8-b3ef-74e44d481880"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":144,"raw_source":"def test_syntax_errors_in_nested_blocks_have_correct_line_number\n    source = <<~LIQUID\n      foobar\n\n      {% if 1 != 2 %}\n        {% foo %}\n      {% endif %}\n\n      bla\n    LIQUID\n\n    assert_match_syntax_error(\"Liquid syntax error (line 4): Unknown tag 'foo'\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_errors_in_nested_blocks_have_correct_line_number\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{% if 1 != 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% foo %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unknown tag 'foo'\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"caa89bd4-bf4f-46e8-bf2b-305b5862e07d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag_test.rb","start_line":8,"raw_source":"def test_custom_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\n    klass1 = Class.new(Tag) do\n      def render(*)\n        'hello'\n      end\n    end\n\n    with_custom_tag('blabla', klass1) do\n      template = Liquid::Template.parse(\"{% blabla %}\")\n\n      assert_equal('hello', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('hello', output)\n      assert_equal('hello', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n\n    klass2 = Class.new(klass1) do\n      def render(*)\n        'foo' + super + 'bar'\n      end\n    end\n\n    with_custom_tag('blabla', klass2) do\n      template = Liquid::Template.parse(\"{% blabla %}\")\n\n      assert_equal('foohellobar', template.render)\n\n      buf    = +''\n      output = template.render({}, output: buf)\n      assert_equal('foohellobar', output)\n      assert_equal('foohellobar', buf)\n      assert_equal(buf.object_id, output.object_id)\n    end\n  end","complexity_score":42.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass1\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Tag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"hello\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"klass2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"klass1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"blabla\"]},{\"type\":\"lvar\",\"children\":[\"klass2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% blabla %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]},{\"type\":\"lvasgn\",\"children\":[\"buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foohellobar\"]},{\"type\":\"lvar\",\"children\":[\"buf\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"buf\"]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"object_id\"]}]}]}]}]}]}","id":"92d9e4e0-49cc-4012-8f02-a3e3a032dd76"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":47,"raw_source":"def test_underscore_in_filter_name\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n    assert_equal(' 1000$ ', Template.parse(\"{{var | money_with_underscore}}\").render(@context))\n  end","complexity_score":5.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_underscore_in_filter_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money_with_underscore}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}","id":"dc090a28-35c8-4d73-9ef1-18289b7a574c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":32,"raw_source":"def evaluate(context)\n      start_int = to_integer(context.evaluate(@start_obj))\n      end_int   = to_integer(context.evaluate(@end_obj))\n      start_int..end_int\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start_int\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@start_obj\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"end_int\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@end_obj\"]}]}]}]},{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_int\"]},{\"type\":\"lvar\",\"children\":[\"end_int\"]}]}]}]}","id":"8acba9dd-2cc0-4e9c-a96d-c9a86b481feb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":151,"raw_source":"def app\n      @app ||= Class.new Sinatra::Base\n      Rack::Lint.new @app\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Lint\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@app\"]}]}]}]}","id":"77294819-5d14-4300-a702-8d984e459f86"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":311,"raw_source":"def parse_response\n        cookies_from_response = Array(@response['Set-Cookie'])\n        return if @response_array == cookies_from_response\n\n        hash = {}\n\n        cookies_from_response.each do |line|\n          key, value = line.split(';', 2).first.to_s.split('=', 2)\n          next if key.nil?\n\n          key = Rack::Utils.unescape(key)\n          if line =~ /expires=Thu, 01[-\\s]Jan[-\\s]1970/\n            @deleted << key\n          else\n            @deleted.delete key\n            hash[key] = value\n          end\n        end\n\n        @response_hash.replace hash\n        @response_array = cookies_from_response\n      end","complexity_score":30.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_response\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cookies_from_response\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Set-Cookie\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response_array\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]},\"to_s\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"nil?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"unescape\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"expires=Thu, 01[-\\\\s]Jan[-\\\\s]1970\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@deleted\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@deleted\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response_hash\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@response_array\",{\"type\":\"lvar\",\"children\":[\"cookies_from_response\"]}]}]}]}","id":"7197ccd2-8b29-488b-972a-105ed40df699"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":177,"raw_source":"def inspect\n        \"<##{self.class}: #{to_hash.inspect[1..-2]}>\"\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<#\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"inspect\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}","id":"ca2ffe03-3fb6-4e16-9a7c-38254acf0d97"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":48,"raw_source":"def test_liquid_tag_errors\n    assert_match_syntax_error(\"syntax error (line 1): Unknown tag 'error'\", <<~LIQUID)\n      {%- liquid error no such tag -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 7): Unknown tag 'error'\", <<~LIQUID)\n      {{ test }}\n\n      {%-\n      liquid\n        for value in array\n\n          error no such tag\n        endfor\n      -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 2): Unknown tag '!!! the guards are vigilant'\", <<~LIQUID)\n      {%- liquid\n        !!! the guards are vigilant\n      -%}\n    LIQUID\n\n    assert_match_syntax_error(\"syntax error (line 4): 'for' tag was never closed\", <<~LIQUID)\n      {%- liquid\n        for value in array\n          echo 'forgot to close the for tag'\n      -%}\n    LIQUID\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_tag_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 1): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{%- liquid error no such tag -%}\\n\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 7): Unknown tag 'error'\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{ test }}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{%-\\n\"]},{\"type\":\"str\",\"children\":[\"liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"    error no such tag\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 2): Unknown tag '!!! the guards are vigilant'\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  !!! the guards are vigilant\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 4): 'for' tag was never closed\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    echo 'forgot to close the for tag'\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]}]}]}]}","id":"0d1b5153-5e9d-4eaa-abd5-6f54769bc3c1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":140,"raw_source":"def test_find_index_on_empty_array\n    assert_nil(@filters.find_index([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"find_index\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}","id":"c77082d6-2fcb-42c2-8be9-7313cfa8c37b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":122,"raw_source":"def map!(&block)\n        @transformer ||= nil\n\n        if @transformer\n          inner = @transformer\n          outer = block\n          block = proc { |value| outer[inner[value]] }\n        end\n        @transformer = block\n        self\n      end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"map!\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@transformer\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@transformer\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner\",{\"type\":\"ivar\",\"children\":[\"@transformer\"]}]},{\"type\":\"lvasgn\",\"children\":[\"outer\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outer\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@transformer\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"b65c616d-66e4-49b3-aa2e-1a7ecff25f9b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":483,"raw_source":"def test_complex_trim\n    text = <<-END_TEMPLATE\n      <div>\n        {%- if true -%}\n          {%- if true -%}\n            <p>\n              {{- 'John' -}}\n            </p>\n          {%- endif -%}\n        {%- endif -%}\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div><p>John</p></div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"            <p>\\n\"]},{\"type\":\"str\",\"children\":[\"              {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"            </p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"      <div><p>John</p></div>\\n\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"cc234adc-faf5-4acc-9527-6e971ca26ce0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":253,"raw_source":"def test_custom_include_tag_within_if_statement\n    original_tag = Liquid::Template.tags['include']\n    Liquid::Template.tags['include'] = CustomInclude\n    begin\n      assert_equal(\n        \"custom_foo_if_true\",\n        Template.parse(\"{% if true %}{% include 'custom_foo_if_true' %}{% endif %}\").render!,\n      )\n    ensure\n      Liquid::Template.tags['include'] = original_tag\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_include_tag_within_if_statement\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"include\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"const\",\"children\":[null,\"CustomInclude\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"custom_foo_if_true\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %}{% include 'custom_foo_if_true' %}{% endif %}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"lvar\",\"children\":[\"original_tag\"]}]}]}]}]}]}","id":"e1bf5d39-1be4-41ec-94fe-4b17addcebc7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":125,"raw_source":"def test_doc_tag_ignores_malformed_syntax\n    template = <<~LIQUID.chomp\n      {% doc %}\n      {% {{ {%- enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_malformed_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% {{ {%- enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"e80d00a4-554e-4a38-8008-44dc31a00aa7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":78,"raw_source":"def test_false_renders_as_false\n    assert_template_result(\"false\", \"{{ foo }}\", { 'foo' => false })\n    assert_template_result(\"false\", \"{{ false }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_false_renders_as_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false }}\"]}]}]}]}","id":"9f643432-a5e1-41f5-8e38-d7a766deed8b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":15,"raw_source":"def test_varible_with_filter\n    assert_equal(\n      [\"test\", \"infilter\"],\n      visit(%({{ test | split: infilter }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_varible_with_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"infilter\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test | split: infilter }}\"]}]}]}]}","id":"a1ab84aa-85ab-4854-bea9-8506d30e36af"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":720,"raw_source":"def test_times\n    assert_template_result(\"12\", \"{{ 3 | times:4 }}\")\n    assert_template_result(\"0\", \"{{ 'foo' | times:4 }}\")\n    assert_template_result(\"6\", \"{{ '2.1' | times:3 | replace: '.','-' | plus:0}}\")\n    assert_template_result(\"7.25\", \"{{ 0.0725 | times:100 }}\")\n    assert_template_result(\"-7.25\", '{{ \"-0.0725\" | times:100 }}')\n    assert_template_result(\"7.25\", '{{ \"-0.0725\" | times: -100 }}')\n    assert_template_result(\"4\", \"{{ price | times:2 }}\", { 'price' => NumberLikeThing.new(2) })\n  end","complexity_score":8.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_times\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"{{ 3 | times:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ 'foo' | times:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ '2.1' | times:3 | replace: '.','-' | plus:0}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"7.25\"]},{\"type\":\"str\",\"children\":[\"{{ 0.0725 | times:100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-7.25\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"-0.0725\\\" | times:100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"7.25\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"-0.0725\\\" | times: -100 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ price | times:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}]}","id":"5cd2de79-b994-43c7-bebd-f337489c1331"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":124,"raw_source":"def to_s(full = false)\n        full ? entry : to_str\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"full\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"full\"]},{\"type\":\"send\",\"children\":[null,\"entry\"]},{\"type\":\"send\",\"children\":[null,\"to_str\"]}]}]}","id":"809f5d55-3bec-4d00-9c19-7a67ec04a369"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":32,"raw_source":"def unknown_tag(tag_name, _markup, _tokenizer)\n      Block.raise_unknown_tag(tag_name, block_name, block_delimiter, parse_context)\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"_markup\"]},{\"type\":\"arg\",\"children\":[\"_tokenizer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Block\"]},\"raise_unknown_tag\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"send\",\"children\":[null,\"block_name\"]},{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}","id":"6d77f6b4-4439-49de-8e29-67a28d1fc0cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":140,"raw_source":"def test_initialization_reused_static_same_memory_object\n    static_register_1 = Registers.new(a: 1, b: 2)\n    static_register_1[:b] = 22\n    static_register_1[:c] = 33\n\n    static_register_2 = Registers.new(static_register_1)\n\n    assert_equal(1, static_register_2[:a])\n    assert_equal(2, static_register_2[:b])\n    assert_nil(static_register_2[:c])\n\n    static_register_1.static[:b] = 222\n    static_register_1.static[:c] = 333\n\n    assert_same(static_register_1.static, static_register_2.static)\n  end","complexity_score":22.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_initialization_reused_static_same_memory_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register_1\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"static_register_2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"static_register_1\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[222]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[333]}]},{\"type\":\"send\",\"children\":[null,\"assert_same\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"static\"]}]}]}]}","id":"92e4e689-73c7-4a73-a19f-8969335f9f21"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/middleware/logger.rb","start_line":8,"raw_source":"def initialize(app, level = ::Logger::INFO)\n        @app, @level = app, level\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"level\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"INFO\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"ivasgn\",\"children\":[\"@level\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"lvar\",\"children\":[\"level\"]}]}]}]}","id":"dd249731-c2ba-4c99-a267-259b5689484d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":77,"raw_source":"def raise_nested_doc_error\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.doc_invalid_nested\")\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_nested_doc_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.doc_invalid_nested\"]}]}]}]}","id":"6e8a6fd9-ca33-429b-b510-5c43650d8953"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":53,"raw_source":"def render_to_output_buffer(context, output)\n      template_name = context.evaluate(@template_name_expr)\n      raise ArgumentError, options[:locale].t(\"errors.argument.include\") unless template_name.is_a?(String)\n\n      partial = PartialCache.load(\n        template_name,\n        context: context,\n        parse_context: parse_context,\n      )\n\n      context_variable_name = @alias_name || template_name.split('/').last\n\n      variable = if @variable_name_expr\n        context.evaluate(@variable_name_expr)\n      else\n        context.find_variable(template_name, raise_on_not_found: false)\n      end\n\n      old_template_name = context.template_name\n      old_partial       = context.partial\n\n      begin\n        context.template_name = partial.name\n        context.partial = true\n\n        context.stack do\n          @attributes.each do |key, value|\n            context[key] = context.evaluate(value)\n          end\n\n          if variable.is_a?(Array)\n            variable.each do |var|\n              context[context_variable_name] = var\n              partial.render_to_output_buffer(context, output)\n            end\n          else\n            context[context_variable_name] = variable\n            partial.render_to_output_buffer(context, output)\n          end\n        end\n      ensure\n        context.template_name = old_template_name\n        context.partial       = old_partial\n      end\n\n      output\n    end","complexity_score":50.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@template_name_expr\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.argument.include\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PartialCache\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_variable_name\",{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@alias_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"split\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"last\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"find_variable\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"raise_on_not_found\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"old_template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"old_partial\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"variable\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"lvar\",\"children\":[\"old_template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"partial=\",{\"type\":\"lvar\",\"children\":[\"old_partial\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"af6773fb-38df-47b5-92de-37ffd5798488"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1215,"raw_source":"def test_sum_with_nested_arrays\n    input = [1, [2, [3, 4]]]\n\n    assert_equal(10, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_nested_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}","id":"d9a65267-77ba-4825-98b2-acc889284c1c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":597,"raw_source":"def replace_first(input, string, replacement = '')\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n      input = Utils.to_s(input)\n      input.sub(string, replacement)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace_first\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"optarg\",\"children\":[\"replacement\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"sub\",{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]}]}","id":"adc948ab-a5e9-4969-a2f6-db63bc37fe87"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":181,"raw_source":"def last_request?\n      last_request\n      true\n    rescue Rack::Test::Error\n      false\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"last_request?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}","id":"2b9c2004-ae20-4bf6-bcd9-906d80cbf9a7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1024,"raw_source":"def settings\n      self.class.settings\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"settings\"]}]}","id":"038d2cd9-244c-4936-bb90-6e6d17ca07f6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":29,"raw_source":"def nodelist\n      @blocks.map(&:attachment)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]}]}","id":"ccaaf8bb-f562-4345-a54d-5b4834c483f0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":285,"raw_source":"def respond_to(*args)\n        return @conditions[:provides] || base.respond_to if args.empty?\n\n        @conditions[:provides] = args\n      end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"provides\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"provides\"]},{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}","id":"8bbdb3b2-d07d-4725-ba15-cb9a8d859b18"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":72,"raw_source":"def test_cache_is_not_broken_when_a_different_parse_context_is_used\n    file_system = StubFileSystem.new('my_partial' => 'some partial body')\n    context     = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new(my_key: 'value one'),\n    )\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new(my_key: 'value two'),\n    )\n\n    # Technically what we care about is that the file was parsed twice,\n    # but measuring file reads is an OK proxy for this.\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_is_not_broken_when_a_different_parse_context_is_used\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"some partial body\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_key\"]},{\"type\":\"str\",\"children\":[\"value one\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_key\"]},{\"type\":\"str\",\"children\":[\"value two\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}","id":"650fde40-9565-423b-b173-38f5a59aefd8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":149,"raw_source":"def ignore(path)\n          watcher_for(path).ignore\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"ignore\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watcher_for\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"ignore\"]}]}","id":"3917d50e-fe12-454f-9596-9c04de1c0473"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":140,"raw_source":"def html?(headers)\n        return false unless (header = headers.detect { |k, _v| k.downcase == 'content-type' })\n\n        options[:html_types].include? header.last[%r{^\\w+/\\w+}]\n      end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"html?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"header\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"downcase\"]},\"==\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"html_types\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"header\"]},\"last\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\\\\w+/\\\\w+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}","id":"34c0cf52-4728-496e-b14c-fe06e093db64"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":42,"raw_source":"def parse(tokens)\n      body = case_body = new_body\n      body = @blocks.last.attachment while parse_body(body, tokens)\n      @blocks.reverse_each do |condition|\n        body = condition.attachment\n        unless body.frozen?\n          body.remove_blank_strings if blank?\n          body.freeze\n        end\n      end\n      case_body.freeze\n    end","complexity_score":22.1,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"lvasgn\",\"children\":[\"case_body\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"last\"]},\"attachment\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"attachment\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"frozen?\"]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"remove_blank_strings\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"freeze\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"case_body\"]},\"freeze\"]}]}]}","id":"175eb9bb-4292-4527-9475-e2692535d6e4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":27,"raw_source":"def initialize(start_obj, end_obj)\n      @start_obj = start_obj\n      @end_obj   = end_obj\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_obj\"]},{\"type\":\"arg\",\"children\":[\"end_obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@start_obj\",{\"type\":\"lvar\",\"children\":[\"start_obj\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@end_obj\",{\"type\":\"lvar\",\"children\":[\"end_obj\"]}]}]}]}","id":"259bd173-7f0e-401d-a7fa-07c3e08577a1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1066,"raw_source":"def route!(base = settings, pass_block = nil)\n      routes = base.routes[@request.request_method]\n\n      routes&.each do |pattern, conditions, block|\n        response.delete_header('content-type') unless @pinned_response\n\n        returned_pass_block = process_route(pattern, conditions) do |*args|\n          env['sinatra.route'] = \"#{@request.request_method} #{pattern}\"\n          route_eval { block[*args] }\n        end\n\n        # don't wipe out pass_block in superclass\n        pass_block = returned_pass_block if returned_pass_block\n      end\n\n      # Run routes defined in superclass.\n      if base.superclass.respond_to?(:routes)\n        return route!(base.superclass, pass_block)\n      end\n\n      route_eval(&pass_block) if pass_block\n      route_missing\n    end","complexity_score":38.0,"ast_json":"{\"type\":\"def\",\"children\":[\"route!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"optarg\",\"children\":[\"pass_block\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"routes\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"routes\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"request_method\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"routes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"conditions\"]},{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pinned_response\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"delete_header\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"returned_pass_block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.route\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"request_method\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"returned_pass_block\"]},{\"type\":\"lvasgn\",\"children\":[\"pass_block\",{\"type\":\"lvar\",\"children\":[\"returned_pass_block\"]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"routes\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},{\"type\":\"lvar\",\"children\":[\"pass_block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pass_block\"]},{\"type\":\"send\",\"children\":[null,\"route_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pass_block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"route_missing\"]}]}]}","id":"f32ef9eb-5fe3-4125-b7f2-7472fbb0b396"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":160,"raw_source":"def transform_keys(&block)\n      dup.transform_keys!(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_keys\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"transform_keys!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"52cf735c-6d96-4735-b85e-1dee1b1a84eb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":18,"raw_source":"def test_variable_lookup_calls_to_liquid_value\n    assert_template_result('1', '{{ foo }}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('2', '{{ list[foo] }}', { 'foo' => IntegerDrop.new('1'), 'list' => [1, 2, 3] })\n    assert_template_result('one', '{{ list[foo] }}', { 'foo' => IntegerDrop.new('1'), 'list' => { 1 => 'one' } })\n    assert_template_result('Yay', '{{ foo }}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('YAY', '{{ foo | upcase }}', { 'foo' => BooleanDrop.new(true) })\n  end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{{ list[foo] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{{ list[foo] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"one\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ foo }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"YAY\"]},{\"type\":\"str\",\"children\":[\"{{ foo | upcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}","id":"a030c78b-5fc3-4bfe-8edf-30060c778a48"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":60,"raw_source":"def test_for_with_drop_value_range\n    foobar = ThingWithValue.new\n    assert_template_result(' 1  2  3 ', '{%for item in (1..foobar.value) %} {{item}} {%endfor%}', { \"foobar\" => foobar })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_drop_value_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foobar\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithValue\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..foobar.value) %} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"foobar\"]}]}]}]}]}]}","id":"71251c3d-5443-4153-8817-7266a7c6aa8b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":111,"raw_source":"def test_nested_if\n    assert_template_result('', '{% if false %}{% if false %} NO {% endif %}{% endif %}')\n    assert_template_result('', '{% if false %}{% if true %} NO {% endif %}{% endif %}')\n    assert_template_result('', '{% if true %}{% if false %} NO {% endif %}{% endif %}')\n    assert_template_result(' YES ', '{% if true %}{% if true %} YES {% endif %}{% endif %}')\n\n    assert_template_result(' YES ', '{% if true %}{% if true %} YES {% else %} NO {% endif %}{% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if true %}{% if false %} NO {% else %} YES {% endif %}{% else %} NO {% endif %}')\n    assert_template_result(' YES ', '{% if false %}{% if true %} NO {% else %} NONO {% endif %}{% else %} YES {% endif %}')\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if false %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if true %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if false %} NO {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if true %} YES {% endif %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if true %} YES {% else %} NO {% endif %}{% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true %}{% if false %} NO {% else %} YES {% endif %}{% else %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if false %}{% if true %} NO {% else %} NONO {% endif %}{% else %} YES {% endif %}\"]}]}]}]}","id":"e235e2c4-0815-4b31-95c8-50eeb634e611"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1746,"raw_source":"def user_agent(pattern)\n        condition do\n          if request.user_agent.to_s =~ pattern\n            @params[:agent] = $~[1..-1]\n            true\n          else\n            false\n          end\n        end\n      end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"user_agent\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"user_agent\"]},\"to_s\"]},\"=~\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"agent\"]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$~\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"d71db4ef-ee84-478c-adb7-95c44b81c00a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":224,"raw_source":"def test_digits\n    assert_template_result(\"pass\", \"{% if 100 == expect %}pass{% endif %}\", { \"expect\" => 100 })\n    assert_template_result(\"pass\", \"{% if 100.00 == expect %}pass{% endif %}\", { \"expect\" => 100.00 })\n  end","complexity_score":2.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_digits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if 100 == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if 100.00 == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}]}","id":"c060fd38-3f70-4bf5-9c87-a0a014bcc328"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":682,"raw_source":"def concat(input, array)\n      unless array.respond_to?(:to_ary)\n        raise ArgumentError, \"concat filter requires an array argument\"\n      end\n      InputIterator.new(input, context).concat(array)\n    end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"concat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_ary\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"concat filter requires an array argument\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}","id":"3c10f801-1150-4d6e-a791-127f7f2b727a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":123,"raw_source":"def test_profiling_multiple_renders\n    with_custom_tag('sleep', SleepTag) do\n      context = Liquid::Context.new\n      t = Liquid::Template.parse(\"{% sleep 0.001 %}\", profile: true)\n      context.template_name = 'index'\n      t.render!(context)\n      context.template_name = 'layout'\n      first_render_time = context.profiler.total_time\n      t.render!(context)\n\n      profiler = context.profiler\n      children = profiler.children\n      assert_operator(first_render_time, :>=, 0.001)\n      assert_operator(profiler.total_time, :>=, 0.001 + first_render_time)\n      assert_equal([\"index\", \"layout\"], children.map(&:template_name))\n      assert_equal([nil, nil], children.map(&:code))\n      assert_equal(profiler.total_time, children.map(&:total_time).reduce(&:+))\n    end\n  end","complexity_score":43.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_multiple_renders\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"sleep\"]},{\"type\":\"const\",\"children\":[null,\"SleepTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% sleep 0.001 %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"str\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name=\",{\"type\":\"str\",\"children\":[\"layout\"]}]},{\"type\":\"lvasgn\",\"children\":[\"first_render_time\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"total_time\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"lvasgn\",\"children\":[\"profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]}]},{\"type\":\"lvasgn\",\"children\":[\"children\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"children\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"lvar\",\"children\":[\"first_render_time\"]},{\"type\":\"sym\",\"children\":[\">=\"]},{\"type\":\"float\",\"children\":[0.001]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"total_time\"]},{\"type\":\"sym\",\"children\":[\">=\"]},{\"type\":\"send\",\"children\":[{\"type\":\"float\",\"children\":[0.001]},\"+\",{\"type\":\"lvar\",\"children\":[\"first_render_time\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"index\"]},{\"type\":\"str\",\"children\":[\"layout\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"total_time\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"total_time\"]}]}]},\"reduce\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"+\"]}]}]}]}]}]}]}","id":"8b867f67-460b-4ce2-ab61-b441fce2218f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":244,"raw_source":"def select(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.select(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"select\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"select\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"368420c2-bcdd-4eca-afb7-c000e1ab5cf9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":39,"raw_source":"def invoke_drop(method_or_key)\n      if self.class.invokable?(method_or_key)\n        send(method_or_key)\n      else\n        liquid_method_missing(method_or_key)\n      end\n    end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_drop\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_or_key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"invokable?\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]},{\"type\":\"send\",\"children\":[null,\"liquid_method_missing\",{\"type\":\"lvar\",\"children\":[\"method_or_key\"]}]}]}]}","id":"0d82742c-a636-4633-9c1d-abdb986acd8e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":33,"raw_source":"def parse(tokens)\n      while parse_body(@blocks.last.attachment, tokens)\n      end\n      @blocks.reverse_each do |block|\n        block.attachment.remove_blank_strings if blank?\n        block.attachment.freeze\n      end\n    end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"last\"]},\"attachment\"]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"blank?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"remove_blank_strings\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"freeze\"]}]}]}]}]}","id":"6a5c06a4-4465-44b0-b243-91c45871d97b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":13,"raw_source":"def test_true_not_eql_true\n    text = ' {% if true != true %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_not_eql_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if true != true %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"e55ae894-fcc2-4b29-96b7-ef94d7549cc9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":37,"raw_source":"def test_classic_app_with_zeitwerk\n    app_file = File.join(__dir__, \"integration\", \"zeitwerk_app.rb\")\n    command = command_for(app_file)\n    with_process(command: command) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra \\(v.+\\) has taken the stage/)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_classic_app_with_zeitwerk\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"zeitwerk_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra \\\\(v.+\\\\) has taken the stage\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}","id":"4a7fd324-3d72-4598-b712-41f320991657"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":362,"raw_source":"def test_sort_natural_case_check\n    input = [\n      { \"key\" => \"X\" },\n      { \"key\" => \"Y\" },\n      { \"key\" => \"Z\" },\n      { \"fake\" => \"t\" },\n      { \"key\" => \"a\" },\n      { \"key\" => \"b\" },\n      { \"key\" => \"c\" },\n    ]\n    expectation = [\n      { \"key\" => \"a\" },\n      { \"key\" => \"b\" },\n      { \"key\" => \"c\" },\n      { \"key\" => \"X\" },\n      { \"key\" => \"Y\" },\n      { \"key\" => \"Z\" },\n      { \"fake\" => \"t\" },\n    ]\n    assert_equal(expectation, @filters.sort_natural(input, \"key\"))\n    assert_equal([\"a\", \"b\", \"c\", \"X\", \"Y\", \"Z\"], @filters.sort_natural([\"X\", \"Y\", \"Z\", \"a\", \"b\", \"c\"]))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_case_check\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"X\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Y\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"str\",\"children\":[\"t\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"X\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Y\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"str\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"X\"]},{\"type\":\"str\",\"children\":[\"Y\"]},{\"type\":\"str\",\"children\":[\"Z\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"X\"]},{\"type\":\"str\",\"children\":[\"Y\"]},{\"type\":\"str\",\"children\":[\"Z\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}","id":"f36037df-5a7c-480b-976d-1504571de338"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":101,"raw_source":"def warnings\n      log.scan(%r[(?:\\(eval|lib/sinatra).*warning:.*$])\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"log\"]},\"scan\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(?:\\\\(eval|lib/sinatra).*warning:.*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}","id":"00c0a2c8-d213-41e4-8634-f2e17f7c13fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":549,"raw_source":"def test_new_isolated_subcontext_does_not_inherit_non_static_registers\n    registers = {\n      my_register: :my_value,\n    }\n    super_context = Context.new({}, {}, Registers.new(registers))\n    super_context.registers[:my_register] = :my_alt_value\n    subcontext                            = super_context.new_isolated_subcontext\n    assert_equal(:my_value, subcontext.registers[:my_register])\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_does_not_inherit_non_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_alt_value\"]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}","id":"fdc2662f-e30c-4b0f-8a67-d2cac1e6508c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":72,"raw_source":"def test_add_filter_does_not_include_already_included_module\n    mod = Module.new do\n      class << self\n        attr_accessor :include_count\n        def included(_mod)\n          self.include_count += 1\n        end\n      end\n      self.include_count = 0\n    end\n    strainer = Context.new.strainer\n    strainer.class.add_filter(mod)\n    strainer.class.add_filter(mod)\n    assert_equal(1, mod.include_count)\n  end","complexity_score":20.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_does_not_include_already_included_module\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"mod\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"sclass\",\"children\":[{\"type\":\"self\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"attr_accessor\",{\"type\":\"sym\",\"children\":[\"include_count\"]}]},{\"type\":\"def\",\"children\":[\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_mod\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"include_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"include_count=\",{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]},\"strainer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mod\"]},\"include_count\"]}]}]}]}","id":"5831f145-c14a-42e9-ba9e-99ba8e2790c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":170,"raw_source":"def test_warnings\n    template = Liquid::Template.parse('{% if ~~~ %}{{%%%}}{% else %}{{ hello. }}{% endif %}', error_mode: :warn)\n    assert_equal(3, template.warnings.size)\n    assert_equal('Unexpected character ~ in \"~~~\"', template.warnings[0].to_s(false))\n    assert_equal('Unexpected character % in \"{{%%%}}\"', template.warnings[1].to_s(false))\n    assert_equal('Expected id but found end_of_string in \"{{ hello. }}\"', template.warnings[2].to_s(false))\n    assert_equal('', template.render)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if ~~~ %}{{%%%}}{% else %}{{ hello. }}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unexpected character ~ in \\\"~~~\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Expected id but found end_of_string in \\\"{{ hello. }}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"to_s\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}","id":"5d85ae97-4cdd-4409-9c22-69160d11964e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":48,"raw_source":"def call(env)\n        app.call(env)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}","id":"477847fc-b6f3-4f53-b4b1-198a668d29ef"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":102,"raw_source":"def test_float\n    var = create_variable(%( 1000.01 ))\n    assert_equal(1000.01, var.name)\n  end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 1000.01 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[1000.01]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"564477ad-0540-4ab8-adf8-9e4789c32c97"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":505,"raw_source":"def test_static_environments_are_read_with_lower_priority_than_environments\n    context = Context.build(\n      static_environments: { 'shadowed' => 'static', 'unshadowed' => 'static' },\n      environments: { 'shadowed' => 'dynamic' },\n    )\n\n    assert_equal('dynamic', context['shadowed'])\n    assert_equal('static', context['unshadowed'])\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_static_environments_are_read_with_lower_priority_than_environments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"shadowed\"]},{\"type\":\"str\",\"children\":[\"static\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"unshadowed\"]},{\"type\":\"str\",\"children\":[\"static\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"shadowed\"]},{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"shadowed\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"static\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"unshadowed\"]}]}]}]}]}","id":"a434d335-7e49-473e-8f12-008600eed40e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":89,"raw_source":"def test_assoc\n    assert_nil @hash.assoc(:d)\n    assert_equal [?a, :a], @hash.assoc(:a)\n    assert_equal [?b, :b], @hash.assoc(:b)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assoc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"assoc\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}","id":"95329d3e-9afd-48b2-b9f8-29272ad01fc4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1461,"raw_source":"def mime_type(type, value = nil)\n        return type      if type.nil?\n        return type.to_s if type.to_s.include?('/')\n\n        type = \".#{type}\" unless type.to_s[0] == '.'\n        return Rack::Mime.mime_type(type, nil) unless value\n\n        Rack::Mime::MIME_TYPES[type] = value\n      end","complexity_score":16.1,"ast_json":"{\"type\":\"def\",\"children\":[\"mime_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]},\"include?\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"to_s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\".\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"MIME_TYPES\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"19a3f607-2fb7-432e-96ad-9b6dbbfb06cc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":83,"raw_source":"def test_downcase\n    assert_equal('testing', @filters.downcase(\"Testing\"))\n    assert_equal('', @filters.downcase(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_downcase\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"testing\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"downcase\",{\"type\":\"str\",\"children\":[\"Testing\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"downcase\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"60fdadd5-74f1-483f-8d0d-cae873287630"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":858,"raw_source":"def test_date_raises_nothing\n    assert_template_result('', \"{{ '' | date: '%D' }}\")\n    assert_template_result('abc', \"{{ 'abc' | date: '%D' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_date_raises_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ '' | date: '%D' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ 'abc' | date: '%D' }}\"]}]}]}]}","id":"ff11bdd2-f645-459b-8857-03ca36377764"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":16,"raw_source":"def currency\n    ShopDrop.new.currency\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"currency\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ShopDrop\"]},\"new\"]},\"currency\"]}]}","id":"c9f532f5-36c9-4573-bd6a-bcd028dc85ae"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":14,"raw_source":"def handle(_type, req, res)\n    @request  = req\n    @response = res\n\n    @request.path_info =~ /(\\w+)\\z/\n    @action  = Regexp.last_match(1) || 'index'\n    @assigns = send(@action) if respond_to?(@action)\n\n    @response['Content-Type'] = \"text/html\"\n    @response.status = 200\n    @response.body   = Liquid::Template.parse(read_template).render(@assigns, filters: [ProductsFilter])\n  end","complexity_score":19.68,"ast_json":"{\"type\":\"def\",\"children\":[\"handle\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_type\"]},{\"type\":\"arg\",\"children\":[\"req\"]},{\"type\":\"arg\",\"children\":[\"res\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"lvar\",\"children\":[\"req\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"lvar\",\"children\":[\"res\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"path_info\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(\\\\w+)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@action\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"str\",\"children\":[\"index\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@assigns\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Content-Type\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"status=\",{\"type\":\"int\",\"children\":[200]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"body=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[null,\"read_template\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductsFilter\"]}]}]}]}]}]}]}]}","id":"814170e5-00d3-4b88-8598-9c32818c1795"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":152,"raw_source":"def assert_expression_result(expect, markup, **assigns)\n    liquid = \"{% if expect == #{markup} %}pass{% else %}got {{ #{markup} }}{% endif %}\"\n    assert_template_result(\"pass\", liquid, { \"expect\" => expect, **assigns })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_expression_result\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expect\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"kwrestarg\",\"children\":[\"assigns\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"liquid\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if expect == \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %}pass{% else %}got {{ \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" }}{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"lvar\",\"children\":[\"liquid\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"lvar\",\"children\":[\"expect\"]}]},{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}","id":"196185eb-935f-489c-932f-8f66ada245bb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":66,"raw_source":"def test_var_strings_are_not_equal\n    text = ' {% if \"hello there!\" == var %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_strings_are_not_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if \\\"hello there!\\\" == var %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}","id":"ac814e36-ebb6-4a94-a556-738f179f7147"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":50,"raw_source":"def test_comment_tag_with_block\n    template = Liquid::Template.parse(\"  {% comment %} {% endcomment %} \")\n    assert_equal([String, Comment, String], block_types(template.root.nodelist))\n    assert_equal(3, template.root.nodelist.size)\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_tag_with_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {% comment %} {% endcomment %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Comment\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]}]}]}","id":"61f34329-cd07-40c3-8dc2-8f568403f1e2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1575,"raw_source":"def development?; environment == :development end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"development?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"==\",{\"type\":\"sym\",\"children\":[\"development\"]}]}]}","id":"58334abf-6316-4327-912e-5d4abbd93e85"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":150,"raw_source":"def test_if_with_custom_condition\n    original_op = Condition.operators['contains']\n    Condition.operators['contains'] = :[]\n\n    assert_template_result('yes', %({% if 'bob' contains 'o' %}yes{% endif %}))\n    assert_template_result('no', %({% if 'bob' contains 'f' %}yes{% else %}no{% endif %}))\n  ensure\n    Condition.operators['contains'] = original_op\n  end","complexity_score":9.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_with_custom_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_op\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]\",{\"type\":\"str\",\"children\":[\"contains\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"str\",\"children\":[\"{% if 'bob' contains 'o' %}yes{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"no\"]},{\"type\":\"str\",\"children\":[\"{% if 'bob' contains 'f' %}yes{% else %}no{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"lvar\",\"children\":[\"original_op\"]}]}]}]}","id":"e8e3c817-c30d-4017-aa9d-c759912b5721"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":64,"raw_source":"def command\n      @command ||= begin\n        cmd = [\"APP_ENV=#{environment}\", \"exec\"]\n        if RbConfig.respond_to? :ruby\n          cmd << RbConfig.ruby.inspect\n        else\n          file, dir = RbConfig::CONFIG.values_at('ruby_install_name', 'bindir')\n          cmd << File.expand_path(file, dir).inspect\n        end\n        cmd << \"-w\" unless net_http_server?\n        cmd << \"-I\" << File.expand_path('../lib', __dir__).inspect\n        cmd << app_file.inspect << '-s' << server << '-o' << '127.0.0.1' << '-p' << port\n        cmd << \"-e\" << environment.to_s << '2>&1'\n        cmd.join \" \"\n      end\n    end","complexity_score":58.3,"ast_json":"{\"type\":\"def\",\"children\":[\"command\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@command\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cmd\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"APP_ENV=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]}]}]},{\"type\":\"str\",\"children\":[\"exec\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"ruby\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"ruby\"]},\"inspect\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file\"]},{\"type\":\"lvasgn\",\"children\":[\"dir\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RbConfig\"]},\"CONFIG\"]},\"values_at\",{\"type\":\"str\",\"children\":[\"ruby_install_name\"]},{\"type\":\"str\",\"children\":[\"bindir\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"lvar\",\"children\":[\"dir\"]}]},\"inspect\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"net_http_server?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-w\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-I\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"../lib\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},\"inspect\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_file\"]},\"inspect\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-s\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"server\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-o\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"-p\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"<<\",{\"type\":\"str\",\"children\":[\"-e\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"2>&1\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cmd\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}]}]}","id":"b8fc63a3-3c42-436e-8827-dc33a2ea36b9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":12,"raw_source":"def test_tokenize_variables\n    assert_equal(['{{funk}}'], tokenize('{{funk}}'))\n    assert_equal([' ', '{{funk}}', ' '], tokenize(' {{funk}} '))\n    assert_equal([' ', '{{funk}}', ' ', '{{so}}', ' ', '{{brother}}', ' '], tokenize(' {{funk}} {{so}} {{brother}} '))\n    assert_equal([' ', '{{  funk  }}', ' '], tokenize(' {{  funk  }} '))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{funk}}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{funk}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{funk}}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{so}}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{brother}}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{funk}} {{so}} {{brother}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{{  funk  }}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {{  funk  }} \"]}]}]}]}]}","id":"6768e457-77cd-47db-9810-1f8d63219027"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":82,"raw_source":"def test_strainer_only_allows_methods_defined_in_filters\n    strainer = @environment.create_strainer(@context)\n    assert_equal(\"1 + 1\", strainer.invoke(\"instance_eval\", \"1 + 1\"))\n    assert_equal(\"puts\",  strainer.invoke(\"__send__\", \"puts\", \"Hi Mom\"))\n    assert_equal(\"has_method?\", strainer.invoke(\"invoke\", \"has_method?\", \"invoke\"))\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_only_allows_methods_defined_in_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 + 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"instance_eval\"]},{\"type\":\"str\",\"children\":[\"1 + 1\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"puts\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"__send__\"]},{\"type\":\"str\",\"children\":[\"puts\"]},{\"type\":\"str\",\"children\":[\"Hi Mom\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"has_method?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"invoke\"]},{\"type\":\"str\",\"children\":[\"has_method?\"]},{\"type\":\"str\",\"children\":[\"invoke\"]}]}]}]}]}","id":"35bd58a6-3179-427c-a42f-f14bbab40a43"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":51,"raw_source":"def self.parse_expression(parse_context, markup)\n      @@method_literals[markup] || parse_context.parse_expression(markup)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@method_literals\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}","id":"37445135-607c-4ae5-aca9-0a796ddef443"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":155,"raw_source":"def watcher_for(path)\n          @path_watcher_map[File.expand_path(path)]\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"watcher_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@path_watcher_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}","id":"c954fa13-8bf6-47db-8baf-cb643b7087f7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":311,"raw_source":"def use(middleware, *args, &block)\n        path = caller_files[1] || File.expand_path($0)\n        watch_element(path, :middleware, [middleware, args, block])\n        super\n      end","complexity_score":6.83,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"middleware\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"f43a1ead-8f59-4f97-bb2b-8d3b046dff7d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":114,"raw_source":"def equal_variables(left, right)\n      if left.is_a?(MethodLiteral)\n        if right.respond_to?(left.method_name)\n          return right.send(left.method_name)\n        else\n          return nil\n        end\n      end\n\n      if right.is_a?(MethodLiteral)\n        if left.respond_to?(right.method_name)\n          return left.send(right.method_name)\n        else\n          return nil\n        end\n      end\n\n      left == right\n    end","complexity_score":22.0,"ast_json":"{\"type\":\"def\",\"children\":[\"equal_variables\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"MethodLiteral\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"respond_to?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"method_name\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"MethodLiteral\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"respond_to?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"send\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"method_name\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"right\"]}]}]}]}","id":"263d39d3-68fe-413b-9fbe-ef6f1c92b0fd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":35,"raw_source":"def setup\n    Liquid::Environment.default.file_system = ProfilingFileSystem.new\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"file_system=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProfilingFileSystem\"]},\"new\"]}]}]}","id":"6924b163-6fed-4ef8-8330-87372fdd74e8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":179,"raw_source":"def test_warning_line_numbers\n    template = Liquid::Template.parse(\"{% if ~~~ %}\\n{{%%%}}{% else %}\\n{{ hello. }}{% endif %}\", error_mode: :warn, line_numbers: true)\n    assert_equal('Liquid syntax error (line 1): Unexpected character ~ in \"~~~\"', template.warnings[0].message)\n    assert_equal('Liquid syntax error (line 2): Unexpected character % in \"{{%%%}}\"', template.warnings[1].message)\n    assert_equal('Liquid syntax error (line 3): Expected id but found end_of_string in \"{{ hello. }}\"', template.warnings[2].message)\n    assert_equal(3, template.warnings.size)\n    assert_equal([1, 2, 3], template.warnings.map(&:line_number))\n  end","complexity_score":28.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_warning_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if ~~~ %}\\n{{%%%}}{% else %}\\n{{ hello. }}{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"warn\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unexpected character ~ in \\\"~~~\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 2): Unexpected character % in \\\"{{%%%}}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 3): Expected id but found end_of_string in \\\"{{ hello. }}\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"warnings\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]}]}]}]}]}]}","id":"6fa03fc4-8f5a-4820-adae-5c3c5f18ad6d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":334,"raw_source":"def test_size_of_hash\n    assigns = { \"hash\" => { a: 1, b: 2, c: 3, d: 4 } }\n    assert_template_result('hash has 4 elements', \"hash has {{ hash.size }} elements\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size_of_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hash has 4 elements\"]},{\"type\":\"str\",\"children\":[\"hash has {{ hash.size }} elements\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"a9a4d811-2866-44c6-805e-5a34976cb7c4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":102,"raw_source":"def drop_session(env)\n        return unless session? env\n\n        session(env).clear\n\n        return if [\"1\", \"true\"].include?(ENV[\"RACK_PROTECTION_SILENCE_DROP_SESSION_WARNING\"])\n\n        warn env, \"session dropped by #{self.class}\"\n      end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_session\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"clear\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"true\"]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"RACK_PROTECTION_SILENCE_DROP_SESSION_WARNING\"]}]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"session dropped by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]}]}]}","id":"3bcb099d-7d14-453f-92d9-b7f31ee160bd"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":53,"raw_source":"def inner_parse(markup, ss, cache)\n        if (markup.start_with?(\"(\") && markup.end_with?(\")\")) && markup =~ RANGES_REGEX\n          return RangeLookup.parse(\n            Regexp.last_match(1),\n            Regexp.last_match(2),\n            ss,\n            cache,\n          )\n        end\n\n        if (num = parse_number(markup, ss))\n          num\n        else\n          VariableLookup.parse(markup, ss, cache)\n        end\n      end","complexity_score":15.15,"ast_json":"{\"type\":\"def\",\"children\":[\"inner_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"ss\"]},{\"type\":\"arg\",\"children\":[\"cache\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"(\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\")\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"RANGES_REGEX\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeLookup\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"num\",{\"type\":\"send\",\"children\":[null,\"parse_number\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"num\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]}]}","id":"b9e0f0f7-5c21-49a8-b9bb-a548b7bf3d6b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":46,"raw_source":"def test_mark_as_blank_only_during_parsing\n    assert_template_result(\" \" * (N + 1), wrap(\" {% if false %} this never happens, but still, this block is not blank {% endif %}\"))\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_mark_as_blank_only_during_parsing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% if false %} this never happens, but still, this block is not blank {% endif %}\"]}]}]}]}","id":"f7750ab2-d8c9-4499-b25c-602916311c83"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":288,"raw_source":"def status(value = nil)\n      response.status = Rack::Utils.status_code(value) if value\n      response.status\n    end","complexity_score":7.5,"ast_json":"{\"type\":\"def\",\"children\":[\"status\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"status_code\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"status\"]}]}]}","id":"7c4e81ba-7c7c-4eee-bfd8-931b90fa996d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":110,"raw_source":"def record_else_condition(markup)\n      unless markup.strip.empty?\n        raise SyntaxError, options[:locale].t(\"errors.syntax.case_invalid_else\")\n      end\n\n      block = ElseCondition.new\n      block.attach(new_body)\n      @blocks << block\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"record_else_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case_invalid_else\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ElseCondition\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"e33454ec-8e42-4b75-917a-54056b2f704a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":56,"raw_source":"def unknown_tag(tag, markup, tokens)\n      return super unless tag == 'else'\n      @else_block = new_body\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@else_block\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}","id":"539c735b-0bd1-4db2-a43a-95e845f6839a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1790,"raw_source":"def generate_method(method_name, &block)\n        define_method(method_name, &block)\n        method = instance_method method_name\n        remove_method method_name\n        method\n      end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"generate_method\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"method\",{\"type\":\"send\",\"children\":[null,\"instance_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}","id":"464a403d-4d65-4c03-9d18-2e0da948f02a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/for_tag_unit_test.rb","start_line":11,"raw_source":"def test_for_else_nodelist\n    template = Liquid::Template.parse('{% for item in items %}FOR{% else %}ELSE{% endfor %}')\n    assert_equal(['FOR', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_else_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in items %}FOR{% else %}ELSE{% endfor %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"FOR\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}","id":"0bcdb9f7-1b3b-48f2-b0c2-65a67a998d8c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":76,"raw_source":"def get_stream(url = '/stream', &block)\n      Net::HTTP.start '127.0.0.1', port do |http|\n        request = Net::HTTP::Get.new url\n        http.request request do |response|\n          response.read_body(&block)\n        end\n      end\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"get_stream\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"url\",{\"type\":\"str\",\"children\":[\"/stream\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"start\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"read_body\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}","id":"4087e74e-676c-42f9-adc6-822c41bc4c28"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1411,"raw_source":"def not_found(&block)\n        error(404, &block)\n      end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"int\",\"children\":[404]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"5f20c7e2-9fc5-4037-9910-45ea765a1537"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":35,"raw_source":"def new_tokenizer\n    Tokenizer.new(\n      source: \"\",\n      string_scanner: StringScanner.new(\"\"),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_tokenizer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}]}","id":"890fff79-9bb9-4c98-83d0-f1e2ad65c842"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":111,"raw_source":"def <=>(other)\n        other.priority <=> priority\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<=>\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"priority\"]},\"<=>\",{\"type\":\"send\",\"children\":[null,\"priority\"]}]}]}","id":"0cb4374e-261d-4c64-a386-91cda0a52939"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":105,"raw_source":"def test_doc_tag_ignores_nested_raw_tags\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% raw %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_nested_raw_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"ac27a02f-9e12-429d-bdac-72b3da7cad95"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":535,"raw_source":"def map(input, property)\n      InputIterator.new(input, context).map do |e|\n        e = e.call if e.is_a?(Proc)\n\n        if property == \"to_liquid\"\n          e\n        elsif e.respond_to?(:[])\n          r = e[property]\n          r.is_a?(Proc) ? r.call : r\n        end\n      end\n    rescue TypeError\n      raise_property_error(property)\n    end","complexity_score":26.0,"ast_json":"{\"type\":\"def\",\"children\":[\"map\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"call\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"==\",{\"type\":\"str\",\"children\":[\"to_liquid\"]}]},{\"type\":\"lvar\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"r\"]},\"call\"]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},null]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]}","id":"2c206b0c-7aea-4698-b4b6-16a0afcae845"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":113,"raw_source":"def accepts?(env)\n        session = session(env)\n        set_token(session)\n\n        safe?(env) ||\n          valid_token?(env, env['HTTP_X_CSRF_TOKEN']) ||\n          valid_token?(env, Request.new(env).params[options[:authenticity_param]]) ||\n          options[:allow_if]&.call(env)\n      rescue StandardError\n        false\n      end","complexity_score":29.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[null,\"valid_token?\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_CSRF_TOKEN\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"valid_token?\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"params\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"authenticity_param\"]}]}]}]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}","id":"fb363516-e0a7-483b-9553-43668c0ca165"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/middleware/logger.rb","start_line":12,"raw_source":"def call(env)\n        logger = ::Logger.new(env[Rack::RACK_ERRORS])\n        logger.level = @level\n\n        env[Rack::RACK_LOGGER] = logger\n        @app.call(env)\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"logger\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"RACK_ERRORS\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"logger\"]},\"level=\",{\"type\":\"ivar\",\"children\":[\"@level\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"RACK_LOGGER\"]},{\"type\":\"lvar\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"63a67567-0a32-4fce-a886-499b2321b1db"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":663,"raw_source":"def success?\n      status.between? 200, 299\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"success?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[200]},{\"type\":\"int\",\"children\":[299]}]}]}","id":"7e94d638-cbed-40ec-962f-72c857fb43c5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":352,"raw_source":"def inherited(subclass)\n        result = super\n        subclass.register Sinatra::Reloader\n        result\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"inherited\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"subclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Reloader\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"2a815833-8461-40f3-9ff2-0f1e6be7a960"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":417,"raw_source":"def attachment(filename = nil, disposition = :attachment)\n      response['Content-Disposition'] = disposition.to_s.dup\n      return unless filename\n\n      params = format('; filename=\"%s\"', File.basename(filename).gsub(/[\"\\r\\n]/, MULTIPART_FORM_DATA_REPLACEMENT_TABLE))\n      response['Content-Disposition'] << params\n      ext = File.extname(filename)\n      content_type(ext) unless response['content-type'] || ext.empty?\n    end","complexity_score":24.0,"ast_json":"{\"type\":\"def\",\"children\":[\"attachment\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"disposition\",{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Content-Disposition\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},\"to_s\"]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"; filename=\\\"%s\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\"\\\\r\\\\n]\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"const\",\"children\":[null,\"MULTIPART_FORM_DATA_REPLACEMENT_TABLE\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Content-Disposition\"]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"lvasgn\",\"children\":[\"ext\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"empty?\"]}]},null,{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}","id":"0fc44d51-bca1-4a8a-8293-8e33e80121e3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":193,"raw_source":"def convert_key(key)\n      key.is_a?(Symbol) ? key.to_s : key\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"convert_key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Symbol\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}","id":"03a3b2bb-d0f4-4a89-856a-ffa2b50fc2cb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":34,"raw_source":"def self.registered(_)\n      Sinatra::Request.include WebDAV::Request\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Request\"]},\"include\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"WebDAV\"]},\"Request\"]}]}]}","id":"82ca2303-24ba-4a74-ba6c-1734a84a6d7c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":110,"raw_source":"def increment!\n      @index += 1\n\n      if @col == @cols\n        @col = 1\n        @row += 1\n      else\n        @col += 1\n      end\n    end","complexity_score":11.08,"ast_json":"{\"type\":\"def\",\"children\":[\"increment!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@col\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@cols\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@col\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@row\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@col\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"83fadbdb-3ea7-449c-8600-c17f791d6527"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":85,"raw_source":"def get_response(url)\n      Net::HTTP.start '127.0.0.1', port do |http|\n        request = Net::HTTP::Get.new url\n        http.request request do |response|\n          response\n        end\n      end\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"get_response\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"start\",{\"type\":\"str\",\"children\":[\"127.0.0.1\"]},{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"http\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"response\"]}]},{\"type\":\"lvar\",\"children\":[\"response\"]}]}]}]}]}","id":"619d1166-b37b-495d-a1ca-0b757cf53a5d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":140,"raw_source":"def each_value(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each_value(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_value\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each_value\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"c6d60ec4-b33c-4934-9fed-638235b2572a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":164,"raw_source":"def base64_decode(input)\n      input = Utils.to_s(input)\n      StandardFilters.try_coerce_encoding(Base64.strict_decode64(input), encoding: input.encoding)\n    rescue ::ArgumentError\n      raise Liquid::ArgumentError, \"invalid base64 provided to base64_decode\"\n    end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"try_coerce_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"strict_decode64\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"encoding\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid base64 provided to base64_decode\"]}]}]},null]}]}","id":"773a47b4-675d-49a2-8748-70130abccd93"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":6,"raw_source":"def test_simple_cycle\n    template = <<~LIQUID\n      {%- cycle '1', '2', '3' -%}\n      {%- cycle '1', '2', '3' -%}\n      {%- cycle '1', '2', '3' -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle '1', '2', '3' -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"1e139eb0-b4bd-4d0a-8296-3313785c8cd0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":38,"raw_source":"def test_zero_lq_or_equal_one_involving_nil\n    text = ' {% if null <= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n\n    text = ' {% if 0 <= null %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_or_equal_one_involving_nil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if null <= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 <= null %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"9876c013-928a-4042-b5a1-839c924ca6d1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection.rb","start_line":27,"raw_source":"def self.new(app, options = {})\n      except = Array options[:except]\n      use_these = Array options[:use]\n\n      if options.fetch(:without_session, false)\n        except += %i[remote_token]\n      end\n\n      Rack::Builder.new do\n        # Off by default, unless added\n        use ::Rack::Protection::AuthenticityToken,     options if use_these.include? :authenticity_token\n        use ::Rack::Protection::ContentSecurityPolicy, options if use_these.include? :content_security_policy\n        use ::Rack::Protection::CookieTossing,         options if use_these.include? :cookie_tossing\n        use ::Rack::Protection::EscapedParams,         options if use_these.include? :escaped_params\n        use ::Rack::Protection::FormToken,             options if use_these.include? :form_token\n        use ::Rack::Protection::ReferrerPolicy,        options if use_these.include? :referrer_policy\n        use ::Rack::Protection::RemoteReferrer,        options if use_these.include? :remote_referrer\n        use ::Rack::Protection::SessionHijacking,      options if use_these.include? :session_hijacking\n        use ::Rack::Protection::StrictTransport,       options if use_these.include? :strict_transport\n\n        # On by default, unless skipped\n        use ::Rack::Protection::FrameOptions,          options unless except.include? :frame_options\n        use ::Rack::Protection::HttpOrigin,            options unless except.include? :http_origin\n        use ::Rack::Protection::IPSpoofing,            options unless except.include? :ip_spoofing\n        use ::Rack::Protection::JsonCsrf,              options unless except.include? :json_csrf\n        use ::Rack::Protection::PathTraversal,         options unless except.include? :path_traversal\n        use ::Rack::Protection::RemoteToken,           options unless except.include? :remote_token\n        use ::Rack::Protection::XSSHeader,             options unless except.include? :xss_header\n        run app\n      end.to_app\n    end","complexity_score":85.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"except\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"except\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"use_these\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"use\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"without_session\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"except\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"remote_token\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"authenticity_token\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"AuthenticityToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"content_security_policy\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"ContentSecurityPolicy\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"cookie_tossing\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"CookieTossing\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"escaped_params\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"EscapedParams\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"form_token\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"FormToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"referrer_policy\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"ReferrerPolicy\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"remote_referrer\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"RemoteReferrer\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"session_hijacking\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"SessionHijacking\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"use_these\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"strict_transport\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"StrictTransport\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"frame_options\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"FrameOptions\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"http_origin\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"HttpOrigin\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"ip_spoofing\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"IPSpoofing\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"json_csrf\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"JsonCsrf\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"path_traversal\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"PathTraversal\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"remote_token\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"RemoteToken\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"except\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"xss_header\"]}]},null,{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"Protection\"]},\"XSSHeader\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}]},\"to_app\"]}]}]}","id":"e836b6da-e774-4464-8426-c7f25277a78e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":186,"raw_source":"def key?(key)\n      self[key] != nil\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!=\",{\"type\":\"nil\",\"children\":[]}]}]}","id":"4db28879-729b-45ce-a72a-825bbf8c8d1c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":33,"raw_source":"def initialize(*)\n        super\n        @permitted_hosts = []\n        @domain_hosts = []\n        @ip_hosts = []\n        @all_permitted_hosts = Array(options[:permitted_hosts])\n\n        @all_permitted_hosts.each do |host|\n          case host\n          when String\n            if host.start_with?(DOT)\n              domain = host[1..-1]\n              @permitted_hosts << domain.downcase\n              @domain_hosts << /\\A#{SUBDOMAINS}#{Regexp.escape(domain)}\\z/i\n            else\n              @permitted_hosts << host.downcase\n            end\n          when IPAddr then @ip_hosts << host\n          end\n        end\n      end","complexity_score":29.4,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@permitted_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@domain_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@ip_hosts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@all_permitted_hosts\",{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"permitted_hosts\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"DOT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"domain\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"domain\"]},\"downcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"<<\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SUBDOMAINS\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"escape\",{\"type\":\"lvar\",\"children\":[\"domain\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\\z\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"host\"]},\"downcase\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IPAddr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},null]}]}]}]}","id":"577ed8b2-d703-4fdd-8441-226ae5cf8292"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":213,"raw_source":"def test_doc_tag_blank_with_content\n    template_source = \"{% doc %}Some documentation{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal(false, doc_tag.blank?)\n  end","complexity_score":13.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_blank_with_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}Some documentation{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"blank?\"]}]}]}]}","id":"afd2f3ed-9318-4b1f-b21e-ddf57ad30853"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":148,"raw_source":"def test_output_raw_source_of_variable\n    var = create_variable(%( name_of_variable | upcase ))\n    assert_equal(\" name_of_variable | upcase \", var.raw)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_output_raw_source_of_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" name_of_variable | upcase \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" name_of_variable | upcase \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"raw\"]}]}]}]}","id":"192836e0-d792-48c9-a547-96276cbedbfe"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":154,"raw_source":"def children\n        [@node.name] + @node.filters.flatten\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"name\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"filters\"]},\"flatten\"]}]}]}","id":"61c54a86-0ef7-47d7-9d11-84604abc7540"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":678,"raw_source":"def test_rstrip\n    assert_template_result(\" ab c\", \"{{ source | rstrip }}\", { 'source' => \" ab c  \" })\n    assert_template_result(\" \\tab c\", \"{{ source | rstrip }}\", { 'source' => \" \\tab c  \\n \\t\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rstrip\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" ab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | rstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" ab c  \"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" \\tab c\"]},{\"type\":\"str\",\"children\":[\"{{ source | rstrip }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"source\"]},{\"type\":\"str\",\"children\":[\" \\tab c  \\n \\t\"]}]}]}]}]}]}","id":"b8844def-6774-4c42-8dc0-ef42cbeeb4dd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":203,"raw_source":"def test_enumerable_drop\n    assert_equal('123', Liquid::Template.parse('{% for c in collection %}{{c}}{% endfor %}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for c in collection %}{{c}}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}","id":"3b1e1cf1-f5a7-41d2-bfed-3f0fc61f7b61"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":421,"raw_source":"def objenc(x)\n    '{' + x.map{|k,v| keyenc(k) + ':' + valenc(v)}.join(',') + '}'\n  end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"objenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"keyenc\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"+\",{\"type\":\"str\",\"children\":[\":\"]}]},\"+\",{\"type\":\"send\",\"children\":[null,\"valenc\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},\"+\",{\"type\":\"str\",\"children\":[\"}\"]}]}]}","id":"6553fc52-6d74-4722-a469-3df6cf23bc61"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":11,"raw_source":"def app\n    @app ||= nil\n    @app || mock_app(DummyApp)\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},{\"type\":\"send\",\"children\":[null,\"mock_app\",{\"type\":\"const\",\"children\":[null,\"DummyApp\"]}]}]}]}]}","id":"c472ed79-4267-4557-8f08-c293bbf674c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":218,"raw_source":"def test_base64_url_safe_decode\n    decoded = @filters.base64_url_safe_decode('YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVogMTIzNDU2Nzg5MCAhQCMkJV4mKigpLT1fKy8_Ljo7W117fVx8')\n    assert_equal(\n      'abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890 !@#$%^&*()-=_+/?.:;[]{}\\|',\n      decoded,\n    )\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_url_safe_decode('4pyF')\n    assert_equal('✅', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_url_safe_decode(\"_w==\")\n    assert_equal(Encoding::ASCII_8BIT, decoded.encoding)\n    assert_equal((+\"\\xFF\").force_encoding(Encoding::ASCII_8BIT), decoded)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.base64_url_safe_decode(\"invalidbase64\")\n    end\n    assert_equal('Liquid error: invalid base64 provided to base64_url_safe_decode', exception.message)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_url_safe_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_url_safe_decode\",{\"type\":\"str\",\"children\":[\"invalidbase64\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid base64 provided to base64_url_safe_decode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"adccc61a-7889-4d52-8782-75976537bb16"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/session_hijacking.rb","start_line":21,"raw_source":"def accepts?(env)\n        session = session env\n        key     = options[:tracking_key]\n        if session.include? key\n          session[key].all? { |k, v| v == encode(env[k]) }\n        else\n          session[key] = {}\n          options[:track].each { |k| session[key][k] = encode(env[k]) }\n        end\n      end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"tracking_key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"encode\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"track\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"encode\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]}]}]}]}]}]}]}","id":"802e5405-c08b-4d91-951e-587b22f31f5d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1318,"raw_source":"def test_uniq_with_to_liquid_value_pick_correct_classes\n    input = [\"foo\", StringDrop.new(\"foo\"), StringDrop.new(\"bar\")]\n    expected = [String, StringDrop]\n    result = @filters.uniq(input).map(&:class)\n\n    assert_equal(expected, result)\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_with_to_liquid_value_pick_correct_classes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"StringDrop\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"2a06bd02-c019-4edf-8e53-d1b57ee97d6b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":344,"raw_source":"def test_cents_through_drop\n    @context.merge(\"cents\" => CentsDrop.new)\n    assert_equal(100, @context['cents.amount'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents_through_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.amount\"]}]}]}]}]}","id":"e0ba2b39-6c92-4276-bd8e-9995e97f73b5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":244,"raw_source":"def xor_byte_strings(s1, s2)\n        s2 = s2.dup\n        size = s1.bytesize\n        i = 0\n        while i < size\n          s2.setbyte(i, s1.getbyte(i) ^ s2.getbyte(i))\n          i += 1\n        end\n        s2\n      end","complexity_score":15.65,"ast_json":"{\"type\":\"def\",\"children\":[\"xor_byte_strings\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s1\"]},{\"type\":\"arg\",\"children\":[\"s2\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"s2\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"size\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s1\"]},\"bytesize\"]}]},{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"size\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"setbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s1\"]},\"getbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"^\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s2\"]},\"getbyte\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvar\",\"children\":[\"s2\"]}]}]}","id":"d859a15c-ad62-4168-8bc9-7f04a83b46c3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":39,"raw_source":"def filter_method_names\n        filter_methods.map(&:to_s).to_a\n      end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_method_names\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]},\"to_a\"]}]}","id":"5939111e-2efc-4397-baf6-3b69c15234d2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":41,"raw_source":"def test_for_with_range\n    assert_template_result(' 1  2  3 ', '{%for item in (1..3) %} {{item}} {%endfor%}')\n\n    assert_raises(Liquid::ArgumentError) do\n      Template.parse('{% for i in (a..2) %}{% endfor %}').render!(\"a\" => [1, 2])\n    end\n\n    assert_template_result(' 0  1  2  3 ', '{% for item in (a..3) %} {{item}} {% endfor %}', { \"a\" => \"invalid integer\" })\n  end","complexity_score":7.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..3) %} {{item}} {%endfor%}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in (a..2) %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0  1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{% for item in (a..3) %} {{item}} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]}]}]}]}","id":"4da13218-23d5-49ee-8548-fa75181d176d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/expression.rb","start_line":31,"raw_source":"def parse(markup, ss = StringScanner.new(\"\"), cache = nil)\n        return unless markup\n\n        markup = markup.strip # markup can be a frozen string\n\n        if (markup.start_with?('\"') && markup.end_with?('\"')) ||\n          (markup.start_with?(\"'\") && markup.end_with?(\"'\"))\n          return markup[1..-2]\n        elsif LITERALS.key?(markup)\n          return LITERALS[markup]\n        end\n\n        # Cache only exists during parsing\n        if cache\n          return cache[markup] if cache.key?(markup)\n\n          cache[markup] = inner_parse(markup, ss, cache).freeze\n        else\n          inner_parse(markup, ss, nil).freeze\n        end\n      end","complexity_score":30.4,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"ss\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"'\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LITERALS\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LITERALS\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"inner_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]},\"freeze\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"inner_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]},{\"type\":\"nil\",\"children\":[]}]},\"freeze\"]}]}]}]}","id":"2f5a9816-22a0-4977-9529-90ed2d7bb8a9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":24,"raw_source":"def test_delete\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_nil(static_register.delete(:a))\n\n    assert_equal(22, static_register.delete(:b))\n\n    assert_equal(33, static_register.delete(:c))\n    assert_nil(static_register[:c])\n\n    assert_nil(static_register.delete(:d))\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delete\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}","id":"129865d9-79ea-4407-b984-0e26fb80a0a9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":399,"raw_source":"def start_registering_extension\n        @register_path = caller_files[2]\n      end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"start_registering_extension\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@register_path\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]}","id":"8736c4b7-0325-4d5d-b2fb-a6b2f159d0db"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":40,"raw_source":"def link_to_type(type)\n    if type\n      link_to(type, url_for_type(type), type)\n    else\n      'Unknown Vendor'\n    end\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_type\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"send\",\"children\":[null,\"url_for_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\"Unknown Vendor\"]}]}]}","id":"3d36b1bc-d1fb-4167-9866-f6f44e9c61c4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":20,"raw_source":"def respond_with(*args, &block)\n    respond_app { get('/') { respond_with(*args, &block) } }\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_with\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"respond_with\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"b514abcf-f132-44dd-a530-643dd2b270ac"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":61,"raw_source":"def update_file(path, &block)\n    original_mtime = File.exist?(path) ? File.mtime(path) : Time.at(0)\n    new_time = original_mtime + 1\n    File.open(path, 'w', &block)\n    File.utime(new_time, new_time, path)\n  end","complexity_score":10.7,"ast_json":"{\"type\":\"def\",\"children\":[\"update_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_mtime\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_time\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"original_mtime\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"open\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"str\",\"children\":[\"w\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"utime\",{\"type\":\"lvar\",\"children\":[\"new_time\"]},{\"type\":\"lvar\",\"children\":[\"new_time\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}","id":"a8409991-638f-441c-8126-76b09dd9d15a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":7,"raw_source":"def initialize(value)\n      super()\n      @value = value\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"3e83c313-6328-47b2-bc04-269c81e9eba9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/content_security_policy.rb","start_line":53,"raw_source":"def csp_policy\n        directives = []\n\n        DIRECTIVES.each do |d|\n          if options.key?(d)\n            directives << \"#{d.to_s.sub(/_/, '-')} #{options[d]}\"\n          end\n        end\n\n        # Set these key values to boolean 'true' to include in policy\n        NO_ARG_DIRECTIVES.each do |d|\n          if options.key?(d) && options[d].is_a?(TrueClass)\n            directives << d.to_s.tr('_', '-')\n          end\n        end\n\n        directives.compact.sort.join('; ')\n      end","complexity_score":32.5,"ast_json":"{\"type\":\"def\",\"children\":[\"csp_policy\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"directives\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DIRECTIVES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"d\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"d\"]},\"to_s\"]},\"sub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"d\"]}]}]}]}]},null]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NO_ARG_DIRECTIVES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"d\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"d\"]}]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"TrueClass\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"d\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"directives\"]},\"compact\"]},\"sort\"]},\"join\",{\"type\":\"str\",\"children\":[\"; \"]}]}]}]}","id":"a5819e82-4a57-49fd-9c9b-534bc103f982"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":132,"raw_source":"def content_for(key, value = nil, options = {}, &block)\n      block ||= proc { |*| value }\n      clear_content_for(key) if options[:flush]\n      content_blocks[key.to_sym] << capture_later(&block)\n    end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"content_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"flush\"]}]},{\"type\":\"send\",\"children\":[null,\"clear_content_for\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"capture_later\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"883f60c2-da58-40ae-8b00-024e1224e30a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":31,"raw_source":"def test_single_quoted_words\n    assert_equal(['arg1', 'arg2', \"'arg 3'\"], 'arg1 arg2 \\'arg 3\\''.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_quoted_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"'arg 3'\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 'arg 3'\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"f7cd1f79-4f48-4313-99bf-39e047ed1840"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":43,"raw_source":"def render_to_output_buffer(context, output)\n      context.registers[:cycle] ||= {}\n\n      key       = context.evaluate(@name)\n      iteration = context.registers[:cycle][key].to_i\n\n      val = context.evaluate(@variables[iteration])\n\n      if val.is_a?(Array)\n        val = val.join\n      elsif !val.is_a?(String)\n        val = val.to_s\n      end\n\n      output << val\n\n      iteration += 1\n      iteration = 0 if iteration >= @variables.size\n\n      context.registers[:cycle][key] = iteration\n      output\n    end","complexity_score":33.3,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"iteration\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"to_i\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"iteration\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"join\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},\"!\"]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"to_s\"]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"iteration\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"iteration\"]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"size\"]}]},{\"type\":\"lvasgn\",\"children\":[\"iteration\",{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cycle\"]}]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"iteration\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"6ddc3673-5600-464a-a85f-197958bd8582"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":66,"raw_source":"def copy?\n        request_method == 'COPY'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"copy?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"COPY\"]}]}]}","id":"a07273ac-aeb5-49cf-a614-e44d9cf1bc6c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":683,"raw_source":"def test_newly_built_context_inherits_parent_environment\n    global_environment = Liquid::Environment.build(tags: {})\n    context = Context.build(environment: global_environment)\n    assert_equal(global_environment, context.environment)\n    assert(context.environment.tags.each.to_a.empty?)\n  end","complexity_score":15.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_newly_built_context_inherits_parent_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tags\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"global_environment\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"global_environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environment\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environment\"]},\"tags\"]},\"each\"]},\"to_a\"]},\"empty?\"]}]}]}]}","id":"cc694a39-dc88-4c37-8839-2d2966d95ea2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":83,"raw_source":"def method_missing(method, *args, &block)\n      return super unless Sinatra::Base.respond_to? method\n\n      record(method, *args, &block)\n      DontCall.new(method)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DontCall\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}","id":"31cab6d9-edad-4ba3-9e08-b36fad876cd7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/shared_examples.rb","start_line":16,"raw_source":"def call(env)\n        was = env.dup\n        res = app.call(env)\n        was.each do |k, v|\n          next if env[k] == v\n\n          raise \"env[#{k.inspect}] changed from #{v.inspect} to #{env[k].inspect}\"\n        end\n        res\n      end","complexity_score":18.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"was\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"env[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\"] changed from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" to \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"inspect\"]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}","id":"e36a2a05-83ba-4f6d-bd50-0fde728147c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":20,"raw_source":"def test_table_row\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n</tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => [] },\n    )\n  end","complexity_score":3.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n</tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}","id":"c7a11e2b-e994-4069-b287-635a1ab3a5ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":394,"raw_source":"def test_spacing_with_variable_naming_in_for_loop\n    expected = '12345'\n    template = '{% for       item   in   items %}{{item}}{% endfor %}'\n    assigns  = { 'items' => [1, 2, 3, 4, 5] }\n    assert_template_result(expected, template, assigns)\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_spacing_with_variable_naming_in_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for       item   in   items %}{{item}}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"16f1fcd5-11c0-43f2-a005-2d63f6324c05"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":181,"raw_source":"def test_values_at\n    assert_equal [:a, :b, 3, nil], @hash.values_at(:a, ?b, 3, :d)\n  end","complexity_score":2.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_values_at\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"values_at\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}","id":"b4e39d7a-c242-45f0-ac3b-9d898f6ebdcd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":8,"raw_source":"def test_liquid_tag\n    assert_template_result('1 2 3', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        echo array | join: \" \"\n      -%}\n    LIQUID\n\n    assert_template_result('1 2 3', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        for value in array\n          echo value\n          unless forloop.last\n            echo \" \"\n          endunless\n        endfor\n      -%}\n    LIQUID\n\n    assert_template_result('4 8 12 6', <<~LIQUID, { 'array' => [1, 2, 3] })\n      {%- liquid\n        for value in array\n          assign double_value = value | times: 2\n          echo double_value | times: 2\n          unless forloop.last\n            echo \" \"\n          endunless\n        endfor\n\n        echo \" \"\n        echo double_value\n      -%}\n    LIQUID\n\n    assert_template_result('abc', <<~LIQUID)\n      {%- liquid echo \"a\" -%}\n      b\n      {%- liquid echo \"c\" -%}\n    LIQUID\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  echo array | join: \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    echo value\\n\"]},{\"type\":\"str\",\"children\":[\"    unless forloop.last\\n\"]},{\"type\":\"str\",\"children\":[\"      echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"    endunless\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4 8 12 6\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  for value in array\\n\"]},{\"type\":\"str\",\"children\":[\"    assign double_value = value | times: 2\\n\"]},{\"type\":\"str\",\"children\":[\"    echo double_value | times: 2\\n\"]},{\"type\":\"str\",\"children\":[\"    unless forloop.last\\n\"]},{\"type\":\"str\",\"children\":[\"      echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"    endunless\\n\"]},{\"type\":\"str\",\"children\":[\"  endfor\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  echo \\\" \\\"\\n\"]},{\"type\":\"str\",\"children\":[\"  echo double_value\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- liquid echo \\\"a\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"b\\n\"]},{\"type\":\"str\",\"children\":[\"{%- liquid echo \\\"c\\\" -%}\\n\"]}]}]}]}]}","id":"f2872bf9-abb2-4c2c-b8de-719ef3194401"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":24,"raw_source":"def req(*types)\n    path = types.shift if types.first.is_a?(String) && types.first.start_with?('/')\n    accept = types.map { |t| Sinatra::Base.mime_type(t).to_s }.join ','\n    get (path || '/'), {}, 'HTTP_ACCEPT' => accept\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"req\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"shift\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"accept\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"to_s\"]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"str\",\"children\":[\"/\"]}]}]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]},{\"type\":\"lvar\",\"children\":[\"accept\"]}]}]}]}]}]}","id":"6b64347c-3895-4d7b-9490-e113956ab7a9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":236,"raw_source":"def test_exception_renderer_exposing_non_liquid_error\n    template   = Liquid::Template.parse('This is a runtime error: {{ errors.runtime_error }}', line_numbers: true)\n    exceptions = []\n    handler    = ->(e) {\n      exceptions << e\n      e.cause\n    }\n\n    output = template.render({ 'errors' => ErrorDrop.new }, exception_renderer: handler)\n\n    assert_equal('This is a runtime error: runtime error', output)\n    assert_equal([Liquid::InternalError], exceptions.map(&:class))\n    assert_equal(exceptions, template.errors)\n    assert_equal('#<RuntimeError: runtime error>', exceptions.first.cause.inspect)\n  end","complexity_score":22.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_exception_renderer_exposing_non_liquid_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.runtime_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"cause\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"handler\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: runtime error\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"InternalError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exceptions\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"#<RuntimeError: runtime error>\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"first\"]},\"cause\"]},\"inspect\"]}]}]}]}","id":"42b653a7-eb36-462f-baf9-eb05e1bce153"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":905,"raw_source":"def test_has\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => false },\n    ]\n\n    expected_output = \"true\"\n\n    assert_template_result(expected_output, \"{{ array | has: 'ok' }}\", { \"array\" => array })\n    assert_template_result(expected_output, \"{{ array | has: 'ok', true }}\", { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"f569abe4-57e3-41ca-9b19-86c849d9c56e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":60,"raw_source":"def rassoc(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rassoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"40037e57-2168-4776-9875-27172f0a337d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":100,"raw_source":"def handle_error(e, line_number = nil)\n      e = internal_error unless e.is_a?(Liquid::Error)\n      e.template_name ||= template_name\n      e.line_number   ||= line_number\n      errors.push(e)\n      exception_renderer.call(e).to_s\n    end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"handle_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]},{\"type\":\"optarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"send\",\"children\":[null,\"internal_error\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"template_name\"]},{\"type\":\"send\",\"children\":[null,\"template_name\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"errors\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"exception_renderer\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},\"to_s\"]}]}]}","id":"e04e230a-1201-44bd-b487-354cea5e35cf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":16,"raw_source":"def test_pairs_constructor\n    hash = Sinatra::IndifferentHash[[[:a, 1], [?b, 2]]]\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pairs_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]}","id":"799df709-f0d8-4e3d-98df-9ee642820e61"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":84,"raw_source":"def proppatch(path, opts = {}, &bk) route 'PROPPATCH', path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"proppatch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PROPPATCH\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"26b39d5b-d701-4964-8763-707ce1edb6ab"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":80,"raw_source":"def test_unexpected_characters_silently_eat_logic_lax\n    with_error_mode(:lax) do\n      markup = \"true && false\"\n      assert_template_result(' YES ', \"{% if #{markup} %} YES {% endif %}\")\n      markup = \"false || true\"\n      assert_template_result('', \"{% if #{markup} %} YES {% endif %}\")\n    end\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_characters_silently_eat_logic_lax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"true && false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"false || true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}","id":"8b727ea2-0bc1-41fb-a7b6-afd5a50f2fdb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":62,"raw_source":"def test_strainer_only_invokes_public_filter_methods\n    strainer = @environment.create_strainer(@context)\n    assert_equal(false, strainer.class.invokable?('__test__'))\n    assert_equal(false, strainer.class.invokable?('test'))\n    assert_equal(false, strainer.class.invokable?('instance_eval'))\n    assert_equal(false, strainer.class.invokable?('__send__'))\n    assert_equal(true, strainer.class.invokable?('size')) # from the standard lib\n  end","complexity_score":20.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_only_invokes_public_filter_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"__test__\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"instance_eval\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"__send__\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"class\"]},\"invokable?\",{\"type\":\"str\",\"children\":[\"size\"]}]}]}]}]}","id":"f46a041a-c9f4-4040-bb51-7870b0281b85"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/strict_transport.rb","start_line":34,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['strict-transport-security'] ||= strict_transport\n        [status, headers, body]\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"strict-transport-security\"]}]},{\"type\":\"send\",\"children\":[null,\"strict_transport\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"0f37dc33-9464-490d-ba1c-1cbc86947ea7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":817,"raw_source":"def rabl(template, options = {}, locals = {})\n      Rabl.register!\n      render :rabl, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rabl\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rabl\"]},\"register!\"]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"rabl\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"4680f97e-be52-4053-9473-53a616094f17"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":63,"raw_source":"def kill\n      return unless pipe\n\n      Process.kill('KILL', pipe.pid)\n    rescue NotImplementedError\n      system \"kill -9 #{pipe.pid}\"\n    rescue Errno::ESRCH\n    end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"kill\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"kill\",{\"type\":\"str\",\"children\":[\"KILL\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"pid\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"system\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"kill -9 \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"pid\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ESRCH\"]}]},null,null]},null]}]}","id":"e4e5fb3d-5727-4842-bb0d-5363c8e15fba"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":190,"raw_source":"def test_doc_tag_visitor\n    template_source = '{% doc %}{% enddoc %}'\n\n    assert_equal(\n      [Liquid::Doc],\n      visit(template_source),\n    )\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_visitor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}]}","id":"3fd885f4-1993-4e37-8b94-874eaeb0bfd5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1078,"raw_source":"def test_where_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok', false | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok', false | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"b52a366e-3a10-438a-be8d-37d9915b7c1d"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":17,"raw_source":"def initialize\n    @allocated = []\n    @retained  = []\n    @headings  = []\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@allocated\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@retained\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@headings\",{\"type\":\"array\",\"children\":[]}]}]}]}","id":"a3f9ff00-684c-42b3-9789-b98abf43c2c7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":201,"raw_source":"def remap_extensions\n      ext_map.clear\n      Rack::Mime::MIME_TYPES.each { |e, t| ext_map[t] << e[1..].to_sym }\n      ext_map['text/javascript'] << 'js'\n      ext_map['text/xml'] << 'xml'\n    end","complexity_score":18.53,"ast_json":"{\"type\":\"def\",\"children\":[\"remap_extensions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"clear\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Mime\"]},\"MIME_TYPES\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]},{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},null]}]},\"to_sym\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"str\",\"children\":[\"text/javascript\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"js\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ext_map\"]},\"[]\",{\"type\":\"str\",\"children\":[\"text/xml\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\"xml\"]}]}]}]}","id":"5fdfcf3d-68cf-4774-9b64-c66d7ff234a1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":166,"raw_source":"def test_slice\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash.slice(:a)\n    assert_equal Sinatra::IndifferentHash[b: :b], @hash.slice(?b)\n    assert_equal Sinatra::IndifferentHash[3 => 3], @hash.slice(3)\n    assert_equal Sinatra::IndifferentHash.new, @hash.slice(:d)\n    assert_equal Sinatra::IndifferentHash[a: :a, b: :b, 3 => 3], @hash.slice(:a, :b, 3)\n    assert_equal Sinatra::IndifferentHash[simple_nested: { a: :a, ?b => :b }], @hash.slice(:simple_nested)\n    assert_equal Sinatra::IndifferentHash[nested: { a: [{ a: :a, ?b => :b }, :c, 4], ?f => :f, 7 => 7 }], @hash.slice(:nested)\n  end","complexity_score":26.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"sym\",\"children\":[\"f\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"slice\",{\"type\":\"sym\",\"children\":[\"nested\"]}]}]}]}]}","id":"5776763a-731c-4de4-91b5-bc972e1a85a3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":145,"raw_source":"def config_for_env(hash)\n      return from_environment_key(hash) if environment_keys?(hash)\n\n      hash.each_with_object(IndifferentHash[]) do |(k, v), acc|\n        if environment_keys?(v)\n          acc.merge!(k => v[environment.to_s]) if v.key?(environment.to_s)\n        else\n          acc.merge!(k => v)\n        end\n      end\n    end","complexity_score":24.8,"ast_json":"{\"type\":\"def\",\"children\":[\"config_for_env\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment_keys?\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"from_environment_key\",{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each_with_object\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IndifferentHash\"]},\"[]\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"arg\",\"children\":[\"acc\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment_keys?\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"acc\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_s\"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"acc\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]}]}]}","id":"81e694cd-b958-496c-a136-e3adfc52ff05"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1035,"raw_source":"def initialize(input, context)\n        @context = context\n        @input   = if input.is_a?(Array)\n          input.flatten\n        elsif input.is_a?(Hash)\n          [input]\n        elsif input.is_a?(Enumerable)\n          input\n        else\n          Array(input)\n        end\n      end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@input\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"flatten\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Enumerable\"]}]},{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}]}]}","id":"0d0fbbb6-4d15-4d1f-96c8-95870094513c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":199,"raw_source":"def keys\n        to_hash.keys\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"keys\"]}]}","id":"8b164a83-235b-4d2f-8ae4-288a60db43c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":19,"raw_source":"def test_tokenize_blocks\n    assert_equal(['{%comment%}'], tokenize('{%comment%}'))\n    assert_equal([' ', '{%comment%}', ' '], tokenize(' {%comment%} '))\n\n    assert_equal([' ', '{%comment%}', ' ', '{%endcomment%}', ' '], tokenize(' {%comment%} {%endcomment%} '))\n    assert_equal(['  ', '{% comment %}', ' ', '{% endcomment %}', ' '], tokenize(\"  {% comment %} {% endcomment %} \"))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{%comment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{%comment%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%comment%}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {%comment%} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%comment%}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{%endcomment%}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\" {%comment%} {%endcomment%} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\"{% comment %}\"]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"  {% comment %} {% endcomment %} \"]}]}]}]}]}","id":"b8fe7960-3c74-4e89-8f8b-6a3004f2ae15"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":340,"raw_source":"def prefixed_path(a, b)\n        return a || b || /.*/ unless a && b\n        return Mustermann.new(b) if a == /.*/\n\n        Mustermann.new(a) + Mustermann.new(b)\n      end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"prefixed_path\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"==\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}","id":"aaa43f3b-fb6b-401b-9417-0c4c86030fe3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":89,"raw_source":"def objparse(ts)\n    ts = eat('{', ts)\n    obj = {}\n\n    if ts[0][0] == '}'\n      return obj, ts[1..-1]\n    end\n\n    k, v, ts = pairparse(ts)\n    obj[k] = v\n\n    if ts[0][0] == '}'\n      return obj, ts[1..-1]\n    end\n\n    loop do\n      ts = eat(',', ts)\n\n      k, v, ts = pairparse(ts)\n      obj[k] = v\n\n      if ts[0][0] == '}'\n        return obj, ts[1..-1]\n      end\n    end\n  end","complexity_score":38.7,"ast_json":"{\"type\":\"def\",\"children\":[\"objparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"k\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"pairparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"k\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"pairparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]}]}]}]}]}","id":"93f89cc4-3697-478e-8c5e-4127787f7676"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":55,"raw_source":"def default\n        @default ||= new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@default\"]},{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}","id":"15ee8c09-8293-49cb-8881-9e3ab953166b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markaby_test.rb","start_line":7,"raw_source":"def markaby_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"markaby_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"2cdd9ee4-7ada-4c53-8f65-67e343386cc1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/not_implemented_as_pending.rb","start_line":12,"raw_source":"def finish(reporter)\n    if @exception.is_a?(NotImplementedError)\n      from = @exception.backtrace[0]\n      message = \"#{@exception.message} (from #{from})\"\n      @pending_declared_in_example = message\n      metadata[:pending] = true\n      @exception = nil\n    end\n\n    __finish__(reporter)\n  end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"reporter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"backtrace\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"message\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@exception\"]},\"message\"]}]},{\"type\":\"str\",\"children\":[\" (from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@pending_declared_in_example\",{\"type\":\"lvar\",\"children\":[\"message\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"metadata\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"pending\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@exception\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"__finish__\",{\"type\":\"lvar\",\"children\":[\"reporter\"]}]}]}]}","id":"eb3a2f2a-d45f-4740-81af-87f89e9397e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":103,"raw_source":"def children\n        [\n          @node.template_name_expr,\n          @node.variable_name_expr,\n        ] + @node.attributes.values\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"template_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variable_name_expr\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]}]}","id":"7f3bf7a3-af8b-4996-aa8b-326729f951ad"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":22,"raw_source":"def test_default_block\n    hash = Sinatra::IndifferentHash.new { |h, k| h[k] = k.upcase }\n    assert_nil hash.default\n    assert_equal ?A, hash.default(:a)\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"upcase\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}","id":"d3c2e00a-18cb-4d86-b879-c6e3d8b92a02"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":178,"raw_source":"def settings\n        app.settings\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"settings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"settings\"]}]}","id":"4de8b147-3674-4b54-9791-5122fa248001"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":173,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.map(&:upcase)]\n        end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]}]}]}]}","id":"c23be8e8-377f-4bd1-8ae7-4fd99a71e379"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":104,"raw_source":"def test_assigns_not_polluted_from_template\n    template                 = Template.parse(%({{ test }}{% assign test = 'bar' %}{{ test }}))\n    template.assigns['test'] = 'baz'\n    assert_equal('bazbar', template.render!)\n    assert_equal('bazbar', template.render!)\n    assert_equal('foobar', template.render!('test' => 'foo'))\n    assert_equal('bazbar', template.render!)\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigns_not_polluted_from_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ test }}{% assign test = 'bar' %}{{ test }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bazbar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}","id":"9e421fb9-1aab-4c0f-b912-16c8fd0094ac"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":945,"raw_source":"def test_has_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | has: 'ok', false }}\"\n    expected_output = \"true\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', false }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"89106a41-5540-4bf3-bef3-a12b2ee03db5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":349,"raw_source":"def error(code, body = nil)\n      if code.respond_to? :to_str\n        body = code.to_str\n        code = 500\n      end\n      response.body = body unless body.nil?\n      halt code\n    end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"code\"]},{\"type\":\"optarg\",\"children\":[\"body\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"code\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"code\"]},\"to_str\"]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"int\",\"children\":[500]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"lvar\",\"children\":[\"code\"]}]}]}]}","id":"3401bcbe-6397-44e6-a4d7-067a956d0453"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":80,"raw_source":"def parse_expression(markup)\n      Condition.parse_expression(parse_context, markup)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_expression\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[null,\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}","id":"14e68c64-c262-45b0-a211-540ce6ad6edc"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":20,"raw_source":"def increment_assign_score(amount)\n      @assign_score += amount\n      raise_limits_reached if @assign_score_limit && @assign_score > @assign_score_limit\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_assign_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@assign_score\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@assign_score_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@assign_score\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@assign_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}","id":"d93a3587-8489-4485-a39c-0650924406d8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":515,"raw_source":"def stream(keep_open = false)\n      scheduler = env['async.callback'] ? EventMachine : Stream\n      current   = @params.dup\n      stream = if scheduler == Stream  && keep_open\n        Stream.new(scheduler, false) do |out|\n          until out.closed?\n            with_params(current) { yield(out) }\n          end\n        end\n      else\n        Stream.new(scheduler, keep_open) { |out| with_params(current) { yield(out) } }\n      end\n      body stream\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"keep_open\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"scheduler\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.callback\"]}]},{\"type\":\"const\",\"children\":[null,\"EventMachine\"]},{\"type\":\"const\",\"children\":[null,\"Stream\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"current\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"stream\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"scheduler\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"Stream\"]}]},{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Stream\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"out\"]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]},\"closed?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_params\",{\"type\":\"lvar\",\"children\":[\"current\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Stream\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]},{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"out\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_params\",{\"type\":\"lvar\",\"children\":[\"current\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"lvar\",\"children\":[\"stream\"]}]}]}]}","id":"e37515d9-3648-49ab-ab76-6fe4266b3ba8"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":16,"raw_source":"def link_to_add_tag(label, tag)\n    tags = (@context['current_tags'] + [tag]).uniq\n    \"<a title=\\\"Show tag #{tag}\\\" href=\\\"/collections/#{@context['handle']}/#{tags.join('+')}\\\">#{label}</a>\"\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_add_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"label\"]},{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tags\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]},\"uniq\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a title=\\\"Show tag \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\" href=\\\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},\"join\",{\"type\":\"str\",\"children\":[\"+\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"label\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}]}","id":"003f2871-4d6f-40e0-9b2d-d9fd21bf3301"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":95,"raw_source":"def test_with_line_numbers_adds_numbers_to_parser_errors_with_whitespace_trim\n    source = <<~LIQUID\n      foobar\n\n      {%- \"cat\" | foobar -%}\n\n      bla\n    LIQUID\n\n    assert_match_syntax_error(/Liquid syntax error \\(line 3\\)/, source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_line_numbers_adds_numbers_to_parser_errors_with_whitespace_trim\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"{%- \\\"cat\\\" | foobar -%}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"bla\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Liquid syntax error \\\\(line 3\\\\)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"9111a730-98cc-4828-87ae-392d6de83dbb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":808,"raw_source":"def test_append\n    assigns = { 'a' => 'bc', 'b' => 'd' }\n    assert_template_result('bcd', \"{{ a | append: 'd'}}\", assigns)\n    assert_template_result('bcd', \"{{ a | append: b}}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_append\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"bc\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"d\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bcd\"]},{\"type\":\"str\",\"children\":[\"{{ a | append: 'd'}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bcd\"]},{\"type\":\"str\",\"children\":[\"{{ a | append: b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"8467dcb5-3336-47e9-9ac1-71d9f8a3a48a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":13,"raw_source":"def namespace(*args, &block)\n    mock_app { namespace(*args, &block) }\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"namespace\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"namespace\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"3b0affb3-27cf-4f65-8d37-2cc3c1b651f2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":4,"raw_source":"def route_def(pattern)\n  mock_app { get(pattern) { } }\nend","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"route_def\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"args\",\"children\":[]},null]}]}]}","id":"91f49c2d-309d-42ec-87f0-fde9fe375c33"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":745,"raw_source":"def test_modulo\n    assert_template_result(\"1\", \"{{ 3 | modulo:2 }}\")\n    assert_raises(Liquid::ZeroDivisionError) do\n      assert_template_result(\"4\", \"{{ 1 | modulo: 0 }}\")\n    end\n\n    assert_template_result(\"1\", \"{{ price | modulo:2 }}\", { 'price' => NumberLikeThing.new(3) })\n  end","complexity_score":6.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_modulo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ 3 | modulo:2 }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | modulo: 0 }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ price | modulo:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}","id":"ca449802-ecb6-4c2e-bc45-b1a86a6457e4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":231,"raw_source":"def reject(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.reject(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"reject\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"8d1c5ba8-b56a-41e8-bc16-f68df41e172d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":81,"raw_source":"def ==(other)\n        other.respond_to? :to_hash and to_hash == other.to_hash\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"==\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"to_hash\"]}]}]}]}","id":"3e0eb23c-907c-49bf-9676-dc18d414e54e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":115,"raw_source":"def length\n      children.length\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"length\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"length\"]}]}","id":"c705603e-c9c7-4234-a593-0bd17f91f47d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":354,"raw_source":"def strip_newlines(input)\n      input = Utils.to_s(input)\n      input.gsub(/\\r?\\n/, '')\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip_newlines\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\r?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}","id":"a8ecf4b9-89bb-421c-9ea1-4425f744722e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":229,"raw_source":"def apply_options_to_context(context, options)\n      context.add_filters(options[:filters]) if options[:filters]\n      context.global_filter      = options[:global_filter] if options[:global_filter]\n      context.exception_renderer = options[:exception_renderer] if options[:exception_renderer]\n      context.strict_variables   = options[:strict_variables] if options[:strict_variables]\n      context.strict_filters     = options[:strict_filters] if options[:strict_filters]\n    end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_options_to_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filters\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"global_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"global_filter=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"global_filter\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"exception_renderer\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"exception_renderer\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_variables\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_variables=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_variables\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_filters\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_filters=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"strict_filters\"]}]}]},null]}]}]}","id":"8d5b7cc0-0460-463e-ada3-ce59305f461a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":634,"raw_source":"def test_has_key_will_not_add_an_error_for_missing_keys\n    with_error_mode(:strict) do\n      context = Context.new\n      context.key?('unknown')\n      assert_empty(context.errors)\n    end\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_key_will_not_add_an_error_for_missing_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"key?\",{\"type\":\"str\",\"children\":[\"unknown\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_empty\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"errors\"]}]}]}]}]}","id":"2e21978c-ba7c-4679-9a5f-eb242a9bb9f5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1500,"raw_source":"def add_filter(type, path = /.*/, **options, &block)\n        filters[type] << compile!(type, path, block, **options)\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"<<\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}","id":"ef9ec988-b87e-41d2-8c2e-008d0013713f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":157,"raw_source":"def test_case_on_size_with_else\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [] },\n    )\n\n    assert_template_result(\n      '1',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1] },\n    )\n\n    assert_template_result(\n      '2',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1, 1] },\n    )\n\n    assert_template_result(\n      'else',\n      '{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}',\n      { 'a' => [1, 1, 1, 1, 1] },\n    )\n  end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_size_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"71da998d-780a-4430-9650-ed8adc68e07b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":755,"raw_source":"def erb(template, options = {}, locals = {}, &block)\n      render(:erb, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"erb\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"erb\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"d8777116-98e8-406b-8e1e-b02df4846128"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2170,"raw_source":"def self.use(*args, &block)\n    Delegator.target.use(*args, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"use\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"dab6dbc3-9511-4909-9a2f-b952f7fcbe6f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1402,"raw_source":"def error(*codes, &block)\n        args  = compile! 'ERROR', /.*/, block\n        codes = codes.flat_map(&method(:Array))\n        codes << Exception if codes.empty?\n        codes << Sinatra::NotFound if codes.include?(404)\n        codes.each { |c| (@errors[c] ||= []) << args }\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"str\",\"children\":[\"ERROR\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"codes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"flat_map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"Array\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"include?\",{\"type\":\"int\",\"children\":[404]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"<<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"ebf2d440-44eb-4134-8d09-01648c16df3e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":35,"raw_source":"def deep_fetch_translation(name)\n      name.split('.').reduce(locale) do |level, cur|\n        level[cur] || raise(TranslationError, \"Translation for #{name} does not exist in locale #{path}\")\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"deep_fetch_translation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"split\",{\"type\":\"str\",\"children\":[\".\"]}]},\"reduce\",{\"type\":\"send\",\"children\":[null,\"locale\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"level\"]},{\"type\":\"arg\",\"children\":[\"cur\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"level\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cur\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"TranslationError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Translation for \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" does not exist in locale \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}]}]}]}","id":"04105bdc-16f2-47a5-9039-bb38702db9d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":413,"raw_source":"def load_slice(from, to)\n      @load_slice_called = true\n      @data[(from..to - 1)]\n    end","complexity_score":3.55,"ast_json":"{\"type\":\"def\",\"children\":[\"load_slice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@load_slice_called\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@data\"]},\"[]\",{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"0f71b4c5-1594-42de-b68c-4609b63ded7e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":8,"raw_source":"def test_no_transform\n    assert_template_result(\n      'this text should come out of the template without change...',\n      'this text should come out of the template without change...',\n    )\n\n    assert_template_result('blah', 'blah')\n    assert_template_result('<blah>', '<blah>')\n    assert_template_result('|,.:', '|,.:')\n    assert_template_result('', '')\n\n    text = %(this shouldnt see any transformation either but has multiple lines\n              as you can clearly see here ...)\n    assert_template_result(text, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_transform\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"this text should come out of the template without change...\"]},{\"type\":\"str\",\"children\":[\"this text should come out of the template without change...\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"blah\"]},{\"type\":\"str\",\"children\":[\"blah\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<blah>\"]},{\"type\":\"str\",\"children\":[\"<blah>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"|,.:\"]},{\"type\":\"str\",\"children\":[\"|,.:\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"this shouldnt see any transformation either but has multiple lines\\n\"]},{\"type\":\"str\",\"children\":[\"              as you can clearly see here ...\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"875ad184-02d6-400a-8a6f-c2b0cb8cc372"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":21,"raw_source":"def to_liquid\n    @foo += 1\n    self\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@foo\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"cf68dd0b-e1ec-4edc-9c2f-20d6dc754765"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":78,"raw_source":"def test_invalid_expression\n    assert_raises(SyntaxError) do\n      p = new_parser(\"==\")\n      p.expression\n    end\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"==\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}","id":"d19655fa-5efe-4cf4-8804-97e0e9388bd5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":960,"raw_source":"def fetch(*key)\n      @cache.fetch(key) do\n        @cache[key] = yield\n      end\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"key\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cache\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"yield\",\"children\":[]}]}]}]}","id":"6c67bdad-fbdd-4609-b58e-b36f903ba3e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":692,"raw_source":"def assert_no_object_allocations\n    unless RUBY_ENGINE == 'ruby'\n      skip(\"stackprof needed to count object allocations\")\n    end\n    require 'stackprof'\n\n    profile = StackProf.run(mode: :object) do\n      yield\n    end\n    assert_equal(0, profile[:samples])\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_no_object_allocations\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},\"==\",{\"type\":\"str\",\"children\":[\"ruby\"]}]},null,{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"stackprof needed to count object allocations\"]}]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"str\",\"children\":[\"stackprof\"]}]},{\"type\":\"lvasgn\",\"children\":[\"profile\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StackProf\"]},\"run\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"mode\"]},{\"type\":\"sym\",\"children\":[\"object\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profile\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"samples\"]}]}]}]}]}","id":"4c5d305b-348b-4193-a693-96ea658e382f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":92,"raw_source":"def test_elsif_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif 2 == 2 %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_elsif_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif 2 == 2 %}{{ test }}{% endif %}\"]}]}]}]}","id":"dfcbfaba-ab6a-48b9-a2d4-14dc33cae65b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":421,"raw_source":"def watch_element(path, type, representation = nil)\n        list = Watcher::List.for(self)\n        element = Watcher::Element.new(type, representation)\n        list.watch(path, element)\n        list.watch(register_path, element) if registering_extension?\n      end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"watch_element\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"representation\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"list\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"element\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"Element\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"representation\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"watch\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"element\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"registering_extension?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"watch\",{\"type\":\"send\",\"children\":[null,\"register_path\"]},{\"type\":\"lvar\",\"children\":[\"element\"]}]},null]}]}]}","id":"a9ac052f-10bf-4e69-9bde-cf8ee53bbc63"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":92,"raw_source":"def initialize(app)\n        @app = app\n        @map = {}\n        @generic = {}\n        @default = nil\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@map\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@generic\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"8bdddc4f-7d38-43e3-8773-a0671b9b4f7a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":68,"raw_source":"def setup\n    @hash = Sinatra::IndifferentHash[:a=>:a, ?b=>:b, 3=>3,\n      :simple_nested=>{ :a=>:a, ?b=>:b },\n      :nested=>{ :a=>[{ :a=>:a, ?b=>:b }, :c, 4], ?f=>:f, 7=>7 }\n    ]\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"sym\",\"children\":[\"f\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}]}]}","id":"38deae67-17df-489a-a489-670ccb519dc3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":327,"raw_source":"def test_for_tag_string\n    # ruby 1.8.7 \"String\".each => Enumerator with single \"String\" element.\n    # ruby 1.9.3 no longer supports .each on String though we mimic\n    # the functionality for backwards compatibility\n\n    assert_template_result(\n      'test string',\n      '{%for val in string%}{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n\n    assert_template_result(\n      'test string',\n      '{%for val in string limit:1%}{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n\n    assert_template_result(\n      'val-string-1-1-0-1-0-true-true-test string',\n      '{%for val in string%}' \\\n      '{{forloop.name}}-' \\\n      '{{forloop.index}}-' \\\n      '{{forloop.length}}-' \\\n      '{{forloop.index0}}-' \\\n      '{{forloop.rindex}}-' \\\n      '{{forloop.rindex0}}-' \\\n      '{{forloop.first}}-' \\\n      '{{forloop.last}}-' \\\n      '{{val}}{%endfor%}',\n      { 'string' => \"test string\" },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_tag_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test string\"]},{\"type\":\"str\",\"children\":[\"{%for val in string%}{{val}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test string\"]},{\"type\":\"str\",\"children\":[\"{%for val in string limit:1%}{{val}}{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"val-string-1-1-0-1-0-true-true-test string\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%for val in string%}\"]},{\"type\":\"str\",\"children\":[\"{{forloop.name}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.index}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.length}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.index0}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.rindex}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.rindex0}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.first}}-\"]},{\"type\":\"str\",\"children\":[\"{{forloop.last}}-\"]},{\"type\":\"str\",\"children\":[\"{{val}}{%endfor%}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"string\"]},{\"type\":\"str\",\"children\":[\"test string\"]}]}]}]}]}]}","id":"23a1bb00-19d5-42e4-986d-9ea7299db99b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/cookies_spec.rb","start_line":17,"raw_source":"def cookies(*set_cookies)\n    cookie_route(*set_cookies) { cookies }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"cookies\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"set_cookies\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cookie_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"set_cookies\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"cookies\"]}]}]}","id":"56710d9a-a058-4b2d-8ca2-e083da812f56"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1167,"raw_source":"def invoke(&block)\n      res = catch(:halt, &block)\n\n      res = [res] if (Integer === res) || (String === res)\n      if (Array === res) && (Integer === res.first)\n        res = res.dup\n        status(res.shift)\n        body(res.pop)\n        headers(*res)\n      elsif res.respond_to? :each\n        body res\n      end\n      nil # avoid double setting the same response tuple twice\n    end","complexity_score":26.2,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[null,\"catch\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"res\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"first\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"pop\"]}]},{\"type\":\"send\",\"children\":[null,\"headers\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"lvar\",\"children\":[\"res\"]}]},null]}]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"471c0e59-66ea-4432-9973-ca44b941d099"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":5,"raw_source":"def strict_parse_with_error_mode_fallback(markup)\n      strict_parse_with_error_context(markup)\n    rescue SyntaxError => e\n      case parse_context.error_mode\n      when :strict\n        raise\n      when :warn\n        parse_context.warnings << e\n      end\n      lax_parse(markup)\n    end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse_with_error_mode_fallback\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"error_mode\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict\"]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"warnings\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},null]}]}","id":"10fb02b5-9073-4303-8bc2-7dacf6a1dcda"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1003,"raw_source":"def apply_operation(input, operand, operation)\n      result = Utils.to_number(input).send(operation, Utils.to_number(operand))\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_operation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]},{\"type\":\"arg\",\"children\":[\"operation\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"send\",{\"type\":\"lvar\",\"children\":[\"operation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"operand\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"0d2cf561-16a2-4f57-9bf9-9ae603d1cce3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":99,"raw_source":"def test_else_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% else %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_else_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% else %}{{ test }}{% endif %}\"]}]}]}]}","id":"c928862e-08a4-408b-ae5a-1a0697fe0779"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":54,"raw_source":"def parse_body(tokenizer)\n      @body.parse(tokenizer, parse_context) do |unknown_tag_name, unknown_tag_markup|\n        if unknown_tag_name\n          unknown_tag(unknown_tag_name, unknown_tag_markup, tokenizer)\n          true\n        else\n          false\n        end\n      end\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"arg\",\"children\":[\"unknown_tag_markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"unknown_tag\",{\"type\":\"lvar\",\"children\":[\"unknown_tag_name\"]},{\"type\":\"lvar\",\"children\":[\"unknown_tag_markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"61fb1642-6655-41fa-80f5-dbd192cdfe57"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":265,"raw_source":"def errors\n        base.errors.merge(namespace_errors)\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"errors\"]},\"merge\",{\"type\":\"send\",\"children\":[null,\"namespace_errors\"]}]}]}","id":"b50606de-132f-4a29-97c5-75d4b1c041c7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":82,"raw_source":"def children\n        Array(@node.variables)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variables\"]}]}]}","id":"f7dc1036-070f-42c5-88e5-05cf21ba77e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":199,"raw_source":"def render!(*args)\n      @rethrow_errors = true\n      render(*args)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@rethrow_errors\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"46f210a4-7883-4c37-a6f5-4b1b1c305fcb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/haml_test.rb","start_line":7,"raw_source":"def haml_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"haml_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"ea878a74-b1f7-4988-af5b-4040ee164d3b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":683,"raw_source":"def not_found?\n      status == 404\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[404]}]}]}","id":"577a569f-b413-4df3-8c1f-20aad4714234"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1551,"raw_source":"def patch(path, opts = {}, &block)   route 'PATCH',   path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PATCH\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"e40f8944-7d8f-40a5-b23b-f38242204fcf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":65,"raw_source":"def patch(*args, &block)    super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"f71c5e0a-60b0-4873-a634-f5654e455a9a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":90,"raw_source":"def assert_body(value)\n    if value.respond_to? :to_str\n      assert_equal value.lstrip.gsub(/\\s*\\n\\s*/, \"\"), body.lstrip.gsub(/\\s*\\n\\s*/, \"\")\n    else\n      assert_match value, body\n    end\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_str\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"lstrip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*\\\\n\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"lstrip\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*\\\\n\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}","id":"886cb19e-55e9-4c4a-aec5-3bf831e5920e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":39,"raw_source":"def test_fetch\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(1, static_register.fetch(:a))\n    assert_equal(1, static_register.fetch(:a, \"default\"))\n    assert_equal(22, static_register.fetch(:b))\n    assert_equal(22, static_register.fetch(:b, \"default\"))\n    assert_equal(33, static_register.fetch(:c))\n    assert_equal(33, static_register.fetch(:c, \"default\"))\n\n    assert_raises(KeyError) do\n      static_register.fetch(:d)\n    end\n    assert_equal(\"default\", static_register.fetch(:d, \"default\"))\n\n    result = static_register.fetch(:d) { \"default\" }\n    assert_equal(\"default\", result)\n\n    result = static_register.fetch(:d, \"default 1\") { \"default 2\" }\n    assert_equal(\"default 2\", result)\n  end","complexity_score":33.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"default\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"default 1\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"default 2\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"default 2\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"4f2e614e-9837-4271-a49d-4790472530c6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":250,"raw_source":"def self.engines\n      engines = {\n        css: %i[sass scss],\n        xml: %i[builder nokogiri],\n        html: %i[erb erubi haml hamlit slim liquid\n                 mab markdown rdoc],\n        all: (Sinatra::Templates.instance_methods.map(&:to_sym) +\n          [:mab] - %i[find_template markaby]),\n        json: [:yajl]\n      }\n      engines.default = []\n      defined?(JRUBY_VERSION) ? jrubyify(engines) : engines\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"engines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engines\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"css\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"sass\"]},{\"type\":\"sym\",\"children\":[\"scss\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"xml\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"builder\"]},{\"type\":\"sym\",\"children\":[\"nokogiri\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"html\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"erb\"]},{\"type\":\"sym\",\"children\":[\"erubi\"]},{\"type\":\"sym\",\"children\":[\"haml\"]},{\"type\":\"sym\",\"children\":[\"hamlit\"]},{\"type\":\"sym\",\"children\":[\"slim\"]},{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"sym\",\"children\":[\"mab\"]},{\"type\":\"sym\",\"children\":[\"markdown\"]},{\"type\":\"sym\",\"children\":[\"rdoc\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"all\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Templates\"]},\"instance_methods\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_sym\"]}]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"mab\"]}]}]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"find_template\"]},{\"type\":\"sym\",\"children\":[\"markaby\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"json\"]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"yajl\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engines\"]},\"default=\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"JRUBY_VERSION\"]}]},{\"type\":\"send\",\"children\":[null,\"jrubyify\",{\"type\":\"lvar\",\"children\":[\"engines\"]}]},{\"type\":\"lvar\",\"children\":[\"engines\"]}]}]}]}","id":"49acea4f-351a-416f-81cc-9b8d931dea4b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/break_tag_test.rb","start_line":10,"raw_source":"def test_break_with_no_block\n    assigns  = { 'i' => 1 }\n    markup   = 'before{% break %}after'\n    expected = 'before'\n\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":4.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_with_no_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"i\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"before{% break %}after\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"before\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"82c97858-c8f9-4ae2-a011-8a77e35f1329"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":27,"raw_source":"def initialize(markup, parse_context)\n      @markup        = markup\n      @name          = nil\n      @parse_context = parse_context\n      @line_number   = parse_context.line_number\n\n      strict_parse_with_error_mode_fallback(markup)\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@markup\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@parse_context\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_mode_fallback\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}","id":"e1bb130a-c879-47e2-adb1-9f96bae478ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":8,"raw_source":"def test_if\n    assert_template_result('  ', ' {% if false %} this text should not go into the output {% endif %} ')\n    assert_template_result(\n      '  this text should go into the output  ',\n      ' {% if true %} this text should go into the output {% endif %} ',\n    )\n    assert_template_result('  you rock ?', '{% if false %} you suck {% endif %} {% if true %} you rock {% endif %}?')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\" {% if false %} this text should not go into the output {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  this text should go into the output  \"]},{\"type\":\"str\",\"children\":[\" {% if true %} this text should go into the output {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  you rock ?\"]},{\"type\":\"str\",\"children\":[\"{% if false %} you suck {% endif %} {% if true %} you rock {% endif %}?\"]}]}]}]}","id":"1e216027-79f2-4637-973a-ba7b1051d42a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/capture.rb","start_line":87,"raw_source":"def capture(*args, &block)\n      return block[*args] if ruby?\n\n      if haml? && Tilt[:haml] == Tilt::HamlTemplate && defined?(Haml::Buffer)\n        buffer = Haml::Buffer.new(nil, Haml::Options.new.for_buffer)\n        with_haml_buffer(buffer) { capture_haml(*args, &block) }\n      else\n        buf_was = @_out_buf\n        @_out_buf = +''\n        begin\n          raw = block[*args]\n          captured = block.binding.eval('@_out_buf')\n          captured.empty? ? raw : captured\n        ensure\n          @_out_buf = buf_was\n        end\n      end\n    end","complexity_score":39.8,"ast_json":"{\"type\":\"def\",\"children\":[\"capture\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ruby?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"haml?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"haml\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"HamlTemplate\"]}]}]},{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Buffer\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"buffer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Buffer\"]},\"new\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Haml\"]},\"Options\"]},\"new\"]},\"for_buffer\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_haml_buffer\",{\"type\":\"lvar\",\"children\":[\"buffer\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"capture_haml\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"buf_was\",{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@_out_buf\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"raw\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"[]\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"captured\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"binding\"]},\"eval\",{\"type\":\"str\",\"children\":[\"@_out_buf\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captured\"]},\"empty?\"]},{\"type\":\"lvar\",\"children\":[\"raw\"]},{\"type\":\"lvar\",\"children\":[\"captured\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@_out_buf\",{\"type\":\"lvar\",\"children\":[\"buf_was\"]}]}]}]}]}]}]}]}","id":"54cd2c6d-16f7-4e4a-967d-67006216f919"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":51,"raw_source":"def self.context(*name, &block)\n    subclass = Class.new(self)\n    remove_tests(subclass)\n    subclass.class_eval(&block) if block_given?\n    const_set(context_name(name.join(\" \")), subclass)\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"context\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"subclass\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_tests\",{\"type\":\"lvar\",\"children\":[\"subclass\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subclass\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"const_set\",{\"type\":\"send\",\"children\":[null,\"context_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"lvar\",\"children\":[\"subclass\"]}]}]}]}","id":"3d1dfdd3-f520-4249-995e-17715a94fd7b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":252,"raw_source":"def set(key, options = {})\n        @response.set_cookie key.to_s, @options.merge(options)\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"set_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"adaf14a3-639d-476b-8bda-ab8f9a2542fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":514,"raw_source":"def test_legacy_map_on_hashes_with_dynamic_key\n    template = \"{% assign key = 'foo' %}{{ thing | map: key | map: 'bar' }}\"\n    hash     = { \"foo\" => { \"bar\" => 42 } }\n    assert_template_result(\"42\", template, { \"thing\" => hash })\n  end","complexity_score":3.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_map_on_hashes_with_dynamic_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% assign key = 'foo' %}{{ thing | map: key | map: 'bar' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[42]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"42\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"thing\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]}]}]}","id":"2f598119-7061-4499-9e57-9231e646649f"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":23,"raw_source":"def profile(phase, &block)\n    print(LOG_LABEL)\n    print(\"#{phase}.. \".ljust(10))\n    report = MemoryProfiler.report(&block)\n    puts 'Done.'\n    @headings  << phase.capitalize\n    @allocated << \"#{report.scale_bytes(report.total_allocated_memsize)} (#{report.total_allocated} objects)\"\n    @retained  << \"#{report.scale_bytes(report.total_retained_memsize)} (#{report.total_retained} objects)\"\n\n    return if ENV['CI']\n\n    require 'fileutils'\n    report_file = File.join(REPORTS_DIR, \"#{sanitize(phase)}.txt\")\n    FileUtils.mkdir_p(REPORTS_DIR)\n    report.pretty_print(to_file: report_file, scale_bytes: true)\n  end","complexity_score":27.75,"ast_json":"{\"type\":\"def\",\"children\":[\"profile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"phase\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"const\",\"children\":[null,\"LOG_LABEL\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"phase\"]}]},{\"type\":\"str\",\"children\":[\".. \"]}]},\"ljust\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"report\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MemoryProfiler\"]},\"report\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"str\",\"children\":[\"Done.\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@headings\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"phase\"]},\"capitalize\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@allocated\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"scale_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_allocated_memsize\"]}]}]},{\"type\":\"str\",\"children\":[\" (\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_allocated\"]}]},{\"type\":\"str\",\"children\":[\" objects)\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@retained\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"scale_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_retained_memsize\"]}]}]},{\"type\":\"str\",\"children\":[\" (\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"total_retained\"]}]},{\"type\":\"str\",\"children\":[\" objects)\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"CI\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"str\",\"children\":[\"fileutils\"]}]},{\"type\":\"lvasgn\",\"children\":[\"report_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize\",{\"type\":\"lvar\",\"children\":[\"phase\"]}]}]},{\"type\":\"str\",\"children\":[\".txt\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FileUtils\"]},\"mkdir_p\",{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"report\"]},\"pretty_print\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_file\"]},{\"type\":\"lvar\",\"children\":[\"report_file\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"scale_bytes\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}","id":"dc3162d1-6cca-4b6b-a529-7d4f4cb04dec"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":51,"raw_source":"def test_simple_with_whitespaces\n    assert_template_result(\"  worked  \", \"  {{ test }}  \", { \"test\" => \"worked\" })\n    assert_template_result(\"  worked wonderfully  \", \"  {{ test }}  \", { \"test\" => \"worked wonderfully\" })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_with_whitespaces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  worked  \"]},{\"type\":\"str\",\"children\":[\"  {{ test }}  \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  worked wonderfully  \"]},{\"type\":\"str\",\"children\":[\"  {{ test }}  \"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked wonderfully\"]}]}]}]}]}]}","id":"fad9fc9e-ef21-4829-99f9-bca7acdff678"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/cookies_spec.rb","start_line":4,"raw_source":"def cookie_route(*cookies, headers: {}, &block)\n    result = nil\n    set_cookie(cookies)\n    @cookie_app.get('/') do\n      result = instance_eval(&block)\n      \"ok\"\n    end\n    get '/', {}, headers || {}\n    expect(last_response).to be_ok\n    expect(body).to eq(\"ok\")\n    result\n  end","complexity_score":24.4,"ast_json":"{\"type\":\"def\",\"children\":[\"cookie_route\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"cookies\"]},{\"type\":\"kwoptarg\",\"children\":[\"headers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"set_cookie\",{\"type\":\"lvar\",\"children\":[\"cookies\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@cookie_app\"]},\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[null,\"last_response\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"be_ok\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"a67a7fa6-1376-4f32-9cc3-2eb2e189a617"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":162,"raw_source":"def options(uri, params = {}, env = {}, &block)\n        env = env_for(uri, env.merge(method: 'OPTIONS', params: params))\n        current_session.send(:process_request, uri, env, &block)\n      end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[null,\"env_for\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_session\"]},\"send\",{\"type\":\"sym\",\"children\":[\"process_request\"]},{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"eaa7045d-40ca-49df-bc52-46c6b0987bfa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":43,"raw_source":"def test_complex_if_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 and 2 == test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_if_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 and 2 == test %}{% endif %}\"]}]}]}]}","id":"710fd201-f58f-42ce-96c1-a73a18d5c852"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":42,"raw_source":"def test_unless_tag_calls_to_liquid_value\n    assert_template_result('', '{% unless foo %}true{% endunless %}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('true', '{% unless foo %}true{% endunless %}', { 'foo' => BooleanDrop.new(false) })\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% unless foo %}true{% endunless %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% unless foo %}true{% endunless %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]}]}]}","id":"5147cca1-8eb4-41df-b7f5-f0ffa99c2bad"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":274,"raw_source":"def run!(*args)\n        if settings.reloader?\n          super unless running?\n        else\n          super\n        end\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"run!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"reloader?\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},null,{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"4242f913-cbce-495a-8271-ae5edff56b12"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":50,"raw_source":"def test_quoted_fragment\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      \"{% tablerow n in collections.frontpage cols:3%} {{n}} {% endtablerow %}\",\n      { 'collections' => { 'frontpage' => [1, 2, 3, 4, 5, 6] } },\n    )\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      \"{% tablerow n in collections['frontpage'] cols:3%} {{n}} {% endtablerow %}\",\n      { 'collections' => { 'frontpage' => [1, 2, 3, 4, 5, 6] } },\n    )\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quoted_fragment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in collections.frontpage cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"frontpage\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in collections['frontpage'] cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"frontpage\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}]}]}","id":"9c1f58ee-1531-4e71-9d8f-9d9ddbddeee4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":22,"raw_source":"def parse(tokenizer, parse_context, &block)\n      raise FrozenError, \"can't modify frozen Liquid::BlockBody\" if frozen?\n\n      parse_context.line_number = tokenizer.line_number\n\n      if tokenizer.for_liquid_tag\n        parse_for_liquid_tag(tokenizer, parse_context, &block)\n      else\n        parse_for_document(tokenizer, parse_context, &block)\n      end\n    end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"frozen?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FrozenError\"]},{\"type\":\"str\",\"children\":[\"can't modify frozen Liquid::BlockBody\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},{\"type\":\"send\",\"children\":[null,\"parse_for_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[null,\"parse_for_document\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"d27b042b-5133-40a2-ae37-07206eb4b104"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":87,"raw_source":"def new_parser(str)\n    Parser.new(StringScanner.new(str))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Parser\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}]}","id":"f62bf537-8b44-408c-b64b-d3354e0354f9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":74,"raw_source":"def idempotent?\n      safe? || put? || delete? || link? || unlink?\n    end","complexity_score":11.0,"ast_json":"{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\"]},{\"type\":\"send\",\"children\":[null,\"put?\"]}]},{\"type\":\"send\",\"children\":[null,\"delete?\"]}]},{\"type\":\"send\",\"children\":[null,\"link?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlink?\"]}]}]}","id":"cb0212c7-49c4-44fb-9300-ecbb516202f6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":75,"raw_source":"def lax_parse(markup)\n      if markup =~ Syntax\n        @variable_name   = Regexp.last_match(1)\n        collection_name  = Regexp.last_match(2)\n        @reversed        = !!Regexp.last_match(3)\n        @name            = \"#{@variable_name}-#{collection_name}\"\n        @collection_name = parse_expression(collection_name)\n        markup.scan(TagAttributes) do |key, value|\n          set_attribute(key, value)\n        end\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.for\")\n      end\n    end","complexity_score":26.25,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@reversed\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"!\"]},\"!\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"collection_name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[null,\"set_attribute\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.for\"]}]}]}]}]}","id":"4ff11ec4-7e2e-4fb1-b32d-dd878d443ee4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":266,"raw_source":"def test_does_not_add_error_in_strict_mode_for_missing_variable\n    env = Liquid::Environment.build(file_system: TestFileSystem.new)\n\n    a = Liquid::Template.parse(' {% include \"nested_template\" %}', environment: env)\n    a.render!\n    assert_empty(a.errors)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_add_error_in_strict_mode_for_missing_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestFileSystem\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {% include \\\"nested_template\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_empty\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"errors\"]}]}]}]}","id":"ba1e3bc8-ce61-4aee-9707-7de81d12003f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":953,"raw_source":"def sum(input, property = nil)\n      ary = InputIterator.new(input, context)\n      return 0 if ary.empty?\n\n      values_for_sum = ary.map do |item|\n        if property.nil?\n          item\n        elsif item.respond_to?(:[])\n          item[property]\n        else\n          0\n        end\n      rescue TypeError\n        raise_property_error(property)\n      end\n\n      result = InputIterator.new(values_for_sum, context).sum do |item|\n        Utils.to_number(item)\n      end\n\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":27.7,"ast_json":"{\"type\":\"def\",\"children\":[\"sum\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"values_for_sum\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"item\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"values_for_sum\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"sum\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"20b1f271-62a2-42ec-9cc2-51c1e35df69b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":16,"raw_source":"def mock_app(app = nil, lint: true, &block)\n    app = block if app.nil? && (block.arity == 1)\n    if app\n      klass = described_class\n      mock_app do\n        use Rack::Head\n        use(Rack::Config) { |e| e['rack.session'] ||= {} }\n        use klass\n        run app\n      end\n    elsif lint\n      @app = Rack::Lint.new Rack::Builder.new(&block).to_app\n    else\n      @app = Rack::Builder.new(&block).to_app\n    end\n  end","complexity_score":34.43,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"app\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"lint\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"nil?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"app\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"send\",\"children\":[null,\"described_class\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Head\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Config\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.session\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lint\"]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Lint\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"to_app\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"to_app\"]}]}]}]}]}]}","id":"c870ad41-1c4c-45bd-87ed-ebe84ea74da9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":149,"raw_source":"def test_nested_for\n    assigns = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    assert_template_result('123456', '{%for item in array%}{%for i in item%}{{ i }}{%endfor%}{%endfor%}', assigns)\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123456\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%for i in item%}{{ i }}{%endfor%}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"5099b645-b3e4-4fc0-98f9-986b72ec0740"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":69,"raw_source":"def test_arguments\n    p = new_parser(\"filter: hi.there[5], keyarg: 7\")\n    assert_equal('filter', p.consume(:id))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('hi.there[5]', p.argument)\n    assert_equal(',', p.consume(:comma))\n    assert_equal('keyarg: 7', p.argument)\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"filter: hi.there[5], keyarg: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there[5]\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"comma\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"keyarg: 7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]}]}","id":"5730f887-7bbb-444d-bb48-c0a309250224"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":4,"raw_source":"def price(integer)\n    format(\"$%.2d USD\", integer / 100.0)\n  end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"price\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"integer\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$%.2d USD\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"integer\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}","id":"6947fd53-bcb4-4fb5-af57-b8d1ccb0c43b"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":80,"raw_source":"def parse_raw_tag_body(tokenizer)\n      while (token = tokenizer.send(:shift))\n        return if token =~ BlockBody::FullTokenPossiblyInvalid && \"endraw\" == Regexp.last_match(2)\n      end\n\n      raise_tag_never_closed(\"raw\")\n    end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_raw_tag_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"endraw\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"return\",\"children\":[]},null]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"str\",\"children\":[\"raw\"]}]}]}]}","id":"7821ffd0-3573-40dd-930e-01445705486c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":64,"raw_source":"def fetch(key, *args)\n      args.map!(&method(:convert_value))\n\n      super(convert_key(key), *args)\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"f37f4f3d-ce49-4003-82f6-3a961ede4dca"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":241,"raw_source":"def test_doc_tag_nodelist_returns_array_with_body\n    doc_content = \"Documentation content\\n@param {string} foo\"\n    template_source = \"{% doc %}#{doc_content}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal([doc_content], doc_tag.nodelist)\n    assert_equal(1, doc_tag.nodelist.length)\n    assert_equal(doc_content, doc_tag.nodelist.first)\n  end","complexity_score":22.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_nodelist_returns_array_with_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc_content\",{\"type\":\"str\",\"children\":[\"Documentation content\\n@param {string} foo\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_content\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"doc_content\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"first\"]}]}]}]}","id":"9f662d04-f727-4564-b183-73a5a2307bef"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/decrement.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @variable_name = markup.strip\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"strip\"]}]}]}]}","id":"9a816e12-0e0d-45ed-a2dd-2bcfc2a55044"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":134,"raw_source":"def test_else_if\n    assert_template_result('0', '{% if 0 == 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}')\n    assert_template_result('1', '{% if 0 != 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}')\n    assert_template_result('2', '{% if 0 != 0 %}0{% elsif 1 != 1%}1{% else %}2{% endif %}')\n\n    assert_template_result('elsif', '{% if false %}if{% elsif true %}elsif{% endif %}')\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_else_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{% if 0 == 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% if 0 != 0 %}0{% elsif 1 == 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% if 0 != 0 %}0{% elsif 1 != 1%}1{% else %}2{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"elsif\"]},{\"type\":\"str\",\"children\":[\"{% if false %}if{% elsif true %}elsif{% endif %}\"]}]}]}]}","id":"2dbe757a-3b37-4469-8f66-e23dbafde9f6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":12,"raw_source":"def self.delegates(name)\n    it \"delegates #{name}\" do\n      m = mirror { send name }\n      assert_equal [name.to_s], m.last_call\n    end\n\n    it \"delegates #{name} with arguments\" do\n      m = mirror { send name, \"foo\", \"bar\" }\n      assert_equal [name.to_s, \"foo\", \"bar\"], m.last_call\n    end\n\n    it \"delegates #{name} with block\" do\n      block = proc { }\n      m = mirror { send(name, &block) }\n      assert_equal [name.to_s, block], m.last_call\n    end\n  end","complexity_score":45.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"delegates\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" with arguments\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"delegates \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" with block\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]},{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mirror\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"last_call\"]}]}]}]}]}]}","id":"4a38e686-90b2-49c7-a866-82576632b74a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":406,"raw_source":"def valenc(x)\n    case x\n    when Hash    then objenc(x)\n    when Array   then arrenc(x)\n    when String  then strenc(x)\n    when Numeric then numenc(x)\n    when true    then \"true\"\n    when false   then \"false\"\n    when nil     then \"null\"\n    else\n      raise Error, \"cannot encode #{x.class}: #{x.inspect}\"\n    end\n  end","complexity_score":17.2,"ast_json":"{\"type\":\"def\",\"children\":[\"valenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"objenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"arrenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"strenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Numeric\"]},{\"type\":\"send\",\"children\":[null,\"numenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"null\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"cannot encode \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"inspect\"]}]}]}]}]}]}","id":"87d0a029-3773-4c3b-9a6e-fac301c4a478"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":247,"raw_source":"def test_url_decode\n    assert_equal('foo bar', @filters.url_decode('foo+bar'))\n    assert_equal('foo bar', @filters.url_decode('foo%20bar'))\n    assert_equal('foo+1@example.com', @filters.url_decode('foo%2B1%40example.com'))\n    assert_equal('1', @filters.url_decode(1))\n    assert_equal('2001-02-03', @filters.url_decode(Date.new(2001, 2, 3)))\n    assert_nil(@filters.url_decode(nil))\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.url_decode('%ff')\n    end\n    assert_equal('Liquid error: invalid byte sequence in UTF-8', exception.message)\n  end","complexity_score":22.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_url_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo+bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo%20bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo+1@example.com\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"foo%2B1%40example.com\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"url_decode\",{\"type\":\"str\",\"children\":[\"%ff\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid byte sequence in UTF-8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"e80af55f-20e1-4e5e-be2d-878ffa452c03"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rack_test.rb","start_line":10,"raw_source":"def build(*middleware)\n    endpoint = middleware.pop\n    @app = Rack::Builder.app do\n      middleware.each { |m| use m }\n      run endpoint\n    end\n  end","complexity_score":9.9,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"middleware\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"endpoint\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"pop\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"m\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"lvar\",\"children\":[\"m\"]}]}]},{\"type\":\"send\",\"children\":[null,\"run\",{\"type\":\"lvar\",\"children\":[\"endpoint\"]}]}]}]}]}]}]}","id":"6d48589c-7643-4938-bc56-4e68fe90fe1c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":45,"raw_source":"def render_to_output_buffer(context, output)\n      (collection = context.evaluate(@collection_name)) || (return '')\n\n      from = @attributes.key?('offset') ? to_integer(context.evaluate(@attributes['offset'])) : 0\n      to = @attributes.key?('limit') ? from + to_integer(context.evaluate(@attributes['limit'])) : nil\n\n      collection = Utils.slice_collection(collection, from, to)\n      length     = collection.length\n\n      cols = @attributes.key?('cols') ? to_integer(context.evaluate(@attributes['cols'])) : length\n\n      output << \"<tr class=\\\"row1\\\">\\n\"\n      context.stack do\n        tablerowloop = Liquid::TablerowloopDrop.new(length, cols)\n        context['tablerowloop'] = tablerowloop\n\n        collection.each do |item|\n          context[@variable_name] = item\n\n          output << \"<td class=\\\"col#{tablerowloop.col}\\\">\"\n          super\n          output << '</td>'\n\n          # Handle any interrupts if they exist.\n          if context.interrupt?\n            interrupt = context.pop_interrupt\n            break if interrupt.is_a?(BreakInterrupt)\n          end\n\n          if tablerowloop.col_last && !tablerowloop.last\n            output << \"</tr>\\n<tr class=\\\"row#{tablerowloop.row + 1}\\\">\"\n          end\n\n          tablerowloop.send(:increment!)\n        end\n      end\n\n      output << \"</tr>\\n\"\n      output\n    end","complexity_score":71.88,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"offset\"]}]},{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"offset\"]}]}]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"lvasgn\",\"children\":[\"to\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"limit\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"limit\"]}]}]}]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"slice_collection\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"cols\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"key?\",{\"type\":\"str\",\"children\":[\"cols\"]}]},{\"type\":\"send\",\"children\":[null,\"to_integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cols\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"length\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tablerowloop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TablerowloopDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"lvar\",\"children\":[\"cols\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"tablerowloop\"]},{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<td class=\\\"col\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"col\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]}]}]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"</td>\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"interrupt\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"pop_interrupt\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BreakInterrupt\"]}]},{\"type\":\"break\",\"children\":[]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"col_last\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"last\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"</tr>\\n<tr class=\\\"row\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"row\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tablerowloop\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"2dac9219-02b8-44d6-a446-2a7bfd5e5ad1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":33,"raw_source":"def test_zero_lq_or_equal_one\n    text = ' {% if 0 <= 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_or_equal_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 <= 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"73857958-5c28-46d3-bbf1-d1f61ce59bf4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":179,"raw_source":"def each\n      block_given? ? super : enum_for(:each)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"sym\",\"children\":[\"each\"]}]}]}]}","id":"2798b490-1b39-42d5-b5c9-2b3048d80b26"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":89,"raw_source":"def test_raise_on_invalid_tag_delimiter\n    assert_raises(Liquid::SyntaxError) do\n      Template.new.parse('{% end %}')\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_invalid_tag_delimiter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% end %}\"]}]}]}]}","id":"837cfb0d-d916-4c55-ae10-25ffd41bb446"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":142,"raw_source":"def test_syntax_error_no_variable\n    assert_raises(SyntaxError) { assert_template_result('', '{% if jerry == 1 %}') }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_no_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if jerry == 1 %}\"]}]}]}]}","id":"6f0a3c78-8953-49d4-89ef-5d66ad26e58c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1934,"raw_source":"def force_encoding(*args)\n      settings.force_encoding(*args)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"force_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"force_encoding\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}","id":"37fcf07d-10ef-4c0b-8a4c-ae48960cec01"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":169,"raw_source":"def select(*args, &block)\n      return to_enum(:select) unless block_given?\n\n      dup.tap { |hash| hash.select!(*args, &block) }\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"select\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_enum\",{\"type\":\"sym\",\"children\":[\"select\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"select!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"17525452-851c-4be9-969c-f50fae078ba4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":36,"raw_source":"def setup\n    @context = Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}","id":"22697717-0ec2-44fb-9ccb-423fe71805ec"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1063,"raw_source":"def concat(args)\n        to_a.concat(args)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"concat\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"concat\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}","id":"b4ef5d5f-ab71-43b0-93c2-98e9d98e8fc8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":63,"raw_source":"def block_delimiter\n      @block_delimiter ||= \"end#{block_name}\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"block_delimiter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@block_delimiter\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"end\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}]}","id":"cc2fe633-a10c-4a5b-b517-3bd88c538df8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":39,"raw_source":"def has_vector?(request, headers)\n        return false if request.xhr?\n        return false if options[:allow_if]&.call(request.env)\n        return false unless headers['content-type'].to_s.split(';', 2).first =~ %r{^\\s*application/json\\s*$}\n\n        origin(request.env).nil? and referrer(request.env) != request.host\n      end","complexity_score":24.65,"ast_json":"{\"type\":\"def\",\"children\":[\"has_vector?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"request\"]},{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"xhr?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"to_s\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]},{\"type\":\"int\",\"children\":[2]}]},\"first\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^\\\\s*application/json\\\\s*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"origin\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"env\"]}]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]}]}]}]}]}","id":"14f6546a-b7af-4611-bca6-de71865c5bda"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":87,"raw_source":"def children\n        super + @node.attributes.values + [@node.collection_name]\n      end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"collection_name\"]}]}]}]}","id":"244f4c03-6d59-4b27-abcf-03d8b8bcf8ee"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":388,"raw_source":"def test_bad_variable_naming_in_for_loop\n    assert_raises(Liquid::SyntaxError) do\n      Liquid::Template.parse('{% for a/b in x %}{% endfor %}')\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bad_variable_naming_in_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for a/b in x %}{% endfor %}\"]}]}]}]}","id":"e8541947-a49a-49e4-baa5-b8ab19d9c2c2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":148,"raw_source":"def test_left_or_right_may_contain_operators\n    @context        = Liquid::Context.new\n    @context['one'] = @context['another'] = \"gnomeslab-and-or-liquid\"\n\n    assert_evaluates_true(VariableLookup.new(\"one\"), '==', VariableLookup.new(\"another\"))\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_left_or_right_may_contain_operators\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"another\"]},{\"type\":\"str\",\"children\":[\"gnomeslab-and-or-liquid\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"another\"]}]}]}]}]}","id":"413ee5bd-7263-4085-a438-95f6da60a44b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":148,"raw_source":"def test_for_offset\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) offset: test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_offset\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) offset: test %}{% endfor %}\"]}]}]}]}","id":"6f7462ac-bf65-4079-8381-3696a3615396"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":59,"raw_source":"def unknown_tag(tag, markup, tokens)\n      case tag\n      when 'when'\n        record_when_condition(markup)\n      when 'else'\n        record_else_condition(markup)\n      else\n        super\n      end\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"when\"]},{\"type\":\"send\",\"children\":[null,\"record_when_condition\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"send\",\"children\":[null,\"record_else_condition\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"c1ab72e2-1a05-4ccf-9bb8-9bf8073f8bc9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":52,"raw_source":"def preferred_type(*types)\n      return accept.first if types.empty?\n\n      types.flatten!\n      return types.first if accept.empty?\n\n      accept.detect do |accept_header|\n        type = types.detect { |t| MimeTypeEntry.new(t).accepts?(accept_header) }\n        return type if type\n      end\n    end","complexity_score":20.5,"ast_json":"{\"type\":\"def\",\"children\":[\"preferred_type\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"first\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"flatten!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"first\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accept\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"accept_header\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"type\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"detect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MimeTypeEntry\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"accepts?\",{\"type\":\"lvar\",\"children\":[\"accept_header\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},null]}]}]}]}]}","id":"09dbe3ba-37c8-4495-8579-b393a5ff96ce"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":161,"raw_source":"def test_profiling_supports_multiple_templates\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'b_template' %}\", profile: true)\n    t.render!\n\n    a_template = t.profiler[1]\n    a_template.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n\n    b_template = t.profiler[2]\n    b_template.children.each do |child|\n      assert_equal(\"b_template\", child.partial)\n    end\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_multiple_templates\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'b_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"a_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"b_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b_template\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}","id":"4d0f8515-ca87-4452-90ca-b1e15737ee58"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":153,"raw_source":"def test_variable_lookup_interface\n    lookup = VariableLookup.new('a.b.c')\n    assert_equal('a', lookup.name)\n    assert_equal(['b', 'c'], lookup.lookups)\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_interface\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lookup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"a.b.c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lookup\"]},\"lookups\"]}]}]}]}","id":"01b196e7-0f2f-4de6-b0ce-9943a296c35d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1593,"raw_source":"def quit!\n        return unless running?\n\n        # Use Thin's hard #stop! if available, otherwise just #stop.\n        running_server.respond_to?(:stop!) ? running_server.stop! : running_server.stop\n        warn '== Sinatra has ended his set (crowd applauds)' unless suppress_messages?\n        set :running_server, nil\n        set :handler_name, nil\n\n        on_stop_callback.call unless on_stop_callback.nil?\n      end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"quit!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"stop!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"stop!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"running_server\"]},\"stop\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"suppress_messages?\"]},null,{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"== Sinatra has ended his set (crowd applauds)\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"running_server\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"handler_name\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_stop_callback\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"on_stop_callback\"]},\"call\"]}]}]}]}","id":"2990775c-87ea-4d45-a7ea-d35bc6e3f46f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":37,"raw_source":"def default_exception_renderer=(renderer)\n        Deprecations.warn(\"Template.default_exception_renderer=\", \"Environment#exception_renderer=\")\n        Environment.default.exception_renderer = renderer\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default_exception_renderer=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"renderer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.default_exception_renderer=\"]},{\"type\":\"str\",\"children\":[\"Environment#exception_renderer=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"exception_renderer=\",{\"type\":\"lvar\",\"children\":[\"renderer\"]}]}]}]}","id":"25708ef4-82c1-42ec-86ae-aa4aa2a3e641"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/scss_test.rb","start_line":7,"raw_source":"def scss_app(options = {}, &block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"scss_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"76fcd825-6a20-4101-9570-2b2551c684f4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":85,"raw_source":"def self.to_liquid_value(obj)\n      # Enable \"obj\" to represent itself as a primitive value like integer, string, or boolean\n      return obj.to_liquid_value if obj.respond_to?(:to_liquid_value)\n\n      # Otherwise return the object itself\n      obj\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_liquid_value\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_liquid_value\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_liquid_value\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}","id":"adecab80-5cba-416e-b929-26e2ec2298b0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":673,"raw_source":"def client_error?\n      status.between? 400, 499\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"client_error?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[400]},{\"type\":\"int\",\"children\":[499]}]}]}","id":"533440f7-1025-45db-a53a-bb31a2f22613"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":386,"raw_source":"def content_type(type = nil, params = {})\n      return response['content-type'] unless type\n\n      default = params.delete :default\n      mime_type = mime_type(type) || default\n      raise format('Unknown media type: %p', type) if mime_type.nil?\n\n      mime_type = mime_type.dup\n      unless params.include?(:charset) || settings.add_charset.all? { |p| !(p === mime_type) }\n        params[:charset] = params.delete('charset') || settings.default_encoding\n      end\n      params.delete :charset if mime_type.include? 'charset'\n      unless params.empty?\n        mime_type << ';'\n        mime_type << params.map do |key, val|\n          val = val.inspect if val.to_s =~ /[\";,]/\n          \"#{key}=#{val}\"\n        end.join(';')\n      end\n      response['content-type'] = mime_type\n    end","complexity_score":55.1,"ast_json":"{\"type\":\"def\",\"children\":[\"content_type\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"type\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mime_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"Unknown media type: %p\"]},{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"mime_type\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"include?\",{\"type\":\"sym\",\"children\":[\"charset\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"add_charset\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]}]},\"!\"]}]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"charset\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"str\",\"children\":[\"charset\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"include?\",{\"type\":\"str\",\"children\":[\"charset\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"delete\",{\"type\":\"sym\",\"children\":[\"charset\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"empty?\"]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"<<\",{\"type\":\"str\",\"children\":[\";\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime_type\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"to_s\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\";,]\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]},null]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]}]}]}]}]},\"join\",{\"type\":\"str\",\"children\":[\";\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"lvar\",\"children\":[\"mime_type\"]}]}]}]}","id":"8ab4f0b8-82bd-4745-ba47-7fbe26f8fe7c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":139,"raw_source":"def test_single_line_inner_tag\n    text     = '<p> {% if true -%} yes {%- endif %} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {% if false -%} no {%- endif %} </p>'\n    expected = '<p>  </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_inner_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if true -%} yes {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {% if false -%} no {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>  </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"1d5e5e62-ce30-45b6-89e8-8e20a4930ef7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":49,"raw_source":"def expression\n      token = @tokens[@p]\n      case token[0]\n      when :id\n        str = consume\n        str << variable_lookups\n      when :open_square\n        str = consume.dup\n        str << expression\n        str << consume(:close_square)\n        str << variable_lookups\n      when :string, :number\n        consume\n      when :open_round\n        consume\n        first = expression\n        consume(:dotdot)\n        last = expression\n        consume(:close_round)\n        \"(#{first}..#{last})\"\n      else\n        raise SyntaxError, \"#{token} is not a valid expression\"\n      end\n    end","complexity_score":35.7,"ast_json":"{\"type\":\"def\",\"children\":[\"expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"id\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"variable_lookups\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"open_square\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"consume\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_square\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"variable_lookups\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"string\"]},{\"type\":\"sym\",\"children\":[\"number\"]},{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"open_round\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"consume\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"dotdot\"]}]},{\"type\":\"lvasgn\",\"children\":[\"last\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_round\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]}]},{\"type\":\"str\",\"children\":[\"..\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last\"]}]},{\"type\":\"str\",\"children\":[\")\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"str\",\"children\":[\" is not a valid expression\"]}]}]}]}]}]}","id":"cceba94e-1380-4aa7-845b-81419a1083bf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":21,"raw_source":"def test_consume?\n    p = new_parser(\"wat: 7\")\n    assert_equal('wat', p.consume?(:id))\n    assert_equal(false, p.consume?(:dot))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('7', p.consume?(:number))\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_consume?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"dot\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}","id":"611b10b6-0273-4713-9e0b-f5012497c2e0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":933,"raw_source":"def compile_block_template(template, options, &body)\n      first_location = caller_locations.first\n      path = first_location.path\n      line = first_location.lineno\n      path = options[:path] || path\n      line = options[:line] || line\n      template.new(path, line.to_i, options, &body)\n    end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_block_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"path\"]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"lineno\"]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"path\"]}]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"line\"]}]},{\"type\":\"lvar\",\"children\":[\"line\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}","id":"11597148-2b38-40a8-ae7b-5d1f8e63aa0f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":586,"raw_source":"def test_disables_tag_specified\n    context = Context.new\n    context.with_disabled_tags(%w(foo bar)) do\n      assert_equal(true, context.tag_disabled?(\"foo\"))\n      assert_equal(true, context.tag_disabled?(\"bar\"))\n      assert_equal(false, context.tag_disabled?(\"unknown\"))\n    end\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disables_tag_specified\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"with_disabled_tags\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"str\",\"children\":[\"unknown\"]}]}]}]}]}]}]}","id":"bbb2e2b0-5fd8-4ae3-a48a-bf8c78e43827"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":75,"raw_source":"def test_child_comment_tags_need_to_be_closed\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% comment %}\n          {% comment %}{%    endcomment     %}\n        {% endcomment %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      assert_template_result(\"\", <<~LIQUID.chomp)\n        {% comment %}\n          {% comment %}\n            {% comment %}\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_child_comment_tags_need_to_be_closed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% comment %}{%    endcomment     %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}","id":"cf71e949-5ccf-40f4-8ac9-458d03691465"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":17,"raw_source":"def test_default_operators_evalute_true\n    assert_evaluates_true(1, '==', 1)\n    assert_evaluates_true(1, '!=', 2)\n    assert_evaluates_true(1, '<>', 2)\n    assert_evaluates_true(1, '<', 2)\n    assert_evaluates_true(2, '>', 1)\n    assert_evaluates_true(1, '>=', 1)\n    assert_evaluates_true(2, '>=', 1)\n    assert_evaluates_true(1, '<=', 2)\n    assert_evaluates_true(1, '<=', 1)\n    # negative numbers\n    assert_evaluates_true(1, '>', -1)\n    assert_evaluates_true(-1, '<', 1)\n    assert_evaluates_true(1.0, '>', -1.0)\n    assert_evaluates_true(-1.0, '<', 1.0)\n  end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_operators_evalute_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"!=\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<>\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[-1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"int\",\"children\":[-1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"float\",\"children\":[1.0]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[-1.0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"float\",\"children\":[-1.0]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"float\",\"children\":[1.0]}]}]}]}","id":"d043c975-e922-4528-95a1-e9a3c4eb4606"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":27,"raw_source":"def test_add_filter_raises_when_module_privately_overrides_registered_public_methods\n    error = assert_raises(Liquid::MethodOverrideError) do\n      Liquid::Environment.build do |env|\n        env.register_filter(PublicMethodOverrideFilter)\n        env.register_filter(PrivateMethodOverrideFilter)\n      end\n    end\n\n    assert_equal('Liquid error: Filter overrides registered public methods as non public: public_filter', error.message)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_raises_when_module_privately_overrides_registered_public_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MethodOverrideError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PrivateMethodOverrideFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Filter overrides registered public methods as non public: public_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}","id":"890d8d0e-124d-4a7c-b086-87d210d57241"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":653,"raw_source":"def back\n      request.referer\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"back\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"referer\"]}]}","id":"9a5c246d-699f-4326-a77f-9c45ee7c0916"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/slim_test.rb","start_line":7,"raw_source":"def slim_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"slim_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"a02233a4-f60a-4ac2-8489-f5ad4c59d072"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":91,"raw_source":"def and(condition)\n      @child_relation  = :and\n      @child_condition = condition\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"and\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"sym\",\"children\":[\"and\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}]}","id":"c6a6f5ef-a25b-47bb-b04d-52fda17ba2bd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":120,"raw_source":"def origin(env)\n        env['HTTP_ORIGIN'] || env['HTTP_X_ORIGIN']\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"origin\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ORIGIN\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_X_ORIGIN\"]}]}]}]}","id":"edbcc2c5-f282-45b2-9ffe-31ea53a96f9a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":429,"raw_source":"def test_iterate_with_load_slice_when_limit_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '1'\n    template = '{% for item in items limit:1 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(!loader.each_called)\n    assert(loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_when_limit_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items limit:1 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]}]}]}]}","id":"d08d0338-05d9-47b5-9083-8fb950d7bb4a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":132,"raw_source":"def test_catchall_unknown_method\n    output = Liquid::Template.parse(' {{ product.catchall.unknown }} ').render!('product' => ProductDrop.new)\n    assert_equal(' catchall_method: unknown ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_catchall_unknown_method\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.catchall.unknown }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" catchall_method: unknown \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"fc959844-6290-4f8d-a7da-cc8052a24731"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1287,"raw_source":"def test_sum_with_floats_and_indexable_map_values\n    input = [{ \"quantity\" => 1 }, { \"quantity\" => 0.2, \"weight\" => -0.3 }, { \"weight\" => 0.4 }]\n    assert_equal(0.0, @filters.sum(input))\n    assert_equal(1.2, @filters.sum(input, \"quantity\"))\n    assert_equal(0.1, @filters.sum(input, \"weight\"))\n    assert_equal(0.0, @filters.sum(input, \"subtotal\"))\n    assert_template_result(\"0\", \"{{ input | sum }}\", { \"input\" => input })\n    assert_template_result(\"1.2\", \"{{ input | sum: 'quantity' }}\", { \"input\" => input })\n    assert_template_result(\"0.1\", \"{{ input | sum: 'weight' }}\", { \"input\" => input })\n    assert_template_result(\"0\", \"{{ input | sum: 'subtotal' }}\", { \"input\" => input })\n  end","complexity_score":15.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_floats_and_indexable_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"float\",\"children\":[0.2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"float\",\"children\":[0.4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[1.2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"weight\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"subtotal\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1.2\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'quantity' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.1\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'weight' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum: 'subtotal' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}","id":"0bba430f-9469-4c47-a44b-6076f0dc4fef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":105,"raw_source":"def self.token(session, path: nil, method: :post)\n        new(nil).mask_authenticity_token(session, path: path, method: method)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"kwoptarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"method\",{\"type\":\"sym\",\"children\":[\"post\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"nil\",\"children\":[]}]},\"mask_authenticity_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}","id":"b1b9efe6-21ca-48c6-b699-c8f854345f3e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":78,"raw_source":"def mock_app(base=Sinatra::Base, &block)\n    @app = Sinatra.new(base, &block)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"base\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"4a32006c-10a6-4ef4-99d8-592b6b22aabc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":148,"raw_source":"def test_truncate\n    assert_equal('1234...', @filters.truncate('1234567890', 7))\n    assert_equal('1234567890', @filters.truncate('1234567890', 20))\n    assert_equal('...', @filters.truncate('1234567890', 0))\n    assert_equal('1234567890', @filters.truncate('1234567890'))\n    assert_equal(\"测试...\", @filters.truncate(\"测试测试测试测试\", 5))\n    assert_equal('12341', @filters.truncate(\"1234567890\", 5, 1))\n    assert_equal(\"foobar\", @filters.truncate(\"foobar\", 1 << 63))\n    assert_equal(\"...\", @filters.truncate(\"foobar\", -(1 << 63)))\n  end","complexity_score":25.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"测试...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"测试测试测试测试\"]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"12341\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"1234567890\"]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncate\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]}]}]}]}]}","id":"adf866bc-c163-41e9-ab7e-8da0e9df8af5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":260,"raw_source":"def test_render_tag_with_drop\n    assert_template_result(\n      \"TestEnumerable\",\n      \"{% render 'loop' with loop as value %}\",\n      { \"loop\" => TestEnumerable.new },\n      partials: {\n        'loop' => \"{{ value }}\",\n      },\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_with_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"TestEnumerable\"]},{\"type\":\"str\",\"children\":[\"{% render 'loop' with loop as value %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{{ value }}\"]}]}]}]}]}]}]}","id":"f528909b-59f2-4196-9002-552603a72cde"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":520,"raw_source":"def test_sort_calls_to_liquid\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sort: \"whatever\" }}').render(\"foo\" => [t])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sort: \\\"whatever\\\" }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}","id":"5c22f4f4-e58e-427a-8edf-d26c94abec8a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":303,"raw_source":"def test_access_hashes_with_hash_access_variables\n    assigns = {\n      'var' => 'tags',\n      'nested' => { 'var' => 'tags' },\n      'products' => { 'count' => 5, 'tags' => ['deepsnow', 'freestyle'] },\n    }\n\n    assert_template_result('deepsnow', '{{ products[var].first }}', assigns)\n    assert_template_result('freestyle', '{{ products[nested.var].last }}', assigns)\n  end","complexity_score":3.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_hashes_with_hash_access_variables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"tags\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"tags\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"tags\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"freestyle\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[var].first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"freestyle\"]},{\"type\":\"str\",\"children\":[\"{{ products[nested.var].last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"5d0f7c5b-e16b-49e6-b745-e4e63b69507b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":97,"raw_source":"def json(object, options = {})\n      content_type resolve_content_type(options)\n      resolve_encoder_action object, resolve_encoder(options)\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"json\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"send\",\"children\":[null,\"resolve_content_type\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"send\",\"children\":[null,\"resolve_encoder_action\",{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"send\",\"children\":[null,\"resolve_encoder\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}","id":"0da276e9-8c77-4485-b0f7-0b2ab30926a8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":28,"raw_source":"def test_tag_render_to_output_buffer_nil_value\n    custom_tag = CustomTag.parse(\"some_tag\", \"\", new_tokenizer, ParseContext.new)\n    assert_equal('some string', custom_tag.render_to_output_buffer(Context.new, \"some string\"))\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_render_to_output_buffer_nil_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"custom_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CustomTag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"some_tag\"]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"some string\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"custom_tag\"]},\"render_to_output_buffer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]},{\"type\":\"str\",\"children\":[\"some string\"]}]}]}]}]}","id":"d7fba0cd-0e3e-418a-bb00-7c08ed93b0aa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":195,"raw_source":"def test_case_on_length_with_else\n    assert_template_result(\n      'else',\n      '{% case a.empty? %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'false',\n      '{% case false %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'true',\n      '{% case true %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n\n    assert_template_result(\n      'else',\n      '{% case NULL %}{% when true %}true{% when false %}false{% else %}else{% endcase %}',\n      {},\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_length_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case a.empty? %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% case true %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"else\"]},{\"type\":\"str\",\"children\":[\"{% case NULL %}{% when true %}true{% when false %}false{% else %}else{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}","id":"d739289d-dd89-42c8-a410-df65597fb42d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1104,"raw_source":"def test_where_no_key_set\n    input = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    expectation = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    assert_equal(expectation, @filters.where(input, \"ok\", true))\n    assert_equal(expectation, @filters.where(input, \"ok\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_no_key_set\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}","id":"a063680e-6559-4809-93f1-e217cad336e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":284,"raw_source":"def test_for_with_continue\n    assigns = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n\n    markup   = '{% for i in array.items %}{% continue %}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% continue %}{% endfor %}'\n    expected = \"12345\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% continue %}{{ i }}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% if i > 3 %}{% continue %}{% endif %}{{ i }}{% endfor %}'\n    expected = \"123\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% if i == 3 %}{% continue %}{% else %}{{ i }}{% endif %}{% endfor %}'\n    expected = \"1245\"\n    assert_template_result(expected, markup, assigns)\n\n    # tests to ensure it only continues the local for loop and not all of them.\n    assigns  = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    markup   = '{% for item in array %}' \\\n               '{% for i in item %}' \\\n                 '{% if i == 1 %}' \\\n                   '{% continue %}' \\\n                 '{% endif %}' \\\n                 '{{ i }}' \\\n               '{% endfor %}' \\\n             '{% endfor %}'\n    expected = '23456'\n    assert_template_result(expected, markup, assigns)\n\n    # test continue does nothing when unreached\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n    markup   = '{% for i in array.items %}{% if i == 9999 %}{% continue %}{% endif %}{{ i }}{% endfor %}'\n    expected = '12345'\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":28.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_continue\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% continue %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% continue %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% continue %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i > 3 %}{% continue %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 3 %}{% continue %}{% else %}{{ i }}{% endif %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1245\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for item in array %}\"]},{\"type\":\"str\",\"children\":[\"{% for i in item %}\"]},{\"type\":\"str\",\"children\":[\"{% if i == 1 %}\"]},{\"type\":\"str\",\"children\":[\"{% continue %}\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\"]},{\"type\":\"str\",\"children\":[\"{{ i }}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"23456\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 9999 %}{% continue %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"8dbc9f38-cfe9-4f95-b584-2b756b138d68"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":47,"raw_source":"def test_case_tag_calls_to_liquid_value\n    assert_template_result('One', '{% case foo %}{% when 1 %}One{% endcase %}', { 'foo' => IntegerDrop.new('1') })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"One\"]},{\"type\":\"str\",\"children\":[\"{% case foo %}{% when 1 %}One{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]}]}","id":"48985e07-89b6-4b77-bfcf-ad9432ee53b9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":830,"raw_source":"def test_default\n    assert_equal(\"foo\", @filters.default(\"foo\", \"bar\"))\n    assert_equal(\"bar\", @filters.default(nil, \"bar\"))\n    assert_equal(\"bar\", @filters.default(\"\", \"bar\"))\n    assert_equal(\"bar\", @filters.default(false, \"bar\"))\n    assert_equal(\"bar\", @filters.default([], \"bar\"))\n    assert_equal(\"bar\", @filters.default({}, \"bar\"))\n    assert_template_result('bar', \"{{ false | default: 'bar' }}\")\n    assert_template_result('bar', \"{{ drop | default: 'bar' }}\", { 'drop' => BooleanDrop.new(false) })\n    assert_template_result('Yay', \"{{ drop | default: 'bar' }}\", { 'drop' => BooleanDrop.new(true) })\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ false | default: 'bar' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}","id":"67567a1c-c1ac-43a8-a1f7-971877e01803"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":106,"raw_source":"def test_case_left\n    assert_equal(\n      [\"test\"],\n      visit(%({% case test %}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_left\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case test %}{% endcase %}\"]}]}]}]}","id":"67c8c700-e9b2-43b8-b3f7-b66ad7273ce9"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/weight_filter.rb","start_line":4,"raw_source":"def weight(grams)\n    format(\"%.2f\", grams / 1000)\n  end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"weight\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"grams\"]}]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"%.2f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"grams\"]},\"/\",{\"type\":\"int\",\"children\":[1000]}]}]}]}","id":"538e0f6e-51f2-48eb-a859-fa0187d2161c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":77,"raw_source":"def test_doc_tag_ignores_unclosed_liquid_tags\n    template = <<~LIQUID.chomp\n      {% doc %}\n        {% if true %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_ignores_unclosed_liquid_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"0dec7721-a230-4386-bdea-b9d1f7c2ccf6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":115,"raw_source":"def priority\n        # We sort in descending order; better matches should be higher.\n        [@q, -@type.count('*'), @params.size]\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"priority\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@q\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@type\"]},\"count\",{\"type\":\"str\",\"children\":[\"*\"]}]},\"-@\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"size\"]}]}]}","id":"af993002-629f-43c4-8d30-80d99456df4e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":67,"raw_source":"def put(*args, &block)      super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"put\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"35b6dd78-5f31-41c8-ae81-17c7a54c1d0c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":97,"raw_source":"def test_integer\n    var = create_variable(%( 1000 ))\n    assert_equal(1000, var.name)\n  end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_integer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 1000 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1000]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"134bf739-f64b-4223-b2ce-01e2b245fd75"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1654,"raw_source":"def prototype\n        @prototype ||= new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prototype\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@prototype\"]},{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}","id":"082d94e5-1610-45ed-bae5-36304fb3cea0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":269,"raw_source":"def check_overflow\n      raise StackLevelError, \"Nesting too deep\" if overflow?\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"check_overflow\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"overflow?\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]}]}","id":"5d285366-fe6d-4f32-9948-5c464deead03"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":247,"raw_source":"def self.perform(klass)\n      reloaded_paths = []\n      Watcher::List.for(klass).updated.each do |watcher|\n        klass.set(:inline_templates, watcher.path) if watcher.inline_templates?\n        watcher.elements.each { |element| klass.deactivate(element) }\n        # Deletes all old elements.\n        watcher.elements.delete_if { true }\n        $LOADED_FEATURES.delete(watcher.path)\n        require watcher.path\n        watcher.update\n        reloaded_paths << watcher.path\n      end\n      return if reloaded_paths.empty?\n\n      @@after_reload.each do |block|\n        block.arity.zero? ? block.call : block.call(reloaded_paths)\n      end\n      # Prevents after_reload from increasing each time it's reloaded.\n      @@after_reload.delete_if do |blk|\n        path, = blk.source_location\n        path && reloaded_paths.include?(path)\n      end\n    end","complexity_score":46.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"perform\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"reloaded_paths\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"List\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},\"updated\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"watcher\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"inline_templates?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"elements\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"deactivate\",{\"type\":\"lvar\",\"children\":[\"element\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"elements\"]},\"delete_if\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$LOADED_FEATURES\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"update\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"watcher\"]},\"path\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@after_reload\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@after_reload\"]},\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"blk\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blk\"]},\"source_location\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reloaded_paths\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}]}]}]}","id":"17f4862d-93da-49e3-8fba-865da316ba56"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":78,"raw_source":"def test_elsif_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{% elsif test %}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_elsif_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{% elsif test %}{% endif %}\"]}]}]}]}","id":"ab97d08f-521a-414d-8a6a-53f652016d71"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":82,"raw_source":"def test_assign_score_of_string_counts_bytes\n    assert_equal(3, assign_score_of('123'))\n    assert_equal(5, assign_score_of('12345'))\n    assert_equal(9, assign_score_of('すごい'))\n  end","complexity_score":7.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_string_counts_bytes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"123\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"12345\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"str\",\"children\":[\"すごい\"]}]}]}]}]}","id":"5b7e31df-7f96-4e87-955b-a8593ec95264"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":221,"raw_source":"def test_assign_from_case\n    # Example from the shopify forums\n    code = \"{% case collection.handle %}{% when 'menswear-jackets' %}{% assign ptitle = 'menswear' %}{% when 'menswear-t-shirts' %}{% assign ptitle = 'menswear' %}{% else %}{% assign ptitle = 'womenswear' %}{% endcase %}{{ ptitle }}\"\n    assert_template_result(\"menswear\",   code, { \"collection\" => { 'handle' => 'menswear-jackets' } })\n    assert_template_result(\"menswear\",   code, { \"collection\" => { 'handle' => 'menswear-t-shirts' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'x' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'y' } })\n    assert_template_result(\"womenswear\", code, { \"collection\" => { 'handle' => 'z' } })\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_from_case\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case collection.handle %}{% when 'menswear-jackets' %}{% assign ptitle = 'menswear' %}{% when 'menswear-t-shirts' %}{% assign ptitle = 'menswear' %}{% else %}{% assign ptitle = 'womenswear' %}{% endcase %}{{ ptitle }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"menswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"menswear-jackets\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"menswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"menswear-t-shirts\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"x\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"y\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"womenswear\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"z\"]}]}]}]}]}]}]}]}","id":"04f00f92-6b46-4dac-97b8-5169ca8bf8b9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":89,"raw_source":"def initialize(environment: Environment.default)\n      @environment = environment\n      @rethrow_errors  = false\n      @resource_limits = ResourceLimits.new(environment.default_resource_limits)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@resource_limits\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"default_resource_limits\"]}]}]}]}]}","id":"6bccceb9-f27a-4756-8f9d-bf9f3a2230af"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":59,"raw_source":"def render_to_output_buffer(context, output)\n      render_result = render(context)\n      output << render_result if render_result\n      output\n    end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"render_result\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"render_result\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"daab222e-b3c9-4fe8-a9e9-3bcc88c2b779"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_async_helper.rb","start_line":13,"raw_source":"def self.extend_object(obj)\n    super\n\n    base_port = 5100 + Process.pid % 100\n    servers = %w(puma)\n\n    servers.each_with_index do |server, index|\n      Server.run(server, base_port+index, async: true)\n    end\n  end","complexity_score":10.65,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extend_object\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"base_port\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[5100]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"pid\"]},\"%\",{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"servers\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"puma\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"each_with_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_port\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"async\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}","id":"00fedf25-6d10-4a29-950a-ce794801f505"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":42,"raw_source":"def build(tags: nil, file_system: nil, error_mode: nil, exception_renderer: nil)\n        ret = new\n        ret.tags = tags if tags\n        ret.file_system = file_system if file_system\n        ret.error_mode = error_mode if error_mode\n        ret.exception_renderer = exception_renderer if exception_renderer\n        yield ret if block_given?\n        ret.freeze\n      end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"tags\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"file_system\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"exception_renderer\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ret\",{\"type\":\"send\",\"children\":[null,\"new\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"tags=\",{\"type\":\"lvar\",\"children\":[\"tags\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"file_system=\",{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"error_mode\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"exception_renderer=\",{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ret\"]},\"freeze\"]}]}]}","id":"b89341da-dd9e-4b5c-984b-4b9505ee0533"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":991,"raw_source":"def test_find_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign product = products | find: 'title.content', 'Not found' -%}\n      {%- unless product -%}\n        Product not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Product not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign product = products | find: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless product -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Product not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Product not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}","id":"374ceab6-2395-4183-b643-5d22db55eb5a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1064,"raw_source":"def test_where_with_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok', true | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok', true | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"42fbaa96-6c71-4302-a7e8-3164078b222c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":53,"raw_source":"def test_second_filter_overwrites_first\n    @context['var'] = 1000\n    @context.add_filters(MoneyFilter)\n    @context.add_filters(CanadianMoneyFilter)\n\n    assert_equal(' 1000$ CAD ', Template.parse(\"{{var | money}}\").render(@context))\n  end","complexity_score":6.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_second_filter_overwrites_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | money}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}","id":"7e1f0bfa-ead1-4183-9a13-b18cad3678ec"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":63,"raw_source":"def rindex0\n      @length - @index - 1\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"rindex0\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@index\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}","id":"29a7b9a6-139e-42a2-95ea-643b3050644c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":30,"raw_source":"def self.teardown(&block)  teardown_blocks << block  end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"teardown\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"teardown_blocks\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}","id":"60a503d2-b5d0-4276-a196-4049ab80b4f0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":64,"raw_source":"def partial_options\n      @partial_options ||= begin\n        dont_pass = @template_options[:include_options_blacklist]\n        if dont_pass == true\n          { locale: locale }\n        elsif dont_pass.is_a?(Array)\n          @template_options.reject { |k, _v| dont_pass.include?(k) }\n        else\n          @template_options\n        end\n      end\n    end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"partial_options\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@partial_options\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"dont_pass\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"include_options_blacklist\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]},{\"type\":\"send\",\"children\":[null,\"locale\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_options\"]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"dont_pass\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"ivar\",\"children\":[\"@template_options\"]}]}]}]}]}]}","id":"0ee7aa69-db80-4c78-b9f6-4cafec2c4164"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":417,"raw_source":"def test_legacy_sort_hash\n    assert_equal([{ a: 1, b: 2 }], @filters.sort(a: 1, b: 2))\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_sort_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}","id":"4a5c3ba1-a990-47b9-9a0a-7a711578bd67"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":53,"raw_source":"def new_tokenizer(source, parse_context: Liquid::ParseContext.new, start_line_number: nil)\n    parse_context.new_tokenizer(source, start_line_number: start_line_number)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_tokenizer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]},{\"type\":\"kwoptarg\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"kwoptarg\",\"children\":[\"start_line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"start_line_number\"]},{\"type\":\"lvar\",\"children\":[\"start_line_number\"]}]}]}]}]}","id":"7fa5b21c-a3d8-4c63-a19d-6a1251260a50"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":167,"raw_source":"def test_escape\n    assert_equal('&lt;strong&gt;', @filters.escape('<strong>'))\n    assert_equal('1', @filters.escape(1))\n    assert_equal('2001-02-03', @filters.escape(Date.new(2001, 2, 3)))\n    assert_nil(@filters.escape(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_escape\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"str\",\"children\":[\"<strong>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"5502ebf9-70da-4d25-a485-0255a07189e5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":82,"raw_source":"def unlink?\n      request_method == 'UNLINK'\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"UNLINK\"]}]}]}","id":"2782b119-abd3-4ae5-9eb5-b872f71bd352"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":850,"raw_source":"def modulo(input, operand)\n      apply_operation(input, operand, :%)\n    rescue ::ZeroDivisionError => e\n      raise Liquid::ZeroDivisionError, e.message\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"modulo\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"%\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ZeroDivisionError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}","id":"5c17a7b6-3e3e-459f-a3d6-f78ce8694ede"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":97,"raw_source":"def test_profiling_times_the_rendering_of_tokens\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    node = t.profiler[0]\n    refute_nil(node.render_time)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_times_the_rendering_of_tokens\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"render_time\"]}]}]}]}","id":"b56544e5-4060-4104-8c61-55ab8b9c4c8e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":56,"raw_source":"def assoc(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"dab76dc0-312c-4488-8d65-237b6558e0a3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/liquid_tag_test.rb","start_line":79,"raw_source":"def test_line_number_is_correct_after_a_blank_token\n    assert_match_syntax_error(\"syntax error (line 3): Unknown tag 'error'\", \"{% liquid echo ''\\n\\n error %}\")\n    assert_match_syntax_error(\"syntax error (line 3): Unknown tag 'error'\", \"{% liquid echo ''\\n  \\n error %}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_line_number_is_correct_after_a_blank_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{% liquid echo ''\\n\\n error %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"syntax error (line 3): Unknown tag 'error'\"]},{\"type\":\"str\",\"children\":[\"{% liquid echo ''\\n  \\n error %}\"]}]}]}]}","id":"aceee41e-bdaf-44a1-b013-b6ef7e43bd21"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1310,"raw_source":"def test_uniq_with_to_liquid_value\n    input = [StringDrop.new(\"foo\"), StringDrop.new(\"bar\"), \"foo\"]\n    expected = [StringDrop.new(\"foo\"), StringDrop.new(\"bar\")]\n    result = @filters.uniq(input)\n\n    assert_equal(expected, result)\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_with_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"fabb1bd4-1996-4b83-8fe8-3f19eae5e6fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":61,"raw_source":"def test_filters_without_whitespace\n    var = create_variable('hello | textileze | paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable('hello|textileze|paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable(\"hello|replace:'foo','bar'|textileze\")\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['replace', ['foo', 'bar']], ['textileze', []]], var.filters)\n  end","complexity_score":22.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filters_without_whitespace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze | paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello|textileze|paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello|replace:'foo','bar'|textileze\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"replace\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"1b3e3217-b276-4649-890b-c2128bd2d3b0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":242,"raw_source":"def test_nil_value_access\n    assert_equal('', Liquid::Template.parse('{{ product[value] }}').render!('product' => ProductDrop.new, 'value' => nil))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_value_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product[value] }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"c59659c0-9fb0-4d5e-99e9-4cc0cb26194f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":248,"raw_source":"def abbrev(s)\n    t = s[0,10]\n    p = t['`']\n    t = t[0,p] if p\n    t = t + '...' if t.length < s.length\n    '`' + t + '`'\n  end","complexity_score":16.3,"ast_json":"{\"type\":\"def\",\"children\":[\"abbrev\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"[]\",{\"type\":\"str\",\"children\":[\"`\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"length\"]},\"<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"+\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"`\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"t\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"`\"]}]}]}]}","id":"74b4d259-c257-494b-9bb4-1d9a4e67e93f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":52,"raw_source":"def default=(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"default=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"66168a62-0730-41a5-a408-eafea3aa4cf7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":49,"raw_source":"def initialize(root, pattern = \"_%s.liquid\")\n      @root    = root\n      @pattern = pattern\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"root\"]},{\"type\":\"optarg\",\"children\":[\"pattern\",{\"type\":\"str\",\"children\":[\"_%s.liquid\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@root\",{\"type\":\"lvar\",\"children\":[\"root\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pattern\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}","id":"7927c417-ebc1-499a-a252-d78e77c01f99"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":486,"raw_source":"def test_map_doesnt_call_arbitrary_stuff\n    assert_template_result(\"\", '{{ \"foo\" | map: \"__id__\" }}')\n    assert_template_result(\"\", '{{ \"foo\" | map: \"inspect\" }}')\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_doesnt_call_arbitrary_stuff\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"foo\\\" | map: \\\"__id__\\\" }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"foo\\\" | map: \\\"inspect\\\" }}\"]}]}]}]}","id":"17d750f0-317d-4050-87b2-05e9af619725"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":35,"raw_source":"def assert_template_result(\n      expected, template, assigns = {},\n      message: nil, partials: nil, error_mode: nil, render_errors: false,\n      template_factory: nil\n    )\n      file_system = StubFileSystem.new(partials || {})\n      environment = Liquid::Environment.build(file_system: file_system)\n      template = Liquid::Template.parse(template, line_numbers: true, error_mode: error_mode&.to_sym, environment: environment)\n      registers = Liquid::Registers.new(file_system: file_system, template_factory: template_factory)\n      context = Liquid::Context.build(static_environments: assigns, rethrow_errors: !render_errors, registers: registers, environment: environment)\n      output = template.render(context)\n      assert_equal(expected, output, message)\n    end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_template_result\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expected\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"message\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"partials\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"error_mode\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"render_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"template_factory\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_mode\"]},\"to_sym\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_errors\"]},\"!\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}","id":"92408f0b-f9fe-4081-9163-f7d4ee40b97a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":17,"raw_source":"def with_process(command:, env: {}, debug: false)\n    process = ChildProcess.build(*command)\n    process.leader = true # ensure entire process tree dies\n    process.environment.merge!(env)\n    read_io, write_io = IO.pipe\n    process.io.stdout = write_io\n    process.io.stderr = write_io\n    process.start\n    # Close parent's copy of the write end of the pipe so when the (forked) child\n    # process closes its write end of the pipe the parent receives EOF when\n    # attempting to read from it. If the parent leaves its write end open, it\n    # will not detect EOF.\n    write_io.close\n\n    echo_output(read_io) if debug || debug_all?\n\n    yield process, read_io\n  ensure\n    read_io.close\n    process.stop\n  end","complexity_score":24.6,"ast_json":"{\"type\":\"def\",\"children\":[\"with_process\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"command\"]},{\"type\":\"kwoptarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"debug\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"process\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ChildProcess\"]},\"build\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"leader=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"environment\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"read_io\"]},{\"type\":\"lvasgn\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IO\"]},\"pipe\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"io\"]},\"stdout=\",{\"type\":\"lvar\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"io\"]},\"stderr=\",{\"type\":\"lvar\",\"children\":[\"write_io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"write_io\"]},\"close\"]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"debug\"]},{\"type\":\"send\",\"children\":[null,\"debug_all?\"]}]},{\"type\":\"send\",\"children\":[null,\"echo_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]}]},null]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},{\"type\":\"lvar\",\"children\":[\"read_io\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"close\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"process\"]},\"stop\"]}]}]}]}","id":"369d03df-4155-4914-b8aa-f447d446a658"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":43,"raw_source":"def mirror(&block)\n    mirror = Mirror.new\n    Sinatra::Delegator.target = mirror\n    delegate(&block)\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mirror\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"mirror\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mirror\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target=\",{\"type\":\"lvar\",\"children\":[\"mirror\"]}]},{\"type\":\"send\",\"children\":[null,\"delegate\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"ae70cf9b-37d2-41a8-80d4-cc224b4cda98"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":786,"raw_source":"def markdown(template, options = {}, locals = {})\n      options[:exclude_outvar] = true\n      render :markdown, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"markdown\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"markdown\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"c2536669-506c-4a99-a635-550638c82ff3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":339,"raw_source":"def test_illegal_symbols\n    assert_template_result('', '{% if true == empty %}?{% endif %}', {})\n    assert_template_result('', '{% if true == null %}?{% endif %}', {})\n    assert_template_result('', '{% if empty == true %}?{% endif %}', {})\n    assert_template_result('', '{% if null == true %}?{% endif %}', {})\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_illegal_symbols\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true == empty %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true == null %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if empty == true %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null == true %}?{% endif %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}","id":"3e5e6523-8fd3-4acd-bdb1-0a7494ca5122"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1543,"raw_source":"def post(path, opts = {}, &block)    route 'POST',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"post\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"POST\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"16263c6f-33d1-47b2-93ab-62902714a905"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":34,"raw_source":"def initialize(tag_name, markup, tokens)\n    markup =~ Syntax\n    @template_name = Regexp.last_match(1)\n    super\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"93953974-5298-4049-af97-24e299a80261"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":146,"raw_source":"def render_segment(context, output, segment)\n      for_stack = context.registers[:for_stack] ||= []\n      length    = segment.length\n\n      context.stack do\n        loop_vars = Liquid::ForloopDrop.new(@name, length, for_stack[-1])\n\n        for_stack.push(loop_vars)\n\n        begin\n          context['forloop'] = loop_vars\n\n          segment.each do |item|\n            context[@variable_name] = item\n            @for_block.render_to_output_buffer(context, output)\n            loop_vars.send(:increment!)\n\n            # Handle any interrupts if they exist.\n            next unless context.interrupt?\n            interrupt = context.pop_interrupt\n            break if interrupt.is_a?(BreakInterrupt)\n            next if interrupt.is_a?(ContinueInterrupt)\n          end\n        ensure\n          for_stack.pop\n        end\n      end\n\n      output\n    end","complexity_score":35.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_segment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"segment\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"for_stack\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for_stack\"]}]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"length\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"stack\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loop_vars\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ForloopDrop\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@name\"]},{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"[]\",{\"type\":\"int\",\"children\":[-1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"loop_vars\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"forloop\"]},{\"type\":\"lvar\",\"children\":[\"loop_vars\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"lvar\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_block\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loop_vars\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"interrupt\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"pop_interrupt\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BreakInterrupt\"]}]},{\"type\":\"break\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"interrupt\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"ContinueInterrupt\"]}]},{\"type\":\"next\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"for_stack\"]},\"pop\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"b5501935-d597-4f8a-8fb6-2482486102ef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":818,"raw_source":"def teardown\n      File.unlink @file\n      @file = nil\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"unlink\",{\"type\":\"ivar\",\"children\":[\"@file\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@file\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"aa8a3a0c-805d-4f69-a655-e4024165f4bc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":46,"raw_source":"def run\n      return unless installed?\n      kill\n      @log     = +\"\"\n      super\n      at_exit { kill }\n    end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"installed?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"kill\"]},{\"type\":\"ivasgn\",\"children\":[\"@log\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"at_exit\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"kill\"]}]}]}]}","id":"f29ca036-c007-47b3-895f-464aeb7ffcd0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":8,"raw_source":"def setup\n    @i18n = I18n.new(fixture(\"en_locale.yml\"))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@i18n\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]}]}]}]}","id":"ce90a340-2bc6-4183-b1c9-fff19b58dc9c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":808,"raw_source":"def slim(template, options = {}, locals = {}, &block)\n      render(:slim, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"slim\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"slim\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"2ab86a6c-9a27-44e7-a365-daa962024ee9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1269,"raw_source":"def test_sum_of_negative_floats\n    input = [0.1, 0.2, -0.3]\n    assert_equal(0.0, @filters.sum(input))\n    assert_template_result(\"0.0\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":4.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_of_negative_floats\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.0\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}","id":"946bdd22-f183-4d40-8c73-289efdde8aee"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":256,"raw_source":"def shift\n        key, value = to_hash.shift\n        delete(key)\n        [key, value]\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"shift\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"967716b6-53c1-4cdd-a719-d234b8febd30"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/file_system_unit_test.rb","start_line":14,"raw_source":"def test_local\n    file_system = Liquid::LocalFileSystem.new(\"/some/path\")\n    assert_equal(\"/some/path/_mypartial.liquid\", file_system.full_path(\"mypartial\"))\n    assert_equal(\"/some/path/dir/_mypartial.liquid\", file_system.full_path(\"dir/mypartial\"))\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"../dir/mypartial\")\n    end\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"/dir/../../dir/mypartial\")\n    end\n\n    assert_raises(FileSystemError) do\n      file_system.full_path(\"/etc/passwd\")\n    end\n  end","complexity_score":15.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"LocalFileSystem\"]},\"new\",{\"type\":\"str\",\"children\":[\"/some/path\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/_mypartial.liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"mypartial\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"/some/path/dir/_mypartial.liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"../dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"/dir/../../dir/mypartial\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"full_path\",{\"type\":\"str\",\"children\":[\"/etc/passwd\"]}]}]}]}]}","id":"700e91a6-437b-4d28-b5a6-668b5e428b4a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":185,"raw_source":"def test_base64_encode\n    assert_equal('b25lIHR3byB0aHJlZQ==', @filters.base64_encode('one two three'))\n    assert_equal('', @filters.base64_encode(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_encode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b25lIHR3byB0aHJlZQ==\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_encode\",{\"type\":\"str\",\"children\":[\"one two three\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_encode\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"541b54d0-4cfe-4c57-91c1-bdf2472b1825"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1488,"raw_source":"def before(path = /.*/, **options, &block)\n        add_filter(:before, path, **options, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"before\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\".*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"add_filter\",{\"type\":\"sym\",\"children\":[\"before\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"e2e3023a-69d7-447e-950d-becc08bf4e47"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":142,"raw_source":"def test_text_array_drop\n    output = Liquid::Template.parse('{% for text in product.texts.array %} {{text}} {% endfor %}').render!('product' => ProductDrop.new)\n    assert_equal(' text1  text2 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_text_array_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for text in product.texts.array %} {{text}} {% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" text1  text2 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"0adc9b98-fe35-4e13-9334-a75a93feccac"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":232,"raw_source":"def test_include_for\n    assert_equal(\n      [\"test\"],\n      visit(%({% include \"hai\" for test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_for\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% include \\\"hai\\\" for test %}\"]}]}]}]}","id":"37598459-17c2-4618-b1bb-b2b67e6352f8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":25,"raw_source":"def self.call(env)\n      Thread.current[:last_env] = env\n      [200, { 'content-type' => 'application/json' }, body]\n    end","complexity_score":3.25,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"last_env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"application/json\"]}]}]},{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}","id":"3693b010-3595-4d79-97c3-219fee0bdca0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":15,"raw_source":"def each(&block)\n      @array.each(&block)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@array\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"23afa6fd-e597-49a9-b57d-0b6a974902cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":16,"raw_source":"def test_assigned_variable\n    assert_template_result(\n      '.foo.',\n      '{% assign foo = values %}.{{ foo[0] }}.',\n      { 'values' => %w(foo bar baz) },\n    )\n\n    assert_template_result(\n      '.bar.',\n      '{% assign foo = values %}.{{ foo[1] }}.',\n      { 'values' => %w(foo bar baz) },\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigned_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".foo.\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = values %}.{{ foo[0] }}.\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"values\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\".bar.\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = values %}.{{ foo[1] }}.\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"values\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]}]}]}]}","id":"e335d917-049c-4e57-9dcb-0c072340edb4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1257,"raw_source":"def test_sum_with_property_calls_to_liquid_on_property_values\n    t = TestThing.new\n    Liquid::Template.parse('{{ foo | sum: \"quantity\" }}').render(\"foo\" => [{ \"quantity\" => t }])\n    assert(t.foo > 0)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_property_calls_to_liquid_on_property_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | sum: \\\"quantity\\\" }}\"]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"lvar\",\"children\":[\"t\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"foo\"]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}","id":"781e5dd1-3931-4ae5-a77b-20c580a7d1eb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":151,"raw_source":"def transform_values(&block)\n      dup.transform_values!(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_values\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"transform_values!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"c3af9bd6-cb53-4533-937d-6977c92baeb9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":48,"raw_source":"def self.to_number(obj)\n      case obj\n      when Float\n        BigDecimal(obj.to_s)\n      when Numeric\n        obj\n      when String\n        /\\A-?\\d+\\.\\d+\\z/.match?(obj.strip) ? BigDecimal(obj) : obj.to_i\n      else\n        if obj.respond_to?(:to_number)\n          obj.to_number\n        else\n          0\n        end\n      end\n    end","complexity_score":16.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_number\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Float\"]},{\"type\":\"send\",\"children\":[null,\"BigDecimal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Numeric\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A-?\\\\d+\\\\.\\\\d+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"strip\"]}]},{\"type\":\"send\",\"children\":[null,\"BigDecimal\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_i\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_number\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"5cb68f2c-3117-45fb-affb-bf4f3754775f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1021,"raw_source":"def test_find_index_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign index = products | find_index: 'title.content', 'Not found' -%}\n      {%- unless index -%}\n        Index not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Index not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign index = products | find_index: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless index -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Index not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Index not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}","id":"bce46a42-b2a3-40f4-808a-c1923a4cca75"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":468,"raw_source":"def test_access_to_context_from_proc\n    @context.registers[:magic] = 345392\n\n    @context['magic'] = proc { @context.registers[:magic] }\n\n    assert_equal(345392, @context['magic'])\n  end","complexity_score":10.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_to_context_from_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"magic\"]},{\"type\":\"int\",\"children\":[345392]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"magic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"magic\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[345392]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"magic\"]}]}]}]}]}","id":"2b85635e-6c03-495b-b9fe-0b0888c33256"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":13,"raw_source":"def self.slice_collection_using_each(collection, from, to)\n      segments = []\n      index    = 0\n\n      # Maintains Ruby 1.8.7 String#each behaviour on 1.9\n      if collection.is_a?(String)\n        return collection.empty? ? [] : [collection]\n      end\n      return [] unless collection.respond_to?(:each)\n\n      collection.each do |item|\n        if to && to <= index\n          break\n        end\n\n        if from <= index\n          segments << item\n        end\n\n        index += 1\n      end\n\n      segments\n    end","complexity_score":20.35,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"slice_collection_using_each\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]},{\"type\":\"arg\",\"children\":[\"from\"]},{\"type\":\"arg\",\"children\":[\"to\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"segments\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"index\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"to\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"index\"]}]}]},{\"type\":\"break\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"<=\",{\"type\":\"lvar\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segments\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"item\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvar\",\"children\":[\"segments\"]}]}]}","id":"29f2b637-ad7e-4dc1-90b6-1616ff63b38a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":58,"raw_source":"def proppatch?\n        request_method == 'PROPPATCH'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"proppatch?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"PROPPATCH\"]}]}]}","id":"4f5ec468-8e03-4f65-8428-77759b5242ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":167,"raw_source":"def test_double_nested_variable_lookup\n    assert_template_result(\n      'bar',\n      '{{ list[list[settings.zero]][\"foo\"] }}',\n      {\n        'list' => [1, { 'foo' => 'bar' }],\n        'settings' => SettingsDrop.new(\"zero\" => 0),\n        'bar' => 'foo',\n      },\n    )\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_double_nested_variable_lookup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{ list[list[settings.zero]][\\\"foo\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"list\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"settings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SettingsDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"zero\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}","id":"8d3b6652-cad8-407b-a3df-b8123df21313"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":717,"raw_source":"def with_params(temp_params)\n      original = @params\n      @params = temp_params\n      yield\n    ensure\n      @params = original if original\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"temp_params\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original\",{\"type\":\"ivar\",\"children\":[\"@params\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"lvar\",\"children\":[\"temp_params\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"original\"]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"lvar\",\"children\":[\"original\"]}]},null]}]}]}","id":"e1aad8d1-bfd9-4d83-a2d8-2a05a8ba9d06"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":66,"raw_source":"def register_filter(mod)\n        Deprecations.warn(\"Template.register_filter\", \"Environment#register_filter\")\n        Environment.default.register_filter(mod)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"register_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mod\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.register_filter\"]},{\"type\":\"str\",\"children\":[\"Environment#register_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"register_filter\",{\"type\":\"lvar\",\"children\":[\"mod\"]}]}]}]}","id":"de5f0f59-e89a-4e7b-9810-d3e4399c9369"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":22,"raw_source":"def call(env)\n        status, headers, body = super\n        response = Rack::Response.new(body, status, headers)\n        request = Rack::Request.new(env)\n        remove_bad_cookies(request, response)\n        response.finish\n      end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"response\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Response\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"body\"]},{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"remove_bad_cookies\",{\"type\":\"lvar\",\"children\":[\"request\"]},{\"type\":\"lvar\",\"children\":[\"response\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response\"]},\"finish\"]}]}]}","id":"e422ac94-db80-4f63-8ffe-604f9a757134"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":68,"raw_source":"def variables_from_string(markup)\n      markup.split(',').collect do |var|\n        var =~ /\\s*(#{QuotedFragment})\\s*/o\n        next unless Regexp.last_match(1)\n\n        # Expression Parser returns cached objects, and we need to dup them to\n        # start the cycle over for each new cycle call.\n        # Liquid-C does not have a cache, so we don't need to dup the object.\n        var = parse_expression(Regexp.last_match(1))\n        var.is_a?(VariableLookup) ? var.dup : var\n      end.compact\n    end","complexity_score":17.15,"ast_json":"{\"type\":\"def\",\"children\":[\"variables_from_string\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"collect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]},{\"type\":\"str\",\"children\":[\")\\\\s*\"]},{\"type\":\"regopt\",\"children\":[\"o\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"dup\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]}]}]},\"compact\"]}]}","id":"395fb9ef-efc3-42aa-b550-1b80fdcd2ee3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":234,"raw_source":"def test_merge\n    @context.merge(\"test\" => \"test\")\n    assert_equal('test', @context['test'])\n    @context.merge(\"test\" => \"newvalue\", \"foo\" => \"bar\")\n    assert_equal('newvalue', @context['test'])\n    assert_equal('bar', @context['foo'])\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"newvalue\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"newvalue\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}","id":"3a9a2ef7-99db-4603-92d2-469b53213b23"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":324,"raw_source":"def app\n        base.respond_to?(:base) ? base.base : base\n      end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"app\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"base\"]},{\"type\":\"send\",\"children\":[null,\"base\"]}]}]}","id":"e6469972-cf2f-4673-befd-bb97a2e3aa80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":303,"raw_source":"def disable(*opts)\n        opts.each { |key| set(key, false) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"disable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"bddfb3aa-cb64-4e37-a957-ad754af1e69a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":126,"raw_source":"def method_missing(method, *args, &block)\n        return super if args.any? || block.nil? || !@app.mime_type(method)\n\n        on(method, &block)\n      end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"nil?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"mime_type\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"on\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"f839eb5d-468a-4874-88b9-348061aed0e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":45,"raw_source":"def filter_methods\n        @filter_methods ||= Set.new\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"filter_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filter_methods\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Set\"]},\"new\"]}]}]}","id":"98752263-4a4d-4834-870c-addef8287340"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":122,"raw_source":"def test_comparisons_on_null\n    assert_template_result('', '{% if null < 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null <= 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null >= 10 %} NO {% endif %}')\n    assert_template_result('', '{% if null > 10 %} NO {% endif %}')\n\n    assert_template_result('', '{% if 10 < null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 <= null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 >= null %} NO {% endif %}')\n    assert_template_result('', '{% if 10 > null %} NO {% endif %}')\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparisons_on_null\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null < 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null <= 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null >= 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if null > 10 %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 < null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 <= null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 >= null %} NO {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 10 > null %} NO {% endif %}\"]}]}]}]}","id":"d556d1f8-0ba1-4d70-aee2-cd0e5c6f9830"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/host_authorization_spec.rb","start_line":8,"raw_source":"def assert_response(outcome:, headers:, last_response:)\n    fail_message = \"Expected outcome '#{outcome}' for headers '#{headers}' \" \\\n                   \"last_response.status '#{last_response.status}'\"\n\n    case outcome\n    when :allowed\n      expect(last_response).to be_ok, fail_message\n    when :stopped\n      expect(last_response.status).to eq(403), fail_message\n      expect(last_response.body).to eq('Host not permitted'), fail_message\n    end\n  end","complexity_score":20.8,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_response\",{\"type\":\"args\",\"children\":[{\"type\":\"kwarg\",\"children\":[\"outcome\"]},{\"type\":\"kwarg\",\"children\":[\"headers\"]},{\"type\":\"kwarg\",\"children\":[\"last_response\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"fail_message\",{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Expected outcome '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outcome\"]}]},{\"type\":\"str\",\"children\":[\"' for headers '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"str\",\"children\":[\"' \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"last_response.status '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"status\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outcome\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"allowed\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"lvar\",\"children\":[\"last_response\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"be_ok\"]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"stopped\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"status\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"int\",\"children\":[403]}]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"last_response\"]},\"body\"]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"str\",\"children\":[\"Host not permitted\"]}]},{\"type\":\"lvar\",\"children\":[\"fail_message\"]}]}]}]},null]}]}]}","id":"e62be81a-be28-4fd8-866a-c6e37b4c8457"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":52,"raw_source":"def wait_timeout\n    case RUBY_ENGINE\n    when \"jruby\", \"truffleruby\"\n      # takes some time to start the JVM\n      10.0\n    else\n      3.0\n    end\n  end","complexity_score":2.68,"ast_json":"{\"type\":\"def\",\"children\":[\"wait_timeout\",{\"type\":\"args\",\"children\":[]},{\"type\":\"case\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"jruby\"]},{\"type\":\"str\",\"children\":[\"truffleruby\"]},{\"type\":\"float\",\"children\":[10.0]}]},{\"type\":\"float\",\"children\":[3.0]}]}]}","id":"46628ad5-b85c-4f2b-aaeb-9f455bef18ea"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":113,"raw_source":"def delete(key)\n        result = self[key]\n        @response.delete_cookie(key.to_s, @options)\n        result\n      end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"delete_cookie\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"ivar\",\"children\":[\"@options\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"b8808931-932c-4a43-a09c-3672d03d73d0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":88,"raw_source":"def test_is_collection_empty\n    text = ' {% if array == empty %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'array' => [] })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_is_collection_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if array == empty %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}","id":"ad2d0cd5-4a77-4449-9606-527f106e239c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":85,"raw_source":"def test_cycle_is_not_blank\n    assert_template_result(\"  \" * ((N + 1) / 2) + \" \", wrap(\"{% cycle ' ', ' ' %}\"))\n  end","complexity_score":9.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},\"/\",{\"type\":\"int\",\"children\":[2]}]}]}]},\"+\",{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% cycle ' ', ' ' %}\"]}]}]}]}","id":"ab8c22a1-bda3-4d42-b690-ce14d1c87643"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":68,"raw_source":"def warn(env, message)\n        return unless options[:logging]\n\n        l = options[:logger] || env['rack.logger'] || ::Logger.new(env['rack.errors'])\n        l.warn(message)\n      end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logging\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.logger\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Logger\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"warn\",{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]}","id":"548164e5-1d03-4a9d-b7ab-d8c89fef530f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":24,"raw_source":"def self.run(server, port, async: false)\n      new(server, port, async).run\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"port\"]},{\"type\":\"kwoptarg\",\"children\":[\"async\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"lvar\",\"children\":[\"port\"]},{\"type\":\"lvar\",\"children\":[\"async\"]}]},\"run\"]}]}","id":"2d999cfe-eab6-4727-9205-10853126051d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":67,"raw_source":"def test_expression_cache\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    cache = {}\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    Liquid::Template.parse(template, expression_cache: cache).render\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":18.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}","id":"49a2dda4-ffbf-416c-9f86-78edd4d15b04"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":959,"raw_source":"def test_has_with_false_value_when_does_not_have_it\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => true },\n      { \"handle\" => \"gamma\", \"ok\" => true },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | has: 'ok', false }}\"\n    expected_output = \"false\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_false_value_when_does_not_have_it\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', false }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"ae91270c-c465-4a90-9d80-43906efbc46a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":63,"raw_source":"def test_key\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(true, static_register.key?(:a))\n    assert_equal(true, static_register.key?(:b))\n    assert_equal(true, static_register.key?(:c))\n    assert_equal(false, static_register.key?(:d))\n  end","complexity_score":13.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"key?\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}","id":"03375996-959d-4187-afe7-cf827c1d5dbc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":137,"raw_source":"def test_value?\n    assert_operator @hash, :value?, :a\n    assert_operator @hash, :value?, :b\n    assert_operator @hash, :value?, 3\n    assert_operator @hash, :value?, { :a=>:a, ?b=>:b }\n    refute_operator @hash, :value?, :d\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_value?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_operator\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"sym\",\"children\":[\"value?\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}","id":"71373744-7076-4153-8da6-c834e0dabf32"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":32,"raw_source":"def surround(front, back = front, &block)\n      \"#{front}#{_capture_haml(&block).chomp}#{back}\\n\"\n    end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"surround\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"front\"]},{\"type\":\"optarg\",\"children\":[\"back\",{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"front\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"back\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}","id":"6905e89a-2b10-4924-bac5-df2dc88038e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":122,"raw_source":"def parse_comparison(p)\n      a = parse_expression(p.expression)\n      if (op = p.consume?(:comparison))\n        b = parse_expression(p.expression)\n        Condition.new(a, op, b)\n      else\n        Condition.new(a)\n      end\n    end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_comparison\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"op\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comparison\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"b\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"a\"]}]}]}]}]}","id":"26ece12a-9df9-487c-8b87-476dfc1c3614"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":10,"raw_source":"def initialize(name, length, parentloop)\n      @name       = name\n      @length     = length\n      @parentloop = parentloop\n      @index      = 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"length\"]},{\"type\":\"arg\",\"children\":[\"parentloop\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@length\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@parentloop\",{\"type\":\"lvar\",\"children\":[\"parentloop\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@index\",{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"88db3050-cd4f-4852-a15b-eeb0f14cd5c8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":339,"raw_source":"def cookies\n      @cookies ||= Jar.new(self)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"cookies\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@cookies\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Jar\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]}]}","id":"ac89c5f4-79cd-41c2-8d34-2d548911166e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":119,"raw_source":"def link(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"LINK\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"LINK\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"30336997-4215-4ccd-871f-281df2edcfe9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":933,"raw_source":"def test_has_with_empty_arrays\n    template = <<~LIQUID\n      {%- assign has_product = products | has: 'title.content', 'Not found' -%}\n      {%- unless has_product -%}\n        Product not found.\n      {%- endunless -%}\n    LIQUID\n    expected_output = \"Product not found.\"\n\n    assert_template_result(expected_output, template, { \"products\" => [] })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_with_empty_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign has_product = products | has: 'title.content', 'Not found' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- unless has_product -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  Product not found.\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endunless -%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Product not found.\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]}","id":"14e296aa-d37b-4a95-9740-9718c8b0318c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":837,"raw_source":"def divided_by(input, operand)\n      apply_operation(input, operand, :/)\n    rescue ::ZeroDivisionError => e\n      raise Liquid::ZeroDivisionError, e.message\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"divided_by\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"operand\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"apply_operation\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"operand\"]},{\"type\":\"sym\",\"children\":[\"/\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ZeroDivisionError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}","id":"10f19ae2-2e62-4607-ab96-01babaddcac7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/increment.rb","start_line":33,"raw_source":"def render_to_output_buffer(context, output)\n      counter_environment = context.environments.first\n      value = counter_environment[@variable_name] || 0\n      counter_environment[@variable_name] = value + 1\n\n      output << value.to_s\n      output\n    end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"counter_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"environments\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]}]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"counter_environment\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@variable_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"6b43cccf-6416-44e8-9986-8f4f73511eae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":20,"raw_source":"def test_variable_end\n    template = Liquid::Template.parse(\"  {{funk}}\")\n    assert_equal(2, template.root.nodelist.size)\n    assert_equal(String, template.root.nodelist[0].class)\n    assert_equal(Variable, template.root.nodelist[1].class)\n  end","complexity_score":21.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_end\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]}]}]}","id":"043e7cf2-640e-4dc8-8d04-a05de52d34a2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":147,"raw_source":"def test_context_drop\n    output = Liquid::Template.parse(' {{ context.bar }} ').render!('context' => ContextDrop.new, 'bar' => \"carrot\")\n    assert_equal(' carrot ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ context.bar }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"carrot\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" carrot \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"7e90fe07-0266-4732-8803-dbead97b54b2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":128,"raw_source":"def respond_to?(*args)\n        super || to_str.respond_to?(*args)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_str\"]},\"respond_to?\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"9eae6100-9943-451d-92f3-0238d1dc0e6e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":177,"raw_source":"def set_attribute(key, expr)\n      case key\n      when 'offset'\n        @from = if expr == 'continue'\n          :continue\n        else\n          parse_expression(expr)\n        end\n      when 'limit'\n        @limit = parse_expression(expr)\n      end\n    end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"set_attribute\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"expr\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"offset\"]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expr\"]},\"==\",{\"type\":\"str\",\"children\":[\"continue\"]}]},{\"type\":\"sym\",\"children\":[\"continue\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"limit\"]},{\"type\":\"ivasgn\",\"children\":[\"@limit\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"expr\"]}]}]}]},null]}]}","id":"c358c8d6-21da-41ca-ac0f-6ddf164e2ec0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":32,"raw_source":"def test_no_instance_eval_after_mixing_in_new_filter\n    text     = %( {{ '1+1' | instance_eval }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval_after_mixing_in_new_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}","id":"c4c85822-280f-4af4-9bc6-9e465cf0a423"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":125,"raw_source":"def url_encode(input)\n      CGI.escape(Utils.to_s(input)) unless input.nil?\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"url_encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"escape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}","id":"3c813b9a-81e0-4945-b534-135e1a0eb9c2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":359,"raw_source":"def test_context_from_within_drop\n    @context.merge(\"test\" => '123', \"vars\" => ContextSensitiveDrop.new)\n    assert_equal('123', @context['vars.test'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_from_within_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextSensitiveDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.test\"]}]}]}]}]}","id":"45a304d4-5f0c-4795-8e59-280c37348b91"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":145,"raw_source":"def test_filter_with_keyword_arguments\n    @context['surname'] = 'john'\n    @context['input']   = 'hello %{first_name}, %{last_name}'\n    @context.add_filters(SubstituteFilter)\n    output              = Template.parse(%({{ input | substitute: first_name: surname, last_name: 'doe' }})).render(@context)\n    assert_equal('hello john, doe', output)\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_keyword_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"surname\"]},{\"type\":\"str\",\"children\":[\"john\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"hello %{first_name}, %{last_name}\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"add_filters\",{\"type\":\"const\",\"children\":[null,\"SubstituteFilter\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ input | substitute: first_name: surname, last_name: 'doe' }}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello john, doe\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"bcc0a754-22a4-4c14-ab54-16265aa7153c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":797,"raw_source":"def test_at_least\n    assert_template_result(\"5\", \"{{ 5 | at_least:4 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_least:5 }}\")\n    assert_template_result(\"6\", \"{{ 5 | at_least:6 }}\")\n\n    assert_template_result(\"5\", \"{{ 4.5 | at_least:5 }}\")\n    assert_template_result(\"6\", \"{{ width | at_least:5 }}\", { 'width' => NumberLikeThing.new(6) })\n    assert_template_result(\"5\", \"{{ width | at_least:5 }}\", { 'width' => NumberLikeThing.new(4) })\n    assert_template_result(\"6\", \"{{ 5 | at_least: width }}\", { 'width' => NumberLikeThing.new(6) })\n  end","complexity_score":11.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_at_least\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least:6 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 4.5 | at_least:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_least:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_least:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"6\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_least: width }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}","id":"b5961de1-0de6-4ab3-ba23-3bac23d34d9c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":299,"raw_source":"def enable(*opts)\n        opts.each { |key| set(key, true) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"5760dad8-7094-4182-93c7-ea7c0f967b77"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":51,"raw_source":"def sanitize(string)\n    string.downcase.gsub(/[\\W]/, '-').squeeze('-')\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"sanitize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"downcase\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[\\\\W]\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"-\"]}]},\"squeeze\",{\"type\":\"str\",\"children\":[\"-\"]}]}]}","id":"b41c1d47-8f08-42c9-a66a-865d72a87db1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":59,"raw_source":"def to_s\n      self.class.name\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]}]}","id":"a92dc703-9cce-4b50-b478-6083a0068ef4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":97,"raw_source":"def net_http_server?\n      name.to_s == 'HTTP'\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"net_http_server?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP\"]}]}]}","id":"cc2da89c-d02e-4bd6-baa1-75761638aa6e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2104,"raw_source":"def self.delegate(*methods)\n      methods.each do |method_name|\n        define_method(method_name) do |*args, &block|\n          return super(*args, &block) if respond_to? method_name\n\n          Delegator.target.send(method_name, *args, &block)\n        end\n        # ensure keyword argument passing is compatible with ruby >= 2.7\n        ruby2_keywords(method_name) if respond_to?(:ruby2_keywords, true)\n        private method_name\n      end\n    end","complexity_score":27.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"delegate\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"methods\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"methods\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method_name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"ruby2_keywords\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"ruby2_keywords\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]}]}]}]}","id":"8bf81835-5d17-4f56-9b71-f2d3cdffbfae"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1555,"raw_source":"def unlink(path, opts = {}, &block)  route 'UNLINK',  path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"UNLINK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"6f921d7b-51f9-448e-bbd5-556fcd776de3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/if_tag_unit_test.rb","start_line":6,"raw_source":"def test_if_nodelist\n    template = Liquid::Template.parse('{% if true %}IF{% else %}ELSE{% endif %}')\n    assert_equal(['IF', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %}IF{% else %}ELSE{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"IF\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}","id":"82c6a27c-3351-43a8-8b93-fa1347bfa51f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":19,"raw_source":"def test_does_not_parse_nodes_inside_a_comment\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% if true %}\n        {% if ... %}\n        {%- for ? -%}\n        {% while true %}\n        {%\n          unless if\n        %}\n        {% endcase %}\n      {% endcomment %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_parse_nodes_inside_a_comment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if ... %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%- for ? -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% while true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {%\\n\"]},{\"type\":\"str\",\"children\":[\"    unless if\\n\"]},{\"type\":\"str\",\"children\":[\"  %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcase %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}","id":"e15787d8-f536-43ca-9367-4a25086af1c0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1082,"raw_source":"def empty?\n        @input.each { return false }\n        true\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"empty?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@input\"]},\"each\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"true\",\"children\":[]}]}]}","id":"9e2ae88f-bb0c-4fad-9703-7dd0c2729f8c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":464,"raw_source":"def initialize(scheduler = self.class, keep_open = false, &back)\n        @back = back.to_proc\n        @scheduler = scheduler\n        @keep_open = keep_open\n        @callbacks = []\n        @closed = false\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"scheduler\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"optarg\",\"children\":[\"keep_open\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"back\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@back\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"back\"]},\"to_proc\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@scheduler\",{\"type\":\"lvar\",\"children\":[\"scheduler\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@keep_open\",{\"type\":\"lvar\",\"children\":[\"keep_open\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@callbacks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@closed\",{\"type\":\"false\",\"children\":[]}]}]}]}","id":"654b3b9e-8fa3-4df2-bfc5-78f833b93f67"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":360,"raw_source":"def test_for_parentloop_references_parent_loop\n    assert_template_result(\n      '1.1 1.2 1.3 2.1 2.2 2.3 ',\n      '{% for inner in outer %}{% for k in inner %}' \\\n      '{{ forloop.parentloop.index }}.{{ forloop.index }} ' \\\n      '{% endfor %}{% endfor %}',\n      { 'outer' => [[1, 1, 1], [1, 1, 1]] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_parentloop_references_parent_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1.1 1.2 1.3 2.1 2.2 2.3 \"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for inner in outer %}{% for k in inner %}\"]},{\"type\":\"str\",\"children\":[\"{{ forloop.parentloop.index }}.{{ forloop.index }} \"]},{\"type\":\"str\",\"children\":[\"{% endfor %}{% endfor %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"outer\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"75ee235d-60cb-4f61-96fd-e1f85898dfd7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":78,"raw_source":"def unlock?\n        request_method == 'UNLOCK'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlock?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"UNLOCK\"]}]}]}","id":"01b53be5-10a5-450c-8e68-c24dedf8a224"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":30,"raw_source":"def test_raises_unknown_translation\n    assert_raises(I18n::TranslationError) do\n      @i18n.translate(\"doesnt_exist\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raises_unknown_translation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"TranslationError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"doesnt_exist\"]}]}]}]}","id":"32389767-5a1a-4eb0-9b37-f77d36060add"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":185,"raw_source":"def assert_evaluates_argument_error(left, op, right)\n    assert_raises(Liquid::ArgumentError) do\n      Condition.new(left, op, right).evaluate(@context)\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_argument_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}","id":"8447b20f-d268-4234-ad15-c0c76395cee8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":251,"raw_source":"def async?(status, _headers, body)\n      return true if status == -1\n\n      body.respond_to?(:callback) && body.respond_to?(:errback)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"async?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"status\"]},{\"type\":\"arg\",\"children\":[\"_headers\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},\"==\",{\"type\":\"int\",\"children\":[-1]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"callback\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"errback\"]}]}]}]}]}","id":"f638c2d9-dac8-41b8-bc72-a30682c1afd9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":85,"raw_source":"def puma?\n      name.to_s == \"puma\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"puma?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"puma\"]}]}]}","id":"9ad17b7e-e03c-485c-b951-7bedcb94c661"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":523,"raw_source":"def reverse(input)\n      ary = InputIterator.new(input, context)\n      ary.reverse\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"reverse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"reverse\"]}]}]}","id":"68fbb23c-a8ee-4f03-a32c-5c18121778bf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":568,"raw_source":"def expires(amount, *values)\n      values << {} unless values.last.is_a?(Hash)\n\n      if amount.is_a? Integer\n        time    = Time.now + amount.to_i\n        max_age = amount\n      else\n        time    = time_for amount\n        max_age = time - Time.now\n      end\n\n      values.last.merge!(max_age: max_age) { |_key, v1, v2| v1 || v2 }\n      cache_control(*values)\n\n      response['Expires'] = time.httpdate\n    end","complexity_score":27.2,"ast_json":"{\"type\":\"def\",\"children\":[\"expires\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]},{\"type\":\"restarg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"amount\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"amount\"]},\"to_i\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"max_age\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"time\",{\"type\":\"send\",\"children\":[null,\"time_for\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"max_age\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"max_age\"]},{\"type\":\"lvar\",\"children\":[\"max_age\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_key\"]},{\"type\":\"arg\",\"children\":[\"v1\"]},{\"type\":\"arg\",\"children\":[\"v2\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v1\"]},{\"type\":\"lvar\",\"children\":[\"v2\"]}]}]},{\"type\":\"send\",\"children\":[null,\"cache_control\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Expires\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"time\"]},\"httpdate\"]}]}]}]}","id":"e0059460-e3f0-4f93-bd1b-3c095b51423b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":211,"raw_source":"def test_capture\n    assert_equal(\n      [\"test\"],\n      visit(%({% capture x %}{{ test }}{% endcapture %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% capture x %}{{ test }}{% endcapture %}\"]}]}]}]}","id":"d299d92e-02f2-4c18-ac1a-7291372649c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/file_system.rb","start_line":61,"raw_source":"def full_path(template_path)\n      raise FileSystemError, \"Illegal template name '#{template_path}'\" unless %r{\\A[^./][a-zA-Z0-9_/]+\\z}.match?(template_path)\n\n      full_path = if template_path.include?('/')\n        File.join(root, File.dirname(template_path), @pattern % File.basename(template_path))\n      else\n        File.join(root, @pattern % template_path)\n      end\n\n      raise FileSystemError, \"Illegal template path '#{File.expand_path(full_path)}'\" unless File.expand_path(full_path).start_with?(File.expand_path(root))\n\n      full_path\n    end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"full_path\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A[^./][a-zA-Z0-9_/]+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match?\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Illegal template name '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"full_path\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_path\"]},\"include?\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pattern\"]},\"%\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"root\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@pattern\"]},\"%\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]},\"start_with?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"send\",\"children\":[null,\"root\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"FileSystemError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Illegal template path '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"full_path\"]}]}]}","id":"711a8f01-9c31-4aac-a6ce-407f93358699"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":119,"raw_source":"def test_no_trim_tags\n    text     = '<p>{%- if true -%}yes{%- endif -%}</p>'\n    expected = '<p>yes</p>'\n    assert_template_result(expected, text)\n\n    text     = '<p>{%- if false -%}no{%- endif -%}</p>'\n    expected = '<p></p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{%- if true -%}yes{%- endif -%}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>yes</p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{%- if false -%}no{%- endif -%}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p></p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"bb8c25a3-d613-416b-9a7c-9d37eccdafa9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":181,"raw_source":"def compact\n      dup.tap(&:compact!)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"compact!\"]}]}]}]}","id":"a331b390-a00d-40c2-956f-02aaf1c2c520"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":84,"raw_source":"def lax_parse(markup)\n      expressions = markup.scan(ExpressionsAndOperators)\n      raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless expressions.pop =~ Syntax\n\n      condition = Condition.new(parse_expression(Regexp.last_match(1)), Regexp.last_match(2), parse_expression(Regexp.last_match(3)))\n\n      until expressions.empty?\n        operator = expressions.pop.to_s.strip\n\n        raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless expressions.pop.to_s =~ Syntax\n\n        new_condition = Condition.new(parse_expression(Regexp.last_match(1)), Regexp.last_match(2), parse_expression(Regexp.last_match(3)))\n        raise SyntaxError, options[:locale].t(\"errors.syntax.if\") unless BOOLEAN_OPERATORS.include?(operator)\n        new_condition.send(operator, condition)\n        condition = new_condition\n      end\n\n      condition\n    end","complexity_score":64.35,"ast_json":"{\"type\":\"def\",\"children\":[\"lax_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expressions\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"ExpressionsAndOperators\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"empty?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"operator\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"to_s\"]},\"strip\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expressions\"]},\"pop\"]},\"to_s\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BOOLEAN_OPERATORS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"operator\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.if\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_condition\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"operator\"]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"lvar\",\"children\":[\"new_condition\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}","id":"08114590-c5d8-4d94-862d-ca1921ded6ed"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":26,"raw_source":"def test_float\n    assert_template_result(\"-17.42\", \"{{ -17.42 }}\")\n    assert_template_result(\"2.5\", \"{{ 2.5 }}\")\n    assert_expression_result(0.0, \"0.....5\")\n    assert_expression_result(0.0, \"-0..1\")\n    assert_expression_result(1.5, \"1.5\")\n\n    # this is a unfortunate quirky behavior of Liquid\n    result = Expression.parse(\".5\")\n    assert_kind_of(Liquid::VariableLookup, result)\n\n    result = Expression.parse(\"-.5\")\n    assert_kind_of(Liquid::VariableLookup, result)\n  end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-17.42\"]},{\"type\":\"str\",\"children\":[\"{{ -17.42 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.5\"]},{\"type\":\"str\",\"children\":[\"{{ 2.5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"str\",\"children\":[\"0.....5\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"str\",\"children\":[\"-0..1\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"float\",\"children\":[1.5]},{\"type\":\"str\",\"children\":[\"1.5\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\".5\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VariableLookup\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"str\",\"children\":[\"-.5\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"VariableLookup\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"73f4f7e6-a2ed-4956-8ea1-47dc68e1bbd0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":130,"raw_source":"def encrypt(value)\n        options[:encryptor].hexdigest value.to_s\n      end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"encrypt\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"encryptor\"]}]},\"hexdigest\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]}]}]}","id":"1fa87816-14a3-4aad-aff8-de7b2f771da5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":266,"raw_source":"def traversal(template)\n    ParseTreeVisitor\n      .for(Template.parse(template).root)\n      .add_callback_for(VariableLookup) { |node| node.name } # rubocop:disable Style/SymbolProc\n  end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"traversal\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"name\"]}]}]}","id":"de1c1a49-de70-462a-9294-0c608a041d78"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":40,"raw_source":"def decode(s)\n    ts = lex(s)\n    v, ts = textparse(ts)\n    if ts.length > 0\n      raise Error, 'trailing garbage'\n    end\n    v\n  end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"lex\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"textparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"trailing garbage\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}","id":"954581ad-1ea1-4655-959f-3f92361dd68e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1912,"raw_source":"def cleaned_caller(keep = 3)\n        caller(1)\n          .map! { |line| line.split(/:(?=\\d|in )/, 3)[0, keep] }\n          .reject { |file, *_| callers_to_ignore.any? { |pattern| file =~ pattern } }\n      end","complexity_score":15.38,"ast_json":"{\"type\":\"def\",\"children\":[\"cleaned_caller\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"keep\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\",{\"type\":\"int\",\"children\":[1]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\":(?=\\\\d|in )\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[3]}]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"keep\"]}]}]},\"reject\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]},{\"type\":\"restarg\",\"children\":[\"_\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"callers_to_ignore\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"=~\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}]}","id":"d89a6b9b-0d4f-45b0-bc8a-efd92b543bdf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":675,"raw_source":"def test_new_isolated_context_inherits_parent_environment\n    global_environment = Liquid::Environment.build(tags: {})\n    context = Context.build(environment: global_environment)\n\n    subcontext = context.new_isolated_subcontext\n    assert_equal(global_environment, subcontext.environment)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_context_inherits_parent_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"global_environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tags\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"global_environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"global_environment\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"environment\"]}]}]}]}","id":"cd1d2628-29bc-4171-bbc9-9d4f42d6b1ee"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":39,"raw_source":"def self.included(base)\n        base.class_eval do\n          alias_method :_safe?, :safe?\n          alias_method :_idempotent?, :idempotent?\n\n          def safe?\n            _safe? or propfind?\n          end\n\n          def idempotent?\n            _idempotent? or propfind? or move? or unlock? # or lock?\n          end\n        end\n      end","complexity_score":10.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"_safe?\"]},{\"type\":\"sym\",\"children\":[\"safe?\"]}]},{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"_idempotent?\"]},{\"type\":\"sym\",\"children\":[\"idempotent?\"]}]},{\"type\":\"def\",\"children\":[\"safe?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_safe?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]}]},{\"type\":\"def\",\"children\":[\"idempotent?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_idempotent?\"]},{\"type\":\"send\",\"children\":[null,\"propfind?\"]}]},{\"type\":\"send\",\"children\":[null,\"move?\"]}]},{\"type\":\"send\",\"children\":[null,\"unlock?\"]}]}]}]}]}]}","id":"abae5e80-b67e-4fde-9eba-c741a40e607d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":76,"raw_source":"def upcase(input)\n      Utils.to_s(input).upcase\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"upcase\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"upcase\"]}]}","id":"ff999cb5-77c8-4755-9e97-3182b2b9fa4c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":69,"raw_source":"def test_sort\n    assert_template_result(\"1 2 3 4\", \"{{numbers | sort | join}}\", { \"numbers\" => [2, 1, 4, 3] })\n    assert_template_result(\n      \"alphabetic as expected\",\n      \"{{words | sort | join}}\",\n      { \"words\" => ['expected', 'as', 'alphabetic'] },\n    )\n    assert_template_result(\"3\", \"{{value | sort}}\", { \"value\" => 3 })\n    assert_template_result('are flower', \"{{arrays | sort | join}}\", { 'arrays' => ['flower', 'are'] })\n    assert_template_result(\n      \"Expected case sensitive\",\n      \"{{case_sensitive | sort | join}}\",\n      { \"case_sensitive\" => [\"sensitive\", \"Expected\", \"case\"] },\n    )\n  end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"str\",\"children\":[\"{{numbers | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"alphabetic as expected\"]},{\"type\":\"str\",\"children\":[\"{{words | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"expected\"]},{\"type\":\"str\",\"children\":[\"as\"]},{\"type\":\"str\",\"children\":[\"alphabetic\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"str\",\"children\":[\"{{value | sort}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"are flower\"]},{\"type\":\"str\",\"children\":[\"{{arrays | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"arrays\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"flower\"]},{\"type\":\"str\",\"children\":[\"are\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Expected case sensitive\"]},{\"type\":\"str\",\"children\":[\"{{case_sensitive | sort | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"case_sensitive\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"sensitive\"]},{\"type\":\"str\",\"children\":[\"Expected\"]},{\"type\":\"str\",\"children\":[\"case\"]}]}]}]}]}]}]}","id":"df620ef1-c324-4226-af9f-4ea8cf5ccb45"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":155,"raw_source":"def self.hash_inspect(hash, seen = {})\n      if seen[hash.object_id]\n        return \"{...}\"\n      end\n      seen[hash.object_id] = true\n\n      str = +\"{\"\n      first = true\n      hash.each do |key, value|\n        if first\n          first = false\n        else\n          str << \", \"\n        end\n\n        key_str = inspect(key, seen)\n        str << key_str\n        str << \"=>\"\n\n        value_str = inspect(value, seen)\n        str << value_str\n      end\n      str << \"}\"\n      str\n    ensure\n      seen.delete(hash.object_id)\n    end","complexity_score":28.7,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"hash_inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"{...}\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\", \"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"key_str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"=>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"value_str\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"object_id\"]}]}]}]}","id":"c4a6a6c7-6033-40b7-97eb-a2e0d73a8423"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":40,"raw_source":"def to_integer(input)\n      case input\n      when Integer\n        input\n      when NilClass, String\n        input.to_i\n      else\n        Utils.to_integer(input)\n      end\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NilClass\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"to_i\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}","id":"ef37f7dd-5e90-47be-baa2-219802a6eab2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":13,"raw_source":"def test_filters\n    var = create_variable('hello | textileze')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []]], var.filters)\n\n    var = create_variable('hello | textileze | paragraph')\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['textileze', []], ['paragraph', []]], var.filters)\n\n    var = create_variable(%( hello | strftime: '%Y'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['strftime', ['%Y']]], var.filters)\n\n    var = create_variable(%( 'typo' | link_to: 'Typo', true ))\n    assert_equal('typo', var.name)\n    assert_equal([['link_to', ['Typo', true]]], var.filters)\n\n    var = create_variable(%( 'typo' | link_to: 'Typo', false ))\n    assert_equal('typo', var.name)\n    assert_equal([['link_to', ['Typo', false]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3, 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3, 3]]], var.filters)\n\n    var = create_variable(%( 'foo' | repeat: 3, 3, 3 ))\n    assert_equal('foo', var.name)\n    assert_equal([['repeat', [3, 3, 3]]], var.filters)\n\n    var = create_variable(%( hello | strftime: '%Y, okay?'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['strftime', ['%Y, okay?']]], var.filters)\n\n    var = create_variable(%( hello | things: \"%Y, okay?\", 'the other one'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['things', ['%Y, okay?', 'the other one']]], var.filters)\n  end","complexity_score":71.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"hello | textileze | paragraph\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"textileze\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"paragraph\"]},{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | strftime: '%Y'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"strftime\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'typo' | link_to: 'Typo', true \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"typo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"link_to\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Typo\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'typo' | link_to: 'Typo', false \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"typo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"link_to\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"Typo\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3, 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" 'foo' | repeat: 3, 3, 3 \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"repeat\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | strftime: '%Y, okay?'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"strftime\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y, okay?\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]},{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | things: \\\"%Y, okay?\\\", 'the other one'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"things\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"%Y, okay?\"]},{\"type\":\"str\",\"children\":[\"the other one\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"ff2d7045-aa70-4366-acfc-e8cf71fae600"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":34,"raw_source":"def test_tokenize_with_nil_source_returns_empty_array\n    assert_equal([], tokenize(nil))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tokenize_with_nil_source_returns_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"34be7307-1354-49b4-84a3-74150bd36bbd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":93,"raw_source":"def test_is_not_collection_empty\n    text = ' {% if array == empty %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text, { 'array' => [1, 2, 3] })\n  end","complexity_score":2.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_is_not_collection_empty\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if array == empty %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}","id":"f038cd25-7c76-4a11-b10c-2b7e95b3c85c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/json_spec.rb","start_line":39,"raw_source":"def results_in(obj)\n    expect(OkJson.decode(get('/').body)).to eq(obj)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"results_in\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"expect\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OkJson\"]},\"decode\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"body\"]}]}]},\"to\",{\"type\":\"send\",\"children\":[null,\"eq\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}","id":"d5d78276-3ab8-4168-93fc-41c1bf4f1f80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1878,"raw_source":"def setup_host_authorization(builder)\n        builder.use Rack::Protection::HostAuthorization, host_authorization\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_host_authorization\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Protection\"]},\"HostAuthorization\"]},{\"type\":\"send\",\"children\":[null,\"host_authorization\"]}]}]}","id":"ad72b0e2-ccfb-451a-af78-1e3fdc4ea0b3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":17,"raw_source":"def test_words\n    assert_equal(['arg1', 'arg2'], 'arg1 arg2'.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_words\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"33c77cc6-e842-4578-8d33-02a6064ffc9d"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/example_servlet.rb","start_line":26,"raw_source":"def products\n    { 'products' => products_list, 'more_products' => more_products_list, 'description' => description, 'section' => 'Snowboards', 'cool_products' => true }\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"products\",{\"type\":\"args\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"send\",\"children\":[null,\"products_list\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"more_products\"]},{\"type\":\"send\",\"children\":[null,\"more_products_list\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"description\"]},{\"type\":\"send\",\"children\":[null,\"description\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"section\"]},{\"type\":\"str\",\"children\":[\"Snowboards\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cool_products\"]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"19f1f1c3-d45e-4005-9d27-a8552f8c8f2b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":207,"raw_source":"def test_enumerable_drop_size\n    assert_equal('3', Liquid::Template.parse('{{collection.size}}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{collection.size}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}","id":"79ad9ee5-b03b-458b-af62-d083ee6badd1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":43,"raw_source":"def lookup_command?(lookup_index)\n      @command_flags & (1 << lookup_index) != 0\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lookup_command?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"lookup_index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@command_flags\"]},\"&\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"lvar\",\"children\":[\"lookup_index\"]}]}]}]},\"!=\",{\"type\":\"int\",\"children\":[0]}]}]}","id":"7da09ed9-f3b7-4435-b2d7-29555c7ac90e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1210,"raw_source":"def handle_exception!(boom)\n      error_params = @env['sinatra.error.params']\n\n      @params = @params.merge(error_params) if error_params\n\n      @env['sinatra.error'] = boom\n\n      http_status = if boom.is_a? Sinatra::Error\n                      if boom.respond_to? :http_status\n                        boom.http_status\n                      elsif settings.use_code? && boom.respond_to?(:code)\n                        boom.code\n                      end\n                    end\n\n      http_status = 500 unless http_status&.between?(400, 599)\n      status(http_status)\n\n      if server_error?\n        dump_errors! boom if settings.dump_errors?\n        raise boom if settings.show_exceptions? && (settings.show_exceptions != :after_handler)\n      elsif not_found?\n        headers['X-Cascade'] = 'pass' if settings.x_cascade?\n      end\n\n      if (res = error_block!(boom.class, boom) || error_block!(status, boom))\n        return res\n      end\n\n      if not_found? || bad_request?\n        if boom.message && boom.message != boom.class.name\n          body Rack::Utils.escape_html(boom.message)\n        else\n          content_type 'text/html'\n          body \"<h1>#{not_found? ? 'Not Found' : 'Bad Request'}</h1>\"\n        end\n      end\n\n      return unless server_error?\n\n      raise boom if settings.raise_errors? || settings.show_exceptions?\n\n      error_block! Exception, boom\n    end","complexity_score":93.78,"ast_json":"{\"type\":\"def\",\"children\":[\"handle_exception!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"boom\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error_params\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error.params\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error_params\"]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"error_params\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]},{\"type\":\"lvasgn\",\"children\":[\"http_status\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"is_a?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Error\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"http_status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"http_status\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"use_code?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"code\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"code\"]},null]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_status\"]},\"between?\",{\"type\":\"int\",\"children\":[400]},{\"type\":\"int\",\"children\":[599]}]},null,{\"type\":\"lvasgn\",\"children\":[\"http_status\",{\"type\":\"int\",\"children\":[500]}]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"lvar\",\"children\":[\"http_status\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server_error?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"dump_errors?\"]},{\"type\":\"send\",\"children\":[null,\"dump_errors!\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"after_handler\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"x_cascade?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"X-Cascade\"]},{\"type\":\"str\",\"children\":[\"pass\"]}]},null]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[null,\"status\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"send\",\"children\":[null,\"bad_request?\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},\"name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"escape_html\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"send\",\"children\":[null,\"body\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<h1>\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"not_found?\"]},{\"type\":\"str\",\"children\":[\"Not Found\"]},{\"type\":\"str\",\"children\":[\"Bad Request\"]}]}]},{\"type\":\"str\",\"children\":[\"</h1>\"]}]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server_error?\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"raise_errors?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"show_exceptions?\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"boom\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"const\",\"children\":[null,\"Exception\"]},{\"type\":\"lvar\",\"children\":[\"boom\"]}]}]}]}","id":"790f3629-6f1b-46d8-a3ab-4224cb445749"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":366,"raw_source":"def join(input, glue = ' ')\n      glue = Utils.to_s(glue)\n      InputIterator.new(input, context).join(glue)\n    end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"join\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"glue\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"glue\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]},\"join\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]}]}","id":"3e76a102-6785-4138-946e-fa0c4e1c355e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":107,"raw_source":"def fetch_values(*keys)\n      keys.map!(&method(:convert_key))\n\n      super(*keys)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch_values\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}","id":"7f63ae0c-0b41-4b05-b192-d6f6396541cf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":111,"raw_source":"def test_case_is_blank\n    assert_template_result(\"\", wrap(\" {% assign foo = 'bar' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"))\n    assert_template_result(\"\", wrap(\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"))\n    assert_template_result(\"   x  \" * (N + 1), wrap(\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} x {% endcase %} \"))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'bar' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} {% endcase %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"   x  \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% assign foo = 'else' %} {% case foo %} {% when 'bar' %} {% when 'whatever' %} {% else %} x {% endcase %} \"]}]}]}]}]}","id":"a32ec9ca-745d-4b10-bb26-71874529e47a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":190,"raw_source":"def render_else(context, output)\n      if @else_block\n        @else_block.render_to_output_buffer(context, output)\n      else\n        output\n      end\n    end","complexity_score":2.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_else\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@else_block\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"b197d615-6b87-4ea3-bdd4-6e6cc101a2b4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":313,"raw_source":"def test_post_and_pre_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true -%}\n          yes\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    whitespace = '          '\n    text       = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false -%}\n          no\n          {%- endif %}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<~END_EXPECTED\n            <div>\n              <p>\n      #{whitespace}\n              </p>\n            </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_and_pre_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"whitespace\",{\"type\":\"str\",\"children\":[\"          \"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitespace\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"eaa195aa-08da-419a-9bc6-e7be0fc6a4b0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":233,"raw_source":"def test_profiling_supports_total_time\n    t = Template.parse(\"{% if true %} {{ test }} {% endif %}\", profile: true)\n    output = t.render!(\"test\" => TestDrop.new(\"one\"))\n    assert_equal(\" one \", output)\n\n    assert_operator(t.profiler[0].total_time, :>, 0.0)\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_total_time\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if true %} {{ test }} {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"one\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" one \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_operator\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"total_time\"]},{\"type\":\"sym\",\"children\":[\">\"]},{\"type\":\"float\",\"children\":[0.0]}]}]}]}","id":"95754ccf-c8af-49a8-99cb-ace4d7d794d3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":34,"raw_source":"def setup_blocks(base = self.class)\n    setup_blocks base.superclass if base.superclass.respond_to? :setup_blocks\n    base.setup_blocks.each do |block|\n      instance_eval(&block)\n    end\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_blocks\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"setup_blocks\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_blocks\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"setup_blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"f1a81c6e-1acd-4542-ae44-8c728bab225b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":62,"raw_source":"def initialize(app)\n        @response_array  = nil\n        @response_hash   = {}\n        @response        = app.response\n        @request         = app.request\n        @deleted         = []\n\n        @options = {\n          path: @request.script_name.to_s.empty? ? '/' : @request.script_name,\n          domain: @request.host == 'localhost' ? nil : @request.host,\n          secure: @request.secure?,\n          httponly: true\n        }\n\n        return unless app.settings.respond_to? :cookie_options\n\n        @options.merge! app.settings.cookie_options\n      end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@response_array\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@response_hash\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@response\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"response\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@request\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"request\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@deleted\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"path\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"script_name\"]},\"to_s\"]},\"empty?\"]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"script_name\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"domain\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"host\"]},\"==\",{\"type\":\"str\",\"children\":[\"localhost\"]}]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"host\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"secure\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"secure?\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"httponly\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"cookie_options\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"cookie_options\"]}]}]}]}","id":"4b07eeaf-edce-4150-a339-387ef1f8afda"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":52,"raw_source":"def tokenize\n    ss = StringScanner.new(\"\")\n    @tests.each do |test_hash|\n      tokenizer = Liquid::Tokenizer.new(\n        source: test_hash[:liquid],\n        string_scanner: ss,\n        line_numbers: true,\n      )\n      while tokenizer.shift; end\n    end\n  end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ss\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"ss\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]},null]}]}]}]}]}","id":"f9b0595b-12e7-4a40-b55d-ea13ca75cd3b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":26,"raw_source":"def registered(base)\n        @extensions.each do |method, list|\n          list = list.map { |name| Sinatra.const_get name }\n          base.send(method, *list) unless base == ::Sinatra::Application\n        end\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"arg\",\"children\":[\"list\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"list\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"const_get\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Sinatra\"]},\"Application\"]}]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]}]}]}]}]}]}]}","id":"66d94869-3e52-42c8-95f2-b06936e5e3a9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":55,"raw_source":"def nodelist\n      @blocks.map(&:attachment)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"attachment\"]}]}]}]}","id":"a1c7b0c7-7c7c-4220-8b46-6a94eea3ba97"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":183,"raw_source":"def finish\n      result = body\n\n      if drop_content_info?\n        headers.delete 'content-length'\n        headers.delete 'content-type'\n      end\n\n      if drop_body?\n        close\n        result = []\n      end\n\n      if calculate_content_length?\n        # if some other code has already set content-length, don't muck with it\n        # currently, this would be the static file-handler\n        headers['content-length'] = body.map(&:bytesize).reduce(0, :+).to_s\n      end\n\n      [status, headers, result]\n    end","complexity_score":27.1,"ast_json":"{\"type\":\"def\",\"children\":[\"finish\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"body\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"drop_content_info?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"drop_body?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"close\"]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"array\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"calculate_content_length?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"bytesize\"]}]}]},\"reduce\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"+\"]}]},\"to_s\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},{\"type\":\"send\",\"children\":[null,\"headers\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"637364f8-6fa1-4e63-a1df-2e4e5c94486e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":30,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      if markup =~ Syntax\n        @to   = Regexp.last_match(1)\n        @from = Variable.new(Regexp.last_match(2), parse_context)\n      else\n        self.class.raise_syntax_error(parse_context)\n      end\n    end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@to\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@from\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"raise_syntax_error\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}","id":"bb99e3b7-0444-4c1c-854e-de532ad76544"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":57,"raw_source":"def tokenize(source)\n    tokenizer = new_tokenizer(source)\n    tokens    = []\n    # shift is private in Liquid::C::Tokenizer, since it is only for unit testing\n    while (t = tokenizer.send(:shift))\n      tokens << t\n    end\n    tokens\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"source\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tokenizer\",{\"type\":\"send\",\"children\":[null,\"new_tokenizer\",{\"type\":\"lvar\",\"children\":[\"source\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tokens\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]},{\"type\":\"lvar\",\"children\":[\"tokens\"]}]}]}","id":"48d8c772-1d7c-4e8a-92ad-4b7234e25a2d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/unless.rb","start_line":22,"raw_source":"def render_to_output_buffer(context, output)\n      # First condition is interpreted backwards ( if not )\n      first_block = @blocks.first\n      result = Liquid::Utils.to_liquid_value(\n        first_block.evaluate(context),\n      )\n\n      unless result\n        return first_block.attachment.render_to_output_buffer(context, output)\n      end\n\n      # After the first condition unless works just like if\n      @blocks[1..-1].each do |block|\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          return block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_block\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"98aef236-30aa-48bc-b823-fc97adfcaed0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":94,"raw_source":"def to_integer(value)\n      value.to_i\n    rescue NoMethodError\n      raise Liquid::ArgumentError, \"invalid integer\"\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"to_integer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid integer\"]}]}]},null]}]}","id":"c1b6f554-8560-48f9-a87d-73e8e5ae48c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":81,"raw_source":"def test_increment_is_not_blank\n    assert_template_result(\" 0\" * 2 * (N + 1), wrap(\"{% assign foo = 0 %} {% increment foo %} {% decrement foo %}\"))\n  end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_increment_is_not_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" 0\"]},\"*\",{\"type\":\"int\",\"children\":[2]}]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% assign foo = 0 %} {% increment foo %} {% decrement foo %}\"]}]}]}]}","id":"864d546b-eced-4fa6-b92d-24e1b000d570"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":178,"raw_source":"def mask_token(token)\n        one_time_pad = SecureRandom.random_bytes(token.length)\n        encrypted_token = xor_byte_strings(one_time_pad, token)\n        masked_token = one_time_pad + encrypted_token\n        encode_token(masked_token)\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mask_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"one_time_pad\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SecureRandom\"]},\"random_bytes\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"encrypted_token\",{\"type\":\"send\",\"children\":[null,\"xor_byte_strings\",{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"masked_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"one_time_pad\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"encrypted_token\"]}]}]},{\"type\":\"send\",\"children\":[null,\"encode_token\",{\"type\":\"lvar\",\"children\":[\"masked_token\"]}]}]}]}","id":"a35547ff-ded5-43da-a6ea-350d3b889642"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":151,"raw_source":"def accepts?(entry)\n        File.fnmatch(entry, self) && matches_params?(entry.params)\n      end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"fnmatch\",{\"type\":\"lvar\",\"children\":[\"entry\"]},{\"type\":\"self\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"matches_params?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"params\"]}]}]}]}","id":"26cccef8-3039-4e28-aa51-589d8ff454c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":152,"raw_source":"def initialize(value)\n    super()\n    @value = value\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"bc7f83b1-e0fc-4b8d-b4a7-dd6448b6f344"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":6,"raw_source":"def scopes\n    @context.scopes.size\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"scopes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"scopes\"]},\"size\"]}]}","id":"64baca5b-c977-48f5-8e4f-43e5bd8b2b59"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":140,"raw_source":"def render(*args)\n      return '' if @root.nil?\n\n      context = case args.first\n      when Liquid::Context\n        c = args.shift\n\n        if @rethrow_errors\n          c.exception_renderer = Liquid::RAISE_EXCEPTION_LAMBDA\n        end\n\n        c\n      when Liquid::Drop\n        drop         = args.shift\n        drop.context = Context.new([drop, assigns], instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      when Hash\n        Context.new([args.shift, assigns], instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      when nil\n        Context.new(assigns, instance_assigns, registers, @rethrow_errors, @resource_limits, {}, @environment)\n      else\n        raise ArgumentError, \"Expected Hash or Liquid::Context as parameter\"\n      end\n\n      output = nil\n\n      case args.last\n      when Hash\n        options = args.pop\n        output  = options[:output] if options[:output]\n        static_registers = context.registers.static\n\n        options[:registers]&.each do |key, register|\n          static_registers[key] = register\n        end\n\n        apply_options_to_context(context, options)\n      when Module, Array\n        context.add_filters(args.pop)\n      end\n\n      # Retrying a render resets resource usage\n      context.resource_limits.reset\n\n      if @profiling && context.profiler.nil?\n        @profiler = context.profiler = Liquid::Profiler.new\n      end\n\n      context.template_name ||= name\n\n      begin\n        # render the nodelist.\n        @root.render_to_output_buffer(context, output || +'')\n      rescue Liquid::MemoryError => e\n        context.handle_error(e)\n      ensure\n        @errors = context.errors\n      end\n    end","complexity_score":81.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@root\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"exception_renderer=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"RAISE_EXCEPTION_LAMBDA\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"c\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[null,\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"shift\"]},{\"type\":\"send\",\"children\":[null,\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"assigns\"]},{\"type\":\"send\",\"children\":[null,\"instance_assigns\"]},{\"type\":\"send\",\"children\":[null,\"registers\"]},{\"type\":\"ivar\",\"children\":[\"@rethrow_errors\"]},{\"type\":\"ivar\",\"children\":[\"@resource_limits\"]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"Expected Hash or Liquid::Context as parameter\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"output\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"static_registers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"static\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"registers\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"register\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_registers\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"register\"]}]}]},{\"type\":\"send\",\"children\":[null,\"apply_options_to_context\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"reset\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@profiling\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]},\"nil?\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Profiler\"]},\"new\"]}]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]},{\"type\":\"send\",\"children\":[null,\"name\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@root\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MemoryError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"handle_error\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},null]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"errors\"]}]}]}]}]}]}","id":"32f8df42-7dbb-4256-92ac-15c47d088af5"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":114,"raw_source":"def next_variable_token\n      start = @ss.pos - 2\n\n      byte_a = byte_b = @ss.scan_byte\n\n      while byte_b\n        byte_a = @ss.scan_byte while byte_a && (byte_a != CLOSE_CURLEY && byte_a != OPEN_CURLEY)\n\n        break unless byte_a\n\n        if @ss.eos?\n          return byte_a == CLOSE_CURLEY ? @source.byteslice(start, @ss.pos - start) : \"{{\"\n        end\n\n        byte_b = @ss.scan_byte\n\n        if byte_a == CLOSE_CURLEY\n          if byte_b == CLOSE_CURLEY\n            return @source.byteslice(start, @ss.pos - start)\n          elsif byte_b != CLOSE_CURLEY\n            @ss.pos -= 1\n            return @source.byteslice(start, @ss.pos - start)\n          end\n        elsif byte_a == OPEN_CURLEY && byte_b == PERCENTAGE\n          return next_tag_token_with_start(start)\n        end\n\n        byte_a = byte_b\n      end\n\n      \"{{\"\n    end","complexity_score":56.8,"ast_json":"{\"type\":\"def\",\"children\":[\"next_variable_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},null,{\"type\":\"break\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"eos?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]},{\"type\":\"str\",\"children\":[\"{{\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"byte_b\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"scan_byte\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"!=\",{\"type\":\"const\",\"children\":[null,\"CLOSE_CURLEY\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_a\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"OPEN_CURLEY\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"byte_b\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"PERCENTAGE\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"next_tag_token_with_start\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]},null]}]},{\"type\":\"lvasgn\",\"children\":[\"byte_a\",{\"type\":\"lvar\",\"children\":[\"byte_b\"]}]}]}]},{\"type\":\"str\",\"children\":[\"{{\"]}]}]}","id":"3c5c08c1-9c9e-4d5e-b5de-0cd317078a88"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":61,"raw_source":"def head(*args, &block)     super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"head\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"f56658a7-3160-4c2c-a18e-2440f78ad9d2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":322,"raw_source":"def ucharenc(a, i, u)\n    case true\n    when u <= Uchar1max\n      a[i] = (u & 0xff).chr\n      1\n    when u <= Uchar2max\n      a[i+0] = (Utag2 | ((u>>6)&0xff)).chr\n      a[i+1] = (Utagx | (u&Umaskx)).chr\n      2\n    when u <= Uchar3max\n      a[i+0] = (Utag3 | ((u>>12)&0xff)).chr\n      a[i+1] = (Utagx | ((u>>6)&Umaskx)).chr\n      a[i+2] = (Utagx | (u&Umaskx)).chr\n      3\n    else\n      a[i+0] = (Utag4 | ((u>>18)&0xff)).chr\n      a[i+1] = (Utagx | ((u>>12)&Umaskx)).chr\n      a[i+2] = (Utagx | ((u>>6)&Umaskx)).chr\n      a[i+3] = (Utagx | (u&Umaskx)).chr\n      4\n    end\n  end","complexity_score":89.95,"ast_json":"{\"type\":\"def\",\"children\":[\"ucharenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"i\"]},{\"type\":\"arg\",\"children\":[\"u\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar1max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar2max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag2\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"<=\",{\"type\":\"const\",\"children\":[null,\"Uchar3max\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag3\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utag4\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[18]}]}]},\"&\",{\"type\":\"int\",\"children\":[255]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[12]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\">>\",{\"type\":\"int\",\"children\":[6]}]}]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"+\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utagx\"]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"u\"]},\"&\",{\"type\":\"const\",\"children\":[null,\"Umaskx\"]}]}]}]}]},\"chr\"]}]},{\"type\":\"int\",\"children\":[4]}]}]}]}","id":"eaed1b0c-5a02-4aa2-8382-ccac57a4867a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":434,"raw_source":"def where(input, property, target_value = nil)\n      filter_array(input, property, target_value) { |ary, &block| ary.select(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"where\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"select\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"65dd2265-129a-4b93-99dd-3e1968d26957"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":983,"raw_source":"def initialize(app = nil, **_kwargs)\n      super()\n      @app = app\n      @template_cache = TemplateCache.new\n      @pinned_response = nil # whether a before! filter pinned the content-type\n      yield self if block_given?\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"app\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwrestarg\",\"children\":[\"_kwargs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_cache\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateCache\"]},\"new\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]}]}]}","id":"ab37a33e-e59b-4703-ab54-c792276bb3df"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":48,"raw_source":"def accept?(type)\n      preferred_type(type).to_s.include?(type)\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"accept?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"preferred_type\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"to_s\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}","id":"78a147d5-0500-4500-9c59-8fc5198a72e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":656,"raw_source":"def test_variable_to_liquid_returns_contextual_drop\n    context = {\n      \"products\" => ProductsDrop.new([\"A\", \"B\", \"C\", \"D\", \"E\"]),\n    }\n\n    template = Liquid::Template.parse(<<~LIQUID)\n      {%- for i in (1..3) -%}\n        for_loop_products_count: {{ products | size }}\n      {% endfor %}\n\n      unscoped_products_count: {{ products | size }}\n    LIQUID\n\n    result = template.render(context)\n\n    assert_includes(result, \"for_loop_products_count: 3\")\n    assert_includes(result, \"unscoped_products_count: 5\")\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_to_liquid_returns_contextual_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductsDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"A\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"C\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"E\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  for_loop_products_count: {{ products | size }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"unscoped_products_count: {{ products | size }}\\n\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"for_loop_products_count: 3\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_includes\",{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"unscoped_products_count: 5\"]}]}]}]}","id":"0baf443b-b2a0-4499-a987-3d8ea013d937"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":41,"raw_source":"def test_range\n    assert_template_result(\"3..4\", \"{{ ( 3 .. 4 ) }}\")\n    assert_expression_result(1..2, \"(1..2)\")\n\n    assert_match_syntax_error(\n      \"Liquid syntax error (line 1): Invalid expression type 'false' in range expression\",\n      \"{{ (false..true) }}\",\n    )\n    assert_match_syntax_error(\n      \"Liquid syntax error (line 1): Invalid expression type '(1..2)' in range expression\",\n      \"{{ ((1..2)..3) }}\",\n    )\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3..4\"]},{\"type\":\"str\",\"children\":[\"{{ ( 3 .. 4 ) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"str\",\"children\":[\"(1..2)\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Invalid expression type 'false' in range expression\"]},{\"type\":\"str\",\"children\":[\"{{ (false..true) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Invalid expression type '(1..2)' in range expression\"]},{\"type\":\"str\",\"children\":[\"{{ ((1..2)..3) }}\"]}]}]}]}","id":"f5cb1604-a1ac-4f9c-b2a1-ef48f2c3596e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":123,"raw_source":"def unlink(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"UNLINK\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"unlink\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"UNLINK\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"d60ce09a-a974-4458-ad77-9fe0ca2e001f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/increment_tag_test.rb","start_line":8,"raw_source":"def test_inc\n    assert_template_result('0 1', '{%increment port %} {{ port }}')\n    assert_template_result(' 0 1 2', '{{port}} {%increment port %} {%increment port%} {{port}}')\n    assert_template_result(\n      '0 0 1 2 1',\n      '{%increment port %} {%increment starboard%} ' \\\n      '{%increment port %} {%increment port%} ' \\\n      '{%increment starboard %}',\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 1\"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {{ port }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 0 1 2\"]},{\"type\":\"str\",\"children\":[\"{{port}} {%increment port %} {%increment port%} {{port}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 0 1 2 1\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment port%} \"]},{\"type\":\"str\",\"children\":[\"{%increment starboard %}\"]}]}]}]}]}","id":"0070ceb0-d759-4e0f-b4e4-c1f5a3ffed4e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":155,"raw_source":"def clear_content_for(key)\n      content_blocks.delete(key.to_sym) if content_for?(key)\n    end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"clear_content_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_for?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},null]}]}","id":"7cd5d177-d252-4408-92d3-bcbceb1a0ea4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":125,"raw_source":"def parse_filter_expressions(filter_name, unparsed_args)\n      filter_args  = []\n      keyword_args = nil\n      unparsed_args.each do |a|\n        if (matches = a.match(JustTagAttributes))\n          keyword_args           ||= {}\n          keyword_args[matches[1]] = parse_context.parse_expression(matches[2])\n        else\n          filter_args << parse_context.parse_expression(a)\n        end\n      end\n      result = [filter_name, filter_args]\n      result << keyword_args if keyword_args\n      result\n    end","complexity_score":23.6,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_filter_expressions\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"filter_name\"]},{\"type\":\"arg\",\"children\":[\"unparsed_args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter_args\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"keyword_args\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unparsed_args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"matches\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"match\",{\"type\":\"const\",\"children\":[null,\"JustTagAttributes\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"keyword_args\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keyword_args\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matches\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"matches\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_args\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filter_name\"]},{\"type\":\"lvar\",\"children\":[\"filter_args\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keyword_args\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"keyword_args\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"29f0c3df-35e5-4ffd-a1aa-fcc70d15882c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":376,"raw_source":"def find_template(views, name, engine, &block)\n        Array(views).each { |v| super(v, name, engine, &block) }\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"views\"]},{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"views\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"345381a5-bed8-4323-a6b5-a7b10e6334e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":589,"raw_source":"def test_first_and_last_call_to_liquid\n    assert_template_result('foobar', '{{ foo | first }}', { 'foo' => [ThingWithToLiquid.new] })\n    assert_template_result('foobar', '{{ foo | last }}', { 'foo' => [ThingWithToLiquid.new] })\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_and_last_call_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo | first }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"{{ foo | last }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThingWithToLiquid\"]},\"new\"]}]}]}]}]}]}]}","id":"b3a89abc-269e-4e86-8890-121abfb81df0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":642,"raw_source":"def test_context_always_uses_static_registers\n    registers = {\n      my_register: :my_value,\n    }\n    c = Context.new({}, {}, registers)\n    assert_instance_of(Registers, c.registers)\n    assert_equal(:my_value, c.registers[:my_register])\n\n    r = Registers.new(registers)\n    c = Context.new({}, {}, r)\n    assert_instance_of(Registers, c.registers)\n    assert_equal(:my_value, c.registers[:my_register])\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_always_uses_static_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"r\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"c\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"r\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"Registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}","id":"b020e5c6-fe54-479b-acb8-6f5562840efa"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":132,"raw_source":"def init_template(page_template, template_file)\n    tmpl                         = Liquid::Template.new\n    tmpl.assigns['page_title']   = 'Page title'\n    tmpl.assigns['template']     = page_template\n    tmpl.registers[:file_system] = ThemeRunner::FileSystem.new(File.dirname(template_file))\n    tmpl\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"init_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"page_title\"]},{\"type\":\"str\",\"children\":[\"Page title\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ThemeRunner\"]},\"FileSystem\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"tmpl\"]}]}]}","id":"63b40a9b-6f34-47f0-93c7-3e9240bf5dc1"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":44,"raw_source":"def compile\n    @tests.each do |test_hash|\n      Liquid::Template.new.parse(test_hash[:liquid])\n      Liquid::Template.new.parse(test_hash[:layout])\n    end\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"new\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]}]}]}]}]}","id":"064cdb13-bdf6-4af2-9032-a8ee46409a91"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/required_params.rb","start_line":49,"raw_source":"def required_params(*keys)\n      _required_params(params, *keys)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"required_params\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"send\",\"children\":[null,\"params\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}","id":"41bf4c1e-24a4-4b32-ade2-4887db54fdf1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":215,"raw_source":"def drop_body?\n      DROP_BODY_RESPONSES.include?(status)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_body?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DROP_BODY_RESPONSES\"]},\"include?\",{\"type\":\"send\",\"children\":[null,\"status\"]}]}]}","id":"323eb623-3502-4db2-8039-632fb33f6de7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":214,"raw_source":"def respond_to(*formats)\n      @respond_to ||= nil\n\n      if formats.any?\n        @respond_to ||= []\n        @respond_to.concat formats\n      elsif @respond_to.nil? && superclass.respond_to?(:respond_to)\n        superclass.respond_to\n      else\n        @respond_to\n      end\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"formats\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@respond_to\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"formats\"]},\"any?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@respond_to\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@respond_to\"]},\"concat\",{\"type\":\"lvar\",\"children\":[\"formats\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@respond_to\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"respond_to\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to\"]},{\"type\":\"ivar\",\"children\":[\"@respond_to\"]}]}]}]}]}","id":"53e76f36-98de-41b2-990f-c9d1f5627baf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":426,"raw_source":"def test_lambda_is_called_once\n    @global = 0\n\n    @context['callcount'] = proc {\n      @global += 1\n      @global.to_s\n    }\n\n    assert_equal('1', @context['callcount'])\n    assert_equal('1', @context['callcount'])\n    assert_equal('1', @context['callcount'])\n  end","complexity_score":14.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount\"]}]}]}]}]}","id":"3f518cf3-6a4c-4492-87f6-64a28adfb529"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":211,"raw_source":"def test_profiling_marks_children_of_for_blocks\n    t = Template.parse(\"{% for item in collection %} {{ item }} {% endfor %}\", profile: true)\n    t.render!(\"collection\" => [\"one\", \"two\"])\n\n    assert_equal(1, t.profiler.length)\n    # Will profile each invocation of the for block\n    assert_equal(2, t.profiler[0].children.length)\n  end","complexity_score":14.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_of_for_blocks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in collection %} {{ item }} {% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"two\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"children\"]},\"length\"]}]}]}]}","id":"dea4d201-0f4d-4613-b8b1-20e16ce1f1cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":43,"raw_source":"def look(type, ahead = 0)\n      tok = @tokens[@p + ahead]\n      return false unless tok\n      tok[0] == type\n    end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"look\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"ahead\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tok\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@p\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"ahead\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tok\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tok\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]}]}","id":"43cb3e4b-ae7b-4124-ab9d-950757b283e5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":219,"raw_source":"def test_transform_values\n    hash2 = @hash.transform_values { |v| v.respond_to?(:upcase) ? v.upcase : v }\n\n    refute_equal @hash, hash2\n    assert_equal :A, hash2[:a]\n    assert_equal :A, hash2[?a]\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_values\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"upcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"refute_equal\",{\"type\":\"ivar\",\"children\":[\"@hash\"]},{\"type\":\"lvar\",\"children\":[\"hash2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"A\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash2\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"c0d0ca4f-31b2-4187-9272-d2768c1efac9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":220,"raw_source":"def test_some_enumerable_methods_still_get_invoked\n    [:count, :max].each do |method|\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(\"3\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n    end\n\n    assert_equal(\"yes\", Liquid::Template.parse(\"{% if collection contains 3 %}yes{% endif %}\").render!('collection' => RealEnumerableDrop.new))\n\n    [:min, :first].each do |method|\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(\"1\", Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n    end\n  end","complexity_score":55.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_some_enumerable_methods_still_get_invoked\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"count\"]},{\"type\":\"sym\",\"children\":[\"max\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% if collection contains 3 %}yes{% endif %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"min\"]},{\"type\":\"sym\",\"children\":[\"first\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}]}]}","id":"d33006b7-121f-4920-943a-7582bc43d310"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1147,"raw_source":"def static!(options = {})\n      return if (public_dir = settings.public_folder).nil?\n\n      path = \"#{public_dir}#{URI_INSTANCE.unescape(request.path_info)}\"\n      return unless valid_path?(path)\n\n      path = File.expand_path(path)\n      return unless path.start_with?(\"#{File.expand_path(public_dir)}/\")\n\n      return unless File.file?(path)\n\n      env['sinatra.static_file'] = path\n      cache_control(*settings.static_cache_control) if settings.static_cache_control?\n\n      headers(settings.static_headers) if settings.static_headers?\n\n      send_file path, options.merge(disposition: nil)\n    end","complexity_score":39.0,"ast_json":"{\"type\":\"def\",\"children\":[\"static!\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"public_dir\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"public_folder\"]}]}]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"public_dir\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI_INSTANCE\"]},\"unescape\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"path_info\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"valid_path?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"start_with?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"lvar\",\"children\":[\"public_dir\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"file?\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.static_file\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_cache_control?\"]},{\"type\":\"send\",\"children\":[null,\"cache_control\",{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_cache_control\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_headers?\"]},{\"type\":\"send\",\"children\":[null,\"headers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static_headers\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"send_file\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"disposition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}]}","id":"0f8606d2-6030-4e4c-81e2-62031b71cf4d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":98,"raw_source":"def delete(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"7c9795fe-c52f-41ce-8f56-f64ff56a9bc3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":139,"raw_source":"def test_tablerow_loop_drop_attributes\n    template = <<~LIQUID.chomp\n      {% tablerow i in (1...2) %}\n      col: {{ tablerowloop.col }}\n      col0: {{ tablerowloop.col0 }}\n      col_first: {{ tablerowloop.col_first }}\n      col_last: {{ tablerowloop.col_last }}\n      first: {{ tablerowloop.first }}\n      index: {{ tablerowloop.index }}\n      index0: {{ tablerowloop.index0 }}\n      last: {{ tablerowloop.last }}\n      length: {{ tablerowloop.length }}\n      rindex: {{ tablerowloop.rindex }}\n      rindex0: {{ tablerowloop.rindex0 }}\n      row: {{ tablerowloop.row }}\n      {% endtablerow %}\n    LIQUID\n\n    expected_output = <<~OUTPUT\n      <tr class=\"row1\">\n      <td class=\"col1\">\n      col: 1\n      col0: 0\n      col_first: true\n      col_last: false\n      first: true\n      index: 1\n      index0: 0\n      last: false\n      length: 2\n      rindex: 2\n      rindex0: 1\n      row: 1\n      </td><td class=\"col2\">\n      col: 2\n      col0: 1\n      col_first: false\n      col_last: true\n      first: false\n      index: 2\n      index0: 1\n      last: true\n      length: 2\n      rindex: 1\n      rindex0: 0\n      row: 1\n      </td></tr>\n    OUTPUT\n\n    assert_template_result(expected_output, template)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tablerow_loop_drop_attributes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% tablerow i in (1...2) %}\\n\"]},{\"type\":\"str\",\"children\":[\"col: {{ tablerowloop.col }}\\n\"]},{\"type\":\"str\",\"children\":[\"col0: {{ tablerowloop.col0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: {{ tablerowloop.col_first }}\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: {{ tablerowloop.col_last }}\\n\"]},{\"type\":\"str\",\"children\":[\"first: {{ tablerowloop.first }}\\n\"]},{\"type\":\"str\",\"children\":[\"index: {{ tablerowloop.index }}\\n\"]},{\"type\":\"str\",\"children\":[\"index0: {{ tablerowloop.index0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"last: {{ tablerowloop.last }}\\n\"]},{\"type\":\"str\",\"children\":[\"length: {{ tablerowloop.length }}\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: {{ tablerowloop.rindex }}\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: {{ tablerowloop.rindex0 }}\\n\"]},{\"type\":\"str\",\"children\":[\"row: {{ tablerowloop.row }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endtablerow %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"col: 1\\n\"]},{\"type\":\"str\",\"children\":[\"col0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: true\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: false\\n\"]},{\"type\":\"str\",\"children\":[\"first: true\\n\"]},{\"type\":\"str\",\"children\":[\"index: 1\\n\"]},{\"type\":\"str\",\"children\":[\"index0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"last: false\\n\"]},{\"type\":\"str\",\"children\":[\"length: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"row: 1\\n\"]},{\"type\":\"str\",\"children\":[\"</td><td class=\\\"col2\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"col: 2\\n\"]},{\"type\":\"str\",\"children\":[\"col0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"col_first: false\\n\"]},{\"type\":\"str\",\"children\":[\"col_last: true\\n\"]},{\"type\":\"str\",\"children\":[\"first: false\\n\"]},{\"type\":\"str\",\"children\":[\"index: 2\\n\"]},{\"type\":\"str\",\"children\":[\"index0: 1\\n\"]},{\"type\":\"str\",\"children\":[\"last: true\\n\"]},{\"type\":\"str\",\"children\":[\"length: 2\\n\"]},{\"type\":\"str\",\"children\":[\"rindex: 1\\n\"]},{\"type\":\"str\",\"children\":[\"rindex0: 0\\n\"]},{\"type\":\"str\",\"children\":[\"row: 1\\n\"]},{\"type\":\"str\",\"children\":[\"</td></tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"d36827e9-3f7c-4245-8799-cce6b66f60af"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":174,"raw_source":"def patch(uri, params = {}, env = {}, &block)\n        env = env_for(uri, env.merge(method: 'PATCH', params: params))\n        current_session.send(:process_request, uri, env, &block)\n      end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[null,\"env_for\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"PATCH\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_session\"]},\"send\",{\"type\":\"sym\",\"children\":[\"process_request\"]},{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"3ec02f78-cf7d-45c4-9f6c-f484825f19e9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":105,"raw_source":"def test_nil_limit_is_treated_as_zero\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) limit:nil %}{{ i }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) limit:var %}{{ i }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_limit_is_treated_as_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) limit:nil %}{{ i }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) limit:var %}{{ i }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"001a8f8c-2957-4760-a988-7f13bc5b6e0c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":34,"raw_source":"def test_assigning_from_capture\n    template_source = <<~END_TEMPLATE\n      {% assign first = '' -%}\n      {% assign second = '' -%}\n      {% for number in (1..3) -%}\n        {% capture first %}{{number}}{% endcapture -%}\n        {% assign second = first -%}\n      {% endfor -%}\n      {{ first }}-{{ second -}}\n    END_TEMPLATE\n    assert_template_result(\"3-3\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assigning_from_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign first = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign second = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% for number in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture first %}{{number}}{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign second = first -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ first }}-{{ second -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3-3\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}","id":"d8c96ff0-ff90-444f-b67c-fe11f2640379"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/echo.rb","start_line":29,"raw_source":"def render(context)\n      @variable.render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}","id":"ef7000e5-d250-4051-83af-a335bfca3b88"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":42,"raw_source":"def test_table_col_counter\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row3\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n\",\n      '{% tablerow n in numbers cols:2%}{{tablerowloop.col}}{% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_col_counter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n<tr class=\\\"row3\\\"><td class=\\\"col1\\\">1</td><td class=\\\"col2\\\">2</td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:2%}{{tablerowloop.col}}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}","id":"cb283bd7-0119-4d9a-9b11-5cbbfe76ee07"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":355,"raw_source":"def method_missing(method, *args, &block)\n        base.send(method, *args, &block)\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"19a8ccdd-83c7-4fd1-bedb-c8df795b145a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":8,"raw_source":"def test_assign_with_hyphen_in_variable_name\n    template_source = <<~END_TEMPLATE\n      {% assign this-thing = 'Print this-thing' -%}\n      {{ this-thing -}}\n    END_TEMPLATE\n    assert_template_result(\"Print this-thing\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_with_hyphen_in_variable_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign this-thing = 'Print this-thing' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ this-thing -}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Print this-thing\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}","id":"5c3181fd-03b4-4329-b1ef-6632d4778376"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":77,"raw_source":"def test_strainer_returns_first_argument_if_no_method_and_arguments_given\n    strainer = @environment.create_strainer(@context)\n    assert_equal(\"password\", strainer.invoke(\"undef_the_method\", \"password\"))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_returns_first_argument_if_no_method_and_arguments_given\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"password\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"undef_the_method\"]},{\"type\":\"str\",\"children\":[\"password\"]}]}]}]}]}","id":"cd49b0ee-f14c-49ba-ba1a-60df9da4f298"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":100,"raw_source":"def test_rendering_hash_without_custom_to_s_uses_default_inspect\n    my_hash = Class.new(Hash).new\n    my_hash[:foo] = :bar\n\n    assert_template_result(\"{:foo=>:bar}\", \"{{ my_hash }}\", { \"my_hash\" => my_hash })\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_rendering_hash_without_custom_to_s_uses_default_inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"my_hash\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"my_hash\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"sym\",\"children\":[\"bar\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{:foo=>:bar}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"my_hash\"]}]}]}]}]}]}","id":"98ffb41d-46ec-46b1-9cea-3b3b9daded32"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/capture.rb","start_line":25,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      if markup =~ Syntax\n        @to = Regexp.last_match(1)\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.capture\")\n      end\n    end","complexity_score":8.43,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@to\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.capture\"]}]}]}]}]}]}","id":"28f6a435-ea29-4fe9-b327-4ebe58cbd069"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":532,"raw_source":"def test_pre_trim_blank_preceding_text\n    assert_template_result(\"\", \"\\n{%- raw %}{% endraw %}\")\n    assert_template_result(\"\", \"\\n{%- if true %}{% endif %}\")\n    assert_template_result(\"BC\", \"{{ 'B' }} \\n{%- if true %}C{% endif %}\")\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_blank_preceding_text\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\\n{%- raw %}{% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"\\n{%- if true %}{% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"BC\"]},{\"type\":\"str\",\"children\":[\"{{ 'B' }} \\n{%- if true %}C{% endif %}\"]}]}]}]}","id":"63c52f53-6eb5-465c-b74f-80799bc91d43"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":163,"raw_source":"def children\n        [\n          @node.left,\n          @node.right,\n          @node.child_condition,\n          @node.attachment\n        ].compact\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"left\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"child_condition\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attachment\"]}]},\"compact\"]}]}","id":"20cbe99d-56d5-4839-bb5e-dcc0b132c0c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":221,"raw_source":"def test_setting_exception_renderer_on_environment\n    exceptions = []\n    exception_renderer = ->(e) do\n      exceptions << e\n      ''\n    end\n\n    environment = Liquid::Environment.build(exception_renderer: exception_renderer)\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.argument_error }}', environment: environment)\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: ', output)\n    assert_equal([Liquid::ArgumentError], template.errors.map(&:class))\n  end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_setting_exception_renderer_on_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"exception_renderer\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.argument_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}","id":"4a07a295-ecbf-4455-b5b0-90ab48809563"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":781,"raw_source":"def last(array)\n      array.last if array.respond_to?(:last)\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"array\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"array\"]},\"last\"]},null]}]}","id":"aab9c9f1-477f-4b18-a017-46f152ac556f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":307,"raw_source":"def template(name, &block)\n        first_location = caller_locations.first\n        filename = first_location.path\n        line = first_location.lineno\n        templates[name] = [block, filename, line]\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"path\"]}]},{\"type\":\"lvasgn\",\"children\":[\"line\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first_location\"]},\"lineno\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"lvar\",\"children\":[\"line\"]}]}]}]}]}","id":"e7e3b52f-328a-4829-ad15-139e099f5b25"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":137,"raw_source":"def test_nested_include_tag\n    partials = { \"body\" => \"body {% include 'body_detail' %}\", \"body_detail\" => \"body_detail\" }\n    assert_template_result(\"body body_detail\", \"{% include 'body' %}\", partials: partials)\n\n    partials = partials.merge({\n      \"nested_template\" => \"{% include 'header' %} {% include 'body' %} {% include 'footer' %}\",\n      \"header\" => \"header\",\n      \"footer\" => \"footer\",\n    })\n    assert_template_result(\"header body body_detail footer\", \"{% include 'nested_template' %}\", partials: partials)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_include_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body\"]},{\"type\":\"str\",\"children\":[\"body {% include 'body_detail' %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"body_detail\"]},{\"type\":\"str\",\"children\":[\"body_detail\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"body body_detail\"]},{\"type\":\"str\",\"children\":[\"{% include 'body' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partials\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested_template\"]},{\"type\":\"str\",\"children\":[\"{% include 'header' %} {% include 'body' %} {% include 'footer' %}\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"header\"]},{\"type\":\"str\",\"children\":[\"header\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"footer\"]},{\"type\":\"str\",\"children\":[\"footer\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"header body body_detail footer\"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}","id":"b9ad1cdc-2bae-48c5-a5f9-8935ea5ba893"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":124,"raw_source":"def pop\n      raise ContextError if @scopes.size == 1\n      @scopes.shift\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"pop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"size\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ContextError\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"shift\"]}]}]}","id":"c65bc212-927b-4fb2-b73b-e184863936fa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":401,"raw_source":"def test_sort_natural_empty_array\n    assert_equal([], @filters.sort_natural([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}","id":"7a173ca5-9f5e-4b57-8baa-c19014f25c58"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2165,"raw_source":"def self.helpers(*extensions, &block)\n    Delegator.target.helpers(*extensions, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"helpers\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"14a2f845-f4cd-489f-bed3-ab3619337007"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":94,"raw_source":"def log\n      @log ||= +''\n      loop { @log << pipe.read_nonblock(1) }\n    rescue Exception\n      @log\n    end","complexity_score":10.73,"ast_json":"{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@log\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@log\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"pipe\"]},\"read_nonblock\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},null,{\"type\":\"ivar\",\"children\":[\"@log\"]}]},null]}]}","id":"ab8c93e2-30e6-48e5-ad78-b11cd4a49f15"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":18,"raw_source":"def test_true_lq_true\n    text = ' {% if 0 > 0 %} true {% else %} false {% endif %} '\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_lq_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 > 0 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"3bcf0ff4-e0f9-4d6b-b692-69e568d3479f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":108,"raw_source":"def resolve_encoder(options = {})\n      options[:json_encoder] || settings.json_encoder\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_encoder\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"json_encoder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"json_encoder\"]}]}]}","id":"77a5bf3c-1274-4239-8380-227073311894"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":6,"raw_source":"def method_missing(*a, &b)\n      @last_call = [*a.map(&:to_s)]\n      @last_call << b if b\n    end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]},{\"type\":\"blockarg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@last_call\",{\"type\":\"array\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@last_call\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"b\"]}]},null]}]}]}","id":"a626e046-dbf0-4759-ae4b-bcc9270e9ebe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/continue_tag_test.rb","start_line":10,"raw_source":"def test_continue_with_no_block\n    assigns  = {}\n    markup   = '{% continue %}'\n    expected = ''\n\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_continue_with_no_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% continue %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"1a460b46-2454-4681-b722-cb392e547f86"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/required_params.rb","start_line":55,"raw_source":"def _required_params(p, *keys)\n      keys.each do |key|\n        if key.is_a?(Hash)\n          _required_params(p, *key.keys)\n          key.each do |k, v|\n            _required_params(p[k.to_s], v)\n          end\n        elsif key.is_a?(Array)\n          _required_params(p, *key)\n        else\n          halt 400 unless p.respond_to?(:key?) && p&.key?(key.to_s)\n        end\n      end\n      true\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"_required_params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]},{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"keys\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"send\",\"children\":[null,\"_required_params\",{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[400]}]}]}]}]}]},{\"type\":\"true\",\"children\":[]}]}]}","id":"0daffa0b-347c-4c47-950f-065a1d6b0c38"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":420,"raw_source":"def test_array_containing_lambda_as_variable\n    @context['dynamic'] = [1, 2, proc { 'Hello' }, 4, 5]\n\n    assert_equal('Hello', @context['dynamic[2]'])\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_array_containing_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic[2]\"]}]}]}]}]}","id":"5eef7b29-e67c-4776-9d53-f4e0e0d60d21"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/content_for.rb","start_line":176,"raw_source":"def yield_content(key, *args, &block)\n      if block_given? && !content_for?(key)\n        haml? && Tilt[:haml] == Tilt::HamlTemplate && respond_to?(:capture_haml) ? capture_haml(*args, &block) : yield(*args)\n      else\n        content = content_blocks[key.to_sym].map { |b| capture(*args, &b) }\n        content.join.tap do |c|\n          if block_given? && (erb? || erubi?)\n            @_out_buf << c\n          end\n        end\n      end\n    end","complexity_score":42.6,"ast_json":"{\"type\":\"def\",\"children\":[\"yield_content\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_for?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"haml?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"haml\"]}]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"HamlTemplate\"]}]}]},{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"sym\",\"children\":[\"capture_haml\"]}]}]},{\"type\":\"send\",\"children\":[null,\"capture_haml\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"content_blocks\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_sym\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"capture\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"content\"]},\"join\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"erb?\"]},{\"type\":\"send\",\"children\":[null,\"erubi?\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"c\"]}]},null]}]}]}]}]}","id":"37c1d3f8-153a-467a-a30d-7efbbc6af02a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":136,"raw_source":"def respond_with(template, object = nil, &block)\n        unless Symbol === template\n          object = template\n          template = nil\n        end\n        format = Format.new(self)\n        format.on '*/*' do |type|\n          exts = settings.ext_map[type]\n          exts << :xml if type.end_with? '+xml'\n          if template\n            args = template_cache.fetch(type, template) { template_for(template, exts) }\n            if args.any?\n              locals = { object: object }\n              locals.merge! object.to_hash if object.respond_to? :to_hash\n\n              renderer = args.first\n              options = args[1..] + [{ locals: locals }]\n\n              halt send(renderer, *options)\n            end\n          end\n          if object\n            exts.each do |ext|\n              halt json(object) if ext == :json\n              next unless object.respond_to? method = \"to_#{ext}\"\n\n              halt(*object.send(method))\n            end\n          end\n          false\n        end\n        format.finish(&block)\n      end","complexity_score":77.6,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_with\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"object\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"format\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Format\"]},\"new\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"on\",{\"type\":\"str\",\"children\":[\"*/*\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exts\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"ext_map\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"+xml\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"<<\",{\"type\":\"sym\",\"children\":[\"xml\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_cache\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"template_for\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"exts\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"any?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"object\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"locals\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"to_hash\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"renderer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"first\"]}]},{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},null]}]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locals\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"send\",\"children\":[null,\"send\",{\"type\":\"lvar\",\"children\":[\"renderer\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},null]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"==\",{\"type\":\"sym\",\"children\":[\"json\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"send\",\"children\":[null,\"json\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"lvasgn\",\"children\":[\"method\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"to_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]}]}]}]}]}]},null]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"format\"]},\"finish\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"6fb32a0c-431d-4c6a-9e69-79f7267071e9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":346,"raw_source":"def test_ifchanged\n    assigns = { 'array' => [1, 1, 2, 2, 3, 3] }\n    assert_template_result('123', '{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}', assigns)\n\n    assigns = { 'array' => [1, 1, 1, 1] }\n    assert_template_result('1', '{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}', assigns)\n  end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ifchanged\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{%ifchanged%}{{item}}{% endifchanged %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"b0965754-00eb-40e5-b21f-41f35c8820f5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":173,"raw_source":"def <=>(other)\n    to_liquid_value <=> Liquid::Utils.to_liquid_value(other)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"<=>\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_liquid_value\"]},\"<=>\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"other\"]}]}]}]}","id":"0f3dbae6-b2a6-4fb0-bf83-7e56b910ad80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":791,"raw_source":"def rdoc(template, options = {}, locals = {})\n      render :rdoc, template, options, locals\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"rdoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"rdoc\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}","id":"c95fa601-5f9c-4295-a9d8-d2fa500af849"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":32,"raw_source":"def link_to_vendor(vendor)\n    if vendor\n      link_to(vendor, url_for_vendor(vendor), vendor)\n    else\n      'Unknown Vendor'\n    end\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_vendor\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"vendor\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"vendor\"]},{\"type\":\"send\",\"children\":[null,\"link_to\",{\"type\":\"lvar\",\"children\":[\"vendor\"]},{\"type\":\"send\",\"children\":[null,\"url_for_vendor\",{\"type\":\"lvar\",\"children\":[\"vendor\"]}]},{\"type\":\"lvar\",\"children\":[\"vendor\"]}]},{\"type\":\"str\",\"children\":[\"Unknown Vendor\"]}]}]}","id":"25c6b948-6ff0-4d03-b08f-3aa30aae1e93"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":891,"raw_source":"def test_reject_with_false_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok', false | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject_with_false_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok', false | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"d9822804-0bcb-4551-97b8-265e5ae18af2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/lexer.rb","start_line":172,"raw_source":"def raise_syntax_error(start_pos, ss)\n        ss.pos = start_pos\n        # the character could be a UTF-8 character, use getch to get all the bytes\n        raise SyntaxError, \"Unexpected character #{ss.getch}\"\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_syntax_error\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_pos\"]},{\"type\":\"arg\",\"children\":[\"ss\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"pos=\",{\"type\":\"lvar\",\"children\":[\"start_pos\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unexpected character \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ss\"]},\"getch\"]}]}]}]}]}]}","id":"b6940025-309f-4f6c-8d1c-9bf95be03951"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":108,"raw_source":"def test_include_tag_caches_second_read_of_same_partial\n    file_system = StubFileSystem.new('snippet' => 'echo')\n    assert_equal(\n      'echoecho',\n      Template.parse('{% render \"snippet\" %}{% render \"snippet\" %}')\n      .render!({}, registers: { file_system: file_system }),\n    )\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_caches_second_read_of_same_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"echo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"echoecho\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}{% render \\\"snippet\\\" %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}","id":"e23c4b2c-8119-48e5-b1a4-7ba277670098"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":15,"raw_source":"def test_output_in_raw\n    assert_template_result('>{{ test }}<', '> {%- raw -%}{{ test }}{%- endraw -%} <')\n    assert_template_result(\"> inner  <\", \"> {%- raw -%} inner {%- endraw %} <\")\n    assert_template_result(\"> inner <\", \"> {%- raw -%} inner {%- endraw -%} <\")\n    assert_template_result(\"{Hello}\", \"{% raw %}{{% endraw %}Hello{% raw %}}{% endraw %}\")\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_output_in_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\">{{ test }}<\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%}{{ test }}{%- endraw -%} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"> inner  <\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%} inner {%- endraw %} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"> inner <\"]},{\"type\":\"str\",\"children\":[\"> {%- raw -%} inner {%- endraw -%} <\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{Hello}\"]},{\"type\":\"str\",\"children\":[\"{% raw %}{{% endraw %}Hello{% raw %}}{% endraw %}\"]}]}]}]}","id":"30e8916d-5721-470b-a4ba-8cbf967104a7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":64,"raw_source":"def test_complex_unless_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless 1 == 1 and 2 == test %}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_unless_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless 1 == 1 and 2 == test %}{% endunless %}\"]}]}]}]}","id":"46e6a520-51e9-47af-8834-0cc262f0f688"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":36,"raw_source":"def test_sets_default_path_to_en\n    assert_equal(I18n::DEFAULT_LOCALE, I18n.new.path)\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_path_to_en\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"DEFAULT_LOCALE\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\"]},\"path\"]}]}]}","id":"54cb3b07-9f22-46b0-bdf1-c7e036a254bc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":241,"raw_source":"def self.jrubyify(engs)\n      not_supported = [:markdown]\n      engs.each_key do |key|\n        engs[key].collect! { |eng| eng == :yajl ? :json_pure : eng }\n        engs[key].delete_if { |eng| not_supported.include?(eng) }\n      end\n      engs\n    end","complexity_score":14.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"jrubyify\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engs\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"not_supported\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"markdown\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"collect!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"eng\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"eng\"]},\"==\",{\"type\":\"sym\",\"children\":[\"yajl\"]}]},{\"type\":\"sym\",\"children\":[\"json_pure\"]},{\"type\":\"lvar\",\"children\":[\"eng\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engs\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"eng\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_supported\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"eng\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"engs\"]}]}]}","id":"934906df-6823-4d63-8869-057d35da821d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":125,"raw_source":"def test_and_condition\n    condition = Condition.new(1, '==', 1)\n\n    assert_equal(true, condition.evaluate(Context.new))\n\n    condition.and(Condition.new(2, '==', 2))\n\n    assert_equal(true, condition.evaluate(Context.new))\n\n    condition.and(Condition.new(2, '==', 1))\n\n    assert_equal(false, condition.evaluate(Context.new))\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_and_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"and\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"and\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"condition\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}","id":"a30b6c79-dfcf-4ef2-a902-ca2fbea98463"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":528,"raw_source":"def test_new_isolated_subcontext_inherits_static_environment\n    super_context = Context.build(static_environments: { 'my_environment_value' => 'my value' })\n    subcontext    = super_context.new_isolated_subcontext\n\n    assert_equal('my value', subcontext['my_environment_value'])\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_static_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"static_environments\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_environment_value\"]},{\"type\":\"str\",\"children\":[\"my value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"[]\",{\"type\":\"str\",\"children\":[\"my_environment_value\"]}]}]}]}]}","id":"01f330ad-dcd5-44ba-99fd-ef4ce8f43db3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":57,"raw_source":"def test_argument\n    template = Liquid::Template.parse(' {{ errors.argument_error }} ')\n    assert_equal(' Liquid error: argument error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(ArgumentError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.argument_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid error: argument error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}","id":"57e3b4c0-ea5b-4031-990f-bab3978a0545"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":159,"raw_source":"def test_single_line_pre_tag\n    text     = '<p> {%- if true %} yes {%- endif %} </p>'\n    expected = '<p> yes </p>'\n    assert_template_result(expected, text)\n\n    text     = '<p> {%- if false %} no {%- endif %} </p>'\n    expected = '<p> </p>'\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_line_pre_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if true %} yes {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> yes </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p> {%- if false %} no {%- endif %} </p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p> </p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"b777fe86-c450-4f46-91ea-99190f994023"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":193,"raw_source":"def key(value)\n        to_hash.key(value)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"key\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}","id":"de1eec91-d461-4f4b-a005-23acd7046158"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":204,"raw_source":"def test_assign\n    assert_equal(\n      [\"test\"],\n      visit(%({% assign x = test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% assign x = test %}\"]}]}]}]}","id":"edf3d3e2-2821-40d3-bd45-d2b45cab4508"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/cycle.rb","start_line":23,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      case markup\n      when NamedSyntax\n        @variables = variables_from_string(Regexp.last_match(2))\n        @name      = parse_expression(Regexp.last_match(1))\n        @is_named = true\n      when SimpleSyntax\n        @variables = variables_from_string(markup)\n        @name      = @variables.to_s\n        @is_named = !@name.match?(/\\w+:0x\\h{8}/)\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.cycle\")\n      end\n    end","complexity_score":25.3,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NamedSyntax\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variables\",{\"type\":\"send\",\"children\":[null,\"variables_from_string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_named\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SimpleSyntax\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variables\",{\"type\":\"send\",\"children\":[null,\"variables_from_string\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variables\"]},\"to_s\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_named\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@name\"]},\"match?\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\w+:0x\\\\h{8}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"!\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.cycle\"]}]}]}]}]}]}","id":"cf969eb2-5d62-4c92-8bf7-9ed866044d08"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":246,"raw_source":"def test_default_to_s_on_drops\n    assert_equal('ProductDrop', Liquid::Template.parse(\"{{ product }}\").render!('product' => ProductDrop.new))\n    assert_equal('EnumerableDrop', Liquid::Template.parse('{{ collection }}').render!('collection' => EnumerableDrop.new))\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_to_s_on_drops\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ProductDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"EnumerableDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ collection }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"5a925227-a597-4203-afc3-452955e4720c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":50,"raw_source":"def test_comments_are_blank\n    assert_template_result(\"\", wrap(\" {% comment %} whatever {% endcomment %} \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comments_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% comment %} whatever {% endcomment %} \"]}]}]}]}","id":"c311c7a3-7c20-4b30-9a0e-ab2a03eba64e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":143,"raw_source":"def merge(*other_hashes, &block)\n      dup.merge!(*other_hashes, &block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"merge\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"other_hashes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"merge!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hashes\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"c8cd3252-746d-469d-94d4-8778fa33f184"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":55,"raw_source":"def raise_tag_never_closed(block_name)\n      raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_never_closed\", block_name: block_name)\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"raise_tag_never_closed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block_name\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_never_closed\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]}]}]}]}]}","id":"46b6ce05-7280-4158-9bdc-cb678d0d9da8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":711,"raw_source":"def etag_matches?(list, new_resource = request.post?)\n      return !new_resource if list == '*'\n\n      list.to_s.split(/\\s*,\\s*/).include? response['ETag']\n    end","complexity_score":12.5,"ast_json":"{\"type\":\"def\",\"children\":[\"etag_matches?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"list\"]},{\"type\":\"optarg\",\"children\":[\"new_resource\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"post?\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"==\",{\"type\":\"str\",\"children\":[\"*\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_resource\"]},\"!\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"list\"]},\"to_s\"]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s*,\\\\s*\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"ETag\"]}]}]}]}]}","id":"d6fcfd53-faf5-4ae9-ad02-35d29715bd58"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":472,"raw_source":"def close\n        return if closed?\n\n        @closed = true\n        @scheduler.schedule { @callbacks.each { |c| c.call } }\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"close\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"closed?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"ivasgn\",\"children\":[\"@closed\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scheduler\"]},\"schedule\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"call\"]}]}]}]}]}","id":"dc74ea17-a5f3-4e75-aa5d-23c40c48e525"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":87,"raw_source":"def report(env)\n        warn env, \"attack reported by #{self.class}\"\n        env[options[:report_key]] = true\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"report\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack reported by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"report_key\"]}]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"47c67c0d-03de-4367-86f7-5d1e741a6b89"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rdoc_test.rb","start_line":8,"raw_source":"def rdoc_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"rdoc_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"df09cf23-b4e7-4d71-b09b-cac18db84250"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":460,"raw_source":"def has(input, property, target_value = nil)\n      filter_array(input, property, target_value, false) { |ary, &block| ary.any?(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"has\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"any?\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"9907bae1-3e43-46b6-86b9-f21956b41205"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":49,"raw_source":"def test_variable_parser_with_large_input\n    Timeout.timeout(1) { assert_equal(['[var]'], '[var]'.scan(VariableParser)) }\n\n    very_long_string = \"foo\" * 1000\n\n    # valid dynamic lookup\n    Timeout.timeout(1) { assert_equal([\"[#{very_long_string}]\"], \"[#{very_long_string}]\".scan(VariableParser)) }\n    # invalid dynamic lookup with missing closing bracket\n    Timeout.timeout(1) { assert_equal([very_long_string], \"[#{very_long_string}\".scan(VariableParser)) }\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_parser_with_large_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[var]\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"very_long_string\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"*\",{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"str\",\"children\":[\"]\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"str\",\"children\":[\"]\"]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_string\"]}]}]},\"scan\",{\"type\":\"const\",\"children\":[null,\"VariableParser\"]}]}]}]}]}]}","id":"d7b51938-7fda-4e3a-8e86-e99e05d9e04c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":203,"raw_source":"def compare_with_real_token(token, session)\n        secure_compare(token, real_token(session))\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_real_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"real_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]}","id":"f2554a29-bce7-45a8-974c-4cb95aae170e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":87,"raw_source":"def test_doc_tag_does_not_allow_nested_docs\n    error = assert_raises(Liquid::SyntaxError) do\n      template = <<~LIQUID.chomp\n        {% doc %}\n          {% doc %}\n            {% doc %}\n        {% enddoc %}\n      LIQUID\n\n      Liquid::Template.parse(template)\n    end\n\n    exp_error = \"Liquid syntax error: Syntax Error in 'doc' - Nested doc tags are not allowed\"\n    act_error = error.message\n\n    assert_equal(exp_error, act_error)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_does_not_allow_nested_docs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exp_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Syntax Error in 'doc' - Nested doc tags are not allowed\"]}]},{\"type\":\"lvasgn\",\"children\":[\"act_error\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exp_error\"]},{\"type\":\"lvar\",\"children\":[\"act_error\"]}]}]}]}","id":"bb8aadf1-1c13-4b83-ba2d-ae8ad9a7052e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":70,"raw_source":"def escape(object)\n        case object\n        when Hash   then escape_hash(object)\n        when Array  then object.map { |o| escape(o) }\n        when String then escape_string(object)\n        when Tempfile then object\n        end\n      end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"escape\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"escape_hash\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"escape\",{\"type\":\"lvar\",\"children\":[\"o\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"escape_string\",{\"type\":\"lvar\",\"children\":[\"object\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tempfile\"]},{\"type\":\"lvar\",\"children\":[\"object\"]}]},null]}]}","id":"fbfcc22f-d939-4e88-8740-f73f3c272f3b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/increment_tag_test.rb","start_line":19,"raw_source":"def test_dec\n    assert_template_result('-1 -1', '{%decrement port %} {{ port }}', { 'port' => 10 })\n    assert_template_result(' -1 -2 -2', '{{port}} {%decrement port %} {%decrement port%} {{port}}')\n    assert_template_result(\n      '0 1 2 0 3 1 1 3',\n      '{%increment starboard %} {%increment starboard%} {%increment starboard%} ' \\\n      '{%increment port %} {%increment starboard%} ' \\\n      '{%increment port %} {%decrement port%} ' \\\n      '{%decrement starboard %}',\n    )\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dec\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-1 -1\"]},{\"type\":\"str\",\"children\":[\"{%decrement port %} {{ port }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"port\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" -1 -2 -2\"]},{\"type\":\"str\",\"children\":[\"{{port}} {%decrement port %} {%decrement port%} {{port}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0 1 2 0 3 1 1 3\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%increment starboard %} {%increment starboard%} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%increment starboard%} \"]},{\"type\":\"str\",\"children\":[\"{%increment port %} {%decrement port%} \"]},{\"type\":\"str\",\"children\":[\"{%decrement starboard %}\"]}]}]}]}]}","id":"32731f35-bd93-4002-ae61-4b970f4026c1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":64,"raw_source":"def shift_normal\n      token = next_token\n\n      return unless token\n\n      token\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"shift_normal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"next_token\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}","id":"cb27ab28-3dc7-4db3-aeeb-317bf7c41b50"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":230,"raw_source":"def with_disabled_tags(tag_names)\n      tag_names.each do |name|\n        @disabled_tags[name] = @disabled_tags.fetch(name, 0) + 1\n      end\n      yield\n    ensure\n      tag_names.each do |name|\n        @disabled_tags[name] -= 1\n      end\n    end","complexity_score":9.73,"ast_json":"{\"type\":\"def\",\"children\":[\"with_disabled_tags\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_names\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"int\",\"children\":[0]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"a9d336ec-6c2b-4ce3-b5c0-a69835ad6a1c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":52,"raw_source":"def children\n        [@node.start_obj, @node.end_obj]\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"start_obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"end_obj\"]}]}]}","id":"98200c0f-377c-4d1a-9e5d-e5b3113f6956"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":8,"raw_source":"def test_unless\n    assert_template_result('  ', ' {% unless true %} this text should not go into the output {% endunless %} ')\n    assert_template_result(\n      '  this text should go into the output  ',\n      ' {% unless false %} this text should go into the output {% endunless %} ',\n    )\n    assert_template_result('  you rock ?', '{% unless true %} you suck {% endunless %} {% unless false %} you rock {% endunless %}?')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"str\",\"children\":[\" {% unless true %} this text should not go into the output {% endunless %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  this text should go into the output  \"]},{\"type\":\"str\",\"children\":[\" {% unless false %} this text should go into the output {% endunless %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  you rock ?\"]},{\"type\":\"str\",\"children\":[\"{% unless true %} you suck {% endunless %} {% unless false %} you rock {% endunless %}?\"]}]}]}]}","id":"6a8eaccb-1739-4bbc-9e05-a02dbdaab95b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":324,"raw_source":"def self.registered(klass)\n          klass.after { @bye = 'bye' }\n        end","complexity_score":3.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"after\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@bye\",{\"type\":\"str\",\"children\":[\"bye\"]}]}]}]}","id":"4ece1509-9813-476c-ad04-75b8de268d2c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":84,"raw_source":"def extract_host(authority)\n        authority.to_s.split(PORT_REGEXP).first&.downcase\n      end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"extract_host\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"authority\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"authority\"]},\"to_s\"]},\"split\",{\"type\":\"const\",\"children\":[null,\"PORT_REGEXP\"]}]},\"first\"]},\"downcase\"]}]}","id":"2eb17c4c-3430-4abb-94a3-64d83df12975"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":37,"raw_source":"def self.raise_unknown_tag(tag, block_name, block_delimiter, parse_context)\n      if tag == 'else'\n        raise SyntaxError, parse_context.locale.t(\n          \"errors.syntax.unexpected_else\",\n          block_name: block_name,\n        )\n      elsif tag.start_with?('end')\n        raise SyntaxError, parse_context.locale.t(\n          \"errors.syntax.invalid_delimiter\",\n          tag: tag,\n          block_name: block_name,\n          block_delimiter: block_delimiter,\n        )\n      else\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.unknown_tag\", tag: tag)\n      end\n    end","complexity_score":16.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"raise_unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"block_name\"]},{\"type\":\"arg\",\"children\":[\"block_delimiter\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unexpected_else\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"end\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.invalid_delimiter\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_name\"]},{\"type\":\"lvar\",\"children\":[\"block_name\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"block_delimiter\"]},{\"type\":\"lvar\",\"children\":[\"block_delimiter\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.unknown_tag\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]}]}]}]}]}","id":"9b552391-eb13-4c77-a0bd-8d7b86162451"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":112,"raw_source":"def test_expression_cache_with_lru_redux\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    cache = LruRedux::Cache.new(10)\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    Liquid::Template.parse(template, expression_cache: cache).render\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":19.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache_with_lru_redux\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LruRedux\"]},\"Cache\"]},\"new\",{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}","id":"957d3f66-d2c4-4dcf-be60-13139e779518"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1514,"raw_source":"def condition(name = \"#{caller.first[/`.*'/]} condition\", &block)\n        @conditions << generate_method(name, &block)\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"condition\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller\"]},\"first\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"`.*'\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\" condition\"]}]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"generate_method\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"ac9dc32f-fea8-4956-a6c0-336d184af69c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":211,"raw_source":"def test_enumerable_drop_will_invoke_liquid_method_missing_for_clashing_method_names\n    [\"select\", \"each\", \"map\", \"cycle\"].each do |method|\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => EnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection.#{method}}}\").render!('collection' => RealEnumerableDrop.new))\n      assert_equal(method.to_s, Liquid::Template.parse(\"{{collection[\\\"#{method}\\\"]}}\").render!('collection' => RealEnumerableDrop.new))\n    end\n  end","complexity_score":30.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop_will_invoke_liquid_method_missing_for_clashing_method_names\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"select\"]},{\"type\":\"str\",\"children\":[\"each\"]},{\"type\":\"str\",\"children\":[\"map\"]},{\"type\":\"str\",\"children\":[\"cycle\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection.\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{collection[\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]}]},{\"type\":\"str\",\"children\":[\"\\\"]}}\"]}]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"new\"]}]}]}]}]}]}]}]}","id":"4c0f77c1-00f3-411a-9834-2b3c46e91d95"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":8,"raw_source":"def test_true_eql_true\n    text = ' {% if true == true %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_true_eql_true\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if true == true %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"c8732953-76fe-4d94-8d3d-7b9a9f448614"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":52,"raw_source":"def with_disableable_tags\n    with_custom_tag('custom', Custom) do\n      with_custom_tag('custom2', Custom2) do\n        yield\n      end\n    end\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_disableable_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"custom\"]},{\"type\":\"const\",\"children\":[null,\"Custom\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"custom2\"]},{\"type\":\"const\",\"children\":[null,\"Custom2\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"yield\",\"children\":[]}]}]}]}","id":"c5c7b273-0020-4127-8bba-6a2ff1595a46"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":36,"raw_source":"def initialize(method_name, to_s)\n        @method_name = method_name\n        @to_s = to_s\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]},{\"type\":\"arg\",\"children\":[\"to_s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@method_name\",{\"type\":\"lvar\",\"children\":[\"method_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@to_s\",{\"type\":\"lvar\",\"children\":[\"to_s\"]}]}]}]}","id":"efdcf0fb-101f-49b1-834b-bd6a43a7be1c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":152,"raw_source":"def test_context_drop_array_with_map\n    output = Liquid::Template.parse(' {{ contexts | map: \"bar\" }} ').render!('contexts' => [ContextDrop.new, ContextDrop.new], 'bar' => \"carrot\")\n    assert_equal(' carrotcarrot ', output)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_drop_array_with_map\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ contexts | map: \\\"bar\\\" }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"contexts\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"carrot\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" carrotcarrot \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"2c2949ac-4c92-4560-a7a1-8a2faf492ffa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tag_unit_test.rb","start_line":14,"raw_source":"def test_return_raw_text_of_tag\n    tag = Tag.parse(\"long_tag\", \"param1, param2, param3\", new_tokenizer, ParseContext.new)\n    assert_equal(\"long_tag param1, param2, param3\", tag.raw)\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_return_raw_text_of_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tag\"]},\"parse\",{\"type\":\"str\",\"children\":[\"long_tag\"]},{\"type\":\"str\",\"children\":[\"param1, param2, param3\"]},{\"type\":\"send\",\"children\":[null,\"new_tokenizer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"long_tag param1, param2, param3\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"raw\"]}]}]}]}","id":"d74a7f94-4170-486b-8f0d-a44951bd9236"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":71,"raw_source":"def test_unless_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless 1 == 1 %}{{ test }}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless 1 == 1 %}{{ test }}{% endunless %}\"]}]}]}]}","id":"9ad890b3-1457-4986-9553-d56590a64d20"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":113,"raw_source":"def slice(*keys)\n      keys.map!(&method(:convert_key))\n\n      self.class[super(*keys)]\n    end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"slice\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}]}","id":"9d51ea8c-b082-43e7-a40e-6dc4c6f4abb6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":111,"raw_source":"def options(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"OPTIONS\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"OPTIONS\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"4e006f53-cdae-444f-90c7-44ce1f2877dc"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":86,"raw_source":"def interrupt?\n      !@interrupts.empty?\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"interrupt?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@interrupts\"]},\"empty?\"]},\"!\"]}]}","id":"ace2560f-7c7b-4fea-b48f-57bf37822937"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":145,"raw_source":"def test_nested_comment_tag_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% comment %}\n          {% comment\n            {% assign foo = 1 %}\n          {% endcomment\n          {% assign foo = 1 %}\n        {% endcomment %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_comment_tag_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment\\n\"]},{\"type\":\"str\",\"children\":[\"    {% assign foo = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  {% assign foo = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}","id":"8c620668-73d4-4ec4-992d-521320bdb3bb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/interrupts.rb","start_line":8,"raw_source":"def initialize(message = nil)\n      @message = message || \"interrupt\"\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"message\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@message\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]},{\"type\":\"str\",\"children\":[\"interrupt\"]}]}]}]}","id":"121c9679-8504-44a3-bd04-5d659cff2dfb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":795,"raw_source":"def asciidoc(template, options = {}, locals = {})\n      render :asciidoc, template, options, locals\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"asciidoc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"asciidoc\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}","id":"82959738-26dc-4873-8d3f-df52ff112b5b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":216,"raw_source":"def real_token(session)\n        decode_token(session[options[:key]])\n      end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"real_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"decode_token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"key\"]}]}]}]}]}","id":"4bd36ed9-4b11-4ced-80b9-9dd78726ef9b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":93,"raw_source":"def trinidad?\n      name.to_s == \"trinidad\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"trinidad?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"trinidad\"]}]}]}","id":"0b5ca02b-0a33-4453-acee-2148a226d061"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":70,"raw_source":"def self.invokable_methods\n      @invokable_methods ||= begin\n        blacklist = Liquid::Drop.public_instance_methods + [:each]\n\n        if include?(Enumerable)\n          blacklist += Enumerable.public_instance_methods\n          blacklist -= [:sort, :count, :first, :min, :max]\n        end\n\n        whitelist = [:to_liquid] + (public_instance_methods - blacklist)\n        Set.new(whitelist.map(&:to_s))\n      end\n    end","complexity_score":26.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"invokable_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@invokable_methods\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Drop\"]},\"public_instance_methods\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"each\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"const\",\"children\":[null,\"Enumerable\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Enumerable\"]},\"public_instance_methods\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blacklist\"]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"sort\"]},{\"type\":\"sym\",\"children\":[\"count\"]},{\"type\":\"sym\",\"children\":[\"first\"]},{\"type\":\"sym\",\"children\":[\"min\"]},{\"type\":\"sym\",\"children\":[\"max\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"whitelist\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_liquid\"]}]},\"+\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"public_instance_methods\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"blacklist\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Set\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"whitelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"to_s\"]}]}]}]}]}]}]}","id":"7f262c9e-80db-4569-942b-bca1d2045244"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":96,"raw_source":"def render_to_output_buffer(context, output)\n      obj = render(context)\n      render_obj_to_output(obj, output)\n      output\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"render_obj_to_output\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"23196c23-1a00-4d5b-9748-ec87c1e1c3cf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":320,"raw_source":"def test_multiple_named_cycles_with_names_from_context\n    assigns = { \"var1\" => 1, \"var2\" => 2 }\n    assert_template_result(\n      'one one two two one one',\n      '{%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %} {%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %} {%cycle var1: \"one\", \"two\" %} {%cycle var2: \"one\", \"two\" %}',\n      assigns,\n    )\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_named_cycles_with_names_from_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var1\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var2\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one one two two one one\"]},{\"type\":\"str\",\"children\":[\"{%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %} {%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %} {%cycle var1: \\\"one\\\", \\\"two\\\" %} {%cycle var2: \\\"one\\\", \\\"two\\\" %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"7948eba4-81ee-4161-b0c8-9a70c39312dd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":414,"raw_source":"def test_nested_lambda_as_variable\n    @context['dynamic'] = { \"lambda\" => proc { 'Hello' } }\n\n    assert_equal('Hello', @context['dynamic.lambda'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_lambda_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lambda\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic.lambda\"]}]}]}]}]}","id":"13470ecd-882a-4f2a-94c4-ef6aabcaf767"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":546,"raw_source":"def test_map_works_on_enumerables\n    output = Liquid::Template.parse('{{ foo | map: \"foo\" }}').render!({ \"foo\" => TestEnumerable.new })\n    assert_equal(\"123\", output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_works_on_enumerables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"foo\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"75f73803-6cd2-41d5-a1f3-8e9d9759dc89"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1299,"raw_source":"def test_sum_with_non_string_property\n    input = [{ true => 1 }, { 1.0 => 0.2, 1 => -0.3 }, { 1..5 => 0.4 }]\n\n    assert_equal(1, @filters.sum(input, true))\n    assert_equal(0.2, @filters.sum(input, 1.0))\n    assert_equal(-0.3, @filters.sum(input, 1))\n    assert_equal(0.4, @filters.sum(input, (1..5)))\n    assert_equal(0, @filters.sum(input, nil))\n    assert_equal(0, @filters.sum(input, \"\"))\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_non_string_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"float\",\"children\":[1.0]},{\"type\":\"float\",\"children\":[0.2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"float\",\"children\":[0.4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[1.0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[-0.3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.4]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}","id":"de85278e-1c46-423d-806a-6c1e101c224a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":125,"raw_source":"def test_lookup_on_var_with_literal_name\n    assigns = { \"blank\" => { \"x\" => \"result\" } }\n    assert_template_result('result', \"{{ blank.x }}\", assigns)\n    assert_template_result('result', \"{{ blank['x'] }}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lookup_on_var_with_literal_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"blank\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ blank.x }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"str\",\"children\":[\"{{ blank['x'] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"c70a022c-4393-439e-873b-b681c91a00fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":94,"raw_source":"def test_sub_contexts_count_towards_the_same_recursion_limit\n    env = Liquid::Environment.build(\n      file_system: StubFileSystem.new('loop_render' => '{% render \"loop_render\" %}'),\n    )\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse('{% render \"loop_render\" %}', environment: env).render!\n    end\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sub_contexts_count_towards_the_same_recursion_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop_render\"]},{\"type\":\"str\",\"children\":[\"{% render \\\"loop_render\\\" %}\"]}]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"loop_render\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}","id":"bf19260f-972c-4379-aad0-8903ab7030b2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1048,"raw_source":"def join(glue)\n        first = true\n        output = +\"\"\n        each do |item|\n          if first\n            first = false\n          else\n            output << glue\n          end\n\n          output << Liquid::Utils.to_s(item)\n        end\n        output\n      end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"join\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"glue\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"item\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"18c513d5-e447-40ef-ad80-550d79d1d14d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":92,"raw_source":"def session?(env)\n        env.include? options[:session_key]\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"session?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]}","id":"9a22e096-e336-4730-82b5-7b4947133859"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":332,"raw_source":"def test_internal_error_is_raised_with_template_name\n    template = Template.new\n    template.parse(\n      \"{% render 'snippet' %}\",\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new({}),\n      },\n    )\n\n    assert_equal(\n      \"Liquid error (template/index line 1): internal\",\n      template.render(context),\n    )\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_internal_error_is_raised_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'snippet' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error (template/index line 1): internal\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}","id":"e4b56550-8215-4801-b4ce-e8f50e6ed816"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":77,"raw_source":"def parse_filterargs(p)\n      # first argument\n      filterargs = [p.argument]\n      # followed by comma separated others\n      filterargs << p.argument while p.consume?(:comma)\n      filterargs\n    end","complexity_score":6.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_filterargs\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"comma\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filterargs\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"argument\"]}]}]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}","id":"4d728fcb-60a7-4f14-a9c1-d3fbdc4b670e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1559,"raw_source":"def helpers(*extensions, &block)\n        class_eval(&block)   if block_given?\n        include(*extensions) if extensions.any?\n      end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]}]},null]}]}]}","id":"63b99cf1-e2ff-4fad-bb35-df295be6cab0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":258,"raw_source":"def test_doc_tag_nodelist_with_empty_content\n    template_source = \"{% doc %}{% enddoc %}\"\n\n    doc_tag = nil\n    ParseTreeVisitor\n      .for(Template.parse(template_source).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        doc_tag = tag\n      end\n      .visit\n\n    assert_equal([\"\"], doc_tag.nodelist)\n    assert_equal(1, doc_tag.nodelist.length)\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_nodelist_with_empty_content\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"str\",\"children\":[\"{% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template_source\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"lvasgn\",\"children\":[\"doc_tag\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]},\"visit\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc_tag\"]},\"nodelist\"]},\"length\"]}]}]}]}","id":"a6ca4247-545e-49f6-9f10-6826ff5e5e34"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":86,"raw_source":"def test_render_hash_with_hash_key\n    assert_template_result(\"{{\\\"foo\\\"=>\\\"bar\\\"}=>42}\", \"{{ my_hash }}\", { \"my_hash\" => { Hash[\"foo\" => \"bar\"] => 42 } })\n  end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_hash_with_hash_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{{\\\"foo\\\"=>\\\"bar\\\"}=>42}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]},{\"type\":\"int\",\"children\":[42]}]}]}]}]}]}]}","id":"373043ff-4e98-4848-a39e-50d4bbf81e79"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":992,"raw_source":"def call(env)\n      dup.call!(env)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"call!\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}","id":"465f4ede-0bf0-432d-bcd8-da50c068764c"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":91,"raw_source":"def pluralize(input, singular, plural)\n    input == 1 ? singular : plural\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"pluralize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"singular\"]},{\"type\":\"arg\",\"children\":[\"plural\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvar\",\"children\":[\"singular\"]},{\"type\":\"lvar\",\"children\":[\"plural\"]}]}]}","id":"633cf18e-9093-4725-a465-eaeab049e0c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1328,"raw_source":"def with_timezone(tz)\n    old_tz    = ENV['TZ']\n    ENV['TZ'] = tz\n    yield\n  ensure\n    ENV['TZ'] = old_tz\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_timezone\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tz\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_tz\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"TZ\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"TZ\"]},{\"type\":\"lvar\",\"children\":[\"tz\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"TZ\"]},{\"type\":\"lvar\",\"children\":[\"old_tz\"]}]}]}]}","id":"7bacbb55-568c-4891-9e24-9ba6a99e74fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":275,"raw_source":"def traversal(template)\n    ParseTreeVisitor\n      .for(Template.parse(template).root)\n      .add_callback_for(Liquid::Doc) do |tag|\n        tag_class = tag.class\n        tag_class\n      end\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"traversal\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseTreeVisitor\"]},\"for\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"root\"]}]},\"add_callback_for\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Doc\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_class\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"tag_class\"]}]}]}]}","id":"606feee9-08f1-432d-8ad7-c6b64a397755"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":12,"raw_source":"def app_file_path\n    File.join(tmp_dir, \"example_app_#{$example_app_counter}.rb\")\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file_path\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"tmp_dir\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"example_app_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"gvar\",\"children\":[\"$example_app_counter\"]}]},{\"type\":\"str\",\"children\":[\".rb\"]}]}]}]}","id":"6d8c92ec-4e33-4172-8407-32c07eb4c15f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":7,"raw_source":"def initialize(registers = {})\n      @static = registers.is_a?(Registers) ? registers.static : registers\n      @changes = {}\n    end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@static\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Registers\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"static\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@changes\",{\"type\":\"hash\",\"children\":[]}]}]}]}","id":"ff9c7661-d4cd-4ff5-9463-8fec36b68d2b"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":62,"raw_source":"def strict_parse(markup)\n      @filters = []\n      p = @parse_context.new_parser(markup)\n\n      return if p.look(:end_of_string)\n\n      @name = parse_context.parse_expression(p.expression)\n      while p.consume?(:pipe)\n        filtername = p.consume(:id)\n        filterargs = p.consume?(:colon) ? parse_filterargs(p) : Const::EMPTY_ARRAY\n        @filters << parse_filter_expressions(filtername, filterargs)\n      end\n      p.consume(:end_of_string)\n    end","complexity_score":22.4,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"ivasgn\",\"children\":[\"@name\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"pipe\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filtername\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filterargs\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume?\",{\"type\":\"sym\",\"children\":[\"colon\"]}]},{\"type\":\"send\",\"children\":[null,\"parse_filterargs\",{\"type\":\"lvar\",\"children\":[\"p\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"parse_filter_expressions\",{\"type\":\"lvar\",\"children\":[\"filtername\"]},{\"type\":\"lvar\",\"children\":[\"filterargs\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]}]}]}","id":"e4fcb2f3-6fa2-47ae-b554-c9fd512fd52e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":213,"raw_source":"def test_transform_values!\n    @hash.transform_values! { |v| v.is_a?(Hash) ? Hash[v.to_a] : v }\n\n    assert_instance_of Sinatra::IndifferentHash, @hash[:simple_nested]\n  end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_values!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_values!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"to_a\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]}]}]}]}","id":"a4b1e26f-c659-4811-82ff-d1b56bfa67cc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":175,"raw_source":"def reject(*args, &block)\n      return to_enum(:reject) unless block_given?\n\n      dup.tap { |hash| hash.reject!(*args, &block) }\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"reject\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_enum\",{\"type\":\"sym\",\"children\":[\"reject\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"dup\"]},\"tap\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"ed91a665-edc2-4471-9150-f79b379a1ca8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":146,"raw_source":"def empty?\n        to_hash.empty?\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"empty?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"empty?\"]}]}","id":"e72fb727-1996-4f06-bb15-c2a38f49bbd5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":211,"raw_source":"def merge!(other)\n        other.each_pair do |key, value|\n          self[key] = if block_given? && include?(key)\n                        yield(key.to_s, self[key], value)\n                      else\n                        value\n                      end\n        end\n      end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"merge!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}","id":"00b593b1-6802-49b1-bfd8-b2027fede0dd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":8,"raw_source":"def test_variable\n    assert_equal(\n      [\"test\"],\n      visit(%({{ test }})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{{ test }}\"]}]}]}]}","id":"48d1e617-c711-4166-8fbb-293d570e87aa"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":346,"raw_source":"def hexdec4(s)\n    if s.length != 4\n      raise Error, 'short'\n    end\n    (nibble(s[0])<<12) | (nibble(s[1])<<8) | (nibble(s[2])<<4) | nibble(s[3])\n  end","complexity_score":29.15,"ast_json":"{\"type\":\"def\",\"children\":[\"hexdec4\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]},\"!=\",{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"short\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"<<\",{\"type\":\"int\",\"children\":[12]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},\"<<\",{\"type\":\"int\",\"children\":[8]}]}]}]},\"|\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},\"<<\",{\"type\":\"int\",\"children\":[4]}]}]}]},\"|\",{\"type\":\"send\",\"children\":[null,\"nibble\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}","id":"c756ed8f-bec8-4c5d-be09-d824ea82d278"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":207,"raw_source":"def calculate_content_length?\n      headers['content-type'] && !headers['content-length'] && (Array === body)\n    end","complexity_score":11.3,"ast_json":"{\"type\":\"def\",\"children\":[\"calculate_content_length?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-length\"]}]},\"!\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},\"===\",{\"type\":\"send\",\"children\":[null,\"body\"]}]}]}]}]}","id":"8f4ae519-059a-483f-8fd7-067643017342"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":148,"raw_source":"def valid_token?(env, token)\n        return false if token.nil? || !token.is_a?(String) || token.empty?\n\n        session = session(env)\n\n        begin\n          token = decode_token(token)\n        rescue ArgumentError # encoded_masked_token is invalid Base64\n          return false\n        end\n\n        # See if it's actually a masked token or not. We should be able\n        # to handle any unmasked tokens that we've issued without error.\n\n        if unmasked_token?(token)\n          compare_with_real_token(token, session)\n        elsif masked_token?(token)\n          token = unmask_token(token)\n\n          compare_with_global_token(token, session) ||\n            compare_with_real_token(token, session) ||\n            compare_with_per_form_token(token, session, Request.new(env))\n        else\n          false # Token is malformed\n        end\n      end","complexity_score":29.9,"ast_json":"{\"type\":\"def\",\"children\":[\"valid_token?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"session\",{\"type\":\"send\",\"children\":[null,\"session\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"decode_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"unmasked_token?\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_real_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"masked_token?\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[null,\"unmask_token\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"compare_with_global_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_real_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]}]}]},{\"type\":\"send\",\"children\":[null,\"compare_with_per_form_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"false\",\"children\":[]}]}]}]}]}","id":"12cfa590-d0c4-4750-8435-9e3571fb7c68"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":245,"raw_source":"def after_response(&block)\n      raise NotImplementedError, 'only supports EventMachine at the moment' unless defined? EventMachine\n\n      EventMachine.next_tick(&block)\n    end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"after_response\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EventMachine\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]},{\"type\":\"str\",\"children\":[\"only supports EventMachine at the moment\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EventMachine\"]},\"next_tick\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"73f52d7c-1c2d-49e6-a20e-edcf76a015ee"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/http_origin.rb","start_line":32,"raw_source":"def accepts?(env)\n        return true if safe? env\n        return true unless (origin = env['HTTP_ORIGIN'])\n        return true if base_url(env) == origin\n        return true if options[:allow_if]&.call(env)\n\n        permitted_origins = options[:permitted_origins]\n        Array(permitted_origins).include? origin\n      end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"origin\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ORIGIN\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_url\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"origin\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"permitted_origins\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"permitted_origins\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"permitted_origins\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"origin\"]}]}]}]}","id":"1773a205-a1c4-4104-91ca-e1dedade422e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":249,"raw_source":"def test_render_tag_for_drop\n    assert_template_result(\n      \"123\",\n      \"{% render 'loop' for loop as value %}\",\n      { \"loop\" => TestEnumerable.new },\n      partials: {\n        'loop' => \"{{ value.foo }}\",\n      },\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_for_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% render 'loop' for loop as value %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"loop\"]},{\"type\":\"str\",\"children\":[\"{{ value.foo }}\"]}]}]}]}]}]}]}","id":"eb4b7842-feee-48f6-8a28-63f188cc58a1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":782,"raw_source":"def liquid(template, options = {}, locals = {}, &block)\n      render(:liquid, template, options, locals, &block)\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"liquid\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"99f44c7c-feb4-4b41-82ad-58cde472e6c1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":186,"raw_source":"def test_scope_with_assigns\n    assert_equal('variable', Liquid::Template.parse('{% assign a = \"variable\"%}{{a}}').render!('context' => ContextDrop.new))\n    assert_equal('variable', Liquid::Template.parse('{% assign a = \"variable\"%}{%for i in dummy%}{{a}}{%endfor%}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('test', Liquid::Template.parse('{% assign header_gif = \"test\"%}{{header_gif}}').render!('context' => ContextDrop.new))\n    assert_equal('test', Liquid::Template.parse(\"{% assign header_gif = 'test'%}{{header_gif}}\").render!('context' => ContextDrop.new))\n  end","complexity_score":20.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_with_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign a = \\\"variable\\\"%}{{a}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign a = \\\"variable\\\"%}{%for i in dummy%}{{a}}{%endfor%}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign header_gif = \\\"test\\\"%}{{header_gif}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign header_gif = 'test'%}{{header_gif}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"9ff31006-e5eb-4758-8bf9-382e6ed127b4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":27,"raw_source":"def test_variable_output_with_multiple_blank_lines\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n\n\n          {{- 'John' -}}\n\n\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_output_with_multiple_blank_lines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"4fe48055-b25a-4c6f-8b7a-bfb788b2e09f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":23,"raw_source":"def call(env)\n      env['PATH_INFO'] = env['PATH_INFO'].upcase\n      super\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"upcase\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"24bc4af4-1311-4372-9b54-59faa62e5388"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":85,"raw_source":"def [](key)\n        response_cookies[key.to_s] || request_cookies[key.to_s]\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}]}","id":"6609fb2b-cecd-4d67-9767-4648f8808189"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/tag_filter.rb","start_line":21,"raw_source":"def link_to_remove_tag(label, tag)\n    tags = (@context['current_tags'] - [tag]).uniq\n    \"<a title=\\\"Show tag #{tag}\\\" href=\\\"/collections/#{@context['handle']}/#{tags.join('+')}\\\">#{label}</a>\"\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"link_to_remove_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"label\"]},{\"type\":\"arg\",\"children\":[\"tag\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tags\",{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"current_tags\"]}]},\"-\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}]},\"uniq\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<a title=\\\"Show tag \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\"\\\" href=\\\"/collections/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]}]},{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tags\"]},\"join\",{\"type\":\"str\",\"children\":[\"+\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"label\"]}]},{\"type\":\"str\",\"children\":[\"</a>\"]}]}]}]}","id":"3bab5b95-e10e-4071-b6b5-d00618fe6ecf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":190,"raw_source":"def session\n      return {} unless last_request?\n      raise Rack::Test::Error, 'session not enabled for app' unless last_env['rack.session'] || app.session?\n\n      last_request.session\n    end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.session\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"session?\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]},{\"type\":\"str\",\"children\":[\"session not enabled for app\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},\"session\"]}]}]}","id":"afb14f74-0bec-4a47-be42-9590d2ae98ed"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":71,"raw_source":"def test_whitespace_is_blank\n    assert_template_result(\"\", wrap(\" \"))\n    assert_template_result(\"\", wrap(\"\\t\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"\\t\"]}]}]}]}]}","id":"a7249328-b7a5-422d-8f6c-2505403763ae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":108,"raw_source":"def test_invalid_variables_work\n    with_error_mode(:lax) do\n      assert_template_result('bar', \"{% assign 123foo = 'bar' %}{{ 123foo }}\")\n      assert_template_result('123', \"{% assign 123 = 'bar' %}{{ 123 }}\")\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_variables_work\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{% assign 123foo = 'bar' %}{{ 123foo }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"str\",\"children\":[\"{% assign 123 = 'bar' %}{{ 123 }}\"]}]}]}]}]}","id":"c2b8eab3-f1e3-49d4-b446-9b00e6471075"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1898,"raw_source":"def synchronize(&block)\n        if lock?\n          @@mutex.synchronize(&block)\n        else\n          yield\n        end\n      end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"synchronize\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lock?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"cvar\",\"children\":[\"@@mutex\"]},\"synchronize\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"yield\",\"children\":[]}]}]}","id":"e5bb9713-3d01-43f6-a856-07a5cd046d09"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":515,"raw_source":"def test_apply_global_filter_when_no_global_filter_exist\n    context = Context.new\n    assert_equal('hi', context.apply_global_filter('hi'))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_apply_global_filter_when_no_global_filter_exist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"apply_global_filter\",{\"type\":\"str\",\"children\":[\"hi\"]}]}]}]}]}","id":"a4af98b5-f577-41c8-b034-0ebeefec0730"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":41,"raw_source":"def teardown_blocks(base = self.class)\n    teardown_blocks base.superclass if base.superclass.respond_to? :teardown_blocks\n    base.teardown_blocks.each do |block|\n      instance_eval(&block)\n    end\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"teardown_blocks\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"teardown_blocks\"]}]},{\"type\":\"send\",\"children\":[null,\"teardown_blocks\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"teardown_blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"f8c88b45-72af-4204-9b79-7eb108df873a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":21,"raw_source":"def test_tags\n    assert_equal(['<tr>', '</tr>'], '<tr> </tr>'.scan(QuotedFragment))\n    assert_equal(['<tr></tr>'], '<tr></tr>'.scan(QuotedFragment))\n    assert_equal(['<style', 'class=\"hello\">', '</style>'], %(<style class=\"hello\">' </style>).scan(QuotedFragment))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr>\"]},{\"type\":\"str\",\"children\":[\"</tr>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr> </tr>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr></tr>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr></tr>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"<style\"]},{\"type\":\"str\",\"children\":[\"class=\\\"hello\\\">\"]},{\"type\":\"str\",\"children\":[\"</style>\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"<style class=\\\"hello\\\">' </style>\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}]}","id":"f49d5080-4f48-4c59-a876-288f1eab082c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":237,"raw_source":"def self.prefixed(*names)\n        names.each { |n| define_method(n) { |*a, &b| prefixed(n, *a, &b) } }\n      end","complexity_score":11.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"prefixed\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"names\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"names\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"lvar\",\"children\":[\"n\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]},{\"type\":\"blockarg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"prefixed\",{\"type\":\"lvar\",\"children\":[\"n\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}]}","id":"2ceee661-0bf0-43e7-9b76-7d8de7b6378c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/raw_tag_test.rb","start_line":34,"raw_source":"def test_invalid_raw\n    assert_match_syntax_error(/tag was never closed/, '{% raw %} foo')\n    assert_match_syntax_error(/Valid syntax/, '{% raw } foo {% endraw %}')\n    assert_match_syntax_error(/Valid syntax/, '{% raw } foo %}{% endraw %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_raw\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"tag was never closed\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw %} foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Valid syntax\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw } foo {% endraw %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Valid syntax\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"{% raw } foo %}{% endraw %}\"]}]}]}]}","id":"748addc0-d3c1-4841-abf9-43c374592e48"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":187,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          [status, headers, body.map(&:upcase).map(&:reverse)]\n        end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"upcase\"]}]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"reverse\"]}]}]}]}]}]}","id":"0d514303-0fcc-431d-8c92-363b40c9d4c3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":357,"raw_source":"def test_render_tag_renders_error_with_template_name\n    assert_template_result(\n      'Liquid error (foo line 1): standard error',\n      \"{% include 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      render_errors: true,\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% include 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}","id":"eeedf525-d2af-4807-b5ef-27329909447f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":368,"raw_source":"def test_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true -%}\n          yes\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false -%}\n          no\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"1a8ff1e4-91b5-4648-ba78-29d14d5f69ca"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":77,"raw_source":"def with_global_filter(*globals, &blk)\n      environment = Liquid::Environment.build do |w|\n        w.register_filters(globals)\n      end\n\n      Environment.dangerously_override(environment, &blk)\n    end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"with_global_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"globals\"]},{\"type\":\"blockarg\",\"children\":[\"blk\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"w\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"w\"]},\"register_filters\",{\"type\":\"lvar\",\"children\":[\"globals\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"dangerously_override\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"blk\"]}]}]}]}]}","id":"b8d30088-eb5a-413f-8019-34d387334e94"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":140,"raw_source":"def initialize(entry)\n        params = entry.scan(HEADER_PARAM).map! do |s|\n          key, value = s.strip.split('=', 2)\n          value = value[1..-2].gsub(/\\\\(.)/, '\\1') if value.start_with?('\"')\n          [key, value]\n        end\n\n        @type   = entry[/[^;]+/].delete(' ')\n        @params = params.to_h\n      end","complexity_score":22.45,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_PARAM\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"strip\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\\\\(.)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\\\\1\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"delete\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"to_h\"]}]}]}]}","id":"baa91823-5a7c-4f95-83bb-dad6264a4c36"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1664,"raw_source":"def new(*args, &block)\n        instance = new!(*args, &block)\n        Wrapper.new(build(instance).to_app, instance)\n      end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"instance\",{\"type\":\"send\",\"children\":[null,\"new!\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Wrapper\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"build\",{\"type\":\"lvar\",\"children\":[\"instance\"]}]},\"to_app\"]},{\"type\":\"lvar\",\"children\":[\"instance\"]}]}]}]}","id":"5f736e20-ef20-4c0a-ae27-4d05c4f3a271"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/errors.rb","start_line":24,"raw_source":"def message_prefix\n      str = +\"\"\n      str << if is_a?(SyntaxError)\n        \"Liquid syntax error\"\n      else\n        \"Liquid error\"\n      end\n\n      if line_number\n        str << \" (\"\n        str << template_name << \" \" if template_name\n        str << \"line \" << line_number.to_s << \")\"\n      end\n\n      str << \": \"\n      str\n    end","complexity_score":24.1,"ast_json":"{\"type\":\"def\",\"children\":[\"message_prefix\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"is_a?\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"str\",\"children\":[\"Liquid syntax error\"]},{\"type\":\"str\",\"children\":[\"Liquid error\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_number\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\" (\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"template_name\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"line \"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"line_number\"]},\"to_s\"]}]},\"<<\",{\"type\":\"str\",\"children\":[\")\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\": \"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}","id":"9a3ef969-d71f-4e31-8f5d-83fa61db7f7f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":594,"raw_source":"def use(middleware, *)\n        MiddlewareTracker.used << middleware\n        super\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"use\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"middleware\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"used\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"middleware\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"f244605e-2d4c-446c-bd77-46d8503df96e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":89,"raw_source":"def unlock(path, opts = {}, &bk)    route 'UNLOCK',    path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"unlock\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"UNLOCK\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"dc5f81bd-2614-4b9b-b696-10991ef2c832"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":52,"raw_source":"def each(&block)\n    [{ \"foo\" => 1, \"bar\" => 2 }, { \"foo\" => 2, \"bar\" => 1 }, { \"foo\" => 3, \"bar\" => 3 }].each(&block)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"e4d202bd-f690-449b-b8bb-12d85f49b9b6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/route_added_hook_test.rb","start_line":7,"raw_source":"def self.route_added(verb, path, proc)\n    @routes << [verb, path]\n    @procs << proc\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"route_added\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"proc\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@routes\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@procs\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"proc\"]}]}]}]}","id":"0bf769b4-e8e7-442f-9914-c4ca61049d3d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":4,"raw_source":"def self.parses pattern, example, expected_params, mtype = :sinatra, mopts = {}\n    it \"parses #{example} with #{pattern} into params #{expected_params}\" do\n      compiled = mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      params = compiled.params(example)\n      fail %Q{\"#{example}\" does not parse on pattern \"#{pattern}\".} unless params\n\n      assert_equal expected_params, params, \"Pattern #{pattern} does not match path #{example}.\"\n    end\n  end","complexity_score":19.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parses\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"example\"]},{\"type\":\"arg\",\"children\":[\"expected_params\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"parses \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\" with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\" into params \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expected_params\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled\"]},\"params\",{\"type\":\"lvar\",\"children\":[\"example\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},null,{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\"\\\" does not parse on pattern \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\".\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected_params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Pattern \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\" does not match path \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\".\"]}]}]}]}]}]}","id":"6e8deb4b-6989-42f5-83ee-496f86b167e5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":754,"raw_source":"def test_round\n    assert_template_result(\"5\", \"{{ input | round }}\", { 'input' => 4.6 })\n    assert_template_result(\"4\", \"{{ '4.3' | round }}\")\n    assert_template_result(\"4.56\", \"{{ input | round: 2 }}\", { 'input' => 4.5612 })\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | round }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | round }}\", { 'price' => NumberLikeThing.new(4.6) })\n    assert_template_result(\"4\", \"{{ price | round }}\", { 'price' => NumberLikeThing.new(4.3) })\n  end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_round\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ input | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | round }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4.56\"]},{\"type\":\"str\",\"children\":[\"{{ input | round: 2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.5612]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | round }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ price | round }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.3]}]}]}]}]}]}]}","id":"2e8c2a94-0fdf-4608-9850-973e1cd4fde2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":585,"raw_source":"def test_sort_works_on_enumerables\n    assert_template_result(\"213\", '{{ foo | sort: \"bar\" | map: \"foo\" }}', { \"foo\" => TestEnumerable.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_works_on_enumerables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"213\"]},{\"type\":\"str\",\"children\":[\"{{ foo | sort: \\\"bar\\\" | map: \\\"foo\\\" }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]}]}]}]}","id":"4ee80a0e-6ea4-466b-adc7-26bed4d7600a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":61,"raw_source":"def render_to_output_buffer(context, output)\n      segment = collection_segment(context)\n\n      if segment.empty?\n        render_else(context, output)\n      else\n        render_segment(context, output, segment)\n      end\n\n      output\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"segment\",{\"type\":\"send\",\"children\":[null,\"collection_segment\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[null,\"render_else\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"render_segment\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"segment\"]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"893a0423-e12d-485d-b163-d0b3a6f60f8d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":70,"raw_source":"def initialize(*)     @schedule, @defer = [], []                end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@schedule\"]},{\"type\":\"ivasgn\",\"children\":[\"@defer\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[]},{\"type\":\"array\",\"children\":[]}]}]}]}","id":"34001c22-a5bc-4b2d-ab0c-ef5abaf17b5d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":336,"raw_source":"def test_nested_cents\n    @context.merge(\"cents\" => { 'amount' => HundredCentes.new })\n    assert_equal(100, @context['cents.amount'])\n\n    @context.merge(\"cents\" => { 'cents' => { 'amount' => HundredCentes.new } })\n    assert_equal(100, @context['cents.cents.amount'])\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_cents\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"amount\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.amount\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"amount\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.cents.amount\"]}]}]}]}]}","id":"0c4bc6f1-1ec3-435a-a91e-dffaca982c43"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":700,"raw_source":"def test_minus\n    assert_template_result(\"4\", \"{{ input | minus:operand }}\", { 'input' => 5, 'operand' => 1 })\n    assert_template_result(\"2.3\", \"{{ '4.3' | minus:'2' }}\")\n\n    assert_template_result(\"5\", \"{{ price | minus:'2' }}\", { 'price' => NumberLikeThing.new(7) })\n  end","complexity_score":5.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_minus\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ input | minus:operand }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"operand\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2.3\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | minus:'2' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | minus:'2' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[7]}]}]}]}]}]}]}","id":"33d14268-e79a-4cc8-8fe5-efb84488707f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":13,"raw_source":"def erb_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"erb_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"e8f3a025-803d-49b4-908d-a7aa833e60d9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1121,"raw_source":"def test_where_non_array_map_input\n    assert_equal([{ \"a\" => \"ok\" }], @filters.where({ \"a\" => \"ok\" }, \"a\", \"ok\"))\n    assert_equal([], @filters.where({ \"a\" => \"not ok\" }, \"a\", \"ok\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_non_array_map_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"not ok\"]}]}]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}","id":"527be130-67ce-488e-b0a9-ea7260803240"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":113,"raw_source":"def initialize(tag_name, markup, parse_context)\n      super\n      @duration = Float(markup)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@duration\",{\"type\":\"send\",\"children\":[null,\"Float\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]}]}","id":"38900c4a-fd69-402b-b967-aaf8d15cf0c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":172,"raw_source":"def test_delimiter_can_have_extra_strings\n    assert_template_result('', \"{% comment %}123{% endcomment xyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\txyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\nxyz %}\")\n    assert_template_result('', \"{% comment %}123{% endcomment\\n   xyz  endcomment %}\")\n    assert_template_result('', \"{%comment}{% assign a = 1 %}{%endcomment}{% endif %}\")\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_delimiter_can_have_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment xyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\txyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\nxyz %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% comment %}123{% endcomment\\n   xyz  endcomment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%comment}{% assign a = 1 %}{%endcomment}{% endif %}\"]}]}]}]}","id":"3e54326c-3746-487f-b952-6afed168f40f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":12,"raw_source":"def test_string\n    assert_template_result(\"single quoted\", \"{{'single quoted'}}\")\n    assert_template_result(\"double quoted\", '{{\"double quoted\"}}')\n    assert_template_result(\"spaced\", \"{{ 'spaced' }}\")\n    assert_template_result(\"spaced2\", \"{{ 'spaced2' }}\")\n    assert_template_result(\"emoji🔥\", \"{{ 'emoji🔥' }}\")\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"single quoted\"]},{\"type\":\"str\",\"children\":[\"{{'single quoted'}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"double quoted\"]},{\"type\":\"str\",\"children\":[\"{{\\\"double quoted\\\"}}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"spaced\"]},{\"type\":\"str\",\"children\":[\"{{ 'spaced' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"spaced2\"]},{\"type\":\"str\",\"children\":[\"{{ 'spaced2' }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"emoji🔥\"]},{\"type\":\"str\",\"children\":[\"{{ 'emoji🔥' }}\"]}]}]}]}","id":"d89da8b5-1eee-4fae-b389-b991d081b097"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":194,"raw_source":"def test_merge_with_multiple_argument\n    hash = Sinatra::IndifferentHash.new.merge({a: 1}, {b: 2}, {c: 3})\n    assert_equal 1, hash[?a]\n    assert_equal 2, hash[?b]\n    assert_equal 3, hash[?c]\n\n    hash2 = Sinatra::IndifferentHash[d: 4]\n    hash3 = {e: 5}\n    hash.merge!(hash2, hash3)\n\n    assert_equal 4, hash[?d]\n    assert_equal 5, hash[?e]\n  end","complexity_score":21.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge_with_multiple_argument\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash3\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"e\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"hash2\"]},{\"type\":\"lvar\",\"children\":[\"hash3\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"e\"]}]}]}]}]}","id":"21409531-ece2-42dc-94d6-b1f6c97e4b2d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":142,"raw_source":"def set_token(session)\n        session[options[:key]] ||= self.class.random_token\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"set_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"session\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"key\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"random_token\"]}]}]}","id":"0d5425e8-4b17-4943-9a32-c65d32f9bc34"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":70,"raw_source":"def [](key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"ace79b77-ada5-4c03-a017-009c5421157b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":57,"raw_source":"def run\n      @pipe     = start\n      @started  = Time.now\n      warn \"#{server} up and running on port #{port}\" if ping\n    end","complexity_score":9.7,"ast_json":"{\"type\":\"def\",\"children\":[\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@pipe\",{\"type\":\"send\",\"children\":[null,\"start\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@started\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ping\"]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]}]},{\"type\":\"str\",\"children\":[\" up and running on port \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]}]}]},null]}]}]}","id":"f804fd8b-dbb8-495b-8111-e1be0e34ec92"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":428,"raw_source":"def send_file(path, opts = {})\n      if opts[:type] || !response['content-type']\n        content_type opts[:type] || File.extname(path), default: 'application/octet-stream'\n      end\n\n      disposition = opts[:disposition]\n      filename    = opts[:filename]\n      disposition = :attachment if disposition.nil? && filename\n      filename    = path        if filename.nil?\n      attachment(filename, disposition) if disposition\n\n      last_modified opts[:last_modified] if opts[:last_modified]\n\n      file   = Rack::Files.new(File.dirname(settings.app_file))\n      result = file.serving(request, path)\n\n      result[1].each { |k, v| headers[k] ||= v }\n      headers['content-length'] = result[1]['content-length']\n      opts[:status] &&= Integer(opts[:status])\n      halt (opts[:status] || result[0]), result[2]\n    rescue Errno::ENOENT\n      not_found\n    end","complexity_score":70.4,"ast_json":"{\"type\":\"def\",\"children\":[\"send_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"default\"]},{\"type\":\"str\",\"children\":[\"application/octet-stream\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"disposition\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"disposition\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"filename\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"lvasgn\",\"children\":[\"disposition\",{\"type\":\"sym\",\"children\":[\"attachment\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"filename\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"disposition\"]},{\"type\":\"send\",\"children\":[null,\"attachment\",{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"lvar\",\"children\":[\"disposition\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_modified\"]}]},{\"type\":\"send\",\"children\":[null,\"last_modified\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"last_modified\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Files\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"app_file\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"serving\",{\"type\":\"send\",\"children\":[null,\"request\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"headers\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"[]\",{\"type\":\"str\",\"children\":[\"content-length\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ENOENT\"]}]},null,{\"type\":\"send\",\"children\":[null,\"not_found\"]}]},null]}]}","id":"5a887b8d-bc51-423b-a911-b1c32fbe462f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":65,"raw_source":"def test_join\n    assert_template_result(\"1 2 3 4\", \"{{var | join}}\", { \"var\" => [1, 2, 3, 4] })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"str\",\"children\":[\"{{var | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}]}","id":"943f25ce-9900-4253-ac55-0644bda4baed"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":95,"raw_source":"def test_child_raw_tags_need_to_be_closed\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% comment %}\n        {% raw %}\n          {% endcomment %}\n        {% endraw %}\n      {% endcomment %}\n    LIQUID\n\n    assert_raises(Liquid::SyntaxError) do\n      Liquid::Template.parse(<<~LIQUID.chomp)\n        {% comment %}\n          {% raw %}\n          {% endcomment %}\n        {% endcomment %}\n      LIQUID\n    end\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_child_raw_tags_need_to_be_closed\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"    {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endraw %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% raw %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}]}]}","id":"e36e6d9d-d153-4c2e-93ee-1f8caf516120"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":155,"raw_source":"def transform_values!\n      super\n      super(&method(:convert_value))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"transform_values!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"super\",\"children\":[{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]}]}]}","id":"36af5eca-9820-44fe-be38-ccee2f994c00"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1759,"raw_source":"def provides(*types)\n        types.map! { |t| mime_types(t) }\n        types.flatten!\n        condition do\n          response_content_type = response['content-type']\n          preferred_type = request.preferred_type(types)\n\n          if response_content_type\n            types.include?(response_content_type) || types.include?(response_content_type[/^[^;]+/])\n          elsif preferred_type\n            params = (preferred_type.respond_to?(:params) ? preferred_type.params : {})\n            content_type(preferred_type, params)\n            true\n          else\n            false\n          end\n        end\n      end","complexity_score":29.5,"ast_json":"{\"type\":\"def\",\"children\":[\"provides\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"types\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"send\",\"children\":[null,\"mime_types\",{\"type\":\"lvar\",\"children\":[\"t\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"flatten!\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"response_content_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"preferred_type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"preferred_type\",{\"type\":\"lvar\",\"children\":[\"types\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response_content_type\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"response_content_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"types\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"response_content_type\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"params\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},\"params\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"content_type\",{\"type\":\"lvar\",\"children\":[\"preferred_type\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}]}","id":"8cdec156-125c-46f6-a1f5-c0a0e853757a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":405,"raw_source":"def test_sort_natural_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.sort_natural(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}","id":"0d52f2b5-e2fb-474d-b321-c85c86acbfcd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":58,"raw_source":"def prefers_plain_text?(env)\n      Request.new(env).preferred_type('text/plain', 'text/html') != 'text/html' &&\n        [/curl/].index { |item| item =~ env['HTTP_USER_AGENT'] }\n    end","complexity_score":9.7,"ast_json":"{\"type\":\"def\",\"children\":[\"prefers_plain_text?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"preferred_type\",{\"type\":\"str\",\"children\":[\"text/plain\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},\"!=\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"curl\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"=~\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_USER_AGENT\"]}]}]}]}]}]}","id":"d462b815-e823-4419-b3a2-8f6fb9ed2135"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":347,"raw_source":"def prefixed(method, pattern = nil, conditions = {}, &block)\n        default = %r{(?:/.*)?} if (method == :before) || (method == :after)\n        pattern, conditions = compile pattern, conditions, default\n        result = base.send(method, pattern, **conditions, &block)\n        invoke_hook :route_added, method.to_s.upcase, pattern, block\n        result\n      end","complexity_score":21.3,"ast_json":"{\"type\":\"def\",\"children\":[\"prefixed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"optarg\",\"children\":[\"pattern\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"==\",{\"type\":\"sym\",\"children\":[\"before\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"==\",{\"type\":\"sym\",\"children\":[\"after\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"default\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(?:/.*)?\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\"]},{\"type\":\"lvasgn\",\"children\":[\"conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"compile\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"lvar\",\"children\":[\"default\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"conditions\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"invoke_hook\",{\"type\":\"sym\",\"children\":[\"route_added\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]},\"upcase\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"e2ee40fd-f382-4a5f-b714-7d1c66d8f60a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":113,"raw_source":"def push(new_scope = {})\n      @scopes.unshift(new_scope)\n      check_overflow\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"push\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"new_scope\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"unshift\",{\"type\":\"lvar\",\"children\":[\"new_scope\"]}]},{\"type\":\"send\",\"children\":[null,\"check_overflow\"]}]}]}","id":"c69d8cf8-8271-49bc-a028-c784e694a039"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":231,"raw_source":"def test_case_when_or\n    code = '{% case condition %}{% when 1 or 2 or 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 2 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 3 })\n    assert_template_result(' its 4 ', code, { 'condition' => 4 })\n    assert_template_result('', code, { 'condition' => 5 })\n\n    code = '{% case condition %}{% when 1 or \"string\" or null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}'\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 1 })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => 'string' })\n    assert_template_result(' its 1 or 2 or 3 ', code, { 'condition' => nil })\n    assert_template_result('', code, { 'condition' => 'something else' })\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 or 2 or 3 %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 4 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 or \\\"string\\\" or null %} its 1 or 2 or 3 {% when 4 %} its 4 {% endcase %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 or 2 or 3 \"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"something else\"]}]}]}]}]}]}","id":"ef84d14c-9382-4017-baef-d4a0e42c45ac"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":86,"raw_source":"def body\n    response.body.to_s\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"body\"]},\"to_s\"]}]}","id":"56aebe59-a41f-4256-8619-8b443f17e75f"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":120,"raw_source":"def each_test\n    # Dup assigns because will make some changes to them\n    assigns = Database.tables.dup\n\n    @tests.each do |test_hash|\n      # Compute page_template outside of profiler run, uninteresting to profiler\n      page_template = File.basename(test_hash[:template_name], File.extname(test_hash[:template_name]))\n      yield(test_hash[:liquid], test_hash[:layout], assigns, page_template, test_hash[:template_name])\n    end\n  end","complexity_score":16.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each_test\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Database\"]},\"tables\"]},\"dup\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test_hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"page_template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"extname\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"liquid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_name\"]}]}]}]}]}]}]}","id":"d5dbb993-d4a2-457e-b734-e29a26a16c26"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":13,"raw_source":"def initialize(node, callbacks)\n      @node      = node\n      @callbacks = callbacks\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"arg\",\"children\":[\"callbacks\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@node\",{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@callbacks\",{\"type\":\"lvar\",\"children\":[\"callbacks\"]}]}]}]}","id":"bc340e02-ec73-43f3-a2c7-37b991bfb67f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":93,"raw_source":"def with_custom_tag(tag_name, tag_class, &block)\n      environment = Liquid::Environment.default.dup\n      environment.register_tag(tag_name, tag_class)\n\n      Environment.dangerously_override(environment, &block)\n    end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_custom_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"tag_class\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"register_tag\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"tag_class\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"dangerously_override\",{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"bd5250ab-27bb-4a37-84f2-b7c3c784f78e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":47,"raw_source":"def test_increment_assign_score_by_bytes_not_characters\n    t = Template.parse(\"{% capture foo %}すごい{% endcapture %}\")\n    t.render!\n    assert_equal(9, t.resource_limits.assign_score)\n  end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_increment_assign_score_by_bytes_not_characters\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% capture foo %}すごい{% endcapture %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"resource_limits\"]},\"assign_score\"]}]}]}]}","id":"addac4de-e499-46cb-9326-cbdecb4b0330"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":126,"raw_source":"def self.extend_object(obj)\n    super\n\n    base_port = 5000 + Process.pid % 100\n    servers = Sinatra::Base.server.dup\n\n    # TruffleRuby doesn't support `Fiber.set_scheduler` yet\n    unsupported_truffleruby = RUBY_ENGINE == \"truffleruby\" && !Fiber.respond_to?(:set_scheduler)\n    # Ruby 2.7 uses falcon 0.42.3 which isn't working with rackup 2.2.0+\n    too_old_ruby = RUBY_VERSION <= \"3.0.0\"\n\n    if unsupported_truffleruby || too_old_ruby\n      warn \"skip falcon server\"\n      servers.delete('falcon')\n    end\n\n    servers.each_with_index do |server, index|\n      Server.run(server, base_port+index)\n    end\n  end","complexity_score":24.75,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extend_object\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"base_port\",{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[5000]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Process\"]},\"pid\"]},\"%\",{\"type\":\"int\",\"children\":[100]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"servers\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},\"server\"]},\"dup\"]}]},{\"type\":\"lvasgn\",\"children\":[\"unsupported_truffleruby\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_ENGINE\"]},\"==\",{\"type\":\"str\",\"children\":[\"truffleruby\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Fiber\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"set_scheduler\"]}]},\"!\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"too_old_ruby\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]},\"<=\",{\"type\":\"str\",\"children\":[\"3.0.0\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unsupported_truffleruby\"]},{\"type\":\"lvar\",\"children\":[\"too_old_ruby\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"skip falcon server\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"delete\",{\"type\":\"str\",\"children\":[\"falcon\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"servers\"]},\"each_with_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]},{\"type\":\"arg\",\"children\":[\"index\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"server\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base_port\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"index\"]}]}]}]}]}]}","id":"deb48ddc-b233-49e4-8495-23e10ad7affa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":51,"raw_source":"def test_strings\n    text = \" {% if 'test' == 'test' %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'test' == 'test' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"4593112a-f486-44af-b230-e6c2a9704847"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":877,"raw_source":"def test_reject_with_value\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok', true | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok', true | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"81ed6439-0ffc-4b5a-a655-3b7d58190e4b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/quiet_logger.rb","start_line":37,"raw_source":"def self.registered(app)\n      quiet_logger_prefixes = begin\n        app.settings.quiet_logger_prefixes.join('|')\n      rescue StandardError\n        ''\n      end\n      return warn('You need to specify the paths you wish to exclude from logging via `set :quiet_logger_prefixes, %w(images css fonts)`') if quiet_logger_prefixes.empty?\n\n      const_set('QUIET_LOGGER_REGEX', %r(\\A/{0,2}(?:#{quiet_logger_prefixes})))\n      ::Rack::CommonLogger.prepend(\n        ::Module.new do\n          def log(env, *)\n            super unless env['PATH_INFO'] =~ QUIET_LOGGER_REGEX\n          end\n        end\n      )\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"quiet_logger_prefixes\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"settings\"]},\"quiet_logger_prefixes\"]},\"join\",{\"type\":\"str\",\"children\":[\"|\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"str\",\"children\":[\"\"]}]},null]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"quiet_logger_prefixes\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"str\",\"children\":[\"You need to specify the paths you wish to exclude from logging via `set :quiet_logger_prefixes, %w(images css fonts)`\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"const_set\",{\"type\":\"str\",\"children\":[\"QUIET_LOGGER_REGEX\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A/{0,2}(?:\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"quiet_logger_prefixes\"]}]},{\"type\":\"str\",\"children\":[\")\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Rack\"]},\"CommonLogger\"]},\"prepend\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"log\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]},\"=~\",{\"type\":\"const\",\"children\":[null,\"QUIET_LOGGER_REGEX\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]}]}]}]}]}]}","id":"9543375d-ca1e-4c7e-9557-d3c9eea5b849"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":6,"raw_source":"def test_doc_tag\n    template = <<~LIQUID.chomp\n      {% doc %}\n        Renders loading-spinner.\n\n        @param {string} foo - some foo\n        @param {string} [bar] - optional bar\n\n        @example\n        {% render 'loading-spinner', foo: 'foo' %}\n        {% render 'loading-spinner', foo: 'foo', bar: 'bar' %}\n      {% enddoc %}\n    LIQUID\n\n    assert_template_result('', template)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  Renders loading-spinner.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  @param {string} foo - some foo\\n\"]},{\"type\":\"str\",\"children\":[\"  @param {string} [bar] - optional bar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"  @example\\n\"]},{\"type\":\"str\",\"children\":[\"  {% render 'loading-spinner', foo: 'foo' %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% render 'loading-spinner', foo: 'foo', bar: 'bar' %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"9263eea2-f7e6-46db-b143-d7ce665e7e01"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":63,"raw_source":"def frame_class(frame)\n      if frame.filename =~ %r{lib/sinatra.*\\.rb}\n        'framework'\n      elsif (defined?(Gem) && frame.filename.include?(Gem.dir)) ||\n            frame.filename =~ %r{/bin/(\\w+)\\z}\n        'system'\n      else\n        'app'\n      end\n    end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"frame_class\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"frame\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"lib/sinatra.*\\\\.rb\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"str\",\"children\":[\"framework\"]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"dir\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"frame\"]},\"filename\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"/bin/(\\\\w+)\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]},{\"type\":\"str\",\"children\":[\"system\"]},{\"type\":\"str\",\"children\":[\"app\"]}]}]}]}","id":"99913de9-9566-4c19-834b-18232b517ad3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":71,"raw_source":"def valparse(ts)\n    if ts.length < 0\n      raise Error, 'empty'\n    end\n\n    typ, _, val = ts[0]\n    case typ\n    when '{' then objparse(ts)\n    when '[' then arrparse(ts)\n    when :val,:str then [val, ts[1..-1]]\n    else\n      raise Error, \"unexpected #{val.inspect}\"\n    end\n  end","complexity_score":19.6,"ast_json":"{\"type\":\"def\",\"children\":[\"valparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"length\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"empty\"]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"{\"]},{\"type\":\"send\",\"children\":[null,\"objparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"send\",\"children\":[null,\"arrparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"sym\",\"children\":[\"str\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"inspect\"]}]}]}]}]}]}]}","id":"cf67ad61-4954-4a98-9b7d-69d188f6522f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":409,"raw_source":"def registering_extension?\n        !register_path.nil?\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"registering_extension?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register_path\"]},\"nil?\"]},\"!\"]}]}","id":"52cfb6bb-da24-4f8d-b962-507baeafa7ce"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":310,"raw_source":"def redirect(uri, *args)\n      # SERVER_PROTOCOL is required in Rack 3, fall back to HTTP_VERSION\n      # for servers not updated for Rack 3 (like Puma 5)\n      http_version = env['SERVER_PROTOCOL'] || env['HTTP_VERSION']\n      if (http_version == 'HTTP/1.1') && (env['REQUEST_METHOD'] != 'GET')\n        status 303\n      else\n        status 302\n      end\n\n      # According to RFC 2616 section 14.30, \"the field value consists of a\n      # single absolute URI\"\n      response['Location'] = uri(uri.to_s, settings.absolute_redirects?, settings.prefixed_redirects?)\n      halt(*args)\n    end","complexity_score":27.05,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"http_version\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"SERVER_PROTOCOL\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_VERSION\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http_version\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP/1.1\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]},\"!=\",{\"type\":\"str\",\"children\":[\"GET\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"int\",\"children\":[303]}]},{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"int\",\"children\":[302]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Location\"]},{\"type\":\"send\",\"children\":[null,\"uri\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"absolute_redirects?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"prefixed_redirects?\"]}]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]}]}","id":"e14dc92e-be55-4347-a22d-3e75e8f3b0cf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":27,"raw_source":"def test_variable_middle\n    template = Liquid::Template.parse(\"  {{funk}}  \")\n    assert_equal(3, template.root.nodelist.size)\n    assert_equal(String, template.root.nodelist[0].class)\n    assert_equal(Variable, template.root.nodelist[1].class)\n    assert_equal(String, template.root.nodelist[2].class)\n  end","complexity_score":29.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_middle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}}  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"class\"]}]}]}]}","id":"00529c90-a777-4634-b913-4d1259b23517"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":182,"raw_source":"def invert\n          to_hash.invert\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"invert\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"invert\"]}]}","id":"38009fc0-d7bd-46f3-8b54-af0ca3d96304"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":334,"raw_source":"def test_sort_natural\n    assert_equal([\"a\", \"B\", \"c\", \"D\"], @filters.sort_natural([\"c\", \"D\", \"a\", \"B\"]))\n    assert_equal([{ \"a\" => \"a\" }, { \"a\" => \"B\" }, { \"a\" => \"c\" }, { \"a\" => \"D\" }], @filters.sort_natural([{ \"a\" => \"D\" }, { \"a\" => \"c\" }, { \"a\" => \"a\" }, { \"a\" => \"B\" }], \"a\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]},{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"str\",\"children\":[\"D\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"4dd6bb0d-dcb1-4596-b29a-3e819418c65c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":86,"raw_source":"def with_engine(engine)\n      engine_was = @current_engine\n      @current_engine = engine.to_sym\n      yield\n    ensure\n      @current_engine = engine_was\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"with_engine\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"engine_was\",{\"type\":\"ivar\",\"children\":[\"@current_engine\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_engine\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_sym\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_engine\",{\"type\":\"lvar\",\"children\":[\"engine_was\"]}]}]}]}","id":"009763de-a76f-45cd-89ca-e4a426e184e3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1686,"raw_source":"def caller_files\n        cleaned_caller(1).flatten\n      end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"caller_files\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cleaned_caller\",{\"type\":\"int\",\"children\":[1]}]},\"flatten\"]}]}","id":"9ad9e7ec-f93c-4901-b182-e8baded54ed8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":439,"raw_source":"def test_iterate_with_load_slice_when_limit_and_offset_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '34'\n    template = '{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(!loader.each_called)\n    assert(loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_load_slice_when_limit_and_offset_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"34\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items offset:2 limit:2 %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]}]}]}]}","id":"5ef9fd19-fa10-4e04-94b1-0717229b1a30"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":26,"raw_source":"def call(env)\n        request               = Request.new(env)\n        status, headers, body = app.call(env)\n\n        if has_vector?(request, headers)\n          warn env, \"attack prevented by #{self.class}\"\n\n          react_and_close(env, body) or [status, headers, body]\n        else\n          [status, headers, body]\n        end\n      end","complexity_score":15.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"has_vector?\",{\"type\":\"lvar\",\"children\":[\"request\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"react_and_close\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}","id":"b656ba80-1444-44c3-811d-c4abec0bbecf"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/comment.rb","start_line":31,"raw_source":"def parse_body(body, tokenizer)\n      if parse_context.depth >= MAX_DEPTH\n        raise StackLevelError, \"Nesting too deep\"\n      end\n\n      parse_context.depth += 1\n      comment_tag_depth = 1\n\n      begin\n        # Consume tokens without creating child nodes.\n        # The children tag doesn't require to be a valid Liquid except the comment and raw tag.\n        # The child comment and raw tag must be closed.\n        while (token = tokenizer.send(:shift))\n          tag_name = if tokenizer.for_liquid_tag\n            next if token.empty? || token.match?(BlockBody::WhitespaceOrNothing)\n\n            tag_name_match = BlockBody::LiquidTagToken.match(token)\n\n            next if tag_name_match.nil?\n\n            tag_name_match[1]\n          else\n            token =~ BlockBody::FullToken\n            Regexp.last_match(2)\n          end\n\n          case tag_name\n          when \"raw\"\n            parse_raw_tag_body(tokenizer)\n          when \"comment\"\n            comment_tag_depth += 1\n          when \"endcomment\"\n            comment_tag_depth -= 1\n          end\n\n          if comment_tag_depth.zero?\n            parse_context.trim_whitespace = (token[-3] == WhitespaceControl) unless tokenizer.for_liquid_tag\n            return false\n          end\n        end\n\n        raise_tag_never_closed(block_name)\n      ensure\n        parse_context.depth -= 1\n      end\n\n      false\n    end","complexity_score":65.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]},{\"type\":\"arg\",\"children\":[\"tokenizer\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\">=\",{\"type\":\"const\",\"children\":[null,\"MAX_DEPTH\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"StackLevelError\"]},{\"type\":\"str\",\"children\":[\"Nesting too deep\"]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"send\",{\"type\":\"sym\",\"children\":[\"shift\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"WhitespaceOrNothing\"]}]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"tag_name_match\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"LiquidTagToken\"]},\"match\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name_match\"]},\"nil?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name_match\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullToken\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"raw\"]},{\"type\":\"send\",\"children\":[null,\"parse_raw_tag_body\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"comment\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"endcomment\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"comment_tag_depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"comment_tag_depth\"]},\"zero?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"for_liquid_tag\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},null]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"depth\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"false\",\"children\":[]}]}]}","id":"de5c9480-a650-4001-978e-988ab49d2a35"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":364,"raw_source":"def test_nested_context_from_within_drop\n    @context.merge(\"test\" => '123', \"vars\" => { \"local\" => ContextSensitiveDrop.new })\n    assert_equal('123', @context['vars.local.test'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_context_from_within_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"local\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextSensitiveDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.local.test\"]}]}]}]}]}","id":"949f0554-3159-482d-934e-2e3862d9905b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":389,"raw_source":"def test_sort_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.sort(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}","id":"2ada1e1a-89d1-42bf-ab19-0a21b7916e4c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":125,"raw_source":"def test_case_with_else\n    assigns = { 'condition' => 5 }\n    assert_template_result(\n      ' hit ',\n      '{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 6 }\n    assert_template_result(\n      ' else ',\n      '{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 6 }\n    assert_template_result(\n      ' else ',\n      '{% case condition %} {% when 5 %} hit {% else %} else {% endcase %}',\n      assigns,\n    )\n  end","complexity_score":6.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_with_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" hit \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" else \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" else \"]},{\"type\":\"str\",\"children\":[\"{% case condition %} {% when 5 %} hit {% else %} else {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"96fcade1-59ee-474f-8f6e-1b26cabc82f0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":28,"raw_source":"def error_mode=(mode)\n        Deprecations.warn(\"Template.error_mode=\", \"Environment#error_mode=\")\n        Environment.default.error_mode = mode\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"error_mode=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mode\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.error_mode=\"]},{\"type\":\"str\",\"children\":[\"Environment#error_mode=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"mode\"]}]}]}]}","id":"59e57514-86cb-4804-838f-6be7f1976c1a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/referrer_policy.rb","start_line":20,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        headers['referrer-policy'] ||= options[:referrer_policy]\n        [status, headers, body]\n      end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"referrer-policy\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"referrer_policy\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"8a4b1a9c-766c-4f28-a97d-daca8ca4d134"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":295,"raw_source":"def test_except\n    hash = @hash.except(?b, 3, :simple_nested, 'nested')\n    assert_equal Sinatra::IndifferentHash[a: :a], hash\n    assert_instance_of Sinatra::IndifferentHash, hash\n  end if Gem::Version.new(RUBY_VERSION) >= Gem::Version.new(\"3.0\")","complexity_score":4.4,"ast_json":"{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"const\",\"children\":[null,\"RUBY_VERSION\"]}]},\">=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Gem\"]},\"Version\"]},\"new\",{\"type\":\"str\",\"children\":[\"3.0\"]}]}]},{\"type\":\"def\",\"children\":[\"test_except\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"except\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"str\",\"children\":[\"nested\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]},null]}","id":"da0fe9b9-c4ba-42ae-bfbd-1c69b86ac4f2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":629,"raw_source":"def test_first_last\n    assert_equal(1, @filters.first([1, 2, 3]))\n    assert_equal(3, @filters.last([1, 2, 3]))\n    assert_nil(@filters.first([]))\n    assert_nil(@filters.last([]))\n  end","complexity_score":11.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"first\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"last\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"first\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"last\",{\"type\":\"array\",\"children\":[]}]}]}]}]}","id":"916423d4-9726-4481-a9e6-e62131e7ec36"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":261,"raw_source":"def self.registered(klass)\n          klass.get('/bar') { 'bar' }\n        end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"get\",{\"type\":\"str\",\"children\":[\"/bar\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}","id":"4ce22683-c0a0-41b9-ab29-6e7caa70de9e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":54,"raw_source":"def initialize(code: nil, template_name: nil, line_number: nil)\n        @code = code\n        @template_name = template_name\n        @line_number = line_number\n        @children = []\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"code\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"template_name\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@code\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@line_number\",{\"type\":\"lvar\",\"children\":[\"line_number\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@children\",{\"type\":\"array\",\"children\":[]}]}]}]}","id":"cd403c88-f217-4653-882d-2708ff9de8fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":38,"raw_source":"def test_look\n    p = new_parser(\"wat 6 Peter Hegemon\")\n    assert_equal(true, p.look(:id))\n    assert_equal('wat', p.consume(:id))\n    assert_equal(false, p.look(:comparison))\n    assert_equal(true, p.look(:number))\n    assert_equal(true, p.look(:id, 1))\n    assert_equal(false, p.look(:number, 1))\n  end","complexity_score":15.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_look\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat 6 Peter Hegemon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"comparison\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"id\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"look\",{\"type\":\"sym\",\"children\":[\"number\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"f7fd0937-77f7-41cd-9697-8646b87e52e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":50,"raw_source":"def test_if_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% if 1 == 1 %}{{ test }}{% endif %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% if 1 == 1 %}{{ test }}{% endif %}\"]}]}]}]}","id":"db0a8044-6c3f-45a2-a63d-8eeba87284b8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1091,"raw_source":"def route_eval\n      throw :halt, yield\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"route_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"halt\"]},{\"type\":\"yield\",\"children\":[]}]}]}","id":"e1a00507-2186-49ce-9d33-f085b6abdee9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":322,"raw_source":"def test_first_can_appear_in_middle_of_callchain\n    assigns = { \"product\" => { 'variants' => [{ 'title' => 'draft151cm' }, { 'title' => 'element151cm' }] } }\n\n    assert_template_result('draft151cm', '{{ product.variants[0].title }}', assigns)\n    assert_template_result('element151cm', '{{ product.variants[1].title }}', assigns)\n    assert_template_result('draft151cm', '{{ product.variants.first.title }}', assigns)\n    assert_template_result('element151cm', '{{ product.variants.last.title }}', assigns)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_first_can_appear_in_middle_of_callchain\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"variants\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"draft151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"element151cm\"]}]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants[0].title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants[1].title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants.first.title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product.variants.last.title }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"ad684734-55c9-4972-884e-750b02f04ee8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":89,"raw_source":"def falcon?\n      name.to_s == \"falcon\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"falcon?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"name\"]},\"to_s\"]},\"==\",{\"type\":\"str\",\"children\":[\"falcon\"]}]}]}","id":"5909bd3c-eccb-4b7a-aa10-6c13b5d9afa6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":540,"raw_source":"def cache_control(*values)\n      if values.last.is_a?(Hash)\n        hash = values.pop\n        hash.reject! { |_k, v| v == false }\n        hash.reject! { |k, v| values << k if v == true }\n      else\n        hash = {}\n      end\n\n      values.map! { |value| value.to_s.tr('_', '-') }\n      hash.each do |key, value|\n        key = key.to_s.tr('_', '-')\n        value = value.to_i if %w[max-age s-maxage].include? key\n        values << \"#{key}=#{value}\"\n      end\n\n      response['Cache-Control'] = values.join(', ') if values.any?\n    end","complexity_score":38.5,"ast_json":"{\"type\":\"def\",\"children\":[\"cache_control\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"last\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"pop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]}]},{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},\"tr\",{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"str\",\"children\":[\"-\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"max-age\"]},{\"type\":\"str\",\"children\":[\"s-maxage\"]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"<<\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"Cache-Control\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"join\",{\"type\":\"str\",\"children\":[\", \"]}]}]},null]}]}]}","id":"438861ff-0afa-43d5-becd-3f7c60529445"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/for.rb","start_line":114,"raw_source":"def collection_segment(context)\n      offsets = context.registers[:for] ||= {}\n\n      from = if @from == :continue\n        offsets[@name].to_i\n      else\n        from_value = context.evaluate(@from)\n        if from_value.nil?\n          0\n        else\n          Utils.to_integer(from_value)\n        end\n      end\n\n      collection = context.evaluate(@collection_name)\n      collection = collection.to_a if collection.is_a?(Range)\n\n      limit_value = context.evaluate(@limit)\n      to = if limit_value.nil?\n        nil\n      else\n        Utils.to_integer(limit_value) + from\n      end\n\n      segment = Utils.slice_collection(collection, from, to)\n      segment.reverse! if @reversed\n\n      offsets[@name] = from + segment.length\n\n      segment\n    end","complexity_score":34.4,"ast_json":"{\"type\":\"def\",\"children\":[\"collection_segment\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"offsets\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for\"]}]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"from\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@from\"]},\"==\",{\"type\":\"sym\",\"children\":[\"continue\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offsets\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]},\"to_i\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"from_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@from\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from_value\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"from_value\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@collection_name\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Range\"]}]},{\"type\":\"lvasgn\",\"children\":[\"collection\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"to_a\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"limit_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@limit\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"to\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limit_value\"]},\"nil?\"]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"limit_value\"]}]},\"+\",{\"type\":\"lvar\",\"children\":[\"from\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"segment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"slice_collection\",{\"type\":\"lvar\",\"children\":[\"collection\"]},{\"type\":\"lvar\",\"children\":[\"from\"]},{\"type\":\"lvar\",\"children\":[\"to\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reversed\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"reverse!\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offsets\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"from\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"segment\"]},\"length\"]}]}]},{\"type\":\"lvar\",\"children\":[\"segment\"]}]}]}","id":"bc2ae3d5-70e8-4a57-822b-ebc1312c8a08"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":114,"raw_source":"def test_error_line_number_is_correct\n    template = Liquid::Template.parse(<<~LIQUID.chomp, line_numbers: true)\n      {% comment %}\n        {% if true %}\n      {% endcomment %}\n      {{ errors.standard_error }}\n    LIQUID\n\n    output = template.render('errors' => ErrorDrop.new)\n    expected = <<~TEXT.chomp\n\n      Liquid error (line 4): standard error\n    TEXT\n\n    assert_equal(expected, output)\n  end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_line_number_is_correct\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ errors.standard_error }}\\n\"]}]},\"chomp\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Liquid error (line 4): standard error\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"a26bcaaf-33b2-40de-8b84-122de370aeb0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":170,"raw_source":"def hash\n        to_hash.hash\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"hash\"]}]}","id":"128c4c67-3690-4fe4-a9c0-dd980ebfc5c7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":453,"raw_source":"def test_compact_empty_array\n    assert_equal([], @filters.compact([], \"a\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"compact\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}","id":"fda703b2-e905-49aa-abd2-8fc0cebdd1c3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":172,"raw_source":"def test_operators_are_whitelisted\n    assert_raises(SyntaxError) do\n      assert_template_result('', %({% if 1 or throw or or 1 %}yes{% endif %}))\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_operators_are_whitelisted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if 1 or throw or or 1 %}yes{% endif %}\"]}]}]}]}","id":"5ea249ce-8862-4cf1-b928-aa7c5fa9d80c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_ordering_test.rb","start_line":20,"raw_source":"def test_global_register_order\n    with_global_filter(MoneyFilter, CanadianMoneyFilter) do\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render(nil, nil))\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_global_register_order\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"90581166-1107-4f67-aeed-31ce73e487ae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":469,"raw_source":"def test_reverse\n    assert_equal([4, 3, 2, 1], @filters.reverse([1, 2, 3, 4]))\n  end","complexity_score":4.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reverse\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"reverse\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]}","id":"40f196ab-bcdc-48ec-b3b6-67cee8765eeb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":368,"raw_source":"def self.extended(base)\n      base.extend BaseMethods\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extended\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"BaseMethods\"]}]}]}","id":"2b745b7a-9658-48ea-99a1-a8bf602b65e9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag_test.rb","start_line":28,"raw_source":"def render(*)\n        'foo' + super + 'bar'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}","id":"cf18fc7f-b34a-422f-8f8c-6cedd547eb10"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":271,"raw_source":"def test_try_first\n    assigns = { 'test' => [1, 2, 3, 4, 5] }\n    assert_template_result(\"1\", \"{{ test.first }}\", assigns)\n    assert_template_result(\"pass\", \"{% if test.last == 5 %}pass{% endif %}\", assigns)\n\n    assigns = { \"test\" => { \"test\" => [1, 2, 3, 4, 5] } }\n    assert_template_result(\"1\", \"{{ test.test.first }}\", assigns)\n    assert_template_result(\"5\", \"{{ test.test.last }}\", assigns)\n\n    assigns = { \"test\" => [1] }\n    assert_template_result(\"1\", \"{{ test.first }}\", assigns)\n    assert_template_result(\"1\", \"{{ test.last }}\", assigns)\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_try_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if test.last == 5 %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ test.test.last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ test.last }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"df2134e4-0b1b-40da-b038-addfa12ed497"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/assign.rb","start_line":53,"raw_source":"def assign_score_of(val)\n      if val.instance_of?(String)\n        val.bytesize\n      elsif val.instance_of?(Array)\n        sum = 1\n        # Uses #each to avoid extra allocations.\n        val.each { |child| sum += assign_score_of(child) }\n        sum\n      elsif val.instance_of?(Hash)\n        sum = 1\n        val.each do |key, entry_value|\n          sum += assign_score_of(key)\n          sum += assign_score_of(entry_value)\n        end\n        sum\n      else\n        1\n      end\n    end","complexity_score":31.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assign_score_of\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"bytesize\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"child\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"sum\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"entry_value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"lvar\",\"children\":[\"entry_value\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"sum\"]}]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"6eb5c97e-338d-437b-a377-28a2b464d9cd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":104,"raw_source":"def test_limiting\n    assigns = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assert_template_result('12', '{%for i in array limit:2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('1234', '{%for i in array limit:4 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array limit:4 offset:2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array limit: 4 offset: 2 %}{{ i }}{%endfor%}', assigns)\n    assert_template_result('3456', '{%for i in array, limit: 4, offset: 2 %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":8.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_limiting\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1234\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:4 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit:4 offset:2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit: 4 offset: 2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"3456\"]},{\"type\":\"str\",\"children\":[\"{%for i in array, limit: 4, offset: 2 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"03298c65-6cf9-4846-b95a-039e08777f5e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":142,"raw_source":"def print(*args)\n        args.each { |arg| self << arg }\n        nil\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"print\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arg\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"lvar\",\"children\":[\"arg\"]}]}]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"502078d9-030b-4568-aad4-a405236d0ad9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":9,"raw_source":"def test_standard_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{ 'John' }}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          John\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_standard_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          John\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"9ed5944c-010e-4557-9904-6ba4e282b32d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":107,"raw_source":"def each(&block)\n      children.each(&block)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"children\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"970da6bc-a730-418d-8282-90cd116bbdc3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":87,"raw_source":"def move(path, opts = {}, &bk)      route 'MOVE',      path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"move\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"MOVE\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"595b1754-d4b9-4b68-a147-5f913656b898"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":225,"raw_source":"def numtok(s)\n    m = /-?([1-9][0-9]+|[0-9])([.][0-9]+)?([eE][+-]?[0-9]+)?/.match(s)\n    if m && m.begin(0) == 0\n      if m[3] && !m[2]\n        [:val, m[0], Integer(m[1])*(10**Integer(m[3][1..-1]))]\n      elsif m[2]\n        [:val, m[0], Float(m[0])]\n      else\n        [:val, m[0], Integer(m[0])]\n      end\n    end\n  end","complexity_score":37.7,"ast_json":"{\"type\":\"def\",\"children\":[\"numtok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"-?([1-9][0-9]+|[0-9])([.][0-9]+)?([eE][+-]?[0-9]+)?\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"begin\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},\"!\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[10]},\"**\",{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"Float\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"Integer\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}]},null]}]}]}","id":"9b9855b6-46ec-4ef8-b82c-b45a05640657"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":42,"raw_source":"def test_unless_is_blank\n    assert_template_result(\"\", wrap(\"{% unless true %} {% endunless %}\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% unless true %} {% endunless %}\"]}]}]}]}","id":"1e57a543-18bf-49aa-bc4d-9d602ba38f35"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":598,"raw_source":"def test_date\n    assert_equal('May', @filters.date(Time.parse(\"2006-05-05 10:00:00\"), \"%B\"))\n    assert_equal('June', @filters.date(Time.parse(\"2006-06-05 10:00:00\"), \"%B\"))\n    assert_equal('July', @filters.date(Time.parse(\"2006-07-05 10:00:00\"), \"%B\"))\n\n    assert_equal('May', @filters.date(\"2006-05-05 10:00:00\", \"%B\"))\n    assert_equal('June', @filters.date(\"2006-06-05 10:00:00\", \"%B\"))\n    assert_equal('July', @filters.date(\"2006-07-05 10:00:00\", \"%B\"))\n\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", \"\"))\n    assert_equal('2006-07-05 10:00:00', @filters.date(\"2006-07-05 10:00:00\", nil))\n\n    assert_equal('07/05/2006', @filters.date(\"2006-07-05 10:00:00\", \"%m/%d/%Y\"))\n\n    assert_equal(\"07/16/2004\", @filters.date(\"Fri Jul 16 01:00:00 2004\", \"%m/%d/%Y\"))\n    assert_equal(Date.today.year.to_s, @filters.date('now', '%Y'))\n    assert_equal(Date.today.year.to_s, @filters.date('today', '%Y'))\n    assert_equal(Date.today.year.to_s, @filters.date('Today', '%Y'))\n\n    assert_nil(@filters.date(nil, \"%B\"))\n\n    assert_equal('', @filters.date('', \"%B\"))\n\n    with_timezone(\"UTC\") do\n      assert_equal(\"07/05/2006\", @filters.date(1152098955, \"%m/%d/%Y\"))\n      assert_equal(\"07/05/2006\", @filters.date(\"1152098955\", \"%m/%d/%Y\"))\n    end\n  end","complexity_score":61.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_date\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"May\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-05-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"June\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-06-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"July\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]}]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"May\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-05-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"June\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-06-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"July\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"2006-07-05 10:00:00\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/16/2004\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"Fri Jul 16 01:00:00 2004\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"now\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"today\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"today\"]},\"year\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"Today\"]},{\"type\":\"str\",\"children\":[\"%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"%B\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_timezone\",{\"type\":\"str\",\"children\":[\"UTC\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"int\",\"children\":[1152098955]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"07/05/2006\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"date\",{\"type\":\"str\",\"children\":[\"1152098955\"]},{\"type\":\"str\",\"children\":[\"%m/%d/%Y\"]}]}]}]}]}]}]}","id":"7d96211b-27ca-42fe-a9b1-57784e856e9f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":24,"raw_source":"def wrap(body)\n    wrap_in_for(body) + wrap_in_if(body)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"wrap\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},\"+\",{\"type\":\"send\",\"children\":[null,\"wrap_in_if\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"09178a04-c662-4433-9105-3c09c8dfe03f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":53,"raw_source":"def render_to_output_buffer(context, output)\n      @blocks.each do |block|\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          return block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"645f536f-b0ba-4f0f-afa2-617a0fc1fefc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1581,"raw_source":"def configure(*envs)\n        yield self if envs.empty? || envs.include?(environment.to_sym)\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"configure\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"envs\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"envs\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"envs\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environment\"]},\"to_sym\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]}]}","id":"3474996d-3c69-4051-ae57-45f8288c1819"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":48,"raw_source":"def call(env)\n        unless accepts? env\n          instrument env\n          result = react env\n        end\n        result or app.call(env)\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"accepts?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instrument\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[null,\"react\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]}","id":"8eb0a1e6-dc14-4a38-95cf-b15b51780ca9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":54,"raw_source":"def propfind?\n        request_method == 'PROPFIND'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"propfind?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"PROPFIND\"]}]}]}","id":"59e52296-748d-48a6-9e92-4d903e78f170"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":81,"raw_source":"def apply_global_filter(obj)\n      global_filter.nil? ? obj : global_filter.call(obj)\n    end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"apply_global_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"global_filter\"]},\"nil?\"]},{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"global_filter\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}","id":"cedc9818-9f5e-4e9b-9f91-36d95bdd61fc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":103,"raw_source":"def dig(key, *other_keys)\n      super(convert_key(key), *other_keys)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"dig\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"other_keys\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_keys\"]}]}]}]}","id":"79ae9a63-3c7f-43ae-b332-86d27e41d758"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":535,"raw_source":"def test_new_isolated_subcontext_inherits_resource_limits\n    resource_limits = ResourceLimits.new({})\n    super_context   = Context.new({}, {}, {}, false, resource_limits)\n    subcontext      = super_context.new_isolated_subcontext\n    assert_equal(resource_limits, subcontext.resource_limits)\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_inherits_resource_limits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"resource_limits\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"resource_limits\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"resource_limits\"]}]}]}]}","id":"9b4407a5-f9e4-4643-924c-56d7281ecd3f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":352,"raw_source":"def test_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"5a8235f5-cc8e-4bc0-a3f9-5df126f8bceb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":331,"raw_source":"def test_cents\n    @context.merge(\"cents\" => HundredCentes.new)\n    assert_equal(100, @context['cents'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cents\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"HundredCentes\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents\"]}]}]}]}]}","id":"c05c4be1-5706-47fd-80f3-37530918c4de"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":29,"raw_source":"def test_echo\n    assert_equal(\n      [\"test\"],\n      visit(%({% echo test %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_echo\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% echo test %}\"]}]}]}]}","id":"4cbb95b5-ec87-4c3e-9125-340bded76d4f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":72,"raw_source":"def session_key\n        @session_key ||= options[:session_key]\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"session_key\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@session_key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]}","id":"5999a8b6-75e7-432c-8fef-142f34418f6e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":119,"raw_source":"def delete_if\n        return enum_for(__method__) unless block_given?\n\n        each { |k, v| delete(k) if yield(k, v) }\n        self\n      end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"delete_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"delete\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"d27fdfb4-157e-4ed8-af76-d79c42fc2c25"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":16,"raw_source":"def test_nested_translate_string\n    assert_equal(\"something wasn't right\", @i18n.translate(\"errors.syntax.oops\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_translate_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"something wasn't right\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"errors.syntax.oops\"]}]}]}]}","id":"256b800f-932c-4d49-99f5-0fa92c1b0ac9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":133,"raw_source":"def initialize\n          @path_watcher_map = Hash.new do |hash, key|\n            hash[key] = Watcher.new(key)\n          end\n        end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@path_watcher_map\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]},{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Watcher\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]}]}","id":"d6dcee7e-3683-4462-a07e-95fcff738889"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":316,"raw_source":"def test_error_is_raised_during_parse_with_template_name\n    depth = Liquid::Block::MAX_DEPTH + 1\n    code = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n\n    template = Template.parse(\"{% render 'snippet' %}\", line_numbers: true)\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new(\"snippet\" => code),\n        template_factory: StubTemplateFactory.new,\n      },\n    )\n\n    assert_equal(\"Liquid error (some/path/snippet line 1): Nesting too deep\", template.render(context))\n  end","complexity_score":16.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_is_raised_during_parse_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render 'snippet' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"lvar\",\"children\":[\"code\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/snippet line 1): Nesting too deep\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}","id":"ccb9db62-e030-45a8-a6b7-d04560572a07"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":270,"raw_source":"def test_assign_unassigned\n    assigns = { 'var' => 'content' }\n    assert_template_result('var2:  var2:content', 'var2:{{var2}} {%assign var2 = var%} var2:{{var2}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_unassigned\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"var2:  var2:content\"]},{\"type\":\"str\",\"children\":[\"var2:{{var2}} {%assign var2 = var%} var2:{{var2}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"c5ef9713-304c-4260-a50f-3c4a233ff1cf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":181,"raw_source":"def test_escape_once\n    assert_equal('&lt;strong&gt;Hulk&lt;/strong&gt;', @filters.escape_once('&lt;strong&gt;Hulk</strong>'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_escape_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;Hulk&lt;/strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"escape_once\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;Hulk</strong>\"]}]}]}]}","id":"8e90e0ca-2167-4069-81f8-8f35aeb7bf60"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":169,"raw_source":"def test_pre_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' }}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John\n        </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pre_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"55ec8a4e-a70d-4861-8ea6-525ffcd19b09"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":973,"raw_source":"def test_find_with_value\n    products = [\n      { \"title\" => \"Pro goggles\",    \"price\" => 1299 },\n      { \"title\" => \"Thermal gloves\", \"price\" => 1499 },\n      { \"title\" => \"Alpine jacket\",  \"price\" => 3999 },\n      { \"title\" => \"Mountain boots\", \"price\" => 3899 },\n      { \"title\" => \"Safety helmet\",  \"price\" => 1999 }\n    ]\n\n    template = <<~LIQUID\n      {%- assign product = products | find: 'price', 3999 -%}\n      {{- product.title -}}\n    LIQUID\n    expected_output = \"Alpine jacket\"\n\n    assert_template_result(expected_output, template, { \"products\" => products })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"products\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Pro goggles\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1299]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Thermal gloves\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1499]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3999]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Mountain boots\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3899]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Safety helmet\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1999]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign product = products | find: 'price', 3999 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{- product.title -}}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"lvar\",\"children\":[\"products\"]}]}]}]}]}]}","id":"4a2c561a-91e0-4b3c-810a-446e378b16d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":285,"raw_source":"def test_access_hashes_with_hash_notation\n    assigns = { 'products' => { 'count' => 5, 'tags' => ['deepsnow', 'freestyle'] } }\n    assert_template_result(\"5\", '{{ products[\"count\"] }}', assigns)\n    assert_template_result(\"deepsnow\", '{{ products[\"tags\"][0] }}', assigns)\n    assert_template_result(\"deepsnow\", '{{ products[\"tags\"].first }}', assigns)\n\n    assigns = { 'product' => { 'variants' => [{ 'title' => 'draft151cm' }, { 'title' => 'element151cm' }] } }\n    assert_template_result(\"draft151cm\", '{{ product[\"variants\"][0][\"title\"] }}', assigns)\n    assert_template_result(\"element151cm\", '{{ product[\"variants\"][1][\"title\"] }}', assigns)\n    assert_template_result(\"draft151cm\", '{{ product[\"variants\"].first[\"title\"] }}', assigns)\n    assert_template_result(\"element151cm\", '{{ product[\"variants\"].last[\"title\"] }}', assigns)\n  end","complexity_score":9.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_hashes_with_hash_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"tags\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"freestyle\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"count\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"tags\\\"][0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"deepsnow\"]},{\"type\":\"str\",\"children\":[\"{{ products[\\\"tags\\\"].first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"variants\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"draft151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"element151cm\"]}]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"][0][\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"][1][\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"draft151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"].first[\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"element151cm\"]},{\"type\":\"str\",\"children\":[\"{{ product[\\\"variants\\\"].last[\\\"title\\\"] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"4089164a-215d-4e99-8526-118dbea31778"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":231,"raw_source":"def test_for_with_break\n    assigns = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] } }\n\n    markup   = '{% for i in array.items %}{% break %}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% break %}{% endfor %}'\n    expected = \"1\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{% break %}{{ i }}{% endfor %}'\n    expected = \"\"\n    assert_template_result(expected, markup, assigns)\n\n    markup   = '{% for i in array.items %}{{ i }}{% if i > 3 %}{% break %}{% endif %}{% endfor %}'\n    expected = \"1234\"\n    assert_template_result(expected, markup, assigns)\n\n    # tests to ensure it only breaks out of the local for loop\n    # and not all of them.\n    assigns  = { 'array' => [[1, 2], [3, 4], [5, 6]] }\n    markup   = '{% for item in array %}' \\\n               '{% for i in item %}' \\\n                 '{% if i == 1 %}' \\\n                   '{% break %}' \\\n                 '{% endif %}' \\\n                 '{{ i }}' \\\n               '{% endfor %}' \\\n             '{% endfor %}'\n    expected = '3456'\n    assert_template_result(expected, markup, assigns)\n\n    # test break does nothing when unreached\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5] } }\n    markup   = '{% for i in array.items %}{% if i == 9999 %}{% break %}{% endif %}{{ i }}{% endfor %}'\n    expected = '12345'\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":26.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_break\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[10]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% break %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% break %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% break %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{{ i }}{% if i > 3 %}{% break %}{% endif %}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"1234\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for item in array %}\"]},{\"type\":\"str\",\"children\":[\"{% for i in item %}\"]},{\"type\":\"str\",\"children\":[\"{% if i == 1 %}\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]},{\"type\":\"str\",\"children\":[\"{% endif %}\"]},{\"type\":\"str\",\"children\":[\"{{ i }}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]},{\"type\":\"str\",\"children\":[\"{% endfor %}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"3456\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"{% for i in array.items %}{% if i == 9999 %}{% break %}{% endif %}{{ i }}{% endfor %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"fbf4afa1-adf1-40e9-a9f3-8a7144c01a9f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":55,"raw_source":"def test_for_with_hash_value_range\n    foobar = { \"value\" => 3 }\n    assert_template_result(' 1  2  3 ', '{%for item in (1..foobar.value) %} {{item}} {%endfor%}', { \"foobar\" => foobar })\n  end","complexity_score":2.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_with_hash_value_range\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foobar\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1  2  3 \"]},{\"type\":\"str\",\"children\":[\"{%for item in (1..foobar.value) %} {{item}} {%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"foobar\"]}]}]}]}]}]}","id":"d206bd59-73b6-4ef8-9d53-0482c9cfb08e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1092,"raw_source":"def test_where_string_keys\n    input = [\n      \"alpha\", \"beta\", \"gamma\", \"delta\"\n    ]\n\n    expectation = [\n      \"beta\",\n    ]\n\n    assert_equal(expectation, @filters.where(input, \"be\"))\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_string_keys\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"be\"]}]}]}]}]}","id":"08b8625e-58ea-4dcd-aeaa-fdd92e2db80d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":482,"raw_source":"def test_interrupt_avoids_object_allocations\n    @context.interrupt? # ruby 3.0.0 allocates on the first call\n    assert_no_object_allocations do\n      @context.interrupt?\n    end\n  end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_interrupt_avoids_object_allocations\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"interrupt?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_no_object_allocations\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"interrupt?\"]}]}]}]}","id":"6611346c-c05a-40fa-b0a3-60fcff905b8f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":302,"raw_source":"def inline_templates=(file = nil)\n        file = (caller_files[1] || File.expand_path($0)) if file.nil? || file == true\n        watch_element(file, :inline_templates)\n        super\n      end","complexity_score":12.55,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates=\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"file\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"f860ca70-28d8-4fa6-b88d-bb5827d3b25d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":36,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      raise SyntaxError, options[:locale].t(\"errors.syntax.render\") unless markup =~ SYNTAX\n\n      template_name = Regexp.last_match(1)\n      with_or_for = Regexp.last_match(3)\n      variable_name = Regexp.last_match(4)\n\n      @alias_name = Regexp.last_match(6)\n      @variable_name_expr = variable_name ? parse_expression(variable_name) : nil\n      @template_name_expr = parse_expression(template_name)\n      @is_for_loop = (with_or_for == FOR)\n\n      @attributes = {}\n      markup.scan(TagAttributes) do |key, value|\n        @attributes[key] = parse_expression(value)\n      end\n    end","complexity_score":27.4,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"SYNTAX\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.render\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"with_or_for\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@alias_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name_expr\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable_name\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"variable_name\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name_expr\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@is_for_loop\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"with_or_for\"]},\"==\",{\"type\":\"const\",\"children\":[null,\"FOR\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}","id":"39ea873d-8339-469f-aa52-9151f0bf648b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":57,"raw_source":"def test_variable_piping\n    text     = %( {{ car.gm | make_funny }} )\n    expected = %( LOL )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | make_funny }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" LOL \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"b761afdc-1709-49b3-81c4-f81b48b04ab9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":265,"raw_source":"def sort(&block)\n          to_hash.sort(&block)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"sort\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"sort\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"dd17c37a-bb3a-45b0-a322-4bddd7869626"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1547,"raw_source":"def head(path, opts = {}, &block)    route 'HEAD',    path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"head\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"426b9f2c-ccb1-4622-8ab2-335651a3a0b3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":178,"raw_source":"def test_multiple_conditions\n    tpl = \"{% if a or b and c %}true{% else %}false{% endif %}\"\n\n    tests = {\n      [true, true, true] => true,\n      [true, true, false] => true,\n      [true, false, true] => true,\n      [true, false, false] => true,\n      [false, true, true] => true,\n      [false, true, false] => false,\n      [false, false, true] => false,\n      [false, false, false] => false,\n    }\n\n    tests.each do |vals, expected|\n      a, b, c = vals\n      assigns = { 'a' => a, 'b' => b, 'c' => c }\n      assert_template_result(expected.to_s, tpl, assigns, message: assigns.to_s)\n    end\n  end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_conditions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tpl\",{\"type\":\"str\",\"children\":[\"{% if a or b and c %}true{% else %}false{% endif %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"tests\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tests\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"vals\"]},{\"type\":\"arg\",\"children\":[\"expected\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"a\"]},{\"type\":\"lvasgn\",\"children\":[\"b\"]},{\"type\":\"lvasgn\",\"children\":[\"c\"]}]},{\"type\":\"lvar\",\"children\":[\"vals\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"expected\"]},\"to_s\"]},{\"type\":\"lvar\",\"children\":[\"tpl\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"to_s\"]}]}]}]}]}]}]}]}","id":"1f85b784-672a-4d16-bd43-8b68516a4b40"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/show_exceptions.rb","start_line":22,"raw_source":"def call(env)\n      @app.call(env)\n    rescue Exception => e\n      errors = env['rack.errors']\n      env['rack.errors'] = @@eats_errors\n\n      if prefers_plain_text?(env)\n        content_type = 'text/plain'\n        body = dump_exception(e)\n      else\n        content_type = 'text/html'\n        body = pretty(env, e)\n      end\n\n      env['rack.errors'] = errors\n\n      [\n        500,\n        {\n          'content-type' => content_type,\n          'content-length' => body.bytesize.to_s\n        },\n        [body]\n      ]\n    end","complexity_score":20.28,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"errors\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.errors\"]},{\"type\":\"cvar\",\"children\":[\"@@eats_errors\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prefers_plain_text?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"str\",\"children\":[\"text/plain\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"dump_exception\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"content_type\",{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"send\",\"children\":[null,\"pretty\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.errors\"]},{\"type\":\"lvar\",\"children\":[\"errors\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[500]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"lvar\",\"children\":[\"content_type\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"bytesize\"]},\"to_s\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]},null]}]}","id":"476881d3-1333-439f-8e48-96ff520eb26b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1533,"raw_source":"def get(path, opts = {}, &block)\n        conditions = @conditions.dup\n        route('GET', path, opts, &block)\n\n        @conditions = conditions\n        route('HEAD', path, opts, &block)\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"get\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"conditions\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@conditions\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"GET\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"lvar\",\"children\":[\"conditions\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"HEAD\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"ee8b1267-f7e9-4c5a-8cbd-5c508cb0be01"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/base_test.rb","start_line":109,"raw_source":"def route_missing\n        env['sinatra.route-missing'] = '1'\n        super\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"route_missing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.route-missing\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"b29fbadf-29d8-4ca6-ad30-a8d4ce514f86"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":766,"raw_source":"def test_ceil\n    assert_template_result(\"5\", \"{{ input | ceil }}\", { 'input' => 4.6 })\n    assert_template_result(\"5\", \"{{ '4.3' | ceil }}\")\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | ceil }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | ceil }}\", { 'price' => NumberLikeThing.new(4.6) })\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ceil\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ input | ceil }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | ceil }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | ceil }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | ceil }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[4.6]}]}]}]}]}]}]}","id":"5801f05c-0b88-4ec7-a16a-2585283a71f4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":314,"raw_source":"def layout(name = :layout, &block)\n        template name, &block\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"layout\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"name\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"4d4252e8-9eb8-48e2-937d-4567d4ae2383"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":76,"raw_source":"def default_resource_limits\n        Environment.default.default_resource_limits\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"default_resource_limits\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"default_resource_limits\"]}]}","id":"94a0d79b-643b-4f5c-936d-ced5932d4123"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":653,"raw_source":"def test_remove\n    assert_equal('   ', @filters.remove(\"a a a a\", 'a'))\n    assert_template_result('   ', \"{{ '1 1 1 1' | remove: 1 }}\")\n\n    assert_equal('b a a', @filters.remove_first(\"a b a a\", 'a '))\n    assert_template_result(' 1 1 1', \"{{ '1 1 1 1' | remove_first: 1 }}\")\n\n    assert_equal('a a b', @filters.remove_last(\"a a b a\", ' a'))\n    assert_template_result('1 1 1 ', \"{{ '1 1 1 1' | remove_last: 1 }}\")\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_remove\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"   \"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"   \"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove: 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b a a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove_first\",{\"type\":\"str\",\"children\":[\"a b a a\"]},{\"type\":\"str\",\"children\":[\"a \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" 1 1 1\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove_first: 1 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a a b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"remove_last\",{\"type\":\"str\",\"children\":[\"a a b a\"]},{\"type\":\"str\",\"children\":[\" a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 1 1 \"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | remove_last: 1 }}\"]}]}]}]}","id":"4c34c6ec-a47d-4df8-9318-e0004db5f4a2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1349,"raw_source":"def set(option, value = (not_set = true), ignore_setter = false, &block)\n        raise ArgumentError if block && !not_set\n\n        if block\n          value = block\n          not_set = false\n        end\n\n        if not_set\n          raise ArgumentError unless option.respond_to?(:each)\n\n          option.each { |k, v| set(k, v) }\n          return self\n        end\n\n        if respond_to?(\"#{option}=\") && !ignore_setter\n          return __send__(\"#{option}=\", value)\n        end\n\n        setter = proc { |val| set option, val, true }\n        getter = proc { value }\n\n        case value\n        when Proc\n          getter = value\n        when Symbol, Integer, FalseClass, TrueClass, NilClass\n          getter = value.inspect\n        when Hash\n          setter = proc do |val|\n            val = value.merge val if Hash === val\n            set option, val, true\n          end\n        end\n\n        define_singleton(\"#{option}=\", setter)\n        define_singleton(option, getter)\n        define_singleton(\"#{option}?\", \"!!#{option}\") unless method_defined? \"#{option}?\"\n        self\n      end","complexity_score":56.2,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"option\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"not_set\",{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"optarg\",\"children\":[\"ignore_setter\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_set\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvasgn\",\"children\":[\"not_set\",{\"type\":\"false\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"not_set\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"self\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_to?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ignore_setter\"]},\"!\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__send__\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"setter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Proc\"]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"const\",\"children\":[null,\"FalseClass\"]},{\"type\":\"const\",\"children\":[null,\"TrueClass\"]},{\"type\":\"const\",\"children\":[null,\"NilClass\"]},{\"type\":\"lvasgn\",\"children\":[\"getter\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"inspect\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"lvasgn\",\"children\":[\"setter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"val\"]}]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"val\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"=\"]}]},{\"type\":\"lvar\",\"children\":[\"setter\"]}]},{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"lvar\",\"children\":[\"option\"]},{\"type\":\"lvar\",\"children\":[\"getter\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"?\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"define_singleton\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]},{\"type\":\"str\",\"children\":[\"?\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"!!\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"option\"]}]}]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"f9b522f2-57f1-425f-9d0d-5c6b89224b80"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":28,"raw_source":"def with_default_layout\n    layout = __dir__ + '/views/layout.test'\n    File.open(layout, 'wb') { |io| io.write \"Layout!\\n\" }\n    yield\n  ensure\n    File.unlink(layout) rescue nil\n  end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"with_default_layout\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"layout\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views/layout.test\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"open\",{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"str\",\"children\":[\"wb\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"io\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"io\"]},\"write\",{\"type\":\"str\",\"children\":[\"Layout!\\n\"]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"unlink\",{\"type\":\"lvar\",\"children\":[\"layout\"]}]},{\"type\":\"resbody\",\"children\":[null,null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]}","id":"1b306c41-3dd7-45c7-b841-2df63bc2bed0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":46,"raw_source":"def test_contains_works_on_strings\n    assert_evaluates_true('bob', 'contains', 'o')\n    assert_evaluates_true('bob', 'contains', 'b')\n    assert_evaluates_true('bob', 'contains', 'bo')\n    assert_evaluates_true('bob', 'contains', 'ob')\n    assert_evaluates_true('bob', 'contains', 'bob')\n\n    assert_evaluates_false('bob', 'contains', 'bob2')\n    assert_evaluates_false('bob', 'contains', 'a')\n    assert_evaluates_false('bob', 'contains', '---')\n  end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_works_on_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"ob\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bob\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"bob2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"str\",\"children\":[\"bob\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"---\"]}]}]}]}","id":"213cb1c1-27b5-4084-885d-6aa7ce6d21cd"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":111,"raw_source":"def self.inspect(obj, seen = {})\n      case obj\n      when Hash\n        # If the custom hash implementation overrides `#inspect`, use their\n        # custom implementation. Otherwise we use Liquid's default\n        # implementation.\n        if obj.class.instance_method(:inspect) == HASH_INSPECT_METHOD\n          hash_inspect(obj, seen)\n        else\n          obj.inspect\n        end\n      when Array\n        array_inspect(obj, seen)\n      else\n        obj.inspect\n      end\n    end","complexity_score":15.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"class\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"inspect\"]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"HASH_INSPECT_METHOD\"]}]},{\"type\":\"send\",\"children\":[null,\"hash_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"array_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"inspect\"]}]}]}","id":"57cb2a5e-c17e-44c5-b64b-2e6814fc7faf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":92,"raw_source":"def self.extended(obj)\n        obj.closed = false\n        obj.lineno = 0\n        obj.pos = 0\n        obj.callback { obj.closed = true }\n        obj.errback  { obj.closed = true }\n      end","complexity_score":9.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"extended\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"lineno=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"pos=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"callback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"errback\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"closed=\",{\"type\":\"true\",\"children\":[]}]}]}]}]}","id":"88a1ee9f-b737-4b94-a665-60316737428c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":294,"raw_source":"def test_syntax_error_is_raised_with_template_name_from_template_factory\n    file_system = StubFileSystem.new(\"snippet\" => \"1\\n2\\n{{ 1\")\n\n    context = Liquid::Context.build(\n      registers: {\n        file_system: file_system,\n        template_factory: StubTemplateFactory.new,\n      },\n    )\n\n    template = Template.parse(\n      '{% render \"snippet\" %}',\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    assert_equal(\n      \"Liquid syntax error (some/path/snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\",\n      template.render(context),\n    )\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_is_raised_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"1\\n2\\n{{ 1\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (some/path/snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}","id":"7f4898f2-8b0b-4f60-92dd-6ec28f2c4063"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":5,"raw_source":"def self.parse(tokens, parse_context)\n      doc = new(parse_context)\n      doc.parse(tokens, parse_context)\n      doc\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"doc\",{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"doc\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokens\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"lvar\",\"children\":[\"doc\"]}]}]}","id":"052a0081-02e4-4f67-9fe1-6b39932c50ad"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1712,"raw_source":"def suppress_messages?\n        handler_name =~ /cgi/i || quiet\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"suppress_messages?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handler_name\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"cgi\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]}]},{\"type\":\"send\",\"children\":[null,\"quiet\"]}]}]}","id":"000700a4-31fa-46b2-9270-cb08943099e5"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":137,"raw_source":"def url_decode(input)\n      return if input.nil?\n\n      result = CGI.unescape(Utils.to_s(input))\n      raise Liquid::ArgumentError, \"invalid byte sequence in #{result.encoding}\" unless result.valid_encoding?\n\n      result\n    end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"url_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"unescape\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"encoding\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"a216417b-b5ed-4f80-bcb8-0e39e81b613d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":331,"raw_source":"def error(*codes, &block)\n        path = caller_files[1] || File.expand_path($0)\n        result = super\n        codes.each do |c|\n          watch_element(path, :error, code: c, handler: @errors[c])\n        end\n        result\n      end","complexity_score":11.23,"ast_json":"{\"type\":\"def\",\"children\":[\"error\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"codes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"codes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"sym\",\"children\":[\"error\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"lvar\",\"children\":[\"c\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"handler\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"c\"]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"ca0c0e88-305d-439c-b9ab-61c033146c43"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":199,"raw_source":"def test_access_context_from_drop\n    assert_equal('123', Liquid::Template.parse('{%for a in dummy%}{{ context.loop_pos }}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1, 2, 3]))\n  end","complexity_score":6.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_context_from_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{{ context.loop_pos }}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]}]}]}","id":"d1483ce1-6949-4b00-9287-2cec3aee475f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/templates_test.rb","start_line":17,"raw_source":"def render_app(base=Sinatra::Base, options = {}, &block)\n    base, options = Sinatra::Base, base if base.is_a? Hash\n    mock_app(base) do\n      set :views, __dir__ + '/views'\n      set options\n      get('/', &block)\n      template(:layout3) { \"Layout 3!\\n\" }\n    end\n    get '/'\n  end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"render_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\"]},{\"type\":\"lvasgn\",\"children\":[\"options\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]},{\"type\":\"lvar\",\"children\":[\"base\"]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"template\",{\"type\":\"sym\",\"children\":[\"layout3\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Layout 3!\\n\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"5991e009-6845-4c4d-8f5d-05df030b692e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":151,"raw_source":"def test_profiling_marks_children_with_the_name_of_included_partial\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    include_node = t.profiler[1]\n    include_node.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n  end","complexity_score":12.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_marks_children_with_the_name_of_included_partial\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"include_node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"include_node\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}","id":"46d1df4e-5b16-45f7-8ddd-ff415a1625bb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1022,"raw_source":"def nil_safe_casecmp(a, b)\n      if !a.nil? && !b.nil?\n        a.to_s.casecmp(b.to_s)\n      elsif a.nil? && b.nil?\n        0\n      else\n        a.nil? ? 1 : -1\n      end\n    end","complexity_score":17.83,"ast_json":"{\"type\":\"def\",\"children\":[\"nil_safe_casecmp\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_s\"]},\"casecmp\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_s\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"nil?\"]}]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"nil?\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}","id":"7a62feb0-43d9-432d-b909-cee4e262ded7"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/database.rb","start_line":10,"raw_source":"def self.tables\n    @tables ||= begin\n      db =\n        if YAML.respond_to?(:unsafe_load_file) # Only Psych 4+ can use unsafe_load_file\n          # unsafe_load_file is needed for YAML references\n          YAML.unsafe_load_file(DATABASE_FILE_PATH)\n        else\n          YAML.load_file(DATABASE_FILE_PATH)\n        end\n\n      # From vision source\n      db['products'].each do |product|\n        collections = db['collections'].find_all do |collection|\n          collection['products'].any? { |p| p['id'].to_i == product['id'].to_i }\n        end\n        product['collections'] = collections\n      end\n\n      # key the tables by handles, as this is how liquid expects it.\n      db = db.each_with_object({}) do |(key, values), assigns|\n        assigns[key] = values.each_with_object({}) do |v, h|\n          h[v['handle']] = v\n        end\n      end\n\n      # Some standard direct accessors so that the specialized templates\n      # render correctly\n      db['collection'] = db['collections'].values.first\n      db['product']    = db['products'].values.first\n      db['blog']       = db['blogs'].values.first\n      db['article']    = db['blog']['articles'].first\n\n      db['cart']       = {\n        'total_price' => db['line_items'].values.inject(0) { |sum, item| sum + item['line_price'] * item['quantity'] },\n        'item_count' => db['line_items'].values.inject(0) { |sum, item| sum + item['quantity'] },\n        'items' => db['line_items'].values,\n      }\n\n      db\n    end\n  end","complexity_score":87.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"tables\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tables\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"db\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"unsafe_load_file\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"unsafe_load_file\",{\"type\":\"const\",\"children\":[null,\"DATABASE_FILE_PATH\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load_file\",{\"type\":\"const\",\"children\":[null,\"DATABASE_FILE_PATH\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"product\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"collections\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"collections\"]}]},\"find_all\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"collection\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"collection\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"[]\",{\"type\":\"str\",\"children\":[\"id\"]}]},\"to_i\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"product\"]},\"[]\",{\"type\":\"str\",\"children\":[\"id\"]}]},\"to_i\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"product\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"collections\"]},{\"type\":\"lvar\",\"children\":[\"collections\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"db\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"each_with_object\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"values\"]}]},{\"type\":\"arg\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"values\"]},\"each_with_object\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]},{\"type\":\"arg\",\"children\":[\"h\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"[]\",{\"type\":\"str\",\"children\":[\"handle\"]}]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"collection\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"collections\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"products\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"blog\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"blogs\"]}]},\"values\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"article\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"blog\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"articles\"]}]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"cart\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"total_price\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]},\"inject\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"sum\"]},{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_price\"]}]},\"*\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"item_count\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]},\"inject\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"sum\"]},{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"sum\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"db\"]},\"[]\",{\"type\":\"str\",\"children\":[\"line_items\"]}]},\"values\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"db\"]}]}]}]}","id":"9d0c510e-1d74-40f5-8f74-53780651cc2f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":66,"raw_source":"def post(*args, &block)     super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"post\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"979a575c-d3a8-4776-8af8-818cd7ad46ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":18,"raw_source":"def add_tag(input, tag = \"p\", id = \"foo\")\n    %(<#{tag} id=\"#{id}\">#{input}</#{tag}>)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"tag\",{\"type\":\"str\",\"children\":[\"p\"]}]},{\"type\":\"optarg\",\"children\":[\"id\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\" id=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"id\"]}]},{\"type\":\"str\",\"children\":[\"\\\">\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"str\",\"children\":[\"</\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"str\",\"children\":[\">\"]}]}]}","id":"48d2a4a1-7fbb-45bc-99a6-efd8edd6569c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":242,"raw_source":"def test_array_notation\n    assigns = { \"test\" => [\"a\", \"b\"] }\n    assert_template_result(\"a\", \"{{ test[0] }}\", assigns)\n    assert_template_result(\"b\", \"{{ test[1] }}\", assigns)\n    assert_template_result(\"pass\", \"{% if test[2] == nil %}pass{% endif %}\", assigns)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_array_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"{{ test[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"{{ test[1] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if test[2] == nil %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"9adf70ab-72d8-4d9d-b4b6-8a4ae0cdabef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":119,"raw_source":"def it(message, &block)\n    Server.each do |server|\n      next unless server.installed?\n      super(\"with #{server.name}: #{message}\") { server.run_test(self, &block) }\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"it\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"installed?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"name\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"run_test\",{\"type\":\"self\",\"children\":[]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}","id":"2fd1968b-89a9-4b1b-93d1-c85da901c636"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":154,"raw_source":"def test_offset_only\n    assigns = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assert_template_result('890', '{%for i in array offset:7 %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":4.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_offset_only\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"890\"]},{\"type\":\"str\",\"children\":[\"{%for i in array offset:7 %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"9ae655f8-5e3b-41d0-a00b-64c345ba3620"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":730,"raw_source":"def test_divided_by\n    assert_template_result(\"4\", \"{{ 12 | divided_by:3 }}\")\n    assert_template_result(\"4\", \"{{ 14 | divided_by:3 }}\")\n\n    assert_template_result(\"5\", \"{{ 15 | divided_by:3 }}\")\n    assert_equal(\"Liquid error: divided by 0\", Template.parse(\"{{ 5 | divided_by:0 }}\").render)\n\n    assert_template_result(\"0.5\", \"{{ 2.0 | divided_by:4 }}\")\n    assert_raises(Liquid::ZeroDivisionError) do\n      assert_template_result(\"4\", \"{{ 1 | modulo: 0 }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | divided_by:2 }}\", { 'price' => NumberLikeThing.new(10) })\n  end","complexity_score":13.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_divided_by\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 12 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 14 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 15 | divided_by:3 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: divided by 0\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 5 | divided_by:0 }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.5\"]},{\"type\":\"str\",\"children\":[\"{{ 2.0 | divided_by:4 }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ZeroDivisionError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1 | modulo: 0 }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | divided_by:2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[10]}]}]}]}]}]}]}","id":"349e77d8-cccf-491d-b28f-6e18f75c9ed5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":288,"raw_source":"def compile!(verb, path, block, **options)\n        source_location = block.respond_to?(:source_location) ?\n          block.source_location.first : caller_files[1]\n        signature = super\n        watch_element(\n          source_location, :route, { verb: verb, signature: signature }\n        )\n        signature\n      end","complexity_score":10.13,"ast_json":"{\"type\":\"def\",\"children\":[\"compile!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"arg\",\"children\":[\"block\"]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source_location\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"source_location\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"source_location\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"source_location\"]},{\"type\":\"sym\",\"children\":[\"route\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"signature\"]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}","id":"79394b5a-e1e7-41ce-9fe2-1d6cd80dbad4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":98,"raw_source":"def initialize(entry)\n        params = entry.scan(HEADER_PARAM).map! do |s|\n          key, value = s.strip.split('=', 2)\n          value = value[1..-2].gsub(/\\\\(.)/, '\\1') if value.start_with?('\"')\n          [key, value]\n        end\n\n        @entry  = entry\n        @type   = entry[/[^;]+/].delete(' ')\n        @params = params.to_h\n        @q      = @params.delete('q') { 1.0 }.to_f\n      end","complexity_score":28.18,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"entry\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"params\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_PARAM\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\"]},{\"type\":\"lvasgn\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"strip\"]},\"split\",{\"type\":\"str\",\"children\":[\"=\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"start_with?\",{\"type\":\"str\",\"children\":[\"\\\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\\\\(.)\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"\\\\1\"]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@entry\",{\"type\":\"lvar\",\"children\":[\"entry\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@type\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"entry\"]},\"[]\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"[^;]+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},\"delete\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@params\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"to_h\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@q\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"delete\",{\"type\":\"str\",\"children\":[\"q\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"float\",\"children\":[1.0]}]},\"to_f\"]}]}]}]}","id":"fb7d7634-4beb-452e-b0d1-e039e7e6e10c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":315,"raw_source":"def lstrip(input)\n      input = Utils.to_s(input)\n      input.lstrip\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"lstrip\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"lstrip\"]}]}]}","id":"524abab8-4bb9-4a47-a8e5-10e31e1686c3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":125,"raw_source":"def merge!(*other_hashes)\n      other_hashes.each do |other_hash|\n        if other_hash.is_a?(self.class)\n          super(other_hash)\n        else\n          other_hash.each_pair do |key, value|\n            key = convert_key(key)\n            value = yield(key, self[key], value) if block_given? && key?(key)\n            self[key] = convert_value(value)\n          end\n        end\n      end\n\n      self\n    end","complexity_score":25.0,"ast_json":"{\"type\":\"def\",\"children\":[\"merge!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"other_hashes\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hashes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other_hash\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other_hash\"]},\"each_pair\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"6275eb85-ca21-4c7b-b1c2-9882acb8313e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":477,"raw_source":"def test_map\n    assert_equal([1, 2, 3, 4], @filters.map([{ \"a\" => 1 }, { \"a\" => 2 }, { \"a\" => 3 }, { \"a\" => 4 }], 'a'))\n    assert_template_result(\n      'abc',\n      \"{{ ary | map:'foo' | map:'bar' }}\",\n      { 'ary' => [{ 'foo' => { 'bar' => 'a' } }, { 'foo' => { 'bar' => 'b' } }, { 'foo' => { 'bar' => 'c' } }] },\n    )\n  end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"map\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"abc\"]},{\"type\":\"str\",\"children\":[\"{{ ary | map:'foo' | map:'bar' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ary\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"c\"]}]}]}]}]}]}]}]}]}]}]}","id":"e0d5b6d9-5aa9-4eaa-ae51-a1065361cda2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":55,"raw_source":"def tags\n        Environment.default.tags\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"tags\"]}]}","id":"7e2f39bf-6586-4b8a-80a6-783969e73a5c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":32,"raw_source":"def test_if_or\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => true, 'b' => true })\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => true, 'b' => false })\n    assert_template_result(' YES ', '{% if a or b %} YES {% endif %}', { 'a' => false, 'b' => true })\n    assert_template_result('',      '{% if a or b %} YES {% endif %}', { 'a' => false, 'b' => false })\n\n    assert_template_result(' YES ', '{% if a or b or c %} YES {% endif %}', { 'a' => false, 'b' => false, 'c' => true })\n    assert_template_result('',      '{% if a or b or c %} YES {% endif %}', { 'a' => false, 'b' => false, 'c' => false })\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_or\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a or b %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if a or b or c %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if a or b or c %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]}","id":"18e0d414-ece5-40fb-ad0d-4070f8ea1051"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":218,"raw_source":"def render_to_output_buffer(context, output)\n      freeze unless frozen?\n\n      context.resource_limits.increment_render_score(@nodelist.length)\n\n      idx = 0\n      while (node = @nodelist[idx])\n        if node.instance_of?(String)\n          output << node\n        else\n          render_node(context, output, node)\n          # If we get an Interrupt that means the block must stop processing. An\n          # Interrupt is any command that stops block execution such as {% break %}\n          # or {% continue %}. These tags may also occur through Block or Include tags.\n          break if context.interrupt? # might have happened in a for-block\n        end\n        idx += 1\n\n        context.resource_limits.increment_write_score(output)\n      end\n\n      output\n    end","complexity_score":23.95,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"frozen?\"]},null,{\"type\":\"send\",\"children\":[null,\"freeze\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_render_score\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"idx\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"idx\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"render_node\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"lvar\",\"children\":[\"node\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"interrupt?\"]},{\"type\":\"break\",\"children\":[]},null]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"idx\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"increment_write_score\",{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"36cf377e-5d70-4210-8df5-c9bac9099c7d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":87,"raw_source":"def capitalize(input)\n      Utils.to_s(input).capitalize\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"capitalize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"capitalize\"]}]}","id":"d5e8a9f9-bad6-43b1-bee0-0a71b56c4121"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1143,"raw_source":"def test_where_array_of_only_unindexable_values\n    assert_nil(@filters.where([nil], \"ok\", true))\n    assert_nil(@filters.where([nil], \"ok\"))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_array_of_only_unindexable_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}","id":"897a01d3-8739-4a23-9dc3-b4eb56105951"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":812,"raw_source":"def yajl(template, options = {}, locals = {})\n      options[:default_content_type] = :json\n      render :yajl, template, options, locals\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"yajl\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"json\"]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"yajl\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"b948691a-355f-41c1-829a-382f60d9d04e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":8,"raw_source":"def test_templates_parsed_with_line_numbers_renders_them_in_errors\n    template = <<-LIQUID\n      Hello,\n\n      {{ errors.standard_error }} will raise a standard error.\n\n      Bla bla test.\n\n      {{ errors.syntax_error }} will raise a syntax error.\n\n      This is an argument error: {{ errors.argument_error }}\n\n      Bla.\n    LIQUID\n\n    expected = <<-TEXT\n      Hello,\n\n      Liquid error (line 3): standard error will raise a standard error.\n\n      Bla bla test.\n\n      Liquid syntax error (line 7): syntax error will raise a syntax error.\n\n      This is an argument error: Liquid error (line 9): argument error\n\n      Bla.\n    TEXT\n\n    output = Liquid::Template.parse(template, line_numbers: true).render('errors' => ErrorDrop.new)\n    assert_equal(expected, output)\n  end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_templates_parsed_with_line_numbers_renders_them_in_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      Hello,\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      {{ errors.standard_error }} will raise a standard error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla bla test.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      {{ errors.syntax_error }} will raise a syntax error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      This is an argument error: {{ errors.argument_error }}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla.\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      Hello,\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Liquid error (line 3): standard error will raise a standard error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla bla test.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Liquid syntax error (line 7): syntax error will raise a syntax error.\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      This is an argument error: Liquid error (line 9): argument error\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"      Bla.\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"b51f057d-51b9-4d39-bd38-9bbfa4ff92fa"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":273,"raw_source":"def overflow?\n      base_scope_depth + @scopes.length > Block::MAX_DEPTH\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"overflow?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"base_scope_depth\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"length\"]}]},\">\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Block\"]},\"MAX_DEPTH\"]}]}]}","id":"689d4606-3f61-4c0e-8d8a-691b0d7bb267"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":69,"raw_source":"def test_capture\n    assigns = { 'var' => 'content' }\n    assert_template_result(\n      'content foo content foo ',\n      '{{ var2 }}{% capture var2 %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}',\n      assigns,\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"content foo content foo \"]},{\"type\":\"str\",\"children\":[\"{{ var2 }}{% capture var2 %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"855d6661-074a-4fae-80c7-f48453e9777c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/unless_else_tag_test.rb","start_line":17,"raw_source":"def test_unless_else\n    assert_template_result(' YES ', '{% unless true %} NO {% else %} YES {% endunless %}')\n    assert_template_result(' YES ', '{% unless false %} YES {% else %} NO {% endunless %}')\n    assert_template_result(' YES ', '{% unless \"foo\" %} NO {% else %} YES {% endunless %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless true %} NO {% else %} YES {% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless false %} YES {% else %} NO {% endunless %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% unless \\\"foo\\\" %} NO {% else %} YES {% endunless %}\"]}]}]}]}","id":"2c8c9426-a91a-4561-a4ee-9c3b4743bb7a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":39,"raw_source":"def test_invalid_utf8\n    input = \"\\xff\\x00\"\n    error = assert_raises(SyntaxError) do\n      Liquid::Tokenizer.new(source: input, string_scanner: StringScanner.new(input))\n    end\n    assert_equal(\n      'Liquid syntax error: Invalid byte sequence in UTF-8',\n      error.message,\n    )\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invalid_utf8\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Tokenizer\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"string_scanner\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Invalid byte sequence in UTF-8\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}","id":"fdcba2c9-e4c1-4132-baef-2e1baddd753a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":105,"raw_source":"def test_profiling_times_the_entire_render\n    t = Template.parse(\"{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    assert(t.profiler.total_render_time >= 0, \"Total render time was not calculated\")\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_times_the_entire_render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"total_render_time\"]},\">=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"str\",\"children\":[\"Total render time was not calculated\"]}]}]}]}","id":"9a17e1a3-e585-48e8-bbc2-dbf63467b078"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":8,"raw_source":"def test_blankspace\n    template = Liquid::Template.parse(\"  \")\n    assert_equal([\"  \"], template.root.nodelist)\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_blankspace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"  \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]}]}","id":"9c97b2d7-2236-44fe-a810-27220fa39b3f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":141,"raw_source":"def test_dynamic_variable_limiting\n    assigns           = { 'array' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] }\n    assigns['limit']  = 2\n    assigns['offset'] = 2\n\n    assert_template_result('34', '{%for i in array limit: limit offset: offset %}{{ i }}{%endfor%}', assigns)\n  end","complexity_score":6.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dynamic_variable_limiting\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"limit\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"offset\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"34\"]},{\"type\":\"str\",\"children\":[\"{%for i in array limit: limit offset: offset %}{{ i }}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"3c2cc060-52b3-4f5c-8587-31ce4349b567"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":126,"raw_source":"def each(&block)\n        return enum_for(__method__) unless block_given?\n\n        to_hash.each(&block)\n      end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"each\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"385a5849-32c4-4715-a006-d0b74da09e11"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/partial_cache.rb","start_line":5,"raw_source":"def self.load(template_name, context:, parse_context:)\n      cached_partials = context.registers[:cached_partials]\n      cache_key = \"#{template_name}:#{parse_context.error_mode}\"\n      cached = cached_partials[cache_key]\n      return cached if cached\n\n      file_system = context.registers[:file_system]\n      source      = file_system.read_template_file(template_name)\n\n      parse_context.partial = true\n\n      template_factory = context.registers[:template_factory]\n      template = template_factory.for(template_name)\n\n      begin\n        partial = template.parse(source, parse_context)\n      rescue Liquid::Error => e\n        e.template_name = template&.name || template_name\n        raise e\n      end\n\n      partial.name ||= template_name\n\n      cached_partials[cache_key] = partial\n    ensure\n      parse_context.partial = false\n    end","complexity_score":33.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"load\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"kwarg\",\"children\":[\"context\"]},{\"type\":\"kwarg\",\"children\":[\"parse_context\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cached_partials\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cache_key\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"error_mode\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cached\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached_partials\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cache_key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"file_system\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"read_template_file\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_factory\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_factory\"]},\"for\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"template_name=\",{\"type\":\"or\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cached_partials\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"cache_key\"]},{\"type\":\"lvar\",\"children\":[\"partial\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"partial=\",{\"type\":\"false\",\"children\":[]}]}]}]}","id":"793cb99c-d9c3-4e56-b75f-7bd1ce7506de"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":80,"raw_source":"def test_join_filter_with_hash\n    array = [{ \"key1\" => \"value1\" }, { \"key2\" => \"value2\" }]\n    glue = { \"lol\" => \"wut\" }\n    assert_template_result(\"{\\\"key1\\\"=>\\\"value1\\\"}{\\\"lol\\\"=>\\\"wut\\\"}{\\\"key2\\\"=>\\\"value2\\\"}\", \"{{ my_array | join: glue }}\", { \"my_array\" => array, \"glue\" => glue })\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join_filter_with_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key1\"]},{\"type\":\"str\",\"children\":[\"value1\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"key2\"]},{\"type\":\"str\",\"children\":[\"value2\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"glue\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lol\"]},{\"type\":\"str\",\"children\":[\"wut\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"key1\\\"=>\\\"value1\\\"}{\\\"lol\\\"=>\\\"wut\\\"}{\\\"key2\\\"=>\\\"value2\\\"}\"]},{\"type\":\"str\",\"children\":[\"{{ my_array | join: glue }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"glue\"]},{\"type\":\"lvar\",\"children\":[\"glue\"]}]}]}]}]}]}","id":"04c3daa7-2625-4b83-9c12-eaee3aaa68d5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":431,"raw_source":"def keyenc(k)\n    case k\n    when String then strenc(k)\n    else\n      raise Error, \"Hash key is not a string: #{k.inspect}\"\n    end\n  end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"keyenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[null,\"strenc\",{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Hash key is not a string: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]}]}]}]}]}","id":"deb2e60c-6ae9-4b43-b5db-126ed342c9f2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":112,"raw_source":"def assign_score_of(obj)\n    context = Liquid::Context.new('drop' => ObjectWrapperDrop.new(obj))\n    Liquid::Template.parse('{% assign obj = drop.value %}').render!(context)\n    context.resource_limits.assign_score\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assign_score_of\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ObjectWrapperDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign obj = drop.value %}\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"assign_score\"]}]}]}","id":"21c60c27-0a6c-4155-bc72-e949bcb9ebb4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/render.rb","start_line":64,"raw_source":"def render_tag(context, output)\n      # The expression should be a String literal, which parses to a String object\n      template_name = @template_name_expr\n      raise ::ArgumentError unless template_name.is_a?(String)\n\n      partial = PartialCache.load(\n        template_name,\n        context: context,\n        parse_context: parse_context,\n      )\n\n      context_variable_name = @alias_name || template_name.split('/').last\n\n      render_partial_func = ->(var, forloop) {\n        inner_context               = context.new_isolated_subcontext\n        inner_context.template_name = partial.name\n        inner_context.partial       = true\n        inner_context['forloop']    = forloop if forloop\n\n        @attributes.each do |key, value|\n          inner_context[key] = context.evaluate(value)\n        end\n        inner_context[context_variable_name] = var unless var.nil?\n        partial.render_to_output_buffer(inner_context, output)\n        forloop&.send(:increment!)\n      }\n\n      variable = @variable_name_expr ? context.evaluate(@variable_name_expr) : nil\n      if @is_for_loop && variable.respond_to?(:each) && variable.respond_to?(:count)\n        forloop = Liquid::ForloopDrop.new(template_name, variable.count, nil)\n        variable.each { |var| render_partial_func.call(var, forloop) }\n      else\n        render_partial_func.call(variable, nil)\n      end\n\n      output\n    end","complexity_score":52.9,"ast_json":"{\"type\":\"def\",\"children\":[\"render_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"ivar\",\"children\":[\"@template_name_expr\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"PartialCache\"]},\"load\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[null,\"parse_context\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_variable_name\",{\"type\":\"or\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@alias_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_name\"]},\"split\",{\"type\":\"str\",\"children\":[\"/\"]}]},\"last\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"render_partial_func\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]},{\"type\":\"arg\",\"children\":[\"forloop\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"inner_context\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"template_name=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"partial=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forloop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"forloop\"]},{\"type\":\"lvar\",\"children\":[\"forloop\"]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"inner_context\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"context_variable_name\"]},{\"type\":\"lvar\",\"children\":[\"var\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"inner_context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"csend\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forloop\"]},\"send\",{\"type\":\"sym\",\"children\":[\"increment!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable\",{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@variable_name_expr\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@is_for_loop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"count\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"forloop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ForloopDrop\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"template_name\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"count\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"var\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_partial_func\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"var\"]},{\"type\":\"lvar\",\"children\":[\"forloop\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"render_partial_func\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"variable\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"96c05712-7603-43e8-b05f-9ab7e8071391"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":93,"raw_source":"def test_include_is_blank\n    assert_template_result(\n      \"foobar\" * (N + 1),\n      wrap(\"{% include 'foobar' %}\"),\n      partials: { 'foobar' => 'foobar' },\n    )\n    assert_template_result(\n      \" foobar \" * (N + 1),\n      wrap(\"{% include ' foobar ' %}\"),\n      partials: { ' foobar ' => ' foobar ' },\n    )\n    assert_template_result(\n      \"   \" * (N + 1),\n      wrap(\" {% include ' ' %} \"),\n      partials: { ' ' => ' ' },\n    )\n  end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_is_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% include 'foobar' %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"foobar\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" foobar \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\"{% include ' foobar ' %}\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\" foobar \"]},{\"type\":\"str\",\"children\":[\" foobar \"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"   \"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% include ' ' %} \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\" \"]}]}]}]}]}]}]}]}","id":"faa11971-e1df-4024-9118-c7658d04e8c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/strainer_template.rb","start_line":30,"raw_source":"def invokable?(method)\n        filter_methods.include?(method.to_s)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"invokable?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_methods\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_s\"]}]}]}","id":"fefd5b50-6b88-4b20-9a0d-3ae74b10d436"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":236,"raw_source":"def token_hmac(session, identifier)\n        OpenSSL::HMAC.digest(\n          OpenSSL::Digest.new('SHA256'),\n          real_token(session),\n          identifier\n        )\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"token_hmac\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"identifier\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"HMAC\"]},\"digest\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"Digest\"]},\"new\",{\"type\":\"str\",\"children\":[\"SHA256\"]}]},{\"type\":\"send\",\"children\":[null,\"real_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]},{\"type\":\"lvar\",\"children\":[\"identifier\"]}]}]}","id":"cae2421a-e08a-4097-8d36-7564f2e03c77"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":110,"raw_source":"def escape_once(input)\n      Utils.to_s(input).gsub(HTML_ESCAPE_ONCE_REGEXP, HTML_ESCAPE)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"escape_once\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"gsub\",{\"type\":\"const\",\"children\":[null,\"HTML_ESCAPE_ONCE_REGEXP\"]},{\"type\":\"const\",\"children\":[null,\"HTML_ESCAPE\"]}]}]}","id":"0d8ed873-e58f-48ef-b9fb-81dfc518c799"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":583,"raw_source":"def replace(input, string, replacement = '')\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n      input = Utils.to_s(input)\n      input.gsub(string, replacement)\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"optarg\",\"children\":[\"replacement\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"string\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]}]}","id":"0051ccfd-2de3-4c1a-87f8-f69edafb81b5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":777,"raw_source":"def builder(template = nil, options = {}, locals = {}, &block)\n      options[:default_content_type] = :xml\n      render_ruby(:builder, template, options, locals, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"builder\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"xml\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"builder\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"0a581327-ea83-46b8-bc46-426c4434bada"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":271,"raw_source":"def test_render_tag_renders_error_with_template_name\n    assert_template_result(\n      'Liquid error (foo line 1): standard error',\n      \"{% render 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      render_errors: true,\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% render 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}","id":"a63875c7-9dd3-40fa-867b-2496f436e5c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":144,"raw_source":"def test_has_on_empty_array\n    refute(@filters.has([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"refute\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"has\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}","id":"a56a1dcf-d87f-4a79-81fc-894902a4cfdd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/compile_test.rb","start_line":14,"raw_source":"def self.fails pattern, example, mtype = :sinatra, mopts = {}\n    it \"does not parse #{example} with #{pattern}\" do\n      compiled = mock_app { set :mustermann_opts, :type => mtype }.send(:compile, pattern, mopts)\n      match = compiled.match(example)\n      fail %Q{\"#{pattern}\" does parse \"#{example}\" but it should fail} if match\n    end\n  end","complexity_score":18.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"fails\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"arg\",\"children\":[\"example\"]},{\"type\":\"optarg\",\"children\":[\"mtype\",{\"type\":\"sym\",\"children\":[\"sinatra\"]}]},{\"type\":\"optarg\",\"children\":[\"mopts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"does not parse \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\" with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"compiled\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"mustermann_opts\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"type\"]},{\"type\":\"lvar\",\"children\":[\"mtype\"]}]}]}]}]},\"send\",{\"type\":\"sym\",\"children\":[\"compile\"]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"mopts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"match\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"compiled\"]},\"match\",{\"type\":\"lvar\",\"children\":[\"example\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"match\"]},{\"type\":\"send\",\"children\":[null,\"fail\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]}]},{\"type\":\"str\",\"children\":[\"\\\" does parse \\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"example\"]}]},{\"type\":\"str\",\"children\":[\"\\\" but it should fail\"]}]}]},null]}]}]}]}","id":"1357c752-be60-4f20-a08e-4fe6394da499"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":473,"raw_source":"def test_legacy_reverse_hash\n    assert_equal([{ a: 1, b: 2 }], @filters.reverse(a: 1, b: 2))\n  end","complexity_score":3.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_legacy_reverse_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"reverse\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}","id":"1494d7cb-408e-419b-9cbd-afeea1796a02"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":134,"raw_source":"def interpret_condition(left, right, op, context)\n      # If the operator is empty this means that the decision statement is just\n      # a single variable. We can just poll this variable from the context and\n      # return this as the result.\n      return context.evaluate(left) if op.nil?\n\n      left  = Liquid::Utils.to_liquid_value(context.evaluate(left))\n      right = Liquid::Utils.to_liquid_value(context.evaluate(right))\n\n      operation = self.class.operators[op] || raise(Liquid::ArgumentError, \"Unknown operator #{op}\")\n\n      if operation.respond_to?(:call)\n        operation.call(self, left, right)\n      elsif left.respond_to?(operation) && right.respond_to?(operation) && !left.is_a?(Hash) && !right.is_a?(Hash)\n        begin\n          left.send(operation, right)\n        rescue ::ArgumentError => e\n          raise Liquid::ArgumentError, e.message\n        end\n      end\n    end","complexity_score":42.0,"ast_json":"{\"type\":\"def\",\"children\":[\"interpret_condition\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"right\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"left\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"left\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"left\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"right\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"right\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"operation\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"operators\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unknown operator \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"operation\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"operation\"]},\"call\",{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"operation\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"operation\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},\"!\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"operation\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]},null]}]}]}]}","id":"b3b986b1-c773-4b61-ab36-06d0f88e3b8d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":41,"raw_source":"def test_variable_many_embedded_fragments\n    template = Liquid::Template.parse(\"  {{funk}} {{so}} {{brother}} \")\n    assert_equal(7, template.root.nodelist.size)\n    assert_equal(\n      [String, Variable, String, Variable, String, Variable, String],\n      block_types(template.root.nodelist),\n    )\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_many_embedded_fragments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {{funk}} {{so}} {{brother}} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]}]}]}","id":"480c6686-3921-48f2-95ab-b71dd491440a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":170,"raw_source":"def lex(s)\n    ts = []\n    while s.length > 0\n      typ, lexeme, val = tok(s)\n      if typ == nil\n        raise Error, \"invalid character at #{s[0,10].inspect}\"\n      end\n      if typ != :space\n        ts << [typ, lexeme, val]\n      end\n      s = s[lexeme.length..-1]\n    end\n    ts\n  end","complexity_score":25.28,"ast_json":"{\"type\":\"def\",\"children\":[\"lex\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"length\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"lexeme\"]},{\"type\":\"lvasgn\",\"children\":[\"val\"]}]},{\"type\":\"send\",\"children\":[null,\"tok\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"==\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid character at \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[10]}]},\"inspect\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"space\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},{\"type\":\"lvar\",\"children\":[\"lexeme\"]},{\"type\":\"lvar\",\"children\":[\"val\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"lexeme\"]},\"length\"]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]}","id":"8c65cd30-ce5c-4329-b972-3ae66f139fc0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":111,"raw_source":"def test_symbolic_retrieval\n    assert_equal :a, @hash[:a]\n    assert_equal :b, @hash[:b]\n    assert_equal({ ?a=>:a, ?b=>:b }, @hash[:nested][:a][0])\n    assert_equal :c, @hash[:nested][:a][1]\n    assert_equal 4, @hash[:nested][:a][2]\n    assert_equal :f, @hash[:nested][:f]\n    assert_equal 7, @hash[:nested][7]\n    assert_equal :a, @hash[:simple_nested][:a]\n    assert_equal :b, @hash[:simple_nested][:b]\n    assert_nil @hash[:d]\n  end","complexity_score":38.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_symbolic_retrieval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"f\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}","id":"432929a4-6430-42f1-a81d-af6e3c06f3e6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":70,"raw_source":"def render_to_output_buffer(context, output)\n      execute_else_block = true\n\n      @blocks.each do |block|\n        if block.else?\n          block.attachment.render_to_output_buffer(context, output) if execute_else_block\n          next\n        end\n\n        result = Liquid::Utils.to_liquid_value(\n          block.evaluate(context),\n        )\n\n        if result\n          execute_else_block = false\n          block.attachment.render_to_output_buffer(context, output)\n        end\n      end\n\n      output\n    end","complexity_score":19.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"execute_else_block\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"else?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"execute_else_block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},null]},{\"type\":\"next\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"evaluate\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"execute_else_block\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attachment\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"079b9d77-4f52-4e59-a7e6-025c46e3812f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":920,"raw_source":"def at_most(input, n)\n      max_value = Utils.to_number(n)\n\n      result = Utils.to_number(input)\n      result = max_value if max_value < result\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"at_most\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"max_value\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"max_value\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"lvar\",\"children\":[\"max_value\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"f428801f-4fad-4df2-9293-01dca778b245"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":56,"raw_source":"def test_doc_tag_with_block\n    template = Liquid::Template.parse(\"  {% doc %} {% enddoc %} \")\n    assert_equal([String, Doc, String], block_types(template.root.nodelist))\n    assert_equal(3, template.root.nodelist.size)\n  end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_with_block\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  {% doc %} {% enddoc %} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"const\",\"children\":[null,\"Doc\"]},{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"send\",\"children\":[null,\"block_types\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]}]}]}","id":"b694a4fe-5e60-4767-ad2e-7bcc07d45dad"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":15,"raw_source":"def increment_render_score(amount)\n      @render_score += amount\n      raise_limits_reached if @render_score_limit && @render_score > @render_score_limit\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_render_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"amount\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@render_score\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"amount\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_score_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_score\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@render_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}","id":"17b1a385-ca07-435b-bd1e-e365f1844dd9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":10,"raw_source":"def scopes_as_array\n    (1..@context.scopes.size).to_a\n  end","complexity_score":3.9,"ast_json":"{\"type\":\"def\",\"children\":[\"scopes_as_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"scopes\"]},\"size\"]}]}]},\"to_a\"]}]}","id":"23bb008f-b307-498d-a852-71170412d10c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":142,"raw_source":"def test_break_through_render\n    options = { partials: { 'break' => '{% break %}' } }\n    assert_template_result('1', '{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}', **options)\n    assert_template_result('112233', '{% for i in (1..3) %}{{ i }}{% render \"break\" %}{{ i }}{% endfor %}', **options)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_through_render\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"break\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"112233\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% render \\\"break\\\" %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}]}","id":"1e6e2312-13ad-49e3-b272-d95c3171654f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1313,"raw_source":"def reset!\n        @conditions     = []\n        @routes         = {}\n        @filters        = { before: [], after: [] }\n        @errors         = {}\n        @middleware     = []\n        @prototype      = nil\n        @extensions     = []\n\n        @templates = if superclass.respond_to?(:templates)\n                       Hash.new { |_hash, key| superclass.templates[key] }\n                     else\n                       {}\n                     end\n      end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"reset!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@conditions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@routes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"before\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"after\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@middleware\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@prototype\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@extensions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@templates\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"templates\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_hash\"]},{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"templates\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}","id":"409e10ab-8c0b-47ba-ab2e-4caa39ae047f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":126,"raw_source":"def test_scoping\n    @context.push\n    @context.pop\n\n    assert_raises(Liquid::ContextError) do\n      @context.pop\n    end\n\n    assert_raises(Liquid::ContextError) do\n      @context.push\n      @context.pop\n      @context.pop\n    end\n  end","complexity_score":10.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scoping\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ContextError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ContextError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"push\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"pop\"]}]}]}]}]}","id":"0c4b8344-0c8d-4eaf-b021-1d25c6bcbd09"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":396,"raw_source":"def encode(x)\n    case x\n    when Hash    then objenc(x)\n    when Array   then arrenc(x)\n    else\n      raise Error, 'root value must be an Array or a Hash'\n    end\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"send\",\"children\":[null,\"objenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"arrenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"str\",\"children\":[\"root value must be an Array or a Hash\"]}]}]}]}","id":"50ec8935-9fd8-45ca-8ae1-2dba7637cd33"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":291,"raw_source":"def set(key, value = self, &block)\n        return key.each { |k, v| set(k, v) } if key.respond_to?(:each) && block.nil? && (value == self)\n        raise ArgumentError, \"may not set #{key}\" unless ([:views] + ALLOWED_ENGINES).include?(key)\n\n        block ||= proc { value }\n        singleton_class.send(:define_method, key, &block)\n      end","complexity_score":23.7,"ast_json":"{\"type\":\"def\",\"children\":[\"set\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"optarg\",\"children\":[\"value\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"nil?\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"==\",{\"type\":\"self\",\"children\":[]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"views\"]}]},\"+\",{\"type\":\"const\",\"children\":[null,\"ALLOWED_ENGINES\"]}]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"may not set \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"singleton_class\"]},\"send\",{\"type\":\"sym\",\"children\":[\"define_method\"]},{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"3de3a4cc-1927-43b2-91fe-ba171925e9a6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":51,"raw_source":"def inspect\n      self.class.to_s\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"inspect\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"to_s\"]}]}","id":"9ebb9068-35c2-4ea1-8d9f-33b0f95b9592"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":191,"raw_source":"def test_dont_override_liquid_tag_whitespace_control\n    assert_template_result(\"Hello!World!\", <<~LIQUID.chomp)\n      Hello!\n      {%- liquid\n        comment\n         this is inside a liquid tag\n        endcomment\n      -%}\n      World!\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dont_override_liquid_tag_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!World!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Hello!\\n\"]},{\"type\":\"str\",\"children\":[\"{%- liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  comment\\n\"]},{\"type\":\"str\",\"children\":[\"   this is inside a liquid tag\\n\"]},{\"type\":\"str\",\"children\":[\"  endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"-%}\\n\"]},{\"type\":\"str\",\"children\":[\"World!\\n\"]}]},\"chomp\"]}]}]}","id":"e59cfa27-e193-478f-966d-6dfd8d80706f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_helper.rb","start_line":39,"raw_source":"def echo_output(read_io)\n    Thread.new do\n      begin\n        loop { print read_io.readpartial(8192) }\n      rescue EOFError\n      end\n    end\n  end","complexity_score":8.73,"ast_json":"{\"type\":\"def\",\"children\":[\"echo_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"read_io\"]},\"readpartial\",{\"type\":\"int\",\"children\":[8192]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]}]},null,null]},null]}]}]}]}","id":"981b6e97-4f76-43e8-b800-ed21f64c11eb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":39,"raw_source":"def new_parser(input)\n      @string_scanner.string = input\n      Parser.new(@string_scanner)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"new_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]},\"string=\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Parser\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]}]}]}]}","id":"b804ac72-729e-41bb-867f-55242f4fc52d"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":12,"raw_source":"def self.run\n    puts\n    yield new\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"puts\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}]}","id":"2a7556f3-7f70-42b8-8994-6fd2ed1e4f14"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":476,"raw_source":"def test_to_liquid_and_context_at_first_level\n    @context['category'] = Category.new(\"foobar\")\n    assert_kind_of(CategoryDrop, @context['category'])\n    assert_equal(@context, @context['category'].context)\n  end","complexity_score":7.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_to_liquid_and_context_at_first_level\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"category\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Category\"]},\"new\",{\"type\":\"str\",\"children\":[\"foobar\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_kind_of\",{\"type\":\"const\",\"children\":[null,\"CategoryDrop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"category\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"ivar\",\"children\":[\"@context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"category\"]}]},\"context\"]}]}]}]}","id":"7e39287c-0408-4224-ab51-bad67ae1afb7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":316,"raw_source":"def test_sort_when_property_is_sometimes_missing_puts_nils_last\n    input       = [\n      { \"price\" => 4, \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"price\" => 1, \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n    ]\n    expectation = [\n      { \"price\" => 1, \"handle\" => \"gamma\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n      { \"price\" => 4, \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"delta\" },\n    ]\n    assert_equal(expectation, @filters.sort(input, \"price\"))\n  end","complexity_score":5.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_when_property_is_sometimes_missing_puts_nils_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"price\"]}]}]}]}]}","id":"ea4c4851-94c9-4d6b-97bf-eddb1535e428"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1778,"raw_source":"def route(verb, path, options = {}, &block)\n        enable :empty_path_info if path == '' && empty_path_info.nil?\n        signature = compile!(verb, path, block, **options)\n        (@routes[verb] ||= []) << signature\n        invoke_hook(:route_added, verb, path, block)\n        signature\n      end","complexity_score":11.6,"ast_json":"{\"type\":\"def\",\"children\":[\"route\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"verb\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"==\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"empty_path_info\"]},\"nil?\"]}]},{\"type\":\"send\",\"children\":[null,\"enable\",{\"type\":\"sym\",\"children\":[\"empty_path_info\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"send\",\"children\":[null,\"compile!\",{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@routes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"signature\"]}]},{\"type\":\"send\",\"children\":[null,\"invoke_hook\",{\"type\":\"sym\",\"children\":[\"route_added\"]},{\"type\":\"lvar\",\"children\":[\"verb\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}","id":"e28ed877-4dc0-4456-aa4f-36534564f46f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":16,"raw_source":"def respond_to(*args, &block)\n    respond_app { get('/') { respond_to(*args, &block) } }\n  end","complexity_score":6.8,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"respond_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"respond_to\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"7204e55b-fd05-4b62-aff4-fe0456c6b716"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":178,"raw_source":"def test_includes_error_mode_into_template_cache\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    [:lax, :warn, :strict].each do |error_mode|\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: Liquid::ParseContext.new(error_mode: error_mode),\n      )\n    end\n\n    assert_equal(\n      [\"my_partial:lax\", \"my_partial:warn\", \"my_partial:strict\"],\n      context.registers[:cached_partials].keys,\n    )\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_includes_error_mode_into_template_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"lax\"]},{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"lvar\",\"children\":[\"error_mode\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial:lax\"]},{\"type\":\"str\",\"children\":[\"my_partial:warn\"]},{\"type\":\"str\",\"children\":[\"my_partial:strict\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"keys\"]}]}]}]}","id":"408e8481-7c53-429b-983a-0602c62a6fff"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/lib/rack/protection/json_csrf_spec.rb","start_line":17,"raw_source":"def self.body\n      @body ||= begin\n        body = ['ok']\n        body.extend(Closeable)\n        body\n      end\n    end","complexity_score":4.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"Closeable\"]}]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"533d7d69-1960-46e2-95e7-72263c56e190"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1043,"raw_source":"def forward\n      raise 'downstream app not set' unless @app.respond_to? :call\n\n      status, headers, body = @app.call env\n      @response.status = status\n      @response.body = body\n      @response.headers.merge! headers\n      nil\n    end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"forward\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"call\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"downstream app not set\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"send\",\"children\":[null,\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"status=\",{\"type\":\"lvar\",\"children\":[\"status\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"body=\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@response\"]},\"headers\"]},\"merge!\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"9475029b-fd19-4dfd-b204-2f29247e3807"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":113,"raw_source":"def test_case_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% when test %}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% when test %}{% endcase %}\"]}]}]}]}","id":"44d85170-a38d-4e9d-ae08-4a0eba497dec"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/capture_test.rb","start_line":20,"raw_source":"def test_capture_to_variable_from_outer_scope_if_existing\n    template_source = <<~END_TEMPLATE\n      {% assign var = '' -%}\n      {% if true -%}\n        {% capture var %}first-block-string{% endcapture -%}\n      {% endif -%}\n      {% if true -%}\n        {% capture var %}test-string{% endcapture -%}\n      {% endif -%}\n      {{var-}}\n    END_TEMPLATE\n    assert_template_result(\"test-string\", template_source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_to_variable_from_outer_scope_if_existing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_source\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign var = '' -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture var %}first-block-string{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% capture var %}test-string{% endcapture -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{var-}}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"test-string\"]},{\"type\":\"lvar\",\"children\":[\"template_source\"]}]}]}]}","id":"9610b338-9c60-4c3a-bedc-aac2c92ee863"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/test_helpers.rb","start_line":198,"raw_source":"def last_env\n      last_request.env\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"last_env\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"last_request\"]},\"env\"]}]}","id":"2506ffac-7f04-4b19-aa81-882e3201db92"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":150,"raw_source":"def fetch(key, &block)\n        response_cookies.fetch(key.to_s) do\n          request_cookies.fetch(key.to_s, &block)\n        end\n      end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"fetch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"fetch\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"fetch\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"83afcd50-a873-468b-beb5-ef14c582c0cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":240,"raw_source":"def test_custom_include_tag\n    original_tag = Liquid::Template.tags['include']\n    Liquid::Template.tags['include'] = CustomInclude\n    begin\n      assert_equal(\n        \"custom_foo\",\n        Template.parse(\"{% include 'custom_foo' %}\").render!,\n      )\n    ensure\n      Liquid::Template.tags['include'] = original_tag\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_include_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"include\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"const\",\"children\":[null,\"CustomInclude\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"custom_foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'custom_foo' %}\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"tags\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"lvar\",\"children\":[\"original_tag\"]}]}]}]}]}]}","id":"69cabb48-2b02-4ebb-9a7e-6b88f0ae10f5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":54,"raw_source":"def test_captures_are_blank\n    assert_template_result(\"\", wrap(\" {% capture foo %} whatever {% endcapture %} \"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_captures_are_blank\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"str\",\"children\":[\" {% capture foo %} whatever {% endcapture %} \"]}]}]}]}","id":"5ccdf756-d987-4944-9c87-542b78e89ec1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":126,"raw_source":"def test_parsing_strict_with_line_numbers_adds_numbers_to_lexer_errors\n    err = assert_raises(SyntaxError) do\n      Liquid::Template.parse(\n        '\n          foobar\n\n          {% if 1 =! 2 %}ok{% endif %}\n\n          bla\n                ',\n        error_mode: :strict,\n        line_numbers: true,\n      )\n    end\n\n    assert_equal('Liquid syntax error (line 4): Unexpected character = in \"1 =! 2\"', err.message)\n  end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parsing_strict_with_line_numbers_adds_numbers_to_lexer_errors\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"err\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          foobar\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if 1 =! 2 %}ok{% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          bla\\n\"]},{\"type\":\"str\",\"children\":[\"                \"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 4): Unexpected character = in \\\"1 =! 2\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"err\"]},\"message\"]}]}]}]}","id":"2ee0c4ff-b80d-41a3-98c1-d897007e6bf9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/server_test.rb","start_line":16,"raw_source":"def self.run(app, options={})\n      assert(app < Sinatra::Base)\n      assert_equal 9001, options[:Port]\n      assert_equal 'foo.local', options[:Host]\n      yield new\n    end","complexity_score":9.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"run\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"<\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Base\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[9001]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"Port\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo.local\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"Host\"]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[null,\"new\"]}]}]}]}","id":"6f207a58-3ae9-47b8-93a8-d776edfc743e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/contrib/setup.rb","start_line":21,"raw_source":"def autoload(name, path, method = nil)\n        extensions[method] << name if method\n        Sinatra.autoload(name, path)\n      end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"autoload\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"method\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extensions\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"<<\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"autoload\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}]}","id":"444ef9c9-d9d9-4251-9e79-e9be094a2922"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":190,"raw_source":"def evaluate(object)\n      object.respond_to?(:evaluate) ? object.evaluate(self) : object\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"object\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"evaluate\",{\"type\":\"self\",\"children\":[]}]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}","id":"a23a35b4-b1b7-40c7-afa2-48b0f29ec05c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":62,"raw_source":"def delete(*args, &block)   super(*route_args(args), &block)  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[null,\"route_args\",{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"df089f02-365f-4d8f-945b-8c3bd1689414"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/template.rb","start_line":46,"raw_source":"def file_system=(file_system)\n        Deprecations.warn(\"Template.file_system=\", \"Environment#file_system=\")\n        Environment.default.file_system = file_system\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"file_system=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file_system\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Deprecations\"]},\"warn\",{\"type\":\"str\",\"children\":[\"Template.file_system=\"]},{\"type\":\"str\",\"children\":[\"Environment#file_system=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]},\"file_system=\",{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}","id":"9e2bc321-5e56-41ce-b670-e074b739e649"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":22,"raw_source":"def parse(tokenizer, parse_context)\n      while parse_body(tokenizer)\n      end\n      @body.freeze\n    rescue SyntaxError => e\n      e.line_number ||= parse_context.line_number\n      raise\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_body\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"freeze\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}","id":"701f10e9-b074-4b2d-bcbc-055cba31e4da"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":421,"raw_source":"def test_numerical_vs_lexicographical_sort\n    assert_equal([2, 10], @filters.sort([10, 2]))\n    assert_equal([{ \"a\" => 2 }, { \"a\" => 10 }], @filters.sort([{ \"a\" => 10 }, { \"a\" => 2 }], \"a\"))\n    assert_equal([\"10\", \"2\"], @filters.sort([\"10\", \"2\"]))\n    assert_equal([{ \"a\" => \"10\" }, { \"a\" => \"2\" }], @filters.sort([{ \"a\" => \"10\" }, { \"a\" => \"2\" }], \"a\"))\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_numerical_vs_lexicographical_sort\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[10]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"10\"]},{\"type\":\"str\",\"children\":[\"2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"10\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"10\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"10\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"2\"]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"ee0b5f69-1c46-42fc-98e1-2c50ce96f140"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":9,"raw_source":"def test_simple_variable\n    assert_template_result('worked', \"{{test}}\", { 'test' => 'worked' })\n    assert_template_result('worked wonderfully', \"{{test}}\", { 'test' => 'worked wonderfully' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"worked wonderfully\"]},{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked wonderfully\"]}]}]}]}]}]}","id":"b85df620-d60d-4418-9ada-9a973d9fa39a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":40,"raw_source":"def succeed(str, &block)\n      \"#{_capture_haml(&block).chomp}#{str}\\n\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"succeed\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}","id":"28dfde68-8fc8-4b82-8dd9-3308cae508c3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":61,"raw_source":"def test_ranges\n    p = new_parser(\"(5..7) (1.5..9.6) (young..old) (hi[5].wat..old)\")\n    assert_equal('(5..7)', p.expression)\n    assert_equal('(1.5..9.6)', p.expression)\n    assert_equal('(young..old)', p.expression)\n    assert_equal('(hi[5].wat..old)', p.expression)\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"(5..7) (1.5..9.6) (young..old) (hi[5].wat..old)\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(5..7)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(1.5..9.6)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(young..old)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"(hi[5].wat..old)\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}","id":"d70a978a-25e8-4abc-b64f-bdde53982ac6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1545,"raw_source":"def delete(path, opts = {}, &block)  route 'DELETE',  path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"delete\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"DELETE\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"53a3a1d9-b019-41c0-8b09-1118b9daa530"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":193,"raw_source":"def test_scope_from_tags\n    assert_equal('1', Liquid::Template.parse('{% for i in context.scopes_as_array %}{{i}}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('12', Liquid::Template.parse('{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n    assert_equal('123', Liquid::Template.parse('{%for a in dummy%}{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}{% endfor %}').render!('context' => ContextDrop.new, 'dummy' => [1]))\n  end","complexity_score":16.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_scope_from_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in context.scopes_as_array %}{{i}}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"12\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%for a in dummy%}{%for a in dummy%}{% for i in context.scopes_as_array %}{{i}}{% endfor %}{% endfor %}{% endfor %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"dummy\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}]}","id":"dc95888b-a569-4b84-a7b0-2768c8c6bfb2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":170,"raw_source":"def test_recursively_included_template_does_not_produce_endless_loop\n    infinite_file_system = Class.new do\n      def read_template_file(_template_path)\n        \"-{% include 'loop' %}\"\n      end\n    end\n\n    env = Liquid::Environment.build(file_system: infinite_file_system.new)\n\n    assert_raises(Liquid::StackLevelError) do\n      Template.parse(\"{% include 'loop' %}\", environment: env).render!\n    end\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_recursively_included_template_does_not_produce_endless_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"infinite_file_system\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"str\",\"children\":[\"-{% include 'loop' %}\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"infinite_file_system\"]},\"new\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"StackLevelError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'loop' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},\"render!\"]}]}]}]}","id":"77f05317-8d83-4602-b543-a2e79c70aaa4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":129,"raw_source":"def self.array_inspect(arr, seen = {})\n      if seen[arr.object_id]\n        return \"[...]\"\n      end\n\n      seen[arr.object_id] = true\n      str = +\"[\"\n      cursor = 0\n      len = arr.length\n\n      while cursor < len\n        if cursor > 0\n          str << \", \"\n        end\n\n        item_str = inspect(arr[cursor], seen)\n        str << item_str\n        cursor += 1\n      end\n\n      str << \"]\"\n      str\n    ensure\n      seen.delete(arr.object_id)\n    end","complexity_score":30.18,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"array_inspect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"arr\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"[...]\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},\"+@\"]}]},{\"type\":\"lvasgn\",\"children\":[\"cursor\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"len\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"length\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cursor\"]},\"<\",{\"type\":\"lvar\",\"children\":[\"len\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cursor\"]},\">\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\", \"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"item_str\",{\"type\":\"send\",\"children\":[null,\"inspect\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"cursor\"]}]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"item_str\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cursor\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"seen\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"object_id\"]}]}]}]}","id":"fa3269ec-d2d7-4c8d-9d3c-18f9b42c00fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":283,"raw_source":"def test_case_detects_bad_syntax\n    assert_raises(SyntaxError) do\n      assert_template_result('',  '{% case false %}{% when %}true{% endcase %}', {})\n    end\n\n    assert_raises(SyntaxError) do\n      assert_template_result('',  '{% case false %}{% huh %}true{% endcase %}', {})\n    end\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_detects_bad_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% when %}true{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case false %}{% huh %}true{% endcase %}\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}","id":"cde90293-4fba-4005-add2-dc9dfa41c490"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":127,"raw_source":"def alive?\n      3.times { get(ping_path) }\n      true\n    rescue EOFError, SystemCallError, OpenURI::HTTPError, Timeout::Error\n      false\n    end","complexity_score":6.55,"ast_json":"{\"type\":\"def\",\"children\":[\"alive?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[3]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"send\",\"children\":[null,\"ping_path\"]}]}]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EOFError\"]},{\"type\":\"const\",\"children\":[null,\"SystemCallError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenURI\"]},\"HTTPError\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"Error\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}","id":"4ef3c007-07cf-4a15-a3b3-15939212b2b4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":264,"raw_source":"def self.registered(base)\n      base.set :ext_map, Hash.new { |h, k| h[k] = [] }\n      base.set :template_engines, engines\n      base.remap_extensions\n      base.helpers Helpers\n    end","complexity_score":8.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"ext_map\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"h\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"set\",{\"type\":\"sym\",\"children\":[\"template_engines\"]},{\"type\":\"send\",\"children\":[null,\"engines\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"remap_extensions\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"helpers\",{\"type\":\"const\",\"children\":[null,\"Helpers\"]}]}]}]}","id":"07a697f6-d8a1-42e4-8345-243edef84a0b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1786,"raw_source":"def invoke_hook(name, *args)\n        extensions.each { |e| e.send(name, *args) if e.respond_to?(name) }\n      end","complexity_score":9.0,"ast_json":"{\"type\":\"def\",\"children\":[\"invoke_hook\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},null]}]}]}","id":"3e041f01-149d-496a-b131-e22bc69b480c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":707,"raw_source":"def test_abs\n    assert_template_result(\"17\", \"{{ 17 | abs }}\")\n    assert_template_result(\"17\", \"{{ -17 | abs }}\")\n    assert_template_result(\"17\", \"{{ '17' | abs }}\")\n    assert_template_result(\"17\", \"{{ '-17' | abs }}\")\n    assert_template_result(\"0\", \"{{ 0 | abs }}\")\n    assert_template_result(\"0\", \"{{ '0' | abs }}\")\n    assert_template_result(\"17.42\", \"{{ 17.42 | abs }}\")\n    assert_template_result(\"17.42\", \"{{ -17.42 | abs }}\")\n    assert_template_result(\"17.42\", \"{{ '17.42' | abs }}\")\n    assert_template_result(\"17.42\", \"{{ '-17.42' | abs }}\")\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_abs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ 17 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ -17 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ '17' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17\"]},{\"type\":\"str\",\"children\":[\"{{ '-17' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ 0 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"str\",\"children\":[\"{{ '0' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ 17.42 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ -17.42 | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ '17.42' | abs }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"17.42\"]},{\"type\":\"str\",\"children\":[\"{{ '-17.42' | abs }}\"]}]}]}]}","id":"db509976-75a3-4073-84b6-021a8132da5f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":21,"raw_source":"def self.build(environment: Environment.default, environments: {}, outer_scope: {}, registers: {}, rethrow_errors: false, resource_limits: nil, static_environments: {}, &block)\n      new(environments, outer_scope, registers, rethrow_errors, resource_limits, static_environments, environment, &block)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"kwoptarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]},{\"type\":\"kwoptarg\",\"children\":[\"environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"outer_scope\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"resource_limits\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"static_environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"environments\"]},{\"type\":\"lvar\",\"children\":[\"outer_scope\"]},{\"type\":\"lvar\",\"children\":[\"registers\"]},{\"type\":\"lvar\",\"children\":[\"rethrow_errors\"]},{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"lvar\",\"children\":[\"static_environments\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"ad9577e4-8728-4111-be1a-0e2c378c861d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":160,"raw_source":"def test_operators_are_ignored_unless_isolated\n    original_op = Condition.operators['contains']\n    Condition.operators['contains'] = :[]\n\n    assert_template_result(\n      'yes',\n      %({% if 'gnomeslab-and-or-liquid' contains 'gnomeslab-and-or-liquid' %}yes{% endif %}),\n    )\n  ensure\n    Condition.operators['contains'] = original_op\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_operators_are_ignored_unless_isolated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_op\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]\",{\"type\":\"str\",\"children\":[\"contains\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"yes\"]},{\"type\":\"str\",\"children\":[\"{% if 'gnomeslab-and-or-liquid' contains 'gnomeslab-and-or-liquid' %}yes{% endif %}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"operators\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"lvar\",\"children\":[\"original_op\"]}]}]}]}","id":"b09c7fa4-53ed-4fb7-bcf6-295f374b7446"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":314,"raw_source":"def test_hash_notation_only_for_hash_access\n    assigns = { \"array\" => [1, 2, 3, 4, 5] }\n    assert_template_result(\"1\", \"{{ array.first }}\", assigns)\n    assert_template_result(\"pass\", '{% if array[\"first\"] == nil %}pass{% endif %}', assigns)\n\n    assert_template_result(\"Hello\", '{{ hash[\"first\"] }}', { \"hash\" => { \"first\" => \"Hello\" } })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_notation_only_for_hash_access\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{{ array.first }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if array[\\\"first\\\"] == nil %}pass{% endif %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"str\",\"children\":[\"{{ hash[\\\"first\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hash\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"first\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]}]}]}]}]}]}","id":"688a92ba-d6fc-4dd5-a958-fc7eeefe7873"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":180,"raw_source":"def test_with_whitespace_control\n    assert_template_result(\"Hello!\", \"      {%- comment -%}123{%- endcomment -%}Hello!\")\n    assert_template_result(\"Hello!\", \"{%- comment -%}123{%- endcomment -%}     Hello!\")\n    assert_template_result(\"Hello!\", \"      {%- comment -%}123{%- endcomment -%}     Hello!\")\n\n    assert_template_result(\"Hello!\", <<~LIQUID.chomp)\n      {%- comment %}Whitespace control!{% endcomment -%}\n      Hello!\n    LIQUID\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_whitespace_control\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- comment -%}123{%- endcomment -%}Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"{%- comment -%}123{%- endcomment -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"str\",\"children\":[\"      {%- comment -%}123{%- endcomment -%}     Hello!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Hello!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- comment %}Whitespace control!{% endcomment -%}\\n\"]},{\"type\":\"str\",\"children\":[\"Hello!\\n\"]}]},\"chomp\"]}]}]}]}","id":"0007e22d-fb8e-413f-8dfc-15b61d10ef56"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":378,"raw_source":"def sort(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      return [] if ary.empty?\n\n      if property.nil?\n        ary.sort do |a, b|\n          nil_safe_compare(a, b)\n        end\n      elsif ary.all? { |el| el.respond_to?(:[]) }\n        begin\n          ary.sort { |a, b| nil_safe_compare(a[property], b[property]) }\n        rescue TypeError\n          raise_property_error(property)\n        end\n      end\n    end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"sort\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_compare\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_compare\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]},null]}]}]}]}","id":"4b7d65af-00e5-46c0-9486-1a953e1d8410"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":823,"raw_source":"def send_file_app(opts={})\n      path = @file\n      mock_app {\n        get '/file.txt' do\n          send_file path, opts\n        end\n      }\n    end","complexity_score":7.4,"ast_json":"{\"type\":\"def\",\"children\":[\"send_file_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"ivar\",\"children\":[\"@file\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/file.txt\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"send_file\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]}]}]}]}]}]}","id":"0bdfdd6c-a2fd-4866-a526-cbd4c6b43bb5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":55,"raw_source":"def test_merge!\n    # merge! is already mostly tested by the different constructors, so we\n    # really just need to test the block form here\n    hash = Sinatra::IndifferentHash[:a=>'a', ?b=>'b', 3=>3]\n    hash.merge!(?a=>'A', :b=>'B', :d=>'D') do |key, oldval, newval|\n      \"#{oldval}*#{key}*#{newval}\"\n    end\n\n    assert_equal({ ?a=>'a*a*A', ?b=>'b*b*B', 3=>3, ?d=>'D' }, hash)\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_merge!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"merge!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"B\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"oldval\"]},{\"type\":\"arg\",\"children\":[\"newval\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"oldval\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"*\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newval\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"a*a*A\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"b*b*B\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"str\",\"children\":[\"D\"]}]}]},{\"type\":\"lvar\",\"children\":[\"hash\"]}]}]}]}","id":"e2ae1f98-68f9-46c0-8bdc-191dc029e57a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":132,"raw_source":"def arrparse(ts)\n    ts = eat('[', ts)\n    arr = []\n\n    if ts[0][0] == ']'\n      return arr, ts[1..-1]\n    end\n\n    v, ts = valparse(ts)\n    arr << v\n\n    if ts[0][0] == ']'\n      return arr, ts[1..-1]\n    end\n\n    loop do\n      ts = eat(',', ts)\n\n      v, ts = valparse(ts)\n      arr << v\n\n      if ts[0][0] == ']'\n        return arr, ts[1..-1]\n      end\n    end\n  end","complexity_score":36.5,"ast_json":"{\"type\":\"def\",\"children\":[\"arrparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\"[\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"arr\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\",\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"str\",\"children\":[\"]\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]},null]}]}]}]}]}","id":"1d0eed89-2330-4e1a-add7-7c1eb76bfad3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":496,"raw_source":"def test_map_calls_context=\n    model = TestModel.new(value: :test)\n\n    template = Template.parse('{{ foo | map: \"registers\" }}')\n    template.registers[:test] = 1234\n    template.assigns['foo'] = [model]\n\n    assert_template_result(\"{:test=>1234}\", template.render!)\n  end","complexity_score":10.45,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_calls_context=\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"model\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestModel\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"sym\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ foo | map: \\\"registers\\\" }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"int\",\"children\":[1234]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"model\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{:test=>1234}\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}","id":"a94bd584-c04e-46ba-9dc1-be6ac2d3e436"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":108,"raw_source":"def test_product_drop\n    tpl = Liquid::Template.parse('  ')\n    assert_equal('  ', tpl.render!('product' => ProductDrop.new))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_product_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tpl\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tpl\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"f30c61fe-c4b2-46b1-84d6-88ef27d84429"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":120,"raw_source":"def test_multiple_instances_are_unique\n    static_register_1 = Registers.new(a: 1, b: 2)\n    static_register_1[:b] = 22\n    static_register_1[:c] = 33\n\n    static_register_2 = Registers.new(a: 10, b: 20)\n    static_register_2[:b] = 220\n    static_register_2[:c] = 330\n\n    assert_equal({ a: 1, b: 2 }, static_register_1.static)\n    assert_equal(1, static_register_1[:a])\n    assert_equal(22, static_register_1[:b])\n    assert_equal(33, static_register_1[:c])\n\n    assert_equal({ a: 10, b: 20 }, static_register_2.static)\n    assert_equal(10, static_register_2[:a])\n    assert_equal(220, static_register_2[:b])\n    assert_equal(330, static_register_2[:c])\n  end","complexity_score":30.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_multiple_instances_are_unique\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register_1\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"static_register_2\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[20]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[220]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[330]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"static\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_1\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[20]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"static\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[10]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[220]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[330]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register_2\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}","id":"e96dabc7-7cb8-431b-bd37-5789af58854e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":2160,"raw_source":"def self.register(*extensions, &block)\n    Delegator.target.register(*extensions, &block)\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Delegator\"]},\"target\"]},\"register\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"ba2b453a-1bde-4f91-823d-131dcf785d0f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/settings_test.rb","start_line":580,"raw_source":"def self.track\n        Rack.send :remove_const, :Builder\n        Rack.const_set :Builder, MiddlewareTracker\n        MiddlewareTracker.used.clear\n        yield\n      ensure\n        Rack.send :remove_const, :Builder\n        Rack.const_set :Builder, MiddlewareTracker.superclass\n      end","complexity_score":13.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"track\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_const\"]},{\"type\":\"sym\",\"children\":[\"Builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"const_set\",{\"type\":\"sym\",\"children\":[\"Builder\"]},{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"used\"]},\"clear\"]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"send\",{\"type\":\"sym\",\"children\":[\"remove_const\"]},{\"type\":\"sym\",\"children\":[\"Builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"const_set\",{\"type\":\"sym\",\"children\":[\"Builder\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MiddlewareTracker\"]},\"superclass\"]}]}]}]}]}","id":"7d5269f9-1e05-427b-ae45-3454f23c8ba1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":93,"raw_source":"def self.to_s(obj, seen = {})\n      case obj\n      when Hash\n        # If the custom hash implementation overrides `#to_s`, use their\n        # custom implementation. Otherwise we use Liquid's default\n        # implementation.\n        if obj.class.instance_method(:to_s) == HASH_TO_S_METHOD\n          hash_inspect(obj, seen)\n        else\n          obj.to_s\n        end\n      when Array\n        array_inspect(obj, seen)\n      else\n        obj.to_s\n      end\n    end","complexity_score":15.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"optarg\",\"children\":[\"seen\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"class\"]},\"instance_method\",{\"type\":\"sym\",\"children\":[\"to_s\"]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"HASH_TO_S_METHOD\"]}]},{\"type\":\"send\",\"children\":[null,\"hash_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[null,\"array_inspect\",{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"lvar\",\"children\":[\"seen\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_s\"]}]}]}","id":"af5b76c4-da28-42d1-8db8-d4bb8d61d5b4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":284,"raw_source":"def squash_instance_assigns_with_environments\n      @scopes.last.each_key do |k|\n        @environments.each do |env|\n          if env.key?(k)\n            scopes.last[k] = lookup_and_evaluate(env, k)\n            break\n          end\n        end\n      end\n    end # squash_instance_assigns_with_environments","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"squash_instance_assigns_with_environments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@scopes\"]},\"last\"]},\"each_key\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"send\",\"children\":[null,\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"break\",\"children\":[]}]},null]}]}]}]}","id":"d2028106-5451-4848-8930-ad50cca06be2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/spec_helpers.rb","start_line":33,"raw_source":"def with_headers(headers)\n    proc { [200, { 'content-type' => 'text/plain' }.merge(headers), ['ok']] }\n  end","complexity_score":3.38,"ast_json":"{\"type\":\"def\",\"children\":[\"with_headers\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"headers\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"send\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]},\"merge\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}","id":"6e71ee8a-7d19-4475-b27b-0cec7cb2067d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":94,"raw_source":"def test_reuse_parsed_template\n    template                     = Template.parse(%({{ greeting }} {{ name }}))\n    template.assigns['greeting'] = 'Goodbye'\n    assert_equal('Hello Tobi', template.render!('greeting' => 'Hello', 'name' => 'Tobi'))\n    assert_equal('Hello ', template.render!('greeting' => 'Hello', 'unknown' => 'Tobi'))\n    assert_equal('Hello Brian', template.render!('greeting' => 'Hello', 'name' => 'Brian'))\n    assert_equal('Goodbye Brian', template.render!('name' => 'Brian'))\n    assert_equal({ 'greeting' => 'Goodbye' }, template.assigns)\n  end","complexity_score":15.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reuse_parsed_template\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ greeting }} {{ name }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Goodbye\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Tobi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"unknown\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Brian\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Hello\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Brian\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Goodbye Brian\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"name\"]},{\"type\":\"str\",\"children\":[\"Brian\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"Goodbye\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]}]}]}]}","id":"2c5684a8-fc20-4c7f-9513-8ee8a634cd6f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":97,"raw_source":"def test_contains_returns_false_for_nil_operands\n    @context = Liquid::Context.new\n    assert_evaluates_false(VariableLookup.new('not_assigned'), 'contains', '0')\n    assert_evaluates_false(0, 'contains', VariableLookup.new('not_assigned'))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_returns_false_for_nil_operands\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"not_assigned\"]}]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"0\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"not_assigned\"]}]}]}]}]}","id":"c6c30570-49fb-4567-81f2-df18f0415876"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":32,"raw_source":"def try_coerce_encoding(input, encoding:)\n        original_encoding = input.encoding\n        if input.encoding != encoding\n          input.force_encoding(encoding)\n          unless input.valid_encoding?\n            input.force_encoding(original_encoding)\n          end\n        end\n        input\n      end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"try_coerce_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"kwarg\",\"children\":[\"encoding\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"original_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]},\"!=\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"valid_encoding?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"original_encoding\"]}]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}","id":"58689444-d0d0-4ecc-8fb7-a86e93c57d8d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":109,"raw_source":"def initialize(settings)\n    super()\n    @settings = settings\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"settings\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@settings\",{\"type\":\"lvar\",\"children\":[\"settings\"]}]}]}]}","id":"8f426337-366a-49b1-8778-7a54ad07980f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":152,"raw_source":"def test_dig\n    assert_equal :a, @hash.dig(:a)\n    assert_equal :b, @hash.dig(?b)\n    assert_nil @hash.dig(:d)\n\n    assert_equal :a, @hash.dig(:simple_nested, :a)\n    assert_equal :b, @hash.dig('simple_nested', ?b)\n    assert_nil @hash.dig('simple_nested', :d)\n\n    assert_equal :a, @hash.dig(:nested, :a, 0, :a)\n    assert_equal :b, @hash.dig('nested', ?a, 0, ?b)\n    assert_nil @hash.dig('nested', ?a, 0, :d)\n  end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dig\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"simple_nested\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"simple_nested\"]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"dig\",{\"type\":\"str\",\"children\":[\"nested\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"sym\",\"children\":[\"d\"]}]}]}]}]}","id":"18816e8e-3ce0-46f6-9608-8787acc72c73"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/ifchanged.rb","start_line":5,"raw_source":"def render_to_output_buffer(context, output)\n      block_output = +''\n      super(context, block_output)\n\n      if block_output != context.registers[:ifchanged]\n        context.registers[:ifchanged] = block_output\n        output << block_output\n      end\n\n      output\n    end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block_output\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"block_output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_output\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"ifchanged\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"ifchanged\"]},{\"type\":\"lvar\",\"children\":[\"block_output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"block_output\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"71ab11d3-e5a3-4385-bdb6-1e81d2f177e2"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":22,"raw_source":"def locale\n      @locale ||= YAML.load_file(@path)\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"locale\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@locale\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"YAML\"]},\"load_file\",{\"type\":\"ivar\",\"children\":[\"@path\"]}]}]}]}","id":"985c55f2-dd78-433c-a484-fcb7497b2a41"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":173,"raw_source":"def test_local_global\n    with_global_filter(MoneyFilter) do\n      assert_equal(\" 1000$ \", Template.parse(\"{{1000 | money}}\").render!(nil, nil))\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, filters: CanadianMoneyFilter))\n      assert_equal(\" 1000$ CAD \", Template.parse(\"{{1000 | money}}\").render!(nil, filters: [CanadianMoneyFilter]))\n    end\n  end","complexity_score":14.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_local_global\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_global_filter\",{\"type\":\"const\",\"children\":[null,\"MoneyFilter\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 1000$ CAD \"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{1000 | money}}\"]}]},\"render!\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CanadianMoneyFilter\"]}]}]}]}]}]}]}]}]}","id":"a9fe7d69-bf50-4b45-aa05-726c7cf98ab9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/document.rb","start_line":44,"raw_source":"def render(context)\n      render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[null,\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}","id":"073c6d28-c6ea-4dd8-8446-54f2fd606b05"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":19,"raw_source":"def test_raise_on_label_and_no_close_bracets\n    assert_raises(SyntaxError) do\n      Template.parse(\"TEST {{ \")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_label_and_no_close_bracets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"TEST {{ \"]}]}]}]}","id":"d40acaae-ec91-4826-b0dd-bb7450e4ab55"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":8,"raw_source":"def test_sets_default_localization_in_document\n    t = Template.new\n    t.parse('{%comment%}{%endcomment%}')\n    assert_instance_of(I18n, t.root.nodelist[0].options[:locale])\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_localization_in_document\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"I18n\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]}]}]}]}","id":"64ca3ed4-1828-41af-ad87-fc3e0ecddd8e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":126,"raw_source":"def method_missing(method, *args, &block)\n        return super unless method.to_sym == :options\n        {:some => :option}\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"options\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"zsuper\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"some\"]},{\"type\":\"sym\",\"children\":[\"option\"]}]}]}]}]}","id":"0b92205c-6057-4953-b60d-f26667a2e0cc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/remote_referrer.rb","start_line":17,"raw_source":"def accepts?(env)\n        safe?(env) or referrer(env) == Request.new(env).host\n      end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"safe?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]}]}","id":"afa4a136-45f7-43d4-965a-4fad0597578a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":85,"raw_source":"def with_error_mode(mode)\n      old_mode = Liquid::Environment.default.error_mode\n      Liquid::Environment.default.error_mode = mode\n      yield\n    ensure\n      Liquid::Environment.default.error_mode = old_mode\n    end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"with_error_mode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mode\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"old_mode\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"mode\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"default\"]},\"error_mode=\",{\"type\":\"lvar\",\"children\":[\"old_mode\"]}]}]}]}","id":"c258896c-f5ac-47be-9e15-407ed43fb1bf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":89,"raw_source":"def test_for_and_if\n    assigns = { 'array' => [1, 2, 3] }\n    assert_template_result(\n      '+--',\n      '{%for item in array%}{% if forloop.first %}+{% else %}-{% endif %}{%endfor%}',\n      assigns,\n    )\n  end","complexity_score":2.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_and_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"+--\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}{% if forloop.first %}+{% else %}-{% endif %}{%endfor%}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"a35e6dd6-b71d-409d-ab6b-af0c32b943ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":94,"raw_source":"def test_uses_default_template_factory_when_no_template_factory_found_in_register\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_default_template_factory_when_no_template_factory_found_in_register\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]}]}]}","id":"62f7e773-cf6b-4219-b74c-44a07e00b65d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":190,"raw_source":"def test_base64_decode\n    decoded = @filters.base64_decode('b25lIHR3byB0aHJlZQ==')\n    assert_equal('one two three', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_decode('4pyF')\n    assert_equal('✅', decoded)\n    assert_equal(Encoding::UTF_8, decoded.encoding)\n\n    decoded = @filters.base64_decode(\"/w==\")\n    assert_equal(Encoding::ASCII_8BIT, decoded.encoding)\n    assert_equal((+\"\\xFF\").force_encoding(Encoding::ASCII_8BIT), decoded)\n\n    exception = assert_raises(Liquid::ArgumentError) do\n      @filters.base64_decode(\"invalidbase64\")\n    end\n\n    assert_equal('Liquid error: invalid base64 provided to base64_decode', exception.message)\n  end","complexity_score":24.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_base64_decode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exception\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"base64_decode\",{\"type\":\"str\",\"children\":[\"invalidbase64\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: invalid base64 provided to base64_decode\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exception\"]},\"message\"]}]}]}]}","id":"66400aff-acb5-4144-aad0-688b0b495d07"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":31,"raw_source":"def test_error_on_empty_filter\n    assert(Template.parse(\"{{test}}\"))\n\n    with_error_mode(:lax) do\n      assert(Template.parse(\"{{|test}}\"))\n    end\n\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) { Template.parse(\"{{|test}}\") }\n      assert_raises(SyntaxError) { Template.parse(\"{{test |a|b|}}\") }\n    end\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_error_on_empty_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test}}\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test}}\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test}}\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test |a|b|}}\"]}]}]}]}]}]}]}","id":"e6578665-cfb5-4f7a-99cc-cd456700c4b7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":28,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      if markup =~ SYNTAX\n\n        template_name = Regexp.last_match(1)\n        variable_name = Regexp.last_match(3)\n\n        @alias_name         = Regexp.last_match(5)\n        @variable_name_expr = variable_name ? parse_expression(variable_name) : nil\n        @template_name_expr = parse_expression(template_name)\n        @attributes         = {}\n\n        markup.scan(TagAttributes) do |key, value|\n          @attributes[key] = parse_expression(value)\n        end\n\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.include\")\n      end\n    end","complexity_score":26.45,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"SYNTAX\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@alias_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@variable_name_expr\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"variable_name\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"variable_name\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@template_name_expr\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"template_name\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.include\"]}]}]}]}]}]}","id":"8fb02967-f940-44ac-aa05-03c46e1e64f0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":298,"raw_source":"def test_access_variable_with_hash_notation\n    assert_template_result('baz', '{{ [\"foo\"] }}', { \"foo\" => \"baz\" })\n    assert_template_result('baz', '{{ [bar] }}', { 'foo' => 'baz', 'bar' => 'foo' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_access_variable_with_hash_notation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"baz\"]},{\"type\":\"str\",\"children\":[\"{{ [\\\"foo\\\"] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"baz\"]},{\"type\":\"str\",\"children\":[\"{{ [bar] }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"baz\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]}]}]}","id":"5bca5d32-3af1-456c-9f92-4632aa6eb2ed"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":419,"raw_source":"def test_whitespace_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if true -%}\n          yes\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {%- if false -%}\n          no\n          {%- endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p></p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p></p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"4a3bfd89-027a-4da5-a83f-2dbc6da57405"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":13,"raw_source":"def params(input)\n    { \"one\" => +\"this\", \"two\" => +\"is\", \"three\" => +\"a\", \"four\" => +\"test\" }\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"params\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"this\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"two\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"is\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},\"+@\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},\"+@\"]}]}]}]}","id":"652374e0-acb9-4b1a-af34-5ab8b6d6047a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":10,"raw_source":"def initialize(length, cols)\n      @length = length\n      @row    = 1\n      @col    = 1\n      @cols   = cols\n      @index  = 0\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"length\"]},{\"type\":\"arg\",\"children\":[\"cols\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@length\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@row\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"ivasgn\",\"children\":[\"@col\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"ivasgn\",\"children\":[\"@cols\",{\"type\":\"lvar\",\"children\":[\"cols\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@index\",{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"3106b63d-ceb4-4f16-bf23-abd8c72a9682"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":257,"raw_source":"def test_select!\n    @hash.select! { |k, v| v == :a }\n    assert_equal Sinatra::IndifferentHash[a: :a], @hash\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_select!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"select!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"v\"]},\"==\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"[]\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}","id":"b1c541dc-dcc5-47bf-a609-0cdb24bc972d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":76,"raw_source":"def test_whitespace_is_not_blank_if_other_stuff_is_present\n    body = \"     x \"\n    assert_template_result(body * (N + 1), wrap(body))\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_whitespace_is_not_blank_if_other_stuff_is_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"str\",\"children\":[\"     x \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"*\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"N\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"wrap\",{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}","id":"46a98085-bef3-4934-a99b-57b23ecacb00"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":211,"raw_source":"def compare_with_per_form_token(token, session, request)\n        secure_compare(token,\n                       per_form_token(session, request.path.chomp('/'), request.request_method))\n      end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_per_form_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]},{\"type\":\"arg\",\"children\":[\"request\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"per_form_token\",{\"type\":\"lvar\",\"children\":[\"session\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]},\"chomp\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"request_method\"]}]}]}]}","id":"ee794767-ada1-4ef8-be91-98233f228ffe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":284,"raw_source":"def visit(template)\n    traversal(template).visit.flatten.compact\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"visit\"]},\"flatten\"]},\"compact\"]}]}","id":"37317b42-5bb3-4a5c-b6f1-f7f2b1f7b148"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":441,"raw_source":"def test_uniq_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.uniq(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}","id":"c7927fde-9aa4-407e-9ec7-fe801d725f18"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":47,"raw_source":"def test_tag_output_with_multiple_blank_lines\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n\n\n          {%- if true -%}\n          yes\n          {%- endif -%}\n\n\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>yes</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tag_output_with_multiple_blank_lines\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {%- endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>yes</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"57c51464-3d40-4f2f-aac1-e13dd529463a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/document_test.rb","start_line":8,"raw_source":"def test_unexpected_outer_tag\n    source = \"{% else %}\"\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Unexpected outer 'else' tag\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_outer_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% else %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unexpected outer 'else' tag\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"e611cb9b-ae09-4905-97bd-41d0729e5174"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":216,"raw_source":"def lookup_and_evaluate(obj, key, raise_on_not_found: true)\n      if @strict_variables && raise_on_not_found && obj.respond_to?(:key?) && !obj.key?(key)\n        raise Liquid::UndefinedVariable, \"undefined variable #{key}\"\n      end\n\n      value = obj[key]\n\n      if value.is_a?(Proc) && obj.respond_to?(:[]=)\n        obj[key] = value.arity == 0 ? value.call : value.call(self)\n      else\n        value\n      end\n    end","complexity_score":22.7,"ast_json":"{\"type\":\"def\",\"children\":[\"lookup_and_evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"kwoptarg\",\"children\":[\"raise_on_not_found\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strict_variables\"]},{\"type\":\"lvar\",\"children\":[\"raise_on_not_found\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"!\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedVariable\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined variable \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Proc\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]=\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"arity\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"call\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"call\",{\"type\":\"self\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"5351eae0-5d6f-4849-aff5-9e353e0b9e2d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":35,"raw_source":"def test_template_inheritance\n    assert_equal(\"foo\", TemplateSubclass.parse(\"foo\").render)\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_template_inheritance\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateSubclass\"]},\"parse\",{\"type\":\"str\",\"children\":[\"foo\"]}]},\"render\"]}]}]}","id":"d9ce258a-72a9-45f3-bfb0-700d4436a48d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":134,"raw_source":"def test_for_in\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_in\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in test %}{% endfor %}\"]}]}]}]}","id":"0be71cb7-180e-43b4-99e1-fbc71a31c0e0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":122,"raw_source":"def test_drops_respond_to_to_liquid\n    assert_equal(\"text1\", Liquid::Template.parse(\"{{ product.to_liquid.texts.text }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"text1\", Liquid::Template.parse('{{ product | map: \"to_liquid\" | map: \"texts\" | map: \"text\" }}').render!('product' => ProductDrop.new))\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drops_respond_to_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"text1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.to_liquid.texts.text }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"text1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"to_liquid\\\" | map: \\\"texts\\\" | map: \\\"text\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"3c169b7a-e642-4436-81df-7797855510bc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1832,"raw_source":"def setup_middleware(builder)\n        middleware.each { |c, a, b| builder.use(c, *a, &b) }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_middleware\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]},{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"lvar\",\"children\":[\"c\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]}]}]}]}]}","id":"37c6fce8-ec1e-485d-9c17-93379a8b07f4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/remote_token.rb","start_line":19,"raw_source":"def accepts?(env)\n        super or referrer(env) == Request.new(env).host\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"referrer\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},\"host\"]}]}]}]}","id":"52f4b8d7-198d-4864-a1c0-376fa0584fc2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":68,"raw_source":"def test_if_and\n    assert_template_result(' YES ', '{% if true and true %} YES {% endif %}')\n    assert_template_result('', '{% if false and true %} YES {% endif %}')\n    assert_template_result('', '{% if true and false %} YES {% endif %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_and\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if true and true %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if false and true %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if true and false %} YES {% endif %}\"]}]}]}]}","id":"9de37bf5-d572-453a-8c43-8134fb65ef72"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":165,"raw_source":"def test_add_filter\n    filter = Module.new do\n      def hi(output)\n        output + ' hi!'\n      end\n    end\n\n    context = Context.new\n    context.add_filters(filter)\n    assert_equal('hi? hi!', context.invoke(:hi, 'hi?'))\n\n    context = Context.new\n    assert_equal('hi?', context.invoke(:hi, 'hi?'))\n\n    context.add_filters(filter)\n    assert_equal('hi? hi!', context.invoke(:hi, 'hi?'))\n  end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi? hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi? hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"sym\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"hi?\"]}]}]}]}]}","id":"42f42839-ca2e-4ccf-b056-1a475cfa0f67"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":83,"raw_source":"def call(env)\n      req = Rack::Request.new(env)\n      req.update_param('s', :s)\n      req.update_param('i', 1)\n      req.update_param('c', 3.to_c)\n      req.update_param('t', true)\n      req.update_param('f', false)\n      req.update_param('n', nil)\n      super\n    end","complexity_score":9.85,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"req\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"s\"]},{\"type\":\"sym\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"i\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[3]},\"to_c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"t\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"f\"]},{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"n\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"f45c5db3-9edd-4a1f-8e49-b6bf9786c451"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":128,"raw_source":"def method_missing(name, *args, &block)\n    if response && response.respond_to?(name)\n      response.send(name, *args, &block)\n    else\n      super\n    end\n  rescue Rack::Test::Error\n    super\n  end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Test\"]},\"Error\"]}]},null,{\"type\":\"zsuper\",\"children\":[]}]},null]}]}","id":"75917c2a-f28a-4555-adcf-24ab8c767420"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":623,"raw_source":"def etag(value, options = {})\n      # Before touching this code, please double check RFC 2616 14.24 and 14.26.\n      options      = { kind: options } unless Hash === options\n      kind         = options[:kind] || :strong\n      new_resource = options.fetch(:new_resource) { request.post? }\n\n      unless ETAG_KINDS.include?(kind)\n        raise ArgumentError, ':strong or :weak expected'\n      end\n\n      value = format('\"%s\"', value)\n      value = \"W/#{value}\" if kind == :weak\n      response['ETag'] = value\n\n      return unless success? || status == 304\n\n      if etag_matches?(env['HTTP_IF_NONE_MATCH'], new_resource)\n        halt(request.safe? ? 304 : 412)\n      end\n\n      if env['HTTP_IF_MATCH']\n        return if etag_matches?(env['HTTP_IF_MATCH'], new_resource)\n\n        halt 412\n      end\n\n      nil\n    end","complexity_score":49.28,"ast_json":"{\"type\":\"def\",\"children\":[\"etag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"lvar\",\"children\":[\"options\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"kind\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"kind\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"kind\"]}]},{\"type\":\"sym\",\"children\":[\"strong\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_resource\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"new_resource\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"post?\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ETAG_KINDS\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"kind\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\":strong or :weak expected\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"\\\"%s\\\"\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"kind\"]},\"==\",{\"type\":\"sym\",\"children\":[\"weak\"]}]},{\"type\":\"lvasgn\",\"children\":[\"value\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"W/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"ETag\"]},{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"success?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[304]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"etag_matches?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_NONE_MATCH\"]}]},{\"type\":\"lvar\",\"children\":[\"new_resource\"]}]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"safe?\"]},{\"type\":\"int\",\"children\":[304]},{\"type\":\"int\",\"children\":[412]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MATCH\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"etag_matches?\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_IF_MATCH\"]}]},{\"type\":\"lvar\",\"children\":[\"new_resource\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[412]}]}]},null]},{\"type\":\"nil\",\"children\":[]}]}]}","id":"8d05f640-5e9c-4d89-b612-2b565c03346a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1067,"raw_source":"def reverse\n        reverse_each.to_a\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"reverse\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"reverse_each\"]},\"to_a\"]}]}","id":"c1a66c6f-d6f4-41b5-aeb8-671605647b25"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":814,"raw_source":"def test_concat\n    assert_equal([1, 2, 3, 4], @filters.concat([1, 2], [3, 4]))\n    assert_equal([1, 2, 'a'],  @filters.concat([1, 2], ['a']))\n    assert_equal([1, 2, 10],   @filters.concat([1, 2], [10]))\n\n    assert_raises(Liquid::ArgumentError, \"concat filter requires an array argument\") do\n      @filters.concat([1, 2], 10)\n    end\n  end","complexity_score":16.53,"ast_json":"{\"type\":\"def\",\"children\":[\"test_concat\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[10]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[10]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"concat filter requires an array argument\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"concat\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"int\",\"children\":[10]}]}]}]}]}","id":"b8173da3-5c7b-42c4-84f0-bfd9f8470d1f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/frame_options.rb","start_line":32,"raw_source":"def call(env)\n        status, headers, body        = @app.call(env)\n        headers['x-frame-options'] ||= frame_options if html? headers\n        [status, headers, body]\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"str\",\"children\":[\"x-frame-options\"]}]},{\"type\":\"send\",\"children\":[null,\"frame_options\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"b0695b98-4927-45e4-bf25-2bc07a3109dc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":243,"raw_source":"def helpers(*extensions, &block)\n        class_eval(&block) if block_given?\n        include(*extensions) if extensions.any?\n      end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"helpers\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"any?\"]},{\"type\":\"send\",\"children\":[null,\"include\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]}]}]},null]}]}]}","id":"4948c99a-f420-4ce7-8dbb-a93c2f4fcac4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":761,"raw_source":"def attachment_app(filename=nil)\n      mock_app do\n        get('/attachment') do\n          attachment filename\n          response.write(\"<sinatra></sinatra>\")\n        end\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"attachment_app\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/attachment\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"attachment\",{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"write\",{\"type\":\"str\",\"children\":[\"<sinatra></sinatra>\"]}]}]}]}]}]}","id":"0e32b4f1-8a73-47a4-8f28-bfe6d2a1294f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":454,"raw_source":"def test_lambda_in_array_is_called_once\n    @global = 0\n\n    p = proc {\n      @global += 1\n      @global.to_s\n    }\n    @context['callcount'] = [1, 2, p, 4, 5]\n\n    assert_equal('1', @context['callcount[2]'])\n    assert_equal('1', @context['callcount[2]'])\n    assert_equal('1', @context['callcount[2]'])\n  end","complexity_score":16.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_lambda_in_array_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"lvar\",\"children\":[\"p\"]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount[2]\"]}]}]}]}]}","id":"5b482264-bbbf-469b-a447-889a45415afd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":146,"raw_source":"def test_syntax_error_no_expression\n    assert_raises(SyntaxError) { assert_template_result('', '{% if %}') }\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_no_expression\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if %}\"]}]}]}]}","id":"ef2636b9-9c4c-43ad-ae59-a1687c5b8084"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":178,"raw_source":"def assert_evaluates_false(left, op, right)\n    assert(\n      !Condition.new(left, op, right).evaluate(@context),\n      \"Evaluated true: #{left.inspect} #{op} #{right.inspect}\",\n    )\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_false\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},\"!\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Evaluated true: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"inspect\"]}]}]}]}]}","id":"34de197b-b8dc-4199-a2dc-1b573ddfd956"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/condition.rb","start_line":86,"raw_source":"def or(condition)\n      @child_relation  = :or\n      @child_condition = condition\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"or\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"condition\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@child_relation\",{\"type\":\"sym\",\"children\":[\"or\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@child_condition\",{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}]}","id":"f0b4ee8c-5e39-4f09-bea9-9a0e06c6b433"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":208,"raw_source":"def test_replace\n    @hash.replace(?a=>1, :q=>2)\n    assert_equal({ ?a=>1, ?q=>2 }, @hash)\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_replace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"replace\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"q\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"ivar\",\"children\":[\"@hash\"]}]}]}]}","id":"62b66e25-3954-4392-a2d8-6db175644744"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":835,"raw_source":"def render_ruby(engine, template, options = {}, locals = {}, &block)\n      if template.is_a?(Hash)\n        options = template\n        template = nil\n      end\n      template = proc { block } if template.nil?\n      render engine, template, options, locals\n    end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"render_ruby\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"nil?\"]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"b2e50a96-171f-4fc6-93d3-c114e82f3655"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":17,"raw_source":"def initialize\n      @nodelist = []\n      @blank    = true\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@nodelist\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@blank\",{\"type\":\"true\",\"children\":[]}]}]}]}","id":"84668be6-5760-490a-83b5-1009a66f6ad2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":28,"raw_source":"def test_zero_lq_one\n    text = ' {% if 0 < 1 %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_zero_lq_one\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 0 < 1 %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"b2f709e1-58fc-48e5-a06d-15fda0ba40bf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":74,"raw_source":"def []=(key, value)\n      super(convert_key(key), convert_value(value))\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"[]=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"8b932e36-db13-4916-aaf2-b9aa1f629d10"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":120,"raw_source":"def initialize(value)\n    super()\n    @value = value.to_i\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_i\"]}]}]}]}","id":"7cde2313-ab22-49bc-91de-5ba215448b62"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1055,"raw_source":"def test_where_with_nil_is_a_no_op\n    environment = { \"array\" => [\"alpha\", \"beta\", \"gamma\"] }\n    template = \"{{ array | where: nil | join: ' ' }}\"\n\n    assert_raises(Liquid::ArgumentError) do\n      assert_template_result(\"alpha beta gamma\", template, environment)\n    end\n  end","complexity_score":5.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_with_nil_is_a_no_op\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"environment\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"alpha\"]},{\"type\":\"str\",\"children\":[\"beta\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: nil | join: ' ' }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"alpha beta gamma\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"environment\"]}]}]}]}]}","id":"eabf9030-814e-4b51-bf0c-2b537c92c442"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":53,"raw_source":"def test_unexpected_characters_syntax_error\n    with_error_mode(:strict) do\n      assert_raises(SyntaxError) do\n        markup = \"true && false\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n      assert_raises(SyntaxError) do\n        markup = \"false || true\"\n        Template.parse(\"{% if #{markup} %} YES {% endif %}\")\n      end\n    end\n  end","complexity_score":12.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unexpected_characters_syntax_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"true && false\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"str\",\"children\":[\"false || true\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"str\",\"children\":[\" %} YES {% endif %}\"]}]}]}]}]}]}]}]}","id":"5fd8a51a-e132-4b13-afe6-91a2ff80265c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":53,"raw_source":"def app_file\n      File.expand_path('server.rb', __dir__)\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"server.rb\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}","id":"1184b6fc-3077-4bc5-b60a-49f30c263ab3"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":194,"raw_source":"def inline_templates?\n        elements.any? { |element| element.type == :inline_templates }\n      end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"elements\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"type\"]},\"==\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]}]}]}]}","id":"90b34e85-e8fd-4b93-a74a-2647d0d8186e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/routing_test.rb","start_line":1510,"raw_source":"def protect(*args)\n        condition {\n          unless authorize(params[\"user\"], params[\"password\"])\n            halt 403, \"go away\"\n          end\n        }\n      end","complexity_score":11.35,"ast_json":"{\"type\":\"def\",\"children\":[\"protect\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"authorize\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"params\"]},\"[]\",{\"type\":\"str\",\"children\":[\"user\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"params\"]},\"[]\",{\"type\":\"str\",\"children\":[\"password\"]}]}]},null,{\"type\":\"send\",\"children\":[null,\"halt\",{\"type\":\"int\",\"children\":[403]},{\"type\":\"str\",\"children\":[\"go away\"]}]}]}]}]}","id":"d426b732-c065-45f0-80e5-745e699bc88c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":749,"raw_source":"def initialize\n      super\n      @default_layout = :layout\n      @preferred_extension = nil\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@default_layout\",{\"type\":\"sym\",\"children\":[\"layout\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@preferred_extension\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"cadd90be-77cf-4b51-9c8e-93907a9907f8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":77,"raw_source":"def test_size\n    assert_equal(3, @filters.size([1, 2, 3]))\n    assert_equal(0, @filters.size([]))\n    assert_equal(0, @filters.size(nil))\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"array\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"size\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"9baa347d-a277-4978-b757-c39f79c4b01e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":98,"raw_source":"def escape(input)\n      CGI.escapeHTML(Utils.to_s(input)) unless input.nil?\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"escape\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CGI\"]},\"escapeHTML\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}","id":"149743ab-b4c9-4daa-a49c-3f85c39b9632"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":160,"raw_source":"def test_liquid_argument_error\n    source = \"{{ '' | size: 'too many args' }}\"\n    exc = assert_raises(Liquid::ArgumentError) do\n      Template.parse(source).render!\n    end\n    assert_match(/\\ALiquid error: wrong number of arguments /, exc.message)\n    assert_equal(exc.message, Template.parse(source).render)\n  end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_liquid_argument_error\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{{ '' | size: 'too many args' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"exc\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]}]},\"render!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_match\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\ALiquid error: wrong number of arguments \"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exc\"]},\"message\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"source\"]}]},\"render\"]}]}]}]}","id":"7a4659c8-f008-48bf-b3fd-d7e544d9b8a0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":43,"raw_source":"def render_to_output_buffer(_context, output)\n    output << @template_name[1..-2]\n    output\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@template_name\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"71250d48-b4f7-4576-8e5a-b90e850cb958"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":75,"raw_source":"def initialize\n      @root_children = []\n      @current_children = nil\n      @total_time = 0.0\n    end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@root_children\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@total_time\",{\"type\":\"float\",\"children\":[0.0]}]}]}]}","id":"ec1718df-5959-4dbf-9f24-c3bbff3b0e15"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":86,"raw_source":"def self.render_node(context, output, node)\n      node.render_to_output_buffer(context, output)\n    rescue => exc\n      blank_tag = !node.instance_of?(Variable) && node.blank?\n      rescue_render_node(context, output, node.line_number, exc, blank_tag)\n    end","complexity_score":11.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"resbody\",\"children\":[null,{\"type\":\"lvasgn\",\"children\":[\"exc\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"blank_tag\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"Variable\"]}]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"blank?\"]}]}]},{\"type\":\"send\",\"children\":[null,\"rescue_render_node\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"exc\"]},{\"type\":\"lvar\",\"children\":[\"blank_tag\"]}]}]}]},null]}]}","id":"7fdadc9d-ebcf-47d4-84a7-4f8f66ffa1d9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":149,"raw_source":"def test_nested_include_with_variable\n    partials = {\n      \"nested_product_template\" => \"Product: {{ nested_product_template.title }} {%include 'details'%} \",\n      \"details\" => \"details\",\n    }\n\n    assert_template_result(\n      \"Product: Draft 151cm details \",\n      \"{% include 'nested_product_template' with product %}\",\n      { \"product\" => { \"title\" => 'Draft 151cm' } },\n      partials: partials,\n    )\n\n    assert_template_result(\n      \"Product: Draft 151cm details Product: Element 155cm details \",\n      \"{% include 'nested_product_template' for products %}\",\n      { \"products\" => [{ \"title\" => 'Draft 151cm' }, { \"title\" => 'Element 155cm' }] },\n      partials: partials,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_include_with_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"partials\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"nested_product_template\"]},{\"type\":\"str\",\"children\":[\"Product: {{ nested_product_template.title }} {%include 'details'%} \"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"details\"]},{\"type\":\"str\",\"children\":[\"details\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm details \"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_product_template' with product %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Product: Draft 151cm details Product: Element 155cm details \"]},{\"type\":\"str\",\"children\":[\"{% include 'nested_product_template' for products %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Draft 151cm\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Element 155cm\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"lvar\",\"children\":[\"partials\"]}]}]}]}]}]}","id":"43456737-3e69-4d3f-a262-b98826d47c81"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":257,"raw_source":"def test_hash_to_array_transition\n    assigns = {\n      'colors' => {\n        'Blue' => ['003366', '336699', '6699CC', '99CCFF'],\n        'Green' => ['003300', '336633', '669966', '99CC99'],\n        'Yellow' => ['CC9900', 'FFCC00', 'FFFF99', 'FFFFCC'],\n        'Red' => ['660000', '993333', 'CC6666', 'FF9999'],\n      },\n    }\n\n    assert_template_result(\"003366\", \"{{ colors.Blue[0] }}\", assigns)\n    assert_template_result(\"FF9999\", \"{{ colors.Red[3] }}\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_to_array_transition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"colors\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Blue\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"003366\"]},{\"type\":\"str\",\"children\":[\"336699\"]},{\"type\":\"str\",\"children\":[\"6699CC\"]},{\"type\":\"str\",\"children\":[\"99CCFF\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Green\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"003300\"]},{\"type\":\"str\",\"children\":[\"336633\"]},{\"type\":\"str\",\"children\":[\"669966\"]},{\"type\":\"str\",\"children\":[\"99CC99\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Yellow\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"CC9900\"]},{\"type\":\"str\",\"children\":[\"FFCC00\"]},{\"type\":\"str\",\"children\":[\"FFFF99\"]},{\"type\":\"str\",\"children\":[\"FFFFCC\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"Red\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"660000\"]},{\"type\":\"str\",\"children\":[\"993333\"]},{\"type\":\"str\",\"children\":[\"CC6666\"]},{\"type\":\"str\",\"children\":[\"FF9999\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"003366\"]},{\"type\":\"str\",\"children\":[\"{{ colors.Blue[0] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"FF9999\"]},{\"type\":\"str\",\"children\":[\"{{ colors.Red[3] }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"acb0de0e-2a55-4f71-9717-f1df230fbbf4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":419,"raw_source":"def test_iterate_with_each_when_no_limit_applied\n    loader   = LoaderDrop.new([1, 2, 3, 4, 5])\n    assigns  = { 'items' => loader }\n    expected = '12345'\n    template = '{% for item in items %}{{item}}{% endfor %}'\n    assert_template_result(expected, template, assigns)\n    assert(loader.each_called)\n    assert(!loader.load_slice_called)\n  end","complexity_score":13.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_iterate_with_each_when_no_limit_applied\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"loader\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoaderDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"lvar\",\"children\":[\"loader\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"12345\"]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{% for item in items %}{{item}}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"each_called\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"loader\"]},\"load_slice_called\"]},\"!\"]}]}]}]}","id":"0e4df299-8209-4d19-b766-642de2dcd4ad"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":197,"raw_source":"def convert_value(value)\n      case value\n      when Hash\n        value.is_a?(self.class) ? value : self.class[value]\n      when Array\n        value.map(&method(:convert_value))\n      else\n        value\n      end\n    end","complexity_score":13.8,"ast_json":"{\"type\":\"def\",\"children\":[\"convert_value\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"is_a?\",{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_value\"]}]}]}]}]},{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}","id":"f09eeeb5-b5c3-4e77-9e83-4b662c1d7f51"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":66,"raw_source":"def test_no_error_on_lax_empty_filter\n    assert(Template.parse(\"{{test |a|b|}}\", error_mode: :lax))\n    assert(Template.parse(\"{{test}}\", error_mode: :lax))\n    assert(Template.parse(\"{{|test|}}\", error_mode: :lax))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_error_on_lax_empty_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test |a|b|}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{test}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{|test|}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}]}","id":"cbd3acd9-1f44-4fca-87cd-1590e47ec553"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":25,"raw_source":"def app_const\n    Module.const_get(app_name)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"app_const\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"const_get\",{\"type\":\"send\",\"children\":[null,\"app_name\"]}]}]}","id":"c11c6b21-4969-45b8-99d9-88d9ff7f3d57"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":354,"raw_source":"def test_drop_methods_with_question_marks\n    @context.merge(\"cents\" => CentsDrop.new)\n    assert(@context['cents.non_zero?'])\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_methods_with_question_marks\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"cents.non_zero?\"]}]}]}]}]}","id":"db7a574c-a633-4385-a779-3163351e4d85"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/raw.rb","start_line":53,"raw_source":"def ensure_valid_markup(tag_name, markup, parse_context)\n      unless Syntax.match?(markup)\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.tag_unexpected_args\", tag: tag_name)\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"ensure_valid_markup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Syntax\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.tag_unexpected_args\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]}]}]}]}","id":"3f516ab5-24d7-44a1-ad81-c083e0d385f5"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1224,"raw_source":"def test_sum_with_indexable_map_values\n    input = [{ \"quantity\" => 1 }, { \"quantity\" => 2, \"weight\" => 3 }, { \"weight\" => 4 }]\n\n    assert_equal(0, @filters.sum(input))\n    assert_equal(3, @filters.sum(input, \"quantity\"))\n    assert_equal(7, @filters.sum(input, \"weight\"))\n    assert_equal(0, @filters.sum(input, \"subtotal\"))\n  end","complexity_score":11.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_indexable_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"weight\"]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"weight\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"subtotal\"]}]}]}]}]}","id":"4d68954a-4029-4bda-8457-aab0b0286e9a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/table_row.rb","start_line":31,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      if markup =~ Syntax\n        @variable_name   = Regexp.last_match(1)\n        @collection_name = parse_expression(Regexp.last_match(2))\n        @attributes      = {}\n        markup.scan(TagAttributes) do |key, value|\n          @attributes[key] = parse_expression(value)\n        end\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.table_row\")\n      end\n    end","complexity_score":19.05,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@collection_name\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"TagAttributes\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@attributes\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.table_row\"]}]}]}]}]}]}","id":"55fd9c69-57ba-4e1a-b74b-0de035a833e2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":170,"raw_source":"def respond_to(&block)\n        Format.new(self).finish(&block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Format\"]},\"new\",{\"type\":\"self\",\"children\":[]}]},\"finish\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"23f0e3a6-7dca-4eba-8ad5-1a1f10bbb277"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/markdown_test.rb","start_line":12,"raw_source":"def setup\n    Tilt.prefer engine, 'markdown', 'mkd', 'md'\n    super\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"prefer\",{\"type\":\"send\",\"children\":[null,\"engine\"]},{\"type\":\"str\",\"children\":[\"markdown\"]},{\"type\":\"str\",\"children\":[\"mkd\"]},{\"type\":\"str\",\"children\":[\"md\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"c293fb74-dcd6-4eea-a6d6-aa4c4ca22a55"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":114,"raw_source":"def ping(timeout = 30)\n      loop do\n        return if alive?\n\n        if Time.now - @started > timeout\n          warn command, log\n          raise \"timeout starting server with command '#{command}'\"\n        else\n          sleep 0.1\n        end\n      end\n    end","complexity_score":20.33,"ast_json":"{\"type\":\"def\",\"children\":[\"ping\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"timeout\",{\"type\":\"int\",\"children\":[30]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alive?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"-\",{\"type\":\"ivar\",\"children\":[\"@started\"]}]},\">\",{\"type\":\"lvar\",\"children\":[\"timeout\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"send\",\"children\":[null,\"command\"]},{\"type\":\"send\",\"children\":[null,\"log\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"timeout starting server with command '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"command\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"sleep\",{\"type\":\"float\",\"children\":[0.1]}]}]}]}]}]}","id":"64e81628-15c1-4a7b-b3c9-9334f1d1a0e3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":33,"raw_source":"def test_strainer\n    strainer = @environment.create_strainer(@context)\n    assert_equal(5, strainer.invoke('size', 'input'))\n    assert_equal(\"public\", strainer.invoke(\"public_filter\"))\n  end","complexity_score":6.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[5]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"public\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"public_filter\"]}]}]}]}]}","id":"903ad4c4-ab07-4951-a7a0-ad7c079f001f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":459,"raw_source":"def test_for_cleans_up_registers\n    context = Context.new(ErrorDrop.new)\n\n    assert_raises(StandardError) do\n      Liquid::Template.parse('{% for i in (1..2) %}{{ standard_error }}{% endfor %}').render!(context)\n    end\n\n    assert(context.registers[:for_stack].empty?)\n  end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_cleans_up_registers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for i in (1..2) %}{{ standard_error }}{% endfor %}\"]}]},\"render!\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"for_stack\"]}]},\"empty?\"]}]}]}]}","id":"148f21f0-4e38-4cab-bc88-c6c87dcee3cb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1233,"raw_source":"def test_sum_with_indexable_non_map_values\n    input = [1, [2], \"foo\", { \"quantity\" => 3 }]\n\n    assert_equal(3, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.35,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_indexable_non_map_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}","id":"01bf1fdc-8ed7-41ae-9885-de58f42f0a36"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":489,"raw_source":"def test_context_initialization_with_a_proc_in_environment\n    contx = Context.new([test: ->(c) { c['poutine'] }], test: :foo)\n\n    assert(contx)\n    assert_nil(contx['poutine'])\n  end","complexity_score":7.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_context_initialization_with_a_proc_in_environment\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"contx\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"[]\",{\"type\":\"str\",\"children\":[\"poutine\"]}]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"test\"]},{\"type\":\"sym\",\"children\":[\"foo\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"lvar\",\"children\":[\"contx\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"contx\"]},\"[]\",{\"type\":\"str\",\"children\":[\"poutine\"]}]}]}]}]}","id":"12f07d48-a83c-4468-864f-f3695ed9e0c8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1256,"raw_source":"def error_block!(key, *block_params)\n      base = settings\n      while base.respond_to?(:errors)\n        args_array = base.errors[key]\n\n        next base = base.superclass unless args_array\n\n        args_array.reverse_each do |args|\n          first = args == args_array.first\n          args += [block_params]\n          resp = process_route(*args)\n          return resp unless resp.nil? && !first\n        end\n      end\n      return false unless key.respond_to?(:superclass) && (key.superclass < Exception)\n\n      error_block!(key.superclass, *block_params)\n    end","complexity_score":37.6,"ast_json":"{\"type\":\"def\",\"children\":[\"error_block!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"restarg\",\"children\":[\"block_params\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"errors\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args_array\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},null,{\"type\":\"next\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"base\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"superclass\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},\"reverse_each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"first\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args_array\"]},\"first\"]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"args\"]},\"+\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_params\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"resp\",{\"type\":\"send\",\"children\":[null,\"process_route\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resp\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"first\"]},\"!\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resp\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"superclass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"superclass\"]},\"<\",{\"type\":\"const\",\"children\":[null,\"Exception\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"error_block!\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"superclass\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block_params\"]}]}]}]}]}","id":"7b584386-fff9-42e3-84c2-e2060cdd029f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/haml_helpers.rb","start_line":36,"raw_source":"def precede(str, &block)\n      \"#{str}#{_capture_haml(&block).chomp}\\n\"\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"precede\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"str\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"_capture_haml\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"chomp\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}","id":"49a9f359-7969-4512-aece-ba9d835b67e2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1549,"raw_source":"def options(path, opts = {}, &block) route 'OPTIONS', path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"OPTIONS\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"383c890b-c6c8-46d0-9f68-54a247571ea0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":56,"raw_source":"def test_strings_not_equal\n    text = \" {% if 'test' != 'test' %} true {% else %} false {% endif %} \"\n    assert_template_result('  false  ', text)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings_not_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if 'test' != 'test' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  false  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"c21997e7-ec59-4f18-9590-e2fefda23359"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":291,"raw_source":"def test_render_raise_argument_error_when_template_is_undefined\n    assert_template_result(\n      \"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\",\n      \"{% include undefined_variable %}\",\n      render_errors: true,\n    )\n\n    assert_template_result(\n      \"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\",\n      \"{% include nil %}\",\n      render_errors: true,\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_raise_argument_error_when_template_is_undefined\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\"]},{\"type\":\"str\",\"children\":[\"{% include undefined_variable %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (line 1): Argument error in tag 'include' - Illegal template name\"]},{\"type\":\"str\",\"children\":[\"{% include nil %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}","id":"118db12b-5b8c-4ad2-82d9-b3692d78b6cb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":96,"raw_source":"def session(env)\n        return env[options[:session_key]] if session? env\n\n        raise \"you need to set up a session middleware *before* #{self.class}\"\n      end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"session\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"session?\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"session_key\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"you need to set up a session middleware *before* \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]}]}]}","id":"b013872b-c94b-404c-b017-4dc1f1765fc4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/inline_comment.rb","start_line":5,"raw_source":"def initialize(tag_name, markup, options)\n      super\n\n      # Semantically, a comment should only ignore everything after it on the line.\n      # Currently, this implementation doesn't support mixing a comment with another tag\n      # but we need to reserve future support for this and prevent the introduction\n      # of inline comments from being backward incompatible change.\n      #\n      # As such, we're forcing users to put a # symbol on every line otherwise this\n      # tag will throw an error.\n      if markup.match?(/\\n\\s*[^#\\s]/)\n        raise SyntaxError, options[:locale].t(\"errors.syntax.inline_comment_invalid\")\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"match?\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\n\\\\s*[^#\\\\s]\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.inline_comment_invalid\"]}]}]},null]}]}]}","id":"4e0942a1-24a6-4f74-9011-2dfd7287b74b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":223,"raw_source":"def test_table_row_does_not_leak_interrupts\n    template = <<~LIQUID\n      {% for i in (1..2) -%}\n      {% for j in (1..2) -%}\n      {% tablerow k in (1..3) %}{% break %}{% endtablerow -%}\n      loop j={{ j }}\n      {% endfor -%}\n      loop i={{ i }}\n      {% endfor -%}\n      after loop\n    LIQUID\n\n    expected = <<~STR\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=2\n      loop i=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=1\n      <tr class=\"row1\">\n      <td class=\"col1\"></td></tr>\n      loop j=2\n      loop i=2\n      after loop\n    STR\n\n    assert_template_result(\n      expected,\n      template,\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_does_not_leak_interrupts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% for i in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% for j in (1..2) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow k in (1..3) %}{% break %}{% endtablerow -%}\\n\"]},{\"type\":\"str\",\"children\":[\"loop j={{ j }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"loop i={{ i }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endfor -%}\\n\"]},{\"type\":\"str\",\"children\":[\"after loop\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=2\\n\"]},{\"type\":\"str\",\"children\":[\"loop i=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=1\\n\"]},{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\"></td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"loop j=2\\n\"]},{\"type\":\"str\",\"children\":[\"loop i=2\\n\"]},{\"type\":\"str\",\"children\":[\"after loop\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"dcf6b22d-2e41-4696-89f2-186f54bfdaa8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":96,"raw_source":"def test_new_static_retains_static\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    new_static_register = Registers.new(static_register)\n    new_static_register[:b] = 222\n\n    newest_static_register = Registers.new(new_static_register)\n    newest_static_register[:c] = 333\n\n    assert_equal(1, static_register[:a])\n    assert_equal(22, static_register[:b])\n    assert_equal(33, static_register[:c])\n\n    assert_equal(1, new_static_register[:a])\n    assert_equal(222, new_static_register[:b])\n    assert_nil(new_static_register[:c])\n\n    assert_equal(1, newest_static_register[:a])\n    assert_equal(2, newest_static_register[:b])\n    assert_equal(333, newest_static_register[:c])\n  end","complexity_score":33.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_static_retains_static\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"lvasgn\",\"children\":[\"new_static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"static_register\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[222]}]},{\"type\":\"lvasgn\",\"children\":[\"newest_static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"new_static_register\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[333]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[222]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[333]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"newest_static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}","id":"e87d31ed-de9f-490f-97c6-34264927cce3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":157,"raw_source":"def test_nested_context_drop\n    output = Liquid::Template.parse(' {{ product.context.foo }} ').render!('product' => ProductDrop.new, 'foo' => \"monkey\")\n    assert_equal(' monkey ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_context_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.context.foo }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"monkey\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" monkey \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"4606db06-5f68-4ee1-80a0-26e3558ea14d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/session_hijacking.rb","start_line":32,"raw_source":"def encode(value)\n        value.to_s.downcase\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"encode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},\"to_s\"]},\"downcase\"]}]}","id":"d67c5cd4-6f7a-42e6-bfc7-2d1ce836c1d9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":426,"raw_source":"def arrenc(a)\n    '[' + a.map{|x| valenc(x)}.join(',') + ']'\n  end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"arrenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"[\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"send\",\"children\":[null,\"valenc\",{\"type\":\"lvar\",\"children\":[\"x\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\",\"]}]}]},\"+\",{\"type\":\"str\",\"children\":[\"]\"]}]}]}","id":"1f67089d-0394-4a2e-b667-ed8446dbd013"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":148,"raw_source":"def call(env)\n          status, headers, body = @app.call(env)\n          body.map! { |s| s.upcase }\n          [status, headers, body]\n        end","complexity_score":8.1,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"upcase\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"8e29ac04-a87d-4373-ada1-02ff8dadd08c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":636,"raw_source":"def test_replace\n    assert_equal('b b b b', @filters.replace('a a a a', 'a', 'b'))\n    assert_equal('2 2 2 2', @filters.replace('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace('1 1 1 1', 2, 3))\n    assert_template_result('2 2 2 2', \"{{ '1 1 1 1' | replace: '1', 2 }}\")\n\n    assert_equal('b a a a', @filters.replace_first('a a a a', 'a', 'b'))\n    assert_equal('2 1 1 1', @filters.replace_first('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace_first('1 1 1 1', 2, 3))\n    assert_template_result('2 1 1 1', \"{{ '1 1 1 1' | replace_first: '1', 2 }}\")\n\n    assert_equal('a a a b', @filters.replace_last('a a a a', 'a', 'b'))\n    assert_equal('1 1 1 2', @filters.replace_last('1 1 1 1', 1, 2))\n    assert_equal('1 1 1 1', @filters.replace_last('1 1 1 1', 2, 3))\n    assert_template_result('1 1 1 2', \"{{ '1 1 1 1' | replace_last: '1', 2 }}\")\n  end","complexity_score":27.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_replace\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b b b b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2 2 2 2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2 2 2 2\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace: '1', 2 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"b a a a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_first\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2 1 1 1\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace_first: '1', 2 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a a a b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"a a a a\"]},{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 2\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"replace_last\",{\"type\":\"str\",\"children\":[\"1 1 1 1\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1 1 1 2\"]},{\"type\":\"str\",\"children\":[\"{{ '1 1 1 1' | replace_last: '1', 2 }}\"]}]}]}]}","id":"bd907a6d-96e7-4726-9b31-0f003c0cc6be"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":54,"raw_source":"def size(input)\n      input.respond_to?(:size) ? input.size : 0\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"size\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"size\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"size\"]},{\"type\":\"int\",\"children\":[0]}]}]}","id":"9780dc42-9c92-4204-9137-f1171ebf941c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":16,"raw_source":"def test_simple_cycle_inside_for_loop\n    template = <<~LIQUID\n      {%- for i in (1..3) -%}\n        {% cycle '1', '2', '3' %}\n      {%- endfor -%}\n    LIQUID\n\n    assert_template_result(\"123\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_simple_cycle_inside_for_loop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- for i in (1..3) -%}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% cycle '1', '2', '3' %}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- endfor -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"123\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"5f37b37e-57ff-4a8d-8e56-9484d8b90514"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":107,"raw_source":"def compile_test(template, layout, assigns, page_template, template_file)\n    tmpl            = init_template(page_template, template_file)\n    parsed_template = tmpl.parse(template).dup\n\n    if layout\n      parsed_layout = tmpl.parse(layout)\n      { tmpl: parsed_template, assigns: assigns, layout: parsed_layout }\n    else\n      { tmpl: parsed_template, assigns: assigns }\n    end\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile_test\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"arg\",\"children\":[\"layout\"]},{\"type\":\"arg\",\"children\":[\"assigns\"]},{\"type\":\"arg\",\"children\":[\"page_template\"]},{\"type\":\"arg\",\"children\":[\"template_file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tmpl\",{\"type\":\"send\",\"children\":[null,\"init_template\",{\"type\":\"lvar\",\"children\":[\"page_template\"]},{\"type\":\"lvar\",\"children\":[\"template_file\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parsed_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"dup\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parsed_layout\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tmpl\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"layout\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tmpl\"]},{\"type\":\"lvar\",\"children\":[\"parsed_template\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"lvar\",\"children\":[\"parsed_layout\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tmpl\"]},{\"type\":\"lvar\",\"children\":[\"parsed_template\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"assigns\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}]}]}","id":"8c8d5b71-6d9b-441f-8297-16932721bf98"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block.rb","start_line":70,"raw_source":"def new_body\n      parse_context.new_block_body\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"new_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"new_block_body\"]}]}","id":"ceb0d3e8-fe78-414e-af1e-fa910e43971a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":65,"raw_source":"def registered(base = nil, &block)\n      base ? replay(base) : record(:class_eval, &block)\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"base\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},{\"type\":\"send\",\"children\":[null,\"replay\",{\"type\":\"lvar\",\"children\":[\"base\"]}]},{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"sym\",\"children\":[\"class_eval\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"2095639e-5082-4f45-b420-4e9fce57c06f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":253,"raw_source":"def test_preserve_tree_structure\n    assert_equal(\n      [[nil, [\n        [nil, [[nil, [[\"other\", []]]]]],\n        [\"test\", []],\n        [\"xs\", []],\n      ]]],\n      traversal(%({% for x in xs offset: test %}{{ other }}{% endfor %})).visit,\n    )\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_preserve_tree_structure\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"other\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"xs\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"str\",\"children\":[\"{% for x in xs offset: test %}{{ other }}{% endfor %}\"]}]},\"visit\"]}]}]}","id":"6a86d768-edb3-4560-a934-42c8466dde05"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":18,"raw_source":"def add_callback_for(*classes, &block)\n      callback = block\n      callback = ->(node, _) { yield node } if block.arity.abs == 1\n      callback = ->(_, _) { yield } if block.arity.zero?\n      classes.each { |klass| @callbacks[klass] = callback }\n      self\n    end","complexity_score":19.0,"ast_json":"{\"type\":\"def\",\"children\":[\"add_callback_for\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"classes\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"abs\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"arity\"]},\"zero?\"]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"yield\",\"children\":[]}]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"classes\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@callbacks\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"klass\"]},{\"type\":\"lvar\",\"children\":[\"callback\"]}]}]},{\"type\":\"self\",\"children\":[]}]}]}","id":"b02a9bcd-40c6-462e-86bd-21107932ee1b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":13,"raw_source":"def test_variable_beginning\n    template = Liquid::Template.parse(\"{{funk}}  \")\n    assert_equal(2, template.root.nodelist.size)\n    assert_equal(Variable, template.root.nodelist[0].class)\n    assert_equal(String, template.root.nodelist[1].class)\n  end","complexity_score":21.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_beginning\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{funk}}  \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]},\"class\"]}]}]}]}","id":"727ee0b6-9bc4-414b-9bc7-7b1274817220"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":51,"raw_source":"def test_expression_with_whitespace_in_square_brackets\n    source = \"{% assign r = a[ 'b' ] %}{{ r }}\"\n    assert_template_result('result', source, { 'a' => { 'b' => 'result' } })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_with_whitespace_in_square_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% assign r = a[ 'b' ] %}{{ r }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"str\",\"children\":[\"result\"]}]}]}]}]}]}]}]}","id":"e3775477-3b21-467a-bde2-8f37515b12cb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":75,"raw_source":"def self.test_name(name)\n    name = \"test_#{sanitize_name(name).gsub(/\\s+/,'_')}_0\"\n    name = name.succ while method_defined? name\n    name.to_sym\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"test_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"test_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"str\",\"children\":[\"_\"]}]}]},{\"type\":\"str\",\"children\":[\"_0\"]}]}]},{\"type\":\"while\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_defined?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"succ\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"to_sym\"]}]}]}","id":"7b29b609-1eff-4e15-93fb-b453c75a9042"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":38,"raw_source":"def parse(tokens)\n      @body = +\"\"\n\n      while (token = tokens.shift)\n        tag_name = token =~ BlockBody::FullTokenPossiblyInvalid && Regexp.last_match(2)\n\n        raise_nested_doc_error if tag_name == @tag_name\n\n        if tag_name == block_delimiter\n          parse_context.trim_whitespace = (token[-3] == WhitespaceControl)\n          @body << Regexp.last_match(1) if Regexp.last_match(1) != \"\"\n          return\n        end\n        @body << token unless token.empty?\n      end\n\n      raise_tag_never_closed(block_name)\n    end","complexity_score":38.75,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@body\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokens\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"FullTokenPossiblyInvalid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@tag_name\"]}]},{\"type\":\"send\",\"children\":[null,\"raise_nested_doc_error\"]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"block_delimiter\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[-3]}]},\"==\",{\"type\":\"const\",\"children\":[null,\"WhitespaceControl\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},null]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},null,{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@body\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_tag_never_closed\",{\"type\":\"send\",\"children\":[null,\"block_name\"]}]}]}]}","id":"e0b83f9c-ad7b-4743-bf13-e2112b96e443"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1566,"raw_source":"def register(*extensions, &block)\n        extensions << Module.new(&block) if block_given?\n        @extensions += extensions\n        extensions.each do |extension|\n          extend extension\n          extension.registered(self) if extension.respond_to?(:registered)\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"extension\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"lvar\",\"children\":[\"extension\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"registered\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"registered\",{\"type\":\"self\",\"children\":[]}]},null]}]}]}]}]}","id":"7c9b44c7-a029-41a3-b2a3-019c783992df"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tokenizer_unit_test.rb","start_line":38,"raw_source":"def test_incomplete_curly_braces\n    assert_equal([\"{{.}\", \" \"], tokenize('{{.} '))\n    assert_equal([\"{{}\", \"%}\"], tokenize('{{}%}'))\n    assert_equal([\"{{}}\", \"}\"], tokenize('{{}}}'))\n  end","complexity_score":6.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_incomplete_curly_braces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{.}\"]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{.} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{}\"]},{\"type\":\"str\",\"children\":[\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{}%}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"{{}}\"]},{\"type\":\"str\",\"children\":[\"}\"]}]},{\"type\":\"send\",\"children\":[null,\"tokenize\",{\"type\":\"str\",\"children\":[\"{{}}}\"]}]}]}]}]}","id":"86bc4e0b-3dbf-4d95-b436-cc84275f5d5e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":863,"raw_source":"def round(input, n = 0)\n      result = Utils.to_number(input).round(Utils.to_number(n))\n      result = result.to_f if result.is_a?(BigDecimal)\n      result = result.to_i if n == 0\n      result\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":20.7,"ast_json":"{\"type\":\"def\",\"children\":[\"round\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"n\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"round\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"n\"]},\"==\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_i\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}","id":"1cd7d363-63c2-45c5-92b5-a595788ee522"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":842,"raw_source":"def test_default_handle_false\n    assert_equal(\"foo\", @filters.default(\"foo\", \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default(nil, \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default(\"\", \"bar\", \"allow_false\" => true))\n    assert_equal(false, @filters.default(false, \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default([], \"bar\", \"allow_false\" => true))\n    assert_equal(\"bar\", @filters.default({}, \"bar\", \"allow_false\" => true))\n    assert_template_result('false', \"{{ false | default: 'bar', allow_false: true }}\")\n    assert_template_result('Nay', \"{{ drop | default: 'bar', allow_false: true }}\", { 'drop' => BooleanDrop.new(false) })\n    assert_template_result('Yay', \"{{ drop | default: 'bar', allow_false: true }}\", { 'drop' => BooleanDrop.new(true) })\n  end","complexity_score":18.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_handle_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"false\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"default\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"allow_false\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"false\"]},{\"type\":\"str\",\"children\":[\"{{ false | default: 'bar', allow_false: true }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Nay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar', allow_false: true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Yay\"]},{\"type\":\"str\",\"children\":[\"{{ drop | default: 'bar', allow_false: true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}","id":"8d83e447-7f9f-4034-a0a4-be281b9f0630"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":90,"raw_source":"def setup\n    @context = Liquid::Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]}]}","id":"857e6f78-8f2a-4687-a24f-3ad7cff1fcd2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":62,"raw_source":"def mkcol?\n        request_method == 'MKCOL'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"mkcol?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"MKCOL\"]}]}]}","id":"20249576-2996-4bc9-af67-b21b213915bf"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":905,"raw_source":"def at_least(input, n)\n      min_value = Utils.to_number(n)\n\n      result = Utils.to_number(input)\n      result = min_value if min_value > result\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"at_least\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"n\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"min_value\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"min_value\"]},\">\",{\"type\":\"lvar\",\"children\":[\"result\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"lvar\",\"children\":[\"min_value\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"5c0b2c46-d825-4412-8ff5-1a82c4aa3333"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_helper.rb","start_line":54,"raw_source":"def installed?\n      return @installed unless @installed.nil?\n      s = server == 'HTTP' ? 'net/http/server' : server\n      require s\n      @installed = true\n    rescue LoadError\n      warn \"#{server} is not installed, skipping integration tests\"\n      @installed = false\n    end","complexity_score":15.6,"ast_json":"{\"type\":\"def\",\"children\":[\"installed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@installed\"]},\"nil?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@installed\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"s\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]},\"==\",{\"type\":\"str\",\"children\":[\"HTTP\"]}]},{\"type\":\"str\",\"children\":[\"net/http/server\"]},{\"type\":\"send\",\"children\":[null,\"server\"]}]}]},{\"type\":\"send\",\"children\":[null,\"require\",{\"type\":\"lvar\",\"children\":[\"s\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@installed\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"LoadError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"server\"]}]},{\"type\":\"str\",\"children\":[\" is not installed, skipping integration tests\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@installed\",{\"type\":\"false\",\"children\":[]}]}]}]},null]}]}","id":"cd3d72d9-26f0-43d5-a078-c9b0e0d000dc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":156,"raw_source":"def get_https_url(uri)\n      http = Net::HTTP.new(uri.host, uri.port)\n      http.use_ssl      = true\n      http.verify_mode  = OpenSSL::SSL::VERIFY_NONE\n      request = Net::HTTP::Get.new(uri.request_uri)\n      http.request(request).body\n    end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"get_https_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"http\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"host\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"port\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"use_ssl=\",{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"verify_mode=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OpenSSL\"]},\"SSL\"]},\"VERIFY_NONE\"]}]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Net\"]},\"HTTP\"]},\"Get\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"request_uri\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"http\"]},\"request\",{\"type\":\"lvar\",\"children\":[\"request\"]}]},\"body\"]}]}]}","id":"eb30b9c9-7582-42a1-b5b1-6af94ea0521c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":212,"raw_source":"def template_cache\n        super.fetch(:nested, @namespace) { TemplateCache.new }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"template_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},\"fetch\",{\"type\":\"sym\",\"children\":[\"nested\"]},{\"type\":\"ivar\",\"children\":[\"@namespace\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateCache\"]},\"new\"]}]}]}","id":"010a2636-b298-4974-8f14-669c44a9354f"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/memory_profile.rb","start_line":40,"raw_source":"def tabulate\n    table = Terminal::Table.new(headings: @headings.unshift('Phase')) do |t|\n      t << @allocated.unshift('Total allocated')\n      t << @retained.unshift('Total retained')\n    end\n\n    puts\n    puts table\n    puts \"\\nDetailed report(s) saved to #{REPORTS_DIR}/\" unless ENV['CI']\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"tabulate\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"table\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Terminal\"]},\"Table\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"headings\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@headings\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Phase\"]}]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"t\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@allocated\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Total allocated\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@retained\"]},\"unshift\",{\"type\":\"str\",\"children\":[\"Total retained\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"puts\"]},{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"lvar\",\"children\":[\"table\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"CI\"]}]},null,{\"type\":\"send\",\"children\":[null,\"puts\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\nDetailed report(s) saved to \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"const\",\"children\":[null,\"REPORTS_DIR\"]}]},{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}]}]}","id":"9009dda3-a666-4a80-b537-fef7ffb1c4e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":38,"raw_source":"def test_doc_tag_does_not_support_extra_arguments\n    error = assert_raises(Liquid::SyntaxError) do\n      template = <<~LIQUID.chomp\n        {% doc extra %}\n        {% enddoc %}\n      LIQUID\n\n      Liquid::Template.parse(template)\n    end\n\n    exp_error = \"Liquid syntax error: Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"\n    act_error = error.message\n\n    assert_equal(exp_error, act_error)\n  end","complexity_score":10.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_does_not_support_extra_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc extra %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"exp_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error: Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"act_error\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"exp_error\"]},{\"type\":\"lvar\",\"children\":[\"act_error\"]}]}]}]}","id":"1791cf06-dc5d-428a-a15f-3b86e939529e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/path_traversal.rb","start_line":23,"raw_source":"def cleanup(path)\n        encoding = path.encoding\n        dot   = '.'.encode(encoding)\n        slash = '/'.encode(encoding)\n        backslash = '\\\\'.encode(encoding)\n\n        parts     = []\n        unescaped = path.gsub(/%2e/i, dot).gsub(/%2f/i, slash).gsub(/%5c/i, backslash)\n        unescaped = unescaped.gsub(backslash, slash)\n\n        unescaped.split(slash).each do |part|\n          next if part.empty? || (part == dot)\n\n          part == '..' ? parts.pop : parts << part\n        end\n\n        cleaned = slash + parts.join(slash)\n        cleaned << slash if parts.any? && unescaped =~ (%r{/\\.{0,2}$})\n        cleaned\n      end","complexity_score":36.2,"ast_json":"{\"type\":\"def\",\"children\":[\"cleanup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"encoding\"]}]},{\"type\":\"lvasgn\",\"children\":[\"dot\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\".\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"slash\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"/\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"backslash\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\\"]},\"encode\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"unescaped\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%2e\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"dot\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%2f\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"slash\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%5c\"]},{\"type\":\"regopt\",\"children\":[\"i\"]}]},{\"type\":\"lvar\",\"children\":[\"backslash\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"unescaped\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"backslash\"]},{\"type\":\"lvar\",\"children\":[\"slash\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"split\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"part\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"empty?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"==\",{\"type\":\"lvar\",\"children\":[\"dot\"]}]}]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"part\"]},\"==\",{\"type\":\"str\",\"children\":[\"..\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"pop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"part\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cleaned\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"slash\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parts\"]},\"any?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"unescaped\"]},\"=~\",{\"type\":\"begin\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"/\\\\.{0,2}$\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cleaned\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"slash\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"cleaned\"]}]}]}","id":"3b117084-073a-4f1b-a593-55efec5a7a32"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/helpers_test.rb","start_line":10,"raw_source":"def status_app(code, &block)\n    code += 2 if [204, 304].include? code\n    block ||= proc { }\n    mock_app do\n      get('/') do\n        status code\n        instance_eval(&block).inspect\n      end\n    end\n    get '/'\n  end","complexity_score":25.13,"ast_json":"{\"type\":\"def\",\"children\":[\"status_app\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"code\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[204]},{\"type\":\"int\",\"children\":[304]}]},\"include?\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\"]},\"+\",{\"type\":\"int\",\"children\":[2]}]},null]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},\"inspect\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"44d0fef1-c135-4b49-a209-84b438cdbb5d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":55,"raw_source":"def accepts?(env)\n        return true if options[:allow_if]&.call(env)\n        return true if @all_permitted_hosts.empty?\n\n        request = Request.new(env)\n        origin_host = extract_host(request.host_authority)\n        forwarded_host = extract_host(request.forwarded_authority)\n\n        debug env, \"#{self.class} \" \\\n                   \"@all_permitted_hosts=#{@all_permitted_hosts.inspect} \" \\\n                   \"@permitted_hosts=#{@permitted_hosts.inspect} \" \\\n                   \"@domain_hosts=#{@domain_hosts.inspect} \" \\\n                   \"@ip_hosts=#{@ip_hosts.inspect} \" \\\n                   \"origin_host=#{origin_host.inspect} \" \\\n                   \"forwarded_host=#{forwarded_host.inspect}\"\n\n        if host_permitted?(origin_host)\n          if forwarded_host.nil?\n            true\n          else\n            host_permitted?(forwarded_host)\n          end\n        else\n          false\n        end\n      end","complexity_score":30.0,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"csend\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"allow_if\"]}]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"true\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"origin_host\",{\"type\":\"send\",\"children\":[null,\"extract_host\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host_authority\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"forwarded_host\",{\"type\":\"send\",\"children\":[null,\"extract_host\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"forwarded_authority\"]}]}]},{\"type\":\"send\",\"children\":[null,\"debug\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@all_permitted_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@all_permitted_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@permitted_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@permitted_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@domain_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@domain_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"@ip_hosts=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"origin_host=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"origin_host\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"forwarded_host=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]},\"inspect\"]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"host_permitted?\",{\"type\":\"lvar\",\"children\":[\"origin_host\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]},\"nil?\"]},{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"host_permitted?\",{\"type\":\"lvar\",\"children\":[\"forwarded_host\"]}]}]},{\"type\":\"false\",\"children\":[]}]}]}]}","id":"acff2650-f6fb-42bc-ac86-5368da9eb784"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":563,"raw_source":"def test_map_with_value_property\n    array = [\n      { \"handle\" => \"alpha\", \"value\" => \"A\" },\n      { \"handle\" => \"beta\", \"value\" => \"B\" },\n      { \"handle\" => \"gamma\", \"value\" => \"C\" }\n    ]\n\n    assert_template_result(\"A B C\", \"{{ array | map: 'value' | join: ' ' }}\", { \"array\" => array })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_with_value_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"B\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A B C\"]},{\"type\":\"str\",\"children\":[\"{{ array | map: 'value' | join: ' ' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"fc31b4e6-f5f1-4ef0-ae3f-ce923b368cf0"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":85,"raw_source":"def variable_lookups\n      str = +\"\"\n      loop do\n        if look(:open_square)\n          str << consume\n          str << expression\n          str << consume(:close_square)\n        elsif look(:dot)\n          str << consume\n          str << consume(:id)\n        else\n          break\n        end\n      end\n      str\n    end","complexity_score":23.0,"ast_json":"{\"type\":\"def\",\"children\":[\"variable_lookups\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"loop\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"open_square\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"expression\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"close_square\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"look\",{\"type\":\"sym\",\"children\":[\"dot\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]}]},{\"type\":\"break\",\"children\":[]}]}]}]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}","id":"b981941e-6908-4197-9768-55761752b2bc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rack_test.rb","start_line":18,"raw_source":"def check(*middleware)\n    build(*middleware)\n    assert get('/foo').ok?\n    assert_body 'foo'\n    assert get('/bar').ok?\n    assert_body 'bar'\n  end","complexity_score":10.2,"ast_json":"{\"type\":\"def\",\"children\":[\"check\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"middleware\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"build\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"middleware\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/foo\"]}]},\"ok?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_body\",{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/bar\"]}]},\"ok?\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_body\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}","id":"eab05c69-618e-4b9f-aedd-e7aafabcaa22"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":98,"raw_source":"def children\n      children = @root_children\n      if children.length == 1\n        children.first.children\n      else\n        children\n      end\n    end","complexity_score":6.9,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"children\",{\"type\":\"ivar\",\"children\":[\"@root_children\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"length\"]},\"==\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"children\"]},\"first\"]},\"children\"]},{\"type\":\"lvar\",\"children\":[\"children\"]}]}]}]}","id":"88dbf8d2-8316-4c32-a98d-f5bacf27eccd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":134,"raw_source":"def secure_compare(a, b)\n        Rack::Utils.secure_compare(a.to_s, b.to_s)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"secure_compare\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"secure_compare\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"to_s\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"to_s\"]}]}]}","id":"c97da821-7521-4568-be41-1e09494fd280"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":44,"raw_source":"def accepts?(env)\n        raise NotImplementedError, \"#{self.class} implementation pending\"\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"NotImplementedError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" implementation pending\"]}]}]}]}","id":"43171744-38dc-4a4b-a938-7fb36e1b90c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_factory_unit_test.rb","start_line":8,"raw_source":"def test_for_returns_liquid_template_instance\n    template = TemplateFactory.new.for(\"anything\")\n    assert_instance_of(Liquid::Template, template)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_returns_liquid_template_instance\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateFactory\"]},\"new\"]},\"for\",{\"type\":\"str\",\"children\":[\"anything\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"c3d27c3d-6ac8-4550-8fbe-ae30fb1c8e80"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":82,"raw_source":"def test_contains_works_on_arrays\n    @context          = Liquid::Context.new\n    @context['array'] = [1, 2, 3, 4, 5]\n    array_expr        = VariableLookup.new(\"array\")\n\n    assert_evaluates_false(array_expr, 'contains', 0)\n    assert_evaluates_true(array_expr, 'contains', 1)\n    assert_evaluates_true(array_expr, 'contains', 2)\n    assert_evaluates_true(array_expr, 'contains', 3)\n    assert_evaluates_true(array_expr, 'contains', 4)\n    assert_evaluates_true(array_expr, 'contains', 5)\n    assert_evaluates_false(array_expr, 'contains', 6)\n    assert_evaluates_false(array_expr, 'contains', \"1\")\n  end","complexity_score":16.05,"ast_json":"{\"type\":\"def\",\"children\":[\"test_contains_works_on_arrays\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"lvasgn\",\"children\":[\"array_expr\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"array\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_true\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[5]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"int\",\"children\":[6]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"lvar\",\"children\":[\"array_expr\"]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}","id":"17582b89-c8d8-4c83-9b0a-c34e1750e4c1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1921,"raw_source":"def self.force_encoding(data, encoding = default_encoding)\n      return if data == settings || data.is_a?(Tempfile)\n\n      if data.respond_to? :force_encoding\n        data.force_encoding(encoding).encode!\n      elsif data.respond_to? :each_value\n        data.each_value { |v| force_encoding(v, encoding) }\n      elsif data.respond_to? :each\n        data.each { |v| force_encoding(v, encoding) }\n      end\n      data\n    end","complexity_score":24.2,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"force_encoding\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]},{\"type\":\"optarg\",\"children\":[\"encoding\",{\"type\":\"send\",\"children\":[null,\"default_encoding\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"settings\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Tempfile\"]}]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"force_encoding\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},\"encode!\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each_value\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each_value\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"each\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"data\"]}]}]}","id":"5646a0b2-4dc9-4d93-b10d-782b6f0f0f67"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":113,"raw_source":"def test_hash_with_default_proc\n    template        = Template.parse(%(Hello {{ test }}))\n    assigns         = Hash.new { |_h, k| raise \"Unknown variable '#{k}'\" }\n    assigns['test'] = 'Tobi'\n    assert_equal('Hello Tobi', template.render!(assigns))\n    assigns.delete('test')\n    e = assert_raises(RuntimeError) do\n      template.render!(assigns)\n    end\n    assert_equal(\"Unknown variable 'test'\", e.message)\n  end","complexity_score":16.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_with_default_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"Hello {{ test }}\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_h\"]},{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Unknown variable '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"Tobi\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello Tobi\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"assigns\"]},\"delete\",{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"RuntimeError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\",{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unknown variable 'test'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]}]}","id":"c580d872-21d2-4574-88e4-89a43c663eab"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":18,"raw_source":"def test_no_instance_eval\n    text     = %( {{ '1+1' | instance_eval }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_instance_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | instance_eval }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}","id":"03d8ada6-f9a8-4481-8655-f1c6e48b2239"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":92,"raw_source":"def test_variable_piping_with_multiple_args\n    text     = %( {{ car.gm | add_tag : 'span', 'bar'}} )\n    expected = %( <span id=\"bar\">bad</span> )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_multiple_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_tag : 'span', 'bar'}} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" <span id=\\\"bar\\\">bad</span> \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"bec47006-4b79-4b3b-bc84-accb412f8742"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":175,"raw_source":"def initialize(path)\n        @ignore = nil\n        @path = path\n        @elements = []\n        update\n      end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@ignore\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@elements\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"update\"]}]}]}","id":"32dc63fc-0062-410d-84b7-123f2e97926b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":61,"raw_source":"def configure(*args, &block)\n      record(:configure, *args) { |c| c.instance_exec(c, &block) }\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"configure\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"record\",{\"type\":\"sym\",\"children\":[\"configure\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"instance_exec\",{\"type\":\"lvar\",\"children\":[\"c\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"1f8a115e-fb57-42b5-a312-232497ac96c0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/authenticity_token.rb","start_line":207,"raw_source":"def compare_with_global_token(token, session)\n        secure_compare(token, global_token(session))\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compare_with_global_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"session\"]}]},{\"type\":\"send\",\"children\":[null,\"secure_compare\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[null,\"global_token\",{\"type\":\"lvar\",\"children\":[\"session\"]}]}]}]}","id":"56223047-153d-4cf3-864b-7e5f1302e1e2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/streaming_spec.rb","start_line":4,"raw_source":"def stream(&block)\n    rack_middleware = @use\n    out = nil\n    mock_app do\n      rack_middleware.each { |args| use(*args) }\n      helpers Sinatra::Streaming\n      get('/') { out = stream(&block) }\n    end\n    get('/')\n    out\n  end","complexity_score":16.4,"ast_json":"{\"type\":\"def\",\"children\":[\"stream\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"rack_middleware\",{\"type\":\"ivar\",\"children\":[\"@use\"]}]},{\"type\":\"lvasgn\",\"children\":[\"out\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"rack_middleware\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"send\",\"children\":[null,\"use\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"helpers\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Streaming\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvasgn\",\"children\":[\"out\",{\"type\":\"send\",\"children\":[null,\"stream\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]},{\"type\":\"lvar\",\"children\":[\"out\"]}]}]}","id":"30f4fd9d-7e63-4435-94cd-a33dc533333d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":824,"raw_source":"def find_template(views, name, engine)\n      yield ::File.join(views, \"#{name}.#{@preferred_extension}\")\n\n      Tilt.default_mapping.extensions_for(engine).each do |ext|\n        yield ::File.join(views, \"#{name}.#{ext}\") unless ext == @preferred_extension\n      end\n    end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"find_template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"views\"]},{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@preferred_extension\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"default_mapping\"]},\"extensions_for\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"==\",{\"type\":\"ivar\",\"children\":[\"@preferred_extension\"]}]},null,{\"type\":\"yield\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"File\"]},\"join\",{\"type\":\"lvar\",\"children\":[\"views\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}]}]}]}]}","id":"e61fc1c7-5b48-4b85-952e-064a2f441a05"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":119,"raw_source":"def pairparse(ts)\n    (typ, _, k), ts = ts[0], ts[1..-1]\n    if typ != :str\n      raise Error, \"unexpected #{k.inspect}\"\n    end\n    ts = eat(':', ts)\n    v, ts = valparse(ts)\n    [k, v, ts]\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"pairparse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"typ\"]},{\"type\":\"lvasgn\",\"children\":[\"_\"]},{\"type\":\"lvasgn\",\"children\":[\"k\"]}]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ts\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-1]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"typ\"]},\"!=\",{\"type\":\"sym\",\"children\":[\"str\"]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"unexpected \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"inspect\"]}]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"ts\",{\"type\":\"send\",\"children\":[null,\"eat\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"v\"]},{\"type\":\"lvasgn\",\"children\":[\"ts\"]}]},{\"type\":\"send\",\"children\":[null,\"valparse\",{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},{\"type\":\"lvar\",\"children\":[\"v\"]},{\"type\":\"lvar\",\"children\":[\"ts\"]}]}]}]}","id":"cd0c07ed-d15e-42de-85b1-cd26471f1a98"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":26,"raw_source":"def increment_write_score(output)\n      if (last_captured = @last_capture_length)\n        captured = output.bytesize\n        increment = captured - last_captured\n        @last_capture_length = captured\n        increment_assign_score(increment)\n      elsif @render_length_limit && output.bytesize > @render_length_limit\n        raise_limits_reached\n      end\n    end","complexity_score":15.2,"ast_json":"{\"type\":\"def\",\"children\":[\"increment_write_score\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"last_captured\",{\"type\":\"ivar\",\"children\":[\"@last_capture_length\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"captured\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"bytesize\"]}]},{\"type\":\"lvasgn\",\"children\":[\"increment\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"captured\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"last_captured\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@last_capture_length\",{\"type\":\"lvar\",\"children\":[\"captured\"]}]},{\"type\":\"send\",\"children\":[null,\"increment_assign_score\",{\"type\":\"lvar\",\"children\":[\"increment\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@render_length_limit\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"bytesize\"]},\">\",{\"type\":\"ivar\",\"children\":[\"@render_length_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise_limits_reached\"]},null]}]}]}","id":"c04a6e16-9f87-424e-8c5e-170b5b9876de"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":54,"raw_source":"def test_doc_tag_must_support_valid_tags\n    assert_match_syntax_error(\"Liquid syntax error (line 1): 'doc' tag was never closed\", '{% doc %} foo')\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\", '{% doc } foo {% enddoc %}')\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\", '{% doc } foo %}{% enddoc %}')\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_must_support_valid_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): 'doc' tag was never closed\"]},{\"type\":\"str\",\"children\":[\"{% doc %} foo\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]},{\"type\":\"str\",\"children\":[\"{% doc } foo {% enddoc %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Syntax Error in 'doc' - Valid syntax: {% doc %}{% enddoc %}\"]},{\"type\":\"str\",\"children\":[\"{% doc } foo %}{% enddoc %}\"]}]}]}]}","id":"1f7c95dd-b32b-443a-a78a-9a7f0d1601c5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":102,"raw_source":"def assert_like(a,b)\n    pattern = /id=['\"][^\"']*[\"']|\\s+/\n    assert_equal a.strip.gsub(pattern, \"\"), b.strip.gsub(pattern, \"\")\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_like\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"id=['\\\"][^\\\"']*[\\\"']|\\\\s+\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"strip\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"strip\"]},\"gsub\",{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]}]}","id":"9b6482f2-c105-448d-af08-3a4ef4622c21"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":46,"raw_source":"def test_parse_makes_available_simple_profiling\n    t = Template.parse(\"{{ 'a string' | upcase }}\", profile: true)\n    t.render!\n\n    assert_equal(1, t.profiler.length)\n\n    node = t.profiler[0]\n    assert_equal(\" 'a string' | upcase \", node.code)\n  end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_parse_makes_available_simple_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"length\"]}]},{\"type\":\"lvasgn\",\"children\":[\"node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" 'a string' | upcase \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"code\"]}]}]}]}","id":"45e9fb43-6e73-44a7-a320-7ece6e7196ef"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":127,"raw_source":"private def parse_for_document(tokenizer, parse_context, &block)\n      while (token = tokenizer.shift)\n        next if token.empty?\n        case\n        when token.start_with?(TAGSTART)\n          whitespace_handler(token, parse_context)\n          unless token =~ FullToken\n            return handle_invalid_tag_token(token, parse_context, &block)\n          end\n          tag_name = Regexp.last_match(2)\n          markup   = Regexp.last_match(4)\n\n          if parse_context.line_number\n            # newlines inside the tag should increase the line number,\n            # particularly important for multiline {% liquid %} tags\n            parse_context.line_number += Regexp.last_match(1).count(\"\\n\") + Regexp.last_match(3).count(\"\\n\")\n          end\n\n          if tag_name == 'liquid'\n            parse_liquid_tag(markup, parse_context)\n            next\n          end\n\n          unless (tag = parse_context.environment.tag_for_name(tag_name))\n            # end parsing if we reach an unknown tag and let the caller decide\n            # determine how to proceed\n            return yield tag_name, markup\n          end\n          new_tag = tag.parse(tag_name, markup, tokenizer, parse_context)\n          @blank &&= new_tag.blank?\n          @nodelist << new_tag\n        when token.start_with?(VARSTART)\n          whitespace_handler(token, parse_context)\n          @nodelist << create_variable(token, parse_context)\n          @blank = false\n        else\n          if parse_context.trim_whitespace\n            token.lstrip!\n          end\n          parse_context.trim_whitespace = false\n          @nodelist << token\n          @blank &&= token.match?(WhitespaceOrNothing)\n        end\n        parse_context.line_number = tokenizer.line_number\n      end\n\n      yield nil, nil\n    end","complexity_score":87.15,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_for_document\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"case\",\"children\":[null,{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"TAGSTART\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"whitespace_handler\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"FullToken\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handle_invalid_tag_token\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[3]}]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"str\",\"children\":[\"liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"next\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"environment\"]},\"tag_for_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_tag\"]},\"blank?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"new_tag\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"start_with?\",{\"type\":\"const\",\"children\":[null,\"VARSTART\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"whitespace_handler\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@blank\",{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"lstrip!\"]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"trim_whitespace=\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[null,\"WhitespaceOrNothing\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"287d0650-ffde-40ff-8a12-066a0a84c799"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":61,"raw_source":"def test_var_strings_equal\n    text = ' {% if var == \"hello there!\" %} true {% else %} false {% endif %} '\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_strings_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == \\\"hello there!\\\" %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}","id":"146ea5d0-549e-4529-9b79-d3543b79b9de"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":162,"raw_source":"def test_protected\n    output = Liquid::Template.parse(' {{ product.callmenot }} ').render!('product' => ProductDrop.new)\n    assert_equal('  ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_protected\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.callmenot }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"  \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"9ae3994e-1f4e-4446-88fe-4c86a2f73f6f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":241,"raw_source":"def tag_disabled?(tag_name)\n      @disabled_tags.fetch(tag_name, 0) > 0\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tag_disabled?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@disabled_tags\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"int\",\"children\":[0]}]},\">\",{\"type\":\"int\",\"children\":[0]}]}]}","id":"39977f56-a967-4f9e-80fc-787576437e78"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tablerowloop_drop.rb","start_line":88,"raw_source":"def last\n      @index == @length - 1\n    end","complexity_score":2.55,"ast_json":"{\"type\":\"def\",\"children\":[\"last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@index\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@length\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"784bb6ae-2a2d-46dd-8fee-c91b15dfcb2d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":107,"raw_source":"def test_dashes\n    assert_equal(VariableLookup.new('foo-bar'), create_variable('foo-bar').name)\n    assert_equal(VariableLookup.new('foo-bar-2'), create_variable('foo-bar-2').name)\n\n    with_error_mode(:strict) do\n      assert_raises(Liquid::SyntaxError) { create_variable('foo - bar') }\n      assert_raises(Liquid::SyntaxError) { create_variable('-foo') }\n      assert_raises(Liquid::SyntaxError) { create_variable('2foo') }\n    end\n  end","complexity_score":22.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_dashes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo-bar\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo-bar\"]}]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"foo-bar-2\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo-bar-2\"]}]},\"name\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"strict\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"foo - bar\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"-foo\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\"2foo\"]}]}]}]}]}]}]}","id":"8df50cf2-ce7c-4f24-b5c5-8b676309ee2a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/regexp_unit_test.rb","start_line":35,"raw_source":"def test_quoted_words_in_the_middle\n    assert_equal(['arg1', 'arg2', '\"arg 3\"', 'arg4'], 'arg1 arg2 \"arg 3\" arg4   '.scan(QuotedFragment))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_quoted_words_in_the_middle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1\"]},{\"type\":\"str\",\"children\":[\"arg2\"]},{\"type\":\"str\",\"children\":[\"\\\"arg 3\\\"\"]},{\"type\":\"str\",\"children\":[\"arg4\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"arg1 arg2 \\\"arg 3\\\" arg4   \"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"QuotedFragment\"]}]}]}]}","id":"7d41efd9-c85a-4c5f-ab73-3a8ed3443000"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":9,"raw_source":"def self.parse(markup, string_scanner = StringScanner.new(\"\"), cache = nil)\n      new(markup, string_scanner, cache)\n    end","complexity_score":4.0,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]}","id":"ea92a875-ffc7-4fba-aed5-815fe28a8cb4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":70,"raw_source":"def call(env)\n      req = Rack::Request.new(env)\n      req.update_param('bar', 'baz'.freeze)\n      super\n    end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"req\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"req\"]},\"update_param\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"baz\"]},\"freeze\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"f6e435fc-95e3-4773-afe8-32c3103c507d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":120,"raw_source":"def test_case_when_body\n    assert_equal(\n      [\"test\"],\n      visit(%({% case 1 %}{% when 2 %}{{ test }}{% endcase %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% case 1 %}{% when 2 %}{{ test }}{% endcase %}\"]}]}]}]}","id":"3926b37b-8f39-4dc7-9f13-cf4040a5a286"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":176,"raw_source":"def template_for(name, exts)\n        # in production this is cached, so don't worry too much about runtime\n        possible = []\n        settings.template_engines[:all].each do |engine|\n          exts.each { |ext| possible << [engine, \"#{name}.#{ext}\"] }\n        end\n\n        exts.each do |ext|\n          settings.template_engines[ext].each { |e| possible << [e, name] }\n        end\n\n        possible.each do |engine, template|\n          klass = Tilt.default_mapping.template_map[engine.to_s] ||\n                  Tilt.lazy_map[engine.to_s].fetch(0, [])[0]\n\n          find_template(settings.views, template, klass) do |file|\n            next unless File.exist? file\n\n            return settings.rendering_method(engine) << template.to_sym\n          end\n        end\n        [] # nil or false would not be cached\n      end","complexity_score":53.8,"ast_json":"{\"type\":\"def\",\"children\":[\"template_for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"exts\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"possible\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"template_engines\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"all\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ext\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"template_engines\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"ext\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},{\"type\":\"lvar\",\"children\":[\"name\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"possible\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"default_mapping\"]},\"template_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"lazy_map\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"engine\"]},\"to_s\"]}]},\"fetch\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"array\",\"children\":[]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"find_template\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"views\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"file\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"rendering_method\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"to_sym\"]}]}]}]}]}]}]},{\"type\":\"array\",\"children\":[]}]}]}","id":"1eab9ce1-c47d-44ef-a0c0-c43040af11d4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":439,"raw_source":"def test_nested_lambda_is_called_once\n    @global = 0\n\n    @context['callcount'] = {\n      \"lambda\" => proc {\n                    @global += 1\n                    @global.to_s\n                  },\n    }\n\n    assert_equal('1', @context['callcount.lambda'])\n    assert_equal('1', @context['callcount.lambda'])\n    assert_equal('1', @context['callcount.lambda'])\n  end","complexity_score":14.55,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_lambda_is_called_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"callcount\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"lambda\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@global\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@global\"]},\"to_s\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"callcount.lambda\"]}]}]}]}]}","id":"6c064e41-a18a-44e6-8ec8-933ca57da90b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":63,"raw_source":"def self.example(desc = nil, &block)\n    @example_count = 0 unless instance_variable_defined? :@example_count\n    @example_count += 1\n    it(desc || \"Example #{@example_count}\", &block)\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"example\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"desc\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"instance_variable_defined?\",{\"type\":\"sym\",\"children\":[\"@example_count\"]}]},null,{\"type\":\"ivasgn\",\"children\":[\"@example_count\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@example_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"it\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"desc\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Example \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@example_count\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"15cc33ff-5982-4d27-b6fc-c03e35eda498"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":67,"raw_source":"def test_comparation_of_int_and_str\n    assert_evaluates_argument_error('1', '>', 0)\n    assert_evaluates_argument_error('1', '<', 0)\n    assert_evaluates_argument_error('1', '>=', 0)\n    assert_evaluates_argument_error('1', '<=', 0)\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comparation_of_int_and_str\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_argument_error\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"2ce46df6-e0d7-4e2e-b83a-f7d75d7c271e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/errors.rb","start_line":9,"raw_source":"def to_s(with_prefix = true)\n      str = +\"\"\n      str << message_prefix if with_prefix\n      str << super()\n\n      if markup_context\n        str << \" \"\n        str << markup_context\n      end\n\n      str\n    end","complexity_score":14.4,"ast_json":"{\"type\":\"def\",\"children\":[\"to_s\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"with_prefix\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"str\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"with_prefix\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"message_prefix\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"super\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"markup_context\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"str\",\"children\":[\" \"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"str\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"markup_context\"]}]}]},null]},{\"type\":\"lvar\",\"children\":[\"str\"]}]}]}","id":"18de0345-a3bd-4fa8-bfa8-eb66bf009f4c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":13,"raw_source":"def test_with_custom_tag\n    with_custom_tag('testtag', Block) do\n      assert(Liquid::Template.parse(\"{% testtag %} {% endtesttag %}\"))\n    end\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_with_custom_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"testtag\"]},{\"type\":\"const\",\"children\":[null,\"Block\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% testtag %} {% endtesttag %}\"]}]}]}]}]}","id":"d78f783f-0506-497a-b16a-f1066fe0f73f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":25,"raw_source":"def test_tags_can_be_looped_over\n    with_custom_tag('fake', FakeTag) do\n      result = Template.tags.map { |name, klass| [name, klass] }\n      assert(result.include?([\"fake\", TemplateUnitTest::FakeTag]))\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_tags_can_be_looped_over\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"const\",\"children\":[null,\"FakeTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"tags\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"include?\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"fake\"]},{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TemplateUnitTest\"]},\"FakeTag\"]}]}]}]}]}]}]}","id":"1eb22bdb-8ddd-4483-9333-c273f3ebe1bc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":176,"raw_source":"def test_profiling_supports_rendering_the_same_partial_multiple_times\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    a_template1 = t.profiler[1]\n    a_template1.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n\n    a_template2 = t.profiler[2]\n    a_template2.children.each do |child|\n      assert_equal(\"a_template\", child.partial)\n    end\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_supports_rendering_the_same_partial_multiple_times\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"a_template1\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template1\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"a_template2\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a_template2\"]},\"children\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"child\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"a_template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"child\"]},\"partial\"]}]}]}]}]}","id":"bef003ad-c7d9-48e7-adfe-40deec4373d0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":113,"raw_source":"def test_drop_does_only_respond_to_whitelisted_methods\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.inspect }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.pretty_inspect }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse(\"{{ product.whatever }}\").render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"inspect\" }}').render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"pretty_inspect\" }}').render!('product' => ProductDrop.new))\n    assert_equal(\"\", Liquid::Template.parse('{{ product | map: \"whatever\" }}').render!('product' => ProductDrop.new))\n  end","complexity_score":30.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_does_only_respond_to_whitelisted_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.inspect }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.pretty_inspect }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product.whatever }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"inspect\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"pretty_inspect\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ product | map: \\\"whatever\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"0a10c2f1-ef39-4d4e-bdb1-83ecf91e936d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":22,"raw_source":"def substitute(input, params = {})\n    input.gsub(/%\\{(\\w+)\\}/) { |_match| params[Regexp.last_match(1)] }\n  end","complexity_score":5.78,"ast_json":"{\"type\":\"def\",\"children\":[\"substitute\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%\\\\{(\\\\w+)\\\\}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_match\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"params\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"c9afeb13-f523-481f-9751-4d119482c678"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":28,"raw_source":"def test_default_object\n    hash = Sinatra::IndifferentHash.new({:a=>1, ?b=>2})\n    assert_equal({ :a=>1, ?b=>2 }, hash.default)\n    assert_equal({ :a=>1, ?b=>2 }, hash[:a])\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_object\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"hash\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"IndifferentHash\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"default\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]}]}]}","id":"2ff1aea4-25d6-487d-b4ce-ad4589cd28ea"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":151,"raw_source":"def putc(c)\n        print c.chr\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"putc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"c\"]}]},{\"type\":\"send\",\"children\":[null,\"print\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"c\"]},\"chr\"]}]}]}","id":"dd31dbe2-dd29-42bb-8378-aa25f9f13f06"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/config_file.rb","start_line":165,"raw_source":"def environment_keys?(hash)\n      hash.is_a?(Hash) && hash.any? { |k, _| environments.include?(k.to_s) }\n    end","complexity_score":8.3,"ast_json":"{\"type\":\"def\",\"children\":[\"environment_keys?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"hash\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Hash\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"hash\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"environments\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]}]}]}]}","id":"9314b363-9c3e-408c-abd4-33415fd14d9e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/range_lookup.rb","start_line":5,"raw_source":"def self.parse(start_markup, end_markup, string_scanner, cache = nil)\n      start_obj = Expression.parse(start_markup, string_scanner, cache)\n      end_obj   = Expression.parse(end_markup, string_scanner, cache)\n      if start_obj.respond_to?(:evaluate) || end_obj.respond_to?(:evaluate)\n        new(start_obj, end_obj)\n      else\n        begin\n          start_obj.to_i..end_obj.to_i\n        rescue NoMethodError\n          invalid_expr = start_markup unless start_obj.respond_to?(:to_i)\n          invalid_expr ||= end_markup unless end_obj.respond_to?(:to_i)\n          if invalid_expr\n            raise Liquid::SyntaxError, \"Invalid expression type '#{invalid_expr}' in range expression\"\n          end\n\n          raise\n        end\n      end\n    end","complexity_score":24.9,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"start_markup\"]},{\"type\":\"arg\",\"children\":[\"end_markup\"]},{\"type\":\"arg\",\"children\":[\"string_scanner\"]},{\"type\":\"optarg\",\"children\":[\"cache\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start_obj\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"start_markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"end_obj\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"end_markup\"]},{\"type\":\"lvar\",\"children\":[\"string_scanner\"]},{\"type\":\"lvar\",\"children\":[\"cache\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"evaluate\"]}]}]},{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"start_obj\"]},{\"type\":\"lvar\",\"children\":[\"end_obj\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"to_i\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"to_i\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_i\"]}]},null,{\"type\":\"lvasgn\",\"children\":[\"invalid_expr\",{\"type\":\"lvar\",\"children\":[\"start_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"end_obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_i\"]}]},null,{\"type\":\"or_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"invalid_expr\"]},{\"type\":\"lvar\",\"children\":[\"end_markup\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invalid_expr\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid expression type '\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"invalid_expr\"]}]},{\"type\":\"str\",\"children\":[\"' in range expression\"]}]}]},null]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}","id":"faf631a6-e557-4fa7-b9e5-8f71df3bd3fe"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":87,"raw_source":"def test_string_single_quoted\n    var = create_variable(%( \"hello\" ))\n    assert_equal('hello', var.name)\n  end","complexity_score":4.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_single_quoted\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" \\\"hello\\\" \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"b35e4e83-f163-4580-b62a-7e653ae6f4b4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1339,"raw_source":"def middleware\n        if superclass.respond_to?(:middleware)\n          superclass.middleware + @middleware\n        else\n          @middleware\n        end\n      end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"middleware\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"middleware\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"superclass\"]},\"middleware\"]},\"+\",{\"type\":\"ivar\",\"children\":[\"@middleware\"]}]},{\"type\":\"ivar\",\"children\":[\"@middleware\"]}]}]}","id":"ee2a2014-469b-4be0-857a-b4b4c65ef13d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":143,"raw_source":"def test_profiling_uses_include_to_mark_children\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\", profile: true)\n    t.render!\n\n    include_node = t.profiler[1]\n    assert_equal(2, include_node.children.length)\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_profiling_uses_include_to_mark_children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% include 'a_template' %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"include_node\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"include_node\"]},\"children\"]},\"length\"]}]}]}]}","id":"ff1b3d40-368c-4683-b879-9a9fd95b890e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":128,"raw_source":"def test_filter_with_keyword_arguments\n    var = create_variable(%( hello | things: greeting: \"world\", farewell: 'goodbye'))\n    assert_equal(VariableLookup.new('hello'), var.name)\n    assert_equal([['things', [], { 'greeting' => 'world', 'farewell' => 'goodbye' }]], var.filters)\n  end","complexity_score":7.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_filter_with_keyword_arguments\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" hello | things: greeting: \\\"world\\\", farewell: 'goodbye'\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"hello\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"things\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"greeting\"]},{\"type\":\"str\",\"children\":[\"world\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"farewell\"]},{\"type\":\"str\",\"children\":[\"goodbye\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"filters\"]}]}]}]}","id":"1a2d3a50-fa88-4d94-b6ae-bd2268d37dc4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":129,"raw_source":"def test_cache_state_is_shared_for_subcontexts\n    parse_context      = Liquid::ParseContext.new\n    shared_file_system = StubFileSystem.new(\n      'my_partial' => 'my shared value',\n    )\n    context = Liquid::Context.build(\n      registers: Liquid::Registers.new(\n        file_system: shared_file_system,\n      ),\n    )\n    subcontext = context.new_isolated_subcontext\n\n    assert_equal(subcontext.registers[:cached_partials].object_id, context.registers[:cached_partials].object_id)\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: parse_context,\n      )\n\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: subcontext,\n        parse_context: parse_context,\n      )\n    end\n\n    assert_equal(1, shared_file_system.file_read_count)\n  end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_state_is_shared_for_subcontexts\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"shared_file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my shared value\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"object_id\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},\"object_id\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"subcontext\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]},\"file_read_count\"]}]}]}]}","id":"91429f18-5d23-49de-883e-0387f613392b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1242,"raw_source":"def test_sum_with_unindexable_values\n    input = [1, true, nil, { \"quantity\" => 2 }]\n\n    assert_equal(1, @filters.sum(input))\n    assert_raises(Liquid::ArgumentError, \"cannot select the property 'quantity'\") do\n      @filters.sum(input, \"quantity\")\n    end\n  end","complexity_score":7.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_unindexable_values\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"true\",\"children\":[]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"quantity\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"cannot select the property 'quantity'\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"quantity\"]}]}]}]}]}","id":"d121b382-a67a-443a-84ab-6e2492a81f0d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/resource_limits.rb","start_line":8,"raw_source":"def initialize(limits)\n      @render_length_limit = limits[:render_length_limit]\n      @render_score_limit  = limits[:render_score_limit]\n      @assign_score_limit  = limits[:assign_score_limit]\n      reset\n    end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"limits\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@render_length_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"render_length_limit\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@render_score_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"render_score_limit\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@assign_score_limit\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"limits\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"assign_score_limit\"]}]}]},{\"type\":\"send\",\"children\":[null,\"reset\"]}]}]}","id":"ccdb00a4-942f-4cde-9340-198ff81eefcd"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":770,"raw_source":"def scss(template, options = {}, locals = {})\n      options[:default_content_type] = :css\n      options[:exclude_outvar] = true\n      options[:layout] = nil\n      render :scss, template, options, locals\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"scss\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"css\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"exclude_outvar\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"sym\",\"children\":[\"scss\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]}]}]}]}","id":"681312fe-ac30-46b7-a539-7bf03f14709f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":36,"raw_source":"def accept\n      @env['sinatra.accept'] ||= if @env.include?('HTTP_ACCEPT') && (@env['HTTP_ACCEPT'].to_s != '')\n                                   @env['HTTP_ACCEPT']\n                                     .to_s\n                                     .scan(HEADER_VALUE_WITH_PARAMS)\n                                     .map! { |e| AcceptEntry.new(e) }\n                                     .sort\n                                 else\n                                   [AcceptEntry.new('*/*')]\n                                 end\n    end","complexity_score":18.3,"ast_json":"{\"type\":\"def\",\"children\":[\"accept\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.accept\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"include?\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},\"to_s\"]},\"!=\",{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_ACCEPT\"]}]},\"to_s\"]},\"scan\",{\"type\":\"const\",\"children\":[null,\"HEADER_VALUE_WITH_PARAMS\"]}]},\"map!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AcceptEntry\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},\"sort\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"AcceptEntry\"]},\"new\",{\"type\":\"str\",\"children\":[\"*/*\"]}]}]}]}]}]}","id":"44abaa38-24e6-42b6-8e85-6302694159a2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/yajl_test.rb","start_line":7,"raw_source":"def yajl_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"yajl_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"50a08836-3e9c-4a5e-97b4-b3bba2a4335b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":123,"raw_source":"def test_string_dot\n    var = create_variable(%( test.test ))\n    assert_equal(VariableLookup.new('test.test'), var.name)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_string_dot\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"var\",{\"type\":\"send\",\"children\":[null,\"create_variable\",{\"type\":\"str\",\"children\":[\" test.test \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"VariableLookup\"]},\"new\",{\"type\":\"str\",\"children\":[\"test.test\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"var\"]},\"name\"]}]}]}]}","id":"13fb0b93-7081-4233-9329-9f16f9d6ec11"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_kwarg_test.rb","start_line":7,"raw_source":"def html_tag(_tag, attributes)\n      attributes\n        .map { |key, value| \"#{key}='#{value}'\" }\n        .join(' ')\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"html_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_tag\"]},{\"type\":\"arg\",\"children\":[\"attributes\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"attributes\"]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"str\",\"children\":[\"='\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"str\",\"children\":[\"'\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]}","id":"682b1561-5401-4c38-b464-067ea9cb04f3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":17,"raw_source":"def parse_with_selected_parser(markup)\n      case parse_context.error_mode\n      when :strict then strict_parse_with_error_context(markup)\n      when :lax    then lax_parse(markup)\n      when :warn\n        begin\n          strict_parse_with_error_context(markup)\n        rescue SyntaxError => e\n          parse_context.warnings << e\n          lax_parse(markup)\n        end\n      end\n    end","complexity_score":18.5,"ast_json":"{\"type\":\"def\",\"children\":[\"parse_with_selected_parser\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"error_mode\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"strict\"]},{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"lax\"]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"warn\"]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse_with_error_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_context\"]},\"warnings\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"send\",\"children\":[null,\"lax_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},null]}]}]},null]}]}","id":"a12c6ccb-298a-4fb1-b19b-c1745b605b91"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag/disableable.rb","start_line":6,"raw_source":"def render_to_output_buffer(context, output)\n        if context.tag_disabled?(tag_name)\n          output << disabled_error(context)\n          return\n        end\n        super\n      end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"tag_disabled?\",{\"type\":\"send\",\"children\":[null,\"tag_name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"disabled_error\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"return\",\"children\":[]}]},null]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"4ae38651-a882-47d9-a224-ee8079a93bf4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":117,"raw_source":"def map(&block)\n        # dup would not copy the mixin\n        clone.map!(&block)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"map\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"clone\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"b8d8b3f4-11d4-4d60-a6c5-f393de051c1d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1680,"raw_source":"def call(env)\n        synchronize { prototype.call(env) }\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"synchronize\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"prototype\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"0369392b-cb56-41fe-b93d-04f7bcbb0af7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":272,"raw_source":"def to_hash\n        request_cookies.merge(response_cookies)\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"to_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"merge\",{\"type\":\"send\",\"children\":[null,\"response_cookies\"]}]}]}","id":"6893c6c9-e38a-4e17-b83f-85291b01c20a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/cycle_tag_test.rb","start_line":39,"raw_source":"def test_cycle_tag_always_resets_cycle\n    template = <<~LIQUID\n      {%- assign a = \"1\" -%}\n      {%- cycle a, \"2\" -%}\n      {%- cycle a, \"2\" -%}\n    LIQUID\n\n    assert_template_result(\"11\", template)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle_tag_always_resets_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign a = \\\"1\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle a, \\\"2\\\" -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{%- cycle a, \\\"2\\\" -%}\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"11\"]},{\"type\":\"lvar\",\"children\":[\"template\"]}]}]}]}","id":"c869bcf7-0a70-4a72-ae2f-5dc8cdab30c0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":6,"raw_source":"def test_app_start_without_rackup\n    # Why we skip head versions: The Gemfile used here would have to support\n    # the ENVs and we would need to bundle before starting the app\n    #\n    # Example from locally playing with this:\n    #\n    #   root@df8b1e7cb106:/app# rack_session=head BUNDLE_GEMFILE=./test/integration/gemfile_without_rackup.rb ruby ./test/integration/simple_app.rb -p 0 -s puma\n    #   The git source https://github.com/rack/rack-session.git is not yet checked out. Please run `bundle install` before trying to start your application\n    #\n    # Using bundler/inline is an idea, but it would add to the startup time\n    skip \"So much work to run with rack head branch\" if ENV['rack'] == 'head'\n    skip \"So much work to run with rack-session head branch\" if ENV['rack_session'] == 'head'\n\n    app_file = File.join(__dir__, \"integration\", \"simple_app.rb\")\n    gem_file = File.join(__dir__, \"integration\", \"gemfile_without_rackup.rb\")\n    command = command_for(app_file)\n    env = { \"BUNDLE_GEMFILE\" => gem_file }\n\n    with_process(command: command, env: env) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra could not start, the required gems weren't found/)\n    end\n  end","complexity_score":22.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_app_start_without_rackup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"head\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"So much work to run with rack head branch\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ENV\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack_session\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"head\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"So much work to run with rack-session head branch\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"simple_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"gem_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"gemfile_without_rackup.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"BUNDLE_GEMFILE\"]},{\"type\":\"lvar\",\"children\":[\"gem_file\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra could not start, the required gems weren't found\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}","id":"f3f48b21-6e67-4383-b848-c019177bae22"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":48,"raw_source":"def name\n      self.class.name.downcase\n    end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]},\"downcase\"]}]}","id":"33a7c22b-637e-4df1-ba58-5f5ce01ee2d9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":339,"raw_source":"def strip_html(input)\n      input = Utils.to_s(input)\n      empty  = ''\n      result = input.gsub(STRIP_HTML_BLOCKS, empty)\n      result.gsub!(STRIP_HTML_TAGS, empty)\n      result\n    end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strip_html\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"empty\",{\"type\":\"str\",\"children\":[\"\"]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"gsub\",{\"type\":\"const\",\"children\":[null,\"STRIP_HTML_BLOCKS\"]},{\"type\":\"lvar\",\"children\":[\"empty\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"gsub!\",{\"type\":\"const\",\"children\":[null,\"STRIP_HTML_TAGS\"]},{\"type\":\"lvar\",\"children\":[\"empty\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"79a7fbd3-b578-4db5-88c8-48613091993b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":8,"raw_source":"def setup\n    Tilt.prefer engine, :erb\n    super\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Tilt\"]},\"prefer\",{\"type\":\"send\",\"children\":[null,\"engine\"]},{\"type\":\"sym\",\"children\":[\"erb\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"2170607b-88a2-4f8c-afc8-a33c5ae194de"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/doc.rb","start_line":71,"raw_source":"def ensure_valid_markup(tag_name, markup, parse_context)\n      unless NO_UNEXPECTED_ARGS.match?(markup)\n        raise SyntaxError, parse_context.locale.t(\"errors.syntax.block_tag_unexpected_args\", tag: tag_name)\n      end\n    end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"ensure_valid_markup\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NO_UNEXPECTED_ARGS\"]},\"match?\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"locale\"]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.block_tag_unexpected_args\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]}]}]}]}","id":"f0e75075-ec28-43e6-b5a6-f42464002629"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":38,"raw_source":"def delegation_app(&block)\n    mock_app { Sinatra::Delegator.target = self }\n    delegate(&block)\n  end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"delegation_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target=\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"delegate\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"b7fab16a-13f2-4e4d-8db0-c0c416147e3d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/utils.rb","start_line":65,"raw_source":"def self.to_date(obj)\n      return obj if obj.respond_to?(:strftime)\n\n      if obj.is_a?(String)\n        return nil if obj.empty?\n        obj = obj.downcase\n      end\n\n      case obj\n      when 'now', 'today'\n        Time.now\n      when /\\A\\d+\\z/, Integer\n        Time.at(obj.to_i)\n      when String\n        Time.parse(obj)\n      end\n    rescue ::ArgumentError\n      nil\n    end","complexity_score":22.3,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"to_date\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"strftime\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"obj\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"downcase\"]}]}]},null]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"now\"]},{\"type\":\"str\",\"children\":[\"today\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]}]},{\"type\":\"when\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A\\\\d+\\\\z\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"const\",\"children\":[null,\"Integer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"at\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"to_i\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]},null]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}","id":"0ea68bde-a637-438a-8a5d-e564c01833c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/capture.rb","start_line":34,"raw_source":"def render_to_output_buffer(context, output)\n      context.resource_limits.with_capture do\n        capture_output = render(context)\n        context.scopes.last[@to] = capture_output\n      end\n      output\n    end","complexity_score":9.4,"ast_json":"{\"type\":\"def\",\"children\":[\"render_to_output_buffer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"resource_limits\"]},\"with_capture\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"capture_output\",{\"type\":\"send\",\"children\":[null,\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"scopes\"]},\"last\"]},\"[]=\",{\"type\":\"ivar\",\"children\":[\"@to\"]},{\"type\":\"lvar\",\"children\":[\"capture_output\"]}]}]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"ff5bdf89-0665-4c65-9e60-bfc71e33dae3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":65,"raw_source":"def test_does_not_add_drop_methods_to_symbol_table\n    current_symbols = Symbol.all_symbols\n\n    assigns = { 'drop' => Drop.new }\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_1 }}\", assigns).render!)\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_2 }}\", assigns).render!)\n    assert_equal(\"\", Template.parse(\"{{ drop.custom_method_3 }}\", assigns).render!)\n\n    assert_equal([], (Symbol.all_symbols - current_symbols))\n  end","complexity_score":18.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_does_not_add_drop_methods_to_symbol_table\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"current_symbols\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drop\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Drop\"]},\"new\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_1 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_2 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drop.custom_method_3 }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},\"render!\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Symbol\"]},\"all_symbols\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"current_symbols\"]}]}]}]}]}]}","id":"06ed9465-f757-4333-90d1-3a5898d635e8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":7,"raw_source":"def test_keyword_literals\n    assert_template_result(\"true\", \"{{ true }}\")\n    assert_expression_result(true, \"true\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_keyword_literals\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{{ true }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"true\",\"children\":[]},{\"type\":\"str\",\"children\":[\"true\"]}]}]}]}","id":"694c1515-9b46-4c28-953c-d1e7000ef8a2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/reloader_spec.rb","start_line":6,"raw_source":"def tmp_dir\n    File.expand_path('../tmp', __dir__)\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"tmp_dir\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"str\",\"children\":[\"../tmp\"]},{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]}]}","id":"7ffc8aec-7eeb-48cf-9da0-d11280a4fb4f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":211,"raw_source":"def removed?\n        !File.exist?(path)\n      end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"removed?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"exist?\",{\"type\":\"send\",\"children\":[null,\"path\"]}]},\"!\"]}]}","id":"08e3eaf1-3b2e-4c28-a3b0-94e17a4dfcd3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":453,"raw_source":"def test_complex_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{- 'John' -}}\n          {{- '30' -}}\n        </p>\n        <b>\n          {{ 'John' -}}\n          {{- '30' }}\n        </b>\n        <i>\n          {{- 'John' }}\n          {{ '30' -}}\n        </i>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>John30</p>\n        <b>\n          John30\n        </b>\n        <i>John\n          30</i>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_complex_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"        <b>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- '30' }}\\n\"]},{\"type\":\"str\",\"children\":[\"        </b>\\n\"]},{\"type\":\"str\",\"children\":[\"        <i>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{- 'John' }}\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ '30' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </i>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>John30</p>\\n\"]},{\"type\":\"str\",\"children\":[\"        <b>\\n\"]},{\"type\":\"str\",\"children\":[\"          John30\\n\"]},{\"type\":\"str\",\"children\":[\"        </b>\\n\"]},{\"type\":\"str\",\"children\":[\"        <i>John\\n\"]},{\"type\":\"str\",\"children\":[\"          30</i>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"07bce7c4-77b1-47f5-9010-b2b7db032365"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":65,"raw_source":"def downcase(input)\n      Utils.to_s(input).downcase\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"downcase\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"downcase\"]}]}","id":"a561f803-0604-4e5d-b666-0c4b78cde4b1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":211,"raw_source":"def drop_content_info?\n      informational? || drop_body?\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"drop_content_info?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[null,\"informational?\"]},{\"type\":\"send\",\"children\":[null,\"drop_body?\"]}]}]}","id":"b7c88156-a639-45eb-86ee-afcc3c45e08c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":8,"raw_source":"def setup\n    @context = Liquid::Context.new\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"new\"]}]}]}","id":"30b47d63-450c-42d1-8a61-df06804e18fb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/content_security_policy.rb","start_line":72,"raw_source":"def call(env)\n        status, headers, body = @app.call(env)\n        header = options[:report_only] ? 'content-security-policy-report-only' : 'content-security-policy'\n        headers[header] ||= csp_policy if html? headers\n        [status, headers, body]\n      end","complexity_score":12.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"status\"]},{\"type\":\"lvasgn\",\"children\":[\"headers\"]},{\"type\":\"lvasgn\",\"children\":[\"body\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"header\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"report_only\"]}]},{\"type\":\"str\",\"children\":[\"content-security-policy-report-only\"]},{\"type\":\"str\",\"children\":[\"content-security-policy\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"html?\",{\"type\":\"lvar\",\"children\":[\"headers\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"headers\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"header\"]}]},{\"type\":\"send\",\"children\":[null,\"csp_policy\"]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"status\"]},{\"type\":\"lvar\",\"children\":[\"headers\"]},{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}","id":"b0607e71-99a9-47cc-b755-4f15d1ed2d62"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":102,"raw_source":"def test_fetch\n    assert_raises(KeyError) { @hash.fetch(:d) }\n    assert_equal 1, @hash.fetch(:d, 1)\n    assert_equal 2, @hash.fetch(:d) { 2 }\n    assert_equal ?d, @hash.fetch(:d) { |k| k }\n    assert_equal :a, @hash.fetch(:a, 1)\n    assert_equal :a, @hash.fetch(:a) { 2 }\n  end","complexity_score":19.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_fetch\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"KeyError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"d\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"d\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"fetch\",{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}","id":"6519e19c-918e-423a-adad-b0b5abcba2ea"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1541,"raw_source":"def put(path, opts = {}, &block)     route 'PUT',     path, opts, &block end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"put\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PUT\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"04c0b63f-2f3b-433f-88cd-fb3dea4ac305"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser.rb","start_line":27,"raw_source":"def consume?(type)\n      token = @tokens[@p]\n      return false unless token && token[0] == type\n      @p += 1\n      token[1]\n    end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"consume?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"[]\",{\"type\":\"ivar\",\"children\":[\"@p\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"type\"]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@p\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]}","id":"16c13c1f-530a-464f-ad64-7609e67ee6f6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":191,"raw_source":"def test_can_iterate_over_each_profiling_entry\n    t = Template.parse(\"{{ 'a string' | upcase }}\\n{% increment test %}\", profile: true)\n    t.render!\n\n    timing_count = 0\n    t.profiler.each do |_timing|\n      timing_count += 1\n    end\n\n    assert_equal(2, timing_count)\n  end","complexity_score":11.03,"ast_json":"{\"type\":\"def\",\"children\":[\"test_can_iterate_over_each_profiling_entry\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\\n{% increment test %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"profile\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"lvasgn\",\"children\":[\"timing_count\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_timing\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"lvar\",\"children\":[\"timing_count\"]}]}]}]}","id":"854c952f-6f01-4012-9b7d-d6cf21b7d991"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":92,"raw_source":"def value?(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"value?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"40ed32be-c3dd-41d0-b21c-971ebb6d2026"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/escaped_params.rb","start_line":50,"raw_source":"def call(env)\n        request  = Request.new(env)\n        get_was  = handle(request.GET)\n        post_was = begin\n          handle(request.POST)\n        rescue StandardError\n          nil\n        end\n        app.call env\n      ensure\n        request.GET.replace  get_was  if get_was\n        request.POST.replace post_was if post_was\n      end","complexity_score":20.3,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"get_was\",{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"GET\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"post_was\",{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"handle\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"POST\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardError\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"get_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"GET\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"get_was\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"post_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"POST\"]},\"replace\",{\"type\":\"lvar\",\"children\":[\"post_was\"]}]},null]}]}]}]}","id":"7e377f76-ec1c-4ede-9b68-f901421c0bc9"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/theme_runner.rb","start_line":28,"raw_source":"def initialize\n    @tests = Dir[__dir__ + '/tests/**/*.liquid'].collect do |test|\n      next if File.basename(test) == 'theme.liquid'\n\n      theme_path = File.dirname(test) + '/theme.liquid'\n      {\n        liquid: File.read(test),\n        layout: (File.file?(theme_path) ? File.read(theme_path) : nil),\n        template_name: test,\n      }\n    end.compact\n\n    compile_all_tests\n  end","complexity_score":24.7,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@tests\",{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Dir\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/tests/**/*.liquid\"]}]}]},\"collect\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"test\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"basename\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"theme.liquid\"]}]},{\"type\":\"next\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"theme_path\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"dirname\",{\"type\":\"lvar\",\"children\":[\"test\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"/theme.liquid\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"liquid\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"test\"]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"layout\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"file?\",{\"type\":\"lvar\",\"children\":[\"theme_path\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"theme_path\"]}]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]},{\"type\":\"lvar\",\"children\":[\"test\"]}]}]}]}]},\"compact\"]}]},{\"type\":\"send\",\"children\":[null,\"compile_all_tests\"]}]}]}","id":"1d584441-93cc-4083-b8a3-bf517cbbaa5a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":267,"raw_source":"def call(env)\n        env['sinatra.commonlogger'] = true\n        call_without_check(env)\n      end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"sinatra.commonlogger\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"call_without_check\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"fad85280-85ae-4665-b8b8-c3557923e091"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":64,"raw_source":"def test_assign_with_colon_and_spaces\n    assigns = { 'var' => { 'a:b c' => { 'paged' => '1' } } }\n    assert_template_result('var2: 1', '{%assign var2 = var[\"a:b c\"].paged %}var2: {{var2}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_with_colon_and_spaces\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a:b c\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"paged\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"var2: 1\"]},{\"type\":\"str\",\"children\":[\"{%assign var2 = var[\\\"a:b c\\\"].paged %}var2: {{var2}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"0b728e29-d46c-4626-83c1-4182e8ba9718"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":115,"raw_source":"def patch(uri, params = {}, env = {}, &block)\n    request(uri, env.merge(:method => \"PATCH\", :params => params), &block)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"patch\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"uri\"]},{\"type\":\"optarg\",\"children\":[\"params\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"env\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"request\",{\"type\":\"lvar\",\"children\":[\"uri\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"method\"]},{\"type\":\"str\",\"children\":[\"PATCH\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"params\"]},{\"type\":\"lvar\",\"children\":[\"params\"]}]}]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"acd262e1-40f9-4a23-85d7-66a4a28c508d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1390,"raw_source":"def enable(*opts)\n        opts.each { |key| set(key, true) }\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"enable\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"opts\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"a1ec8bcc-7857-458d-94a7-ab2355096cf2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/contest.rb","start_line":69,"raw_source":"def self.context_name(name)\n    # \"Test#{sanitize_name(name).gsub(/(^| )(\\w)/) { $2.upcase }}\".to_sym\n    name = \"Test#{sanitize_name(name).gsub(/(^| )(\\w)/) { $2.upcase }}\"\n    name.tr(\" \", \"_\").to_sym\n  end","complexity_score":7.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"context_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Test\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"sanitize_name\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"(^| )(\\\\w)\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"nth_ref\",\"children\":[2]},\"upcase\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"tr\",{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"str\",\"children\":[\"_\"]}]},\"to_sym\"]}]}]}","id":"c15a05eb-5586-4b33-8fc8-2ebf1d8e1073"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":157,"raw_source":"def flatten\n          to_hash.flatten\n        end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"flatten\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"flatten\"]}]}","id":"666f5143-7eae-41d0-80a7-6fa06ae5a6b7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/test_helper.rb","start_line":139,"raw_source":"def silence_warnings\n    $VERBOSE, v = nil, $VERBOSE\n    yield\n  ensure\n    $VERBOSE = v\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"silence_warnings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"gvasgn\",\"children\":[\"$VERBOSE\"]},{\"type\":\"lvasgn\",\"children\":[\"v\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"gvar\",\"children\":[\"$VERBOSE\"]}]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"gvasgn\",\"children\":[\"$VERBOSE\",{\"type\":\"lvar\",\"children\":[\"v\"]}]}]}]}","id":"09850bc7-d0b1-4a00-b772-b0804184731e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/document_test.rb","start_line":13,"raw_source":"def test_unknown_tag\n    source = \"{% foo %}\"\n    assert_match_syntax_error(\"Liquid syntax error (line 1): Unknown tag 'foo'\", source)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unknown_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{% foo %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (line 1): Unknown tag 'foo'\"]},{\"type\":\"lvar\",\"children\":[\"source\"]}]}]}]}","id":"640a7291-1d12-4fca-996b-10f9fbf0cffc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":6,"raw_source":"def test_comment_inside_liquid_tag\n    assert_template_result(\"\", <<~LIQUID.chomp)\n      {% liquid\n        if 1 != 1\n        comment\n        else\n          echo 123\n        endcomment\n        endif\n      %}\n    LIQUID\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_inside_liquid_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% liquid\\n\"]},{\"type\":\"str\",\"children\":[\"  if 1 != 1\\n\"]},{\"type\":\"str\",\"children\":[\"  comment\\n\"]},{\"type\":\"str\",\"children\":[\"  else\\n\"]},{\"type\":\"str\",\"children\":[\"    echo 123\\n\"]},{\"type\":\"str\",\"children\":[\"  endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  endif\\n\"]},{\"type\":\"str\",\"children\":[\"%}\\n\"]}]},\"chomp\"]}]}]}","id":"868965d7-9427-4a6e-b39b-d24a3a817ff5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/http_origin.rb","start_line":26,"raw_source":"def base_url(env)\n        request = Rack::Request.new(env)\n        port = \":#{request.port}\" unless request.port == DEFAULT_PORTS[request.scheme]\n        \"#{request.scheme}://#{request.host}#{port}\"\n      end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"base_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"port\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"DEFAULT_PORTS\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"scheme\"]}]}]},null,{\"type\":\"lvasgn\",\"children\":[\"port\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"port\"]}]}]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"scheme\"]}]},{\"type\":\"str\",\"children\":[\"://\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"host\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"port\"]}]}]}]}]}","id":"8fa0562b-7bc0-4a2a-b846-95d05823e0fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":28,"raw_source":"def interpolate(name, vars)\n      name.gsub(/%\\{(\\w+)\\}/) do\n        # raise TranslationError, \"Undefined key #{$1} for interpolation in translation #{name}\"  unless vars[$1.to_sym]\n        (vars[Regexp.last_match(1).to_sym]).to_s\n      end\n    end","complexity_score":8.08,"ast_json":"{\"type\":\"def\",\"children\":[\"interpolate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"vars\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]},\"gsub\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"%\\\\{(\\\\w+)\\\\}\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"vars\"]},\"[]\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]},\"to_sym\"]}]}]},\"to_s\"]}]}]}","id":"9e324fbc-d0f0-40b8-ac25-1c0ce22c2fa6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":95,"raw_source":"def next_text_token\n      start = @ss.pos\n\n      unless @ss.skip_until(TAG_OR_VARIABLE_START)\n        token = @ss.rest\n        @ss.terminate\n        return token\n      end\n\n      pos = @ss.pos -= 2\n      @source.byteslice(start, pos - start)\n    rescue ::ArgumentError => e\n      if e.message == \"invalid byte sequence in #{@ss.string.encoding}\"\n        raise SyntaxError, \"Invalid byte sequence in #{@ss.string.encoding}\"\n      else\n        raise\n      end\n    end","complexity_score":26.9,"ast_json":"{\"type\":\"def\",\"children\":[\"next_text_token\",{\"type\":\"args\",\"children\":[]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"start\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"skip_until\",{\"type\":\"const\",\"children\":[null,\"TAG_OR_VARIABLE_START\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"rest\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"terminate\"]},{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"pos\",{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"pos\"]},\"-\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"byteslice\",{\"type\":\"lvar\",\"children\":[\"start\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pos\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]},\"==\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Invalid byte sequence in \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"string\"]},\"encoding\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}","id":"719d9086-287e-488c-a7e9-ab524850e92a"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parser_switching.rb","start_line":33,"raw_source":"def strict_parse_with_error_context(markup)\n      strict_parse(markup)\n    rescue SyntaxError => e\n      e.line_number    = line_number\n      e.markup_context = markup_context(markup)\n      raise e\n    end","complexity_score":8.7,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse_with_error_context\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[null,\"strict_parse\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"line_number=\",{\"type\":\"send\",\"children\":[null,\"line_number\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"markup_context=\",{\"type\":\"send\",\"children\":[null,\"markup_context\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]}]}","id":"96c9a7cd-29ee-4a58-9615-4aec4eb4b119"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":688,"raw_source":"def bad_request?\n      status == 400\n    end","complexity_score":2.5,"ast_json":"{\"type\":\"def\",\"children\":[\"bad_request?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"==\",{\"type\":\"int\",\"children\":[400]}]}]}","id":"abe1cb2e-72ee-4518-97fd-c14ccd02ab2c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":119,"raw_source":"def values_at(*keys)\n      keys.map!(&method(:convert_key))\n\n      super(*keys)\n    end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"values_at\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"keys\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]},\"map!\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method\",{\"type\":\"sym\",\"children\":[\"convert_key\"]}]}]}]},{\"type\":\"super\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"keys\"]}]}]}]}]}","id":"5fa672c9-ab94-465c-add6-f69e5b768065"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":24,"raw_source":"def read_template_file(_template_path)\n    @count ||= 0\n    @count  += 1\n    'from CountingFileSystem'\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"_template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"str\",\"children\":[\"from CountingFileSystem\"]}]}]}","id":"537104a1-cb61-4551-9732-a1af14803d6c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":51,"raw_source":"def redirect(env)\n        request = Request.new(env)\n        warn env, \"attack prevented by #{self.class}\"\n        [302, { 'content-type' => 'text/html', 'location' => request.path }, []]\n      end","complexity_score":5.45,"ast_json":"{\"type\":\"def\",\"children\":[\"redirect\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"request\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Request\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"attack prevented by \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[302]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"str\",\"children\":[\"text/html\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"location\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"request\"]},\"path\"]}]}]},{\"type\":\"array\",\"children\":[]}]}]}]}","id":"c9b29a24-f1d2-4272-b600-4cdbf0fc89c3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":141,"raw_source":"def test_for_limit\n    assert_equal(\n      [\"test\"],\n      visit(%({% for x in (1..5) limit: test %}{% endfor %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_limit\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% for x in (1..5) limit: test %}{% endfor %}\"]}]}]}]}","id":"aca9af95-dcc8-446b-b9d4-1c0ae27adf9e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/comment_tag_unit_test.rb","start_line":131,"raw_source":"def test_comment_tag_delimiter_with_extra_strings\n    assert_template_result(\n      '',\n      <<~LIQUID.chomp,\n        {% comment %}\n          {% comment %}\n          {% endcomment\n          {% if true %}\n          {% endif %}\n        {% endcomment %}\n      LIQUID\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_comment_tag_delimiter_with_extra_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% comment %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endcomment\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% endif %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% endcomment %}\\n\"]}]},\"chomp\"]}]}]}","id":"16299114-48a9-4421-9ee5-1430c233aa2d"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_context.rb","start_line":57,"raw_source":"def partial=(value)\n      @partial = value\n      @options = value ? partial_options : @template_options\n\n      @error_mode = @options[:error_mode] || @environment.error_mode\n    end","complexity_score":8.3,"ast_json":"{\"type\":\"def\",\"children\":[\"partial=\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@partial\",{\"type\":\"lvar\",\"children\":[\"value\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"value\"]},{\"type\":\"send\",\"children\":[null,\"partial_options\"]},{\"type\":\"ivar\",\"children\":[\"@template_options\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@error_mode\",{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"error_mode\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"error_mode\"]}]}]}]}]}","id":"a111e1c5-2daa-4430-ba5a-9ee28b1907e7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":261,"raw_source":"def test_case_when_comma_and_blank_body\n    code = '{% case condition %}{% when 1, 2 %} {% assign r = \"result\" %} {% endcase %}{{ r }}'\n    assert_template_result('result', code, { 'condition' => 2 })\n  end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_when_comma_and_blank_body\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1, 2 %} {% assign r = \\\"result\\\" %} {% endcase %}{{ r }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"result\"]},{\"type\":\"lvar\",\"children\":[\"code\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]}]}","id":"f808ae24-5b7b-42cd-b4a5-84a639969e64"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable.rb","start_line":102,"raw_source":"def render_obj_to_output(obj, output)\n      case obj\n      when NilClass\n        # Do nothing\n      when Array\n        obj.each do |o|\n          render_obj_to_output(o, output)\n        end\n      else\n        output << Liquid::Utils.to_s(obj)\n      end\n    end","complexity_score":9.3,"ast_json":"{\"type\":\"def\",\"children\":[\"render_obj_to_output\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"obj\"]},{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NilClass\"]},null]},{\"type\":\"when\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Array\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"obj\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"o\"]}]},{\"type\":\"send\",\"children\":[null,\"render_obj_to_output\",{\"type\":\"lvar\",\"children\":[\"o\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"obj\"]}]}]}]}]}","id":"d27c85f8-f5c4-4564-b93d-6e3d8d773813"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":220,"raw_source":"def nulltok(s);  s[0,4] == 'null'  && [:val, 'null',  nil]   end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"nulltok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[4]}]},\"==\",{\"type\":\"str\",\"children\":[\"null\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"null\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"11307139-1d9e-4b91-9f89-e909afa2dba0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":174,"raw_source":"def test_h\n    assert_equal('&lt;strong&gt;', @filters.h('<strong>'))\n    assert_equal('1', @filters.h(1))\n    assert_equal('2001-02-03', @filters.h(Date.new(2001, 2, 3)))\n    assert_nil(@filters.h(nil))\n  end","complexity_score":11.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_h\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"&lt;strong&gt;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"str\",\"children\":[\"<strong>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"2001-02-03\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Date\"]},\"new\",{\"type\":\"int\",\"children\":[2001]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"h\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"61377161-68ef-4a46-ab2d-7ce949a8cbbc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":227,"raw_source":"def self.registered(klass)\n      @reloader_loaded_in ||= {}\n      return if @reloader_loaded_in[klass]\n\n      @reloader_loaded_in[klass] = true\n\n      klass.extend BaseMethods\n      klass.extend ExtensionMethods\n      klass.set(:reloader) { klass.development? }\n      klass.set(:reload_templates) { klass.reloader? }\n      klass.before do\n        if klass.reloader?\n          MUTEX_FOR_PERFORM.synchronize { Reloader.perform(klass) }\n        end\n      end\n      klass.set(:inline_templates, klass.app_file) if klass == Sinatra::Application\n    end","complexity_score":26.5,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"registered\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"klass\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@reloader_loaded_in\"]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reloader_loaded_in\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@reloader_loaded_in\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"klass\"]},{\"type\":\"true\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"BaseMethods\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"extend\",{\"type\":\"const\",\"children\":[null,\"ExtensionMethods\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"reloader\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"development?\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"reload_templates\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"reloader?\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"before\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"reloader?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"MUTEX_FOR_PERFORM\"]},\"synchronize\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Reloader\"]},\"perform\",{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"==\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Application\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"set\",{\"type\":\"sym\",\"children\":[\"inline_templates\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"app_file\"]}]},null]}]}]}","id":"8d45c350-1f4b-406b-bd71-1bd3ea186e2d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/namespace_spec.rb","start_line":6,"raw_source":"def mock_app(&block)\n    super do\n      register Sinatra::Namespace\n      class_eval(&block)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"mock_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Namespace\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"532f70f4-53dc-4ced-b601-8154ec8f4145"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_test.rb","start_line":14,"raw_source":"def test_custom_tag\n    email_environment = Liquid::Environment.build do |environment|\n      environment.register_tag(\"unsubscribe_footer\", UnsubscribeFooter)\n    end\n\n    assert(email_environment.tags[\"unsubscribe_footer\"])\n    assert(email_environment.tag_for_name(\"unsubscribe_footer\"))\n    template = Liquid::Template.parse(\"{% unsubscribe_footer %}\", environment: email_environment)\n\n    assert_equal('Unsubscribe Footer', template.render)\n  end","complexity_score":14.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_custom_tag\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"email_environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"environment\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"register_tag\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]},{\"type\":\"const\",\"children\":[null,\"UnsubscribeFooter\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"email_environment\"]},\"tags\"]},\"[]\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"email_environment\"]},\"tag_for_name\",{\"type\":\"str\",\"children\":[\"unsubscribe_footer\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% unsubscribe_footer %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"email_environment\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Unsubscribe Footer\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\"]}]}]}]}","id":"d6052b07-3431-4483-9fa4-2f61dc6435b1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tokenizer.rb","start_line":53,"raw_source":"def tokenize\n      if @for_liquid_tag\n        @tokens = @source.split(\"\\n\")\n      else\n        @tokens << shift_normal until @ss.eos?\n      end\n\n      @source = nil\n      @ss = nil\n    end","complexity_score":10.1,"ast_json":"{\"type\":\"def\",\"children\":[\"tokenize\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@for_liquid_tag\"]},{\"type\":\"ivasgn\",\"children\":[\"@tokens\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@source\"]},\"split\",{\"type\":\"str\",\"children\":[\"\\n\"]}]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ss\"]},\"eos?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@tokens\"]},\"<<\",{\"type\":\"send\",\"children\":[null,\"shift_normal\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@source\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@ss\",{\"type\":\"nil\",\"children\":[]}]}]}]}","id":"40a61c80-de4e-4011-8dfb-4fecd8203073"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":25,"raw_source":"def initialize(environments = {}, outer_scope = {}, registers = {}, rethrow_errors = false, resource_limits = nil, static_environments = {}, environment = Environment.default)\n      @environment = environment\n      @environments = [environments]\n      @environments.flatten!\n\n      @static_environments = [static_environments].flatten(1).freeze\n      @scopes              = [outer_scope || {}]\n      @registers           = registers.is_a?(Registers) ? registers : Registers.new(registers)\n      @errors              = []\n      @partial             = false\n      @strict_variables    = false\n      @resource_limits     = resource_limits || ResourceLimits.new(environment.default_resource_limits)\n      @base_scope_depth    = 0\n      @interrupts          = []\n      @filters             = []\n      @global_filter       = nil\n      @disabled_tags       = {}\n\n      # Instead of constructing new StringScanner objects for each Expression parse,\n      # we recycle the same one.\n      @string_scanner = StringScanner.new(\"\")\n\n      @registers.static[:cached_partials] ||= {}\n      @registers.static[:file_system] ||= environment.file_system\n      @registers.static[:template_factory] ||= Liquid::TemplateFactory.new\n\n      self.exception_renderer = environment.exception_renderer\n      if rethrow_errors\n        self.exception_renderer = Liquid::RAISE_EXCEPTION_LAMBDA\n      end\n\n      yield self if block_given?\n\n      # Do this last, since it could result in this object being passed to a Proc in the environment\n      squash_instance_assigns_with_environments\n    end","complexity_score":48.25,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"outer_scope\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"registers\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"rethrow_errors\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"resource_limits\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"static_environments\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"environment\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Environment\"]},\"default\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"lvar\",\"children\":[\"environment\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@environments\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environments\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environments\"]},\"flatten!\"]},{\"type\":\"ivasgn\",\"children\":[\"@static_environments\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_environments\"]}]},\"flatten\",{\"type\":\"int\",\"children\":[1]}]},\"freeze\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@scopes\",{\"type\":\"array\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"outer_scope\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@registers\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"registers\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Registers\"]}]},{\"type\":\"lvar\",\"children\":[\"registers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"registers\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@errors\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@partial\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@strict_variables\",{\"type\":\"false\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@resource_limits\",{\"type\":\"or\",\"children\":[{\"type\":\"lvar\",\"children\":[\"resource_limits\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ResourceLimits\"]},\"new\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"default_resource_limits\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@base_scope_depth\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@interrupts\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@filters\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@global_filter\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@disabled_tags\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"ivasgn\",\"children\":[\"@string_scanner\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StringScanner\"]},\"new\",{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"cached_partials\"]}]},{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"file_system\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"file_system\"]}]},{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@registers\"]},\"static\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"template_factory\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"TemplateFactory\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"exception_renderer=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"environment\"]},\"exception_renderer\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"rethrow_errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"exception_renderer=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"RAISE_EXCEPTION_LAMBDA\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[{\"type\":\"self\",\"children\":[]}]},null]},{\"type\":\"send\",\"children\":[null,\"squash_instance_assigns_with_environments\"]}]}]}","id":"0c355035-13d8-44a1-9f91-c97bc5a731cb"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/middleware_test.rb","start_line":16,"raw_source":"def call(env)\n      (env['test.ran'] ||= []) << self.class.to_s\n      app.call(env)\n    end","complexity_score":5.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"test.ran\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"cfa48109-c686-4a49-b4ef-a11824c29f73"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":786,"raw_source":"def test_at_most\n    assert_template_result(\"4\", \"{{ 5 | at_most:4 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_most:5 }}\")\n    assert_template_result(\"5\", \"{{ 5 | at_most:6 }}\")\n\n    assert_template_result(\"4.5\", \"{{ 4.5 | at_most:5 }}\")\n    assert_template_result(\"5\", \"{{ width | at_most:5 }}\", { 'width' => NumberLikeThing.new(6) })\n    assert_template_result(\"4\", \"{{ width | at_most:5 }}\", { 'width' => NumberLikeThing.new(4) })\n    assert_template_result(\"4\", \"{{ 5 | at_most: width }}\", { 'width' => NumberLikeThing.new(4) })\n  end","complexity_score":11.65,"ast_json":"{\"type\":\"def\",\"children\":[\"test_at_most\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:4 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most:6 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4.5\"]},{\"type\":\"str\",\"children\":[\"{{ 4.5 | at_most:5 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_most:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[6]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ width | at_most:5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 5 | at_most: width }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"width\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"int\",\"children\":[4]}]}]}]}]}]}]}","id":"5b701f45-48c0-483a-94e0-3ca2c30f47c8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":69,"raw_source":"def push_block(tag, markup)\n      block = if tag == 'else'\n        ElseCondition.new\n      else\n        parse_with_selected_parser(markup)\n      end\n\n      @blocks.push(block)\n      block.attach(new_body)\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"push_block\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"block\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"==\",{\"type\":\"str\",\"children\":[\"else\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ElseCondition\"]},\"new\"]},{\"type\":\"send\",\"children\":[null,\"parse_with_selected_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blocks\"]},\"push\",{\"type\":\"lvar\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"attach\",{\"type\":\"send\",\"children\":[null,\"new_body\"]}]}]}]}","id":"4bba0f7c-964e-49bc-86e0-90ed4daf1ed3"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":236,"raw_source":"def truncate(input, length = 50, truncate_string = \"...\")\n      return if input.nil?\n      input_str = Utils.to_s(input)\n      length    = Utils.to_integer(length)\n\n      truncate_string_str = Utils.to_s(truncate_string)\n\n      l = length - truncate_string_str.length\n      l = 0 if l < 0\n\n      input_str.length > length ? input_str[0...l].concat(truncate_string_str) : input_str\n    end","complexity_score":22.15,"ast_json":"{\"type\":\"def\",\"children\":[\"truncate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"length\",{\"type\":\"int\",\"children\":[50]}]},{\"type\":\"optarg\",\"children\":[\"truncate_string\",{\"type\":\"str\",\"children\":[\"...\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"lvasgn\",\"children\":[\"input_str\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"length\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"truncate_string_str\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"truncate_string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},\"-\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"truncate_string_str\"]},\"length\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"l\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"lvasgn\",\"children\":[\"l\",{\"type\":\"int\",\"children\":[0]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input_str\"]},\"length\"]},\">\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input_str\"]},\"[]\",{\"type\":\"erange\",\"children\":[{\"type\":\"int\",\"children\":[0]},{\"type\":\"lvar\",\"children\":[\"l\"]}]}]},\"concat\",{\"type\":\"lvar\",\"children\":[\"truncate_string_str\"]}]},{\"type\":\"lvar\",\"children\":[\"input_str\"]}]}]}]}","id":"985e7b48-ff97-471d-a8b9-ffb12f3b145c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/erb_test.rb","start_line":64,"raw_source":"def container\n        @_out_buf << \"THIS.\"\n        yield\n        @_out_buf << \"SPARTA!\"\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"container\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"str\",\"children\":[\"THIS.\"]}]},{\"type\":\"yield\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@_out_buf\"]},\"<<\",{\"type\":\"str\",\"children\":[\"SPARTA!\"]}]}]}]}","id":"6b7b1ee1-4038-4e07-8ac9-61859c78a032"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1183,"raw_source":"def dispatch!\n      # Avoid passing frozen string in force_encoding\n      @params.merge!(@request.params).each do |key, val|\n        next unless val.respond_to?(:force_encoding)\n\n        val = val.dup if val.frozen?\n        @params[key] = force_encoding(val)\n      end\n\n      invoke do\n        static! if settings.static? && (request.get? || request.head?)\n        filter! :before do\n          @pinned_response = !response['content-type'].nil?\n        end\n        route!\n      end\n    rescue ::Exception => e\n      invoke { handle_exception!(e) }\n    ensure\n      begin\n        filter! :after unless env['sinatra.static_file']\n      rescue ::Exception => e\n        invoke { handle_exception!(e) } unless @env['sinatra.error']\n      end\n    end","complexity_score":66.1,"ast_json":"{\"type\":\"def\",\"children\":[\"dispatch!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"ensure\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"merge!\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@request\"]},\"params\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]},{\"type\":\"arg\",\"children\":[\"val\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"force_encoding\"]}]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"frozen?\"]},{\"type\":\"lvasgn\",\"children\":[\"val\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"val\"]},\"dup\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@params\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"key\"]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"val\"]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"static?\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"get?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"head?\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"static!\"]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"sym\",\"children\":[\"before\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@pinned_response\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"content-type\"]}]},\"nil?\"]},\"!\"]}]}]},{\"type\":\"send\",\"children\":[null,\"route!\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"handle_exception!\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]},null]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.static_file\"]}]},null,{\"type\":\"send\",\"children\":[null,\"filter!\",{\"type\":\"sym\",\"children\":[\"after\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"Exception\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"sinatra.error\"]}]},null,{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invoke\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"handle_exception!\",{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]},null]}]}]}]}","id":"f700b2ff-8537-4df4-a347-f955ebcb164a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":35,"raw_source":"def initialize(app, options = {})\n        @app = app\n        @options = default_options.merge(options)\n      end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@app\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@options\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"default_options\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}]}","id":"5b44413d-1194-49de-9bb2-e4d830e7ce3e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":189,"raw_source":"def base64_url_safe_decode(input)\n      input = Utils.to_s(input)\n      StandardFilters.try_coerce_encoding(Base64.urlsafe_decode64(input), encoding: input.encoding)\n    rescue ::ArgumentError\n      raise Liquid::ArgumentError, \"invalid base64 provided to base64_url_safe_decode\"\n    end","complexity_score":8.5,"ast_json":"{\"type\":\"def\",\"children\":[\"base64_url_safe_decode\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"try_coerce_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Base64\"]},\"urlsafe_decode64\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"encoding\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"encoding\"]}]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"ArgumentError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"invalid base64 provided to base64_url_safe_decode\"]}]}]},null]}]}","id":"65c8b477-7f91-4fc1-bd9b-c29873973802"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":76,"raw_source":"def test_max_depth_nested_blocks_does_not_raise_exception\n    depth = Liquid::Block::MAX_DEPTH\n    code  = \"{% if true %}\" * depth + \"rendered\" + \"{% endif %}\" * depth\n    assert_equal(\"rendered\", Template.parse(code).render!)\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_max_depth_nested_blocks_does_not_raise_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"depth\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Block\"]},\"MAX_DEPTH\"]}]},{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% if true %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]},\"+\",{\"type\":\"str\",\"children\":[\"rendered\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"{% endif %}\"]},\"*\",{\"type\":\"lvar\",\"children\":[\"depth\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"rendered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"render!\"]}]}]}]}","id":"9209cb1a-9a94-4928-9967-7d55302debba"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":84,"raw_source":"def key?(key)\n      super(convert_key(key))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_key\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"b45ff758-18ff-44d3-a672-7c90840ceb2f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":135,"raw_source":"def initialize(value)\n    super()\n    @value = value\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"super\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"e3bade23-6c1c-4d6d-9fee-74c52d18ab3e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":290,"raw_source":"def split(input, pattern)\n      pattern = Utils.to_s(pattern)\n      input = Utils.to_s(input)\n      input.split(pattern)\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"split\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"pattern\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"split\",{\"type\":\"lvar\",\"children\":[\"pattern\"]}]}]}]}","id":"bffac58a-11a1-4db9-9561-1349a59f3c38"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":293,"raw_source":"def test_cycle\n    assert_template_result('one', '{%cycle \"one\", \"two\"%}')\n    assert_template_result('one two', '{%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%}')\n    assert_template_result(' two', '{%cycle \"\", \"two\"%} {%cycle \"\", \"two\"%}')\n\n    assert_template_result('one two one', '{%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%} {%cycle \"one\", \"two\"%}')\n\n    assert_template_result(\n      'text-align: left text-align: right',\n      '{%cycle \"text-align: left\", \"text-align: right\" %} {%cycle \"text-align: left\", \"text-align: right\"%}',\n    )\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cycle\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one two\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" two\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"\\\", \\\"two\\\"%} {%cycle \\\"\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one two one\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%} {%cycle \\\"one\\\", \\\"two\\\"%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"text-align: left text-align: right\"]},{\"type\":\"str\",\"children\":[\"{%cycle \\\"text-align: left\\\", \\\"text-align: right\\\" %} {%cycle \\\"text-align: left\\\", \\\"text-align: right\\\"%}\"]}]}]}]}","id":"72d6b379-9fe4-4871-9fe6-8165c0a91c10"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":457,"raw_source":"def test_compact_invalid_property\n    foo = [\n      [1],\n      [2],\n      [3],\n    ]\n\n    assert_raises(Liquid::ArgumentError) do\n      @filters.compact(foo, \"bar\")\n    end\n  end","complexity_score":4.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_compact_invalid_property\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"foo\",{\"type\":\"array\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"compact\",{\"type\":\"lvar\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}","id":"04075a71-6942-4c3e-ad19-849c237f7d5e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1281,"raw_source":"def test_sum_resulting_in_negative_float\n    input = [0.1, -0.2, -0.3]\n    assert_equal(-0.4, @filters.sum(input))\n    assert_template_result(\"-0.4\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_resulting_in_negative_float\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"float\",\"children\":[-0.2]},{\"type\":\"float\",\"children\":[-0.3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[-0.4]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-0.4\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}","id":"2734d91b-d09c-420c-8edf-2a38dcebd203"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/variable_unit_test.rb","start_line":161,"raw_source":"def create_variable(markup, options = {})\n    Variable.new(markup, ParseContext.new(options))\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"create_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"0fd5050d-2ac4-4c73-8758-0a4f2066bbb7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":127,"raw_source":"def test_text_drop\n    output = Liquid::Template.parse(' {{ product.texts.text }} ').render!('product' => ProductDrop.new)\n    assert_equal(' text1 ', output)\n  end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_text_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ product.texts.text }} \"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"product\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" text1 \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"0ce5759b-b72f-4d93-8c49-471d639fddd3"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/paginate.rb","start_line":85,"raw_source":"def link(title, page)\n    { 'title' => title, 'url' => current_url + \"?page=#{page}\", 'is_link' => true }\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"title\"]},{\"type\":\"arg\",\"children\":[\"page\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"lvar\",\"children\":[\"title\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"url\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"current_url\"]},\"+\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"?page=\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"page\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"is_link\"]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"e2c967ff-5ee1-46cb-a251-5f291bcfe708"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":74,"raw_source":"def test_hash_compare_backwards_compatibility\n    assert_nil(Condition.new({}, '>', 2).evaluate(Context.new))\n    assert_nil(Condition.new(2, '>', {}).evaluate(Context.new))\n    assert_equal(false, Condition.new({}, '==', 2).evaluate(Context.new))\n    assert_equal(true, Condition.new({ 'a' => 1 }, '==', 'a' => 1).evaluate(Context.new))\n    assert_equal(true, Condition.new({ 'a' => 2 }, 'contains', 'a').evaluate(Context.new))\n  end","complexity_score":27.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_compare_backwards_compatibility\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"hash\",\"children\":[]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"str\",\"children\":[\"contains\"]},{\"type\":\"str\",\"children\":[\"a\"]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}","id":"8311f714-e52f-4259-85ad-d681c159d0b0"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/multi_route.rb","start_line":82,"raw_source":"def route_args(args)\n      options = Hash === args.last ? args.pop : {}\n      [args, options]\n    end","complexity_score":5.3,"ast_json":"{\"type\":\"def\",\"children\":[\"route_args\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"options\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"last\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},\"pop\"]},{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"8244d9b7-72e7-45a6-97cc-52292ea1fe0a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1428,"raw_source":"def inline_templates=(file = nil)\n        file = (caller_files.first || File.expand_path($0)) if file.nil? || file == true\n\n        begin\n          io = ::IO.respond_to?(:binread) ? ::IO.binread(file) : ::IO.read(file)\n          app, data = io.gsub(\"\\r\\n\", \"\\n\").split(/^__END__$/, 2)\n        rescue Errno::ENOENT\n          app, data = nil\n        end\n\n        return unless data\n\n        encoding = if app && app =~ /([^\\n]*\\n)?#[^\\n]*coding: *(\\S+)/m\n                     $2\n                   else\n                     settings.default_encoding\n                   end\n\n        lines = app.count(\"\\n\") + 1\n        template = nil\n        force_encoding data, encoding\n        data.each_line do |line|\n          lines += 1\n          if line =~ /^@@\\s*(.*\\S)\\s*$/\n            template = force_encoding(String.new, encoding)\n            templates[$1.to_sym] = [template, file, lines]\n          elsif template\n            template << line\n          end\n        end\n      end","complexity_score":57.4,"ast_json":"{\"type\":\"def\",\"children\":[\"inline_templates=\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"file\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file\"]},\"==\",{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"lvasgn\",\"children\":[\"file\",{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"expand_path\",{\"type\":\"gvar\",\"children\":[\"$0\"]}]}]}]}]},null]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"io\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"binread\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"binread\",{\"type\":\"lvar\",\"children\":[\"file\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"IO\"]},\"read\",{\"type\":\"lvar\",\"children\":[\"file\"]}]}]}]},{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app\"]},{\"type\":\"lvasgn\",\"children\":[\"data\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"io\"]},\"gsub\",{\"type\":\"str\",\"children\":[\"\\r\\n\"]},{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"split\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^__END__$\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Errno\"]},\"ENOENT\"]}]},null,{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app\"]},{\"type\":\"lvasgn\",\"children\":[\"data\"]}]},{\"type\":\"nil\",\"children\":[]}]}]},null]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"encoding\",{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"([^\\\\n]*\\\\n)?#[^\\\\n]*coding: *(\\\\S+)\"]},{\"type\":\"regopt\",\"children\":[\"m\"]}]}]}]},{\"type\":\"nth_ref\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"default_encoding\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"lines\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"app\"]},\"count\",{\"type\":\"str\",\"children\":[\"\\n\"]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"lvar\",\"children\":[\"data\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"each_line\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"lines\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^@@\\\\s*(.*\\\\S)\\\\s*$\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[null,\"force_encoding\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"String\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"encoding\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"send\",\"children\":[{\"type\":\"nth_ref\",\"children\":[1]},\"to_sym\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"file\"]},{\"type\":\"lvar\",\"children\":[\"lines\"]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"line\"]}]},null]}]}]}]}]}]}","id":"3d42adcd-8ba0-451a-819c-1fa7d1bb567d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":208,"raw_source":"def read_template_file(template_path)\n    @file_read_count += 1\n    @values.fetch(template_path)\n  end","complexity_score":3.3,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template_file\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@file_read_count\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@values\"]},\"fetch\",{\"type\":\"lvar\",\"children\":[\"template_path\"]}]}]}]}","id":"9a304b17-6c58-4cf2-9911-975b1695e97c"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":148,"raw_source":"def test_case_on_size\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [] })\n    assert_template_result('1', '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1] })\n    assert_template_result('2', '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1, 1] })\n    assert_template_result('',  '{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}', { 'a' => [1, 1, 1, 1, 1] })\n  end","complexity_score":10.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_on_size\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case a.size %}{% when 1 %}1{% when 2 %}2{% endcase %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"78b1dfd1-6aaf-48c6-b0be-852862266841"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":344,"raw_source":"def test_sort_natural_when_property_is_sometimes_missing_puts_nils_last\n    input       = [\n      { \"price\" => \"4\", \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"price\" => \"1\", \"handle\" => \"gamma\" },\n      { \"handle\" => \"delta\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n    ]\n    expectation = [\n      { \"price\" => \"1\", \"handle\" => \"gamma\" },\n      { \"price\" => 2, \"handle\" => \"epsilon\" },\n      { \"price\" => \"4\", \"handle\" => \"alpha\" },\n      { \"handle\" => \"beta\" },\n      { \"handle\" => \"delta\" },\n    ]\n    assert_equal(expectation, @filters.sort_natural(input, \"price\"))\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural_when_property_is_sometimes_missing_puts_nils_last\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"4\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expectation\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"1\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"epsilon\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"str\",\"children\":[\"4\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expectation\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sort_natural\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"str\",\"children\":[\"price\"]}]}]}]}]}","id":"b1e4c5d0-6f87-47aa-a636-e6082940bb36"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":792,"raw_source":"def abs(input)\n      result = Utils.to_number(input).abs\n      result.is_a?(BigDecimal) ? result.to_f : result\n    end","complexity_score":6.3,"ast_json":"{\"type\":\"def\",\"children\":[\"abs\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"abs\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"BigDecimal\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]},\"to_f\"]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]}","id":"837e9549-9dfc-4566-b064-111da08e32d1"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":892,"raw_source":"def floor(input)\n      Utils.to_number(input).floor.to_i\n    rescue ::FloatDomainError => e\n      raise Liquid::FloatDomainError, e.message\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"floor\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_number\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"floor\"]},\"to_i\"]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"cbase\",\"children\":[]},\"FloatDomainError\"]}]},{\"type\":\"lvasgn\",\"children\":[\"e\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"message\"]}]}]},null]}]}","id":"19ed58db-5161-4f37-895a-f8a0b00077f7"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/case.rb","start_line":31,"raw_source":"def initialize(tag_name, markup, options)\n      super\n      @blocks = []\n\n      if markup =~ Syntax\n        @left = parse_expression(Regexp.last_match(1))\n      else\n        raise SyntaxError, options[:locale].t(\"errors.syntax.case\")\n      end\n    end","complexity_score":10.78,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"ivasgn\",\"children\":[\"@blocks\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"ivasgn\",\"children\":[\"@left\",{\"type\":\"send\",\"children\":[null,\"parse_expression\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]},\"t\",{\"type\":\"str\",\"children\":[\"errors.syntax.case\"]}]}]}]}]}]}","id":"4699fad7-3bab-4104-86d4-d83da6fcfa73"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":34,"raw_source":"def test_table_row_with_different_cols\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td><td class=\\\"col4\\\"> 4 </td><td class=\\\"col5\\\"> 5 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:5%} {{n}} {% endtablerow %}',\n      { 'numbers' => [1, 2, 3, 4, 5, 6] },\n    )\n  end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_table_row_with_different_cols\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td><td class=\\\"col4\\\"> 4 </td><td class=\\\"col5\\\"> 5 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:5%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}","id":"bf7b966f-3eb9-43a1-8498-36f0ee5770bb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/case_tag_unit_test.rb","start_line":8,"raw_source":"def test_case_nodelist\n    template = Liquid::Template.parse('{% case var %}{% when true %}WHEN{% else %}ELSE{% endcase %}')\n    assert_equal(['WHEN', 'ELSE'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% case var %}{% when true %}WHEN{% else %}ELSE{% endcase %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"WHEN\"]},{\"type\":\"str\",\"children\":[\"ELSE\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}","id":"56d0fde3-06c6-4a52-813d-703988087241"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/path_traversal.rb","start_line":15,"raw_source":"def call(env)\n        path_was         = env['PATH_INFO']\n        env['PATH_INFO'] = cleanup path_was if path_was && !path_was.empty?\n        app.call env\n      ensure\n        env['PATH_INFO'] = path_was\n      end","complexity_score":12.8,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"path_was\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path_was\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path_was\"]},\"empty?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"send\",\"children\":[null,\"cleanup\",{\"type\":\"lvar\",\"children\":[\"path_was\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"PATH_INFO\"]},{\"type\":\"lvar\",\"children\":[\"path_was\"]}]}]}]}","id":"16b80d22-6705-4c6d-a133-4fd4ea7a8814"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1817,"raw_source":"def compile(path, route_mustermann_opts = {})\n        Mustermann.new(path, **mustermann_opts.merge(route_mustermann_opts))\n      end","complexity_score":4.6,"ast_json":"{\"type\":\"def\",\"children\":[\"compile\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"route_mustermann_opts\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Mustermann\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"kwsplat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mustermann_opts\"]},\"merge\",{\"type\":\"lvar\",\"children\":[\"route_mustermann_opts\"]}]}]}]}]}]}","id":"75b3c95a-c4c3-4758-98e1-655108e31662"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/block_unit_test.rb","start_line":35,"raw_source":"def test_variable_with_multibyte_character\n    template = Liquid::Template.parse(\"{{ '❤️' }}\")\n    assert_equal(1, template.root.nodelist.size)\n    assert_equal(Variable, template.root.nodelist[0].class)\n  end","complexity_score":14.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_with_multibyte_character\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ '❤️' }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"Variable\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"class\"]}]}]}]}","id":"b7876536-5274-4c31-a676-d40f14815e20"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":565,"raw_source":"def test_new_isolated_subcontext_registers_do_not_pollute_context\n    super_context                      = Context.build(registers: { my_register: :my_value })\n    subcontext                         = super_context.new_isolated_subcontext\n    subcontext.registers[:my_register] = :my_alt_value\n    assert_equal(:my_value, super_context.registers[:my_register])\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_isolated_subcontext_registers_do_not_pollute_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"super_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_value\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"subcontext\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"new_isolated_subcontext\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"subcontext\"]},\"registers\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"my_register\"]},{\"type\":\"sym\",\"children\":[\"my_alt_value\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"my_value\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"super_context\"]},\"registers\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"my_register\"]}]}]}]}]}","id":"9851b35a-a69c-4bff-8ba7-f24d7f412cca"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1078,"raw_source":"def compact\n        to_a.compact\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"compact\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_a\"]},\"compact\"]}]}","id":"acaf255a-e9fa-4a87-906c-e36b63227fba"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/custom_logger.rb","start_line":51,"raw_source":"def logger\n      if settings.respond_to?(:logger)\n        settings.logger\n      else\n        request.logger\n      end\n    end","complexity_score":8.0,"ast_json":"{\"type\":\"def\",\"children\":[\"logger\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"logger\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"logger\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"logger\"]}]}]}","id":"0552678b-4bcb-4853-89dc-7589aa107593"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":179,"raw_source":"def test_variable_lookup_should_not_hang_with_invalid_syntax\n    Timeout.timeout(1) do\n      assert_template_result(\n        'bar',\n        \"{{['foo'}}\",\n        {\n          'foo' => 'bar',\n        },\n        error_mode: :lax,\n      )\n    end\n\n    very_long_key = \"1234567890\" * 100\n\n    template_list = [\n      \"{{['#{very_long_key}']}}\", # valid\n      \"{{['#{very_long_key}'}}\", # missing closing bracket\n      \"{{[['#{very_long_key}']}}\", # extra open bracket\n    ]\n\n    template_list.each do |template|\n      Timeout.timeout(1) do\n        assert_template_result(\n          'bar',\n          template,\n          {\n            very_long_key => 'bar',\n          },\n          error_mode: :lax,\n        )\n      end\n    end\n  end","complexity_score":12.43,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_lookup_should_not_hang_with_invalid_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"{{['foo'}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"very_long_key\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"1234567890\"]},\"*\",{\"type\":\"int\",\"children\":[100]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template_list\",{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"']}}\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"'}}\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{{[['\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]}]},{\"type\":\"str\",\"children\":[\"']}}\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_list\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timeout\"]},\"timeout\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"lvar\",\"children\":[\"very_long_key\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}]}]}","id":"cd2eec1c-21a5-4fec-8e38-eb43732c4ce3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":42,"raw_source":"def test_assign_uses_error_mode\n    assert_match_syntax_error(\n      \"Expected dotdot but found pipe in \",\n      \"{% assign foo = ('X' | downcase) %}\",\n      error_mode: :strict,\n    )\n    assert_template_result(\"\", \"{% assign foo = ('X' | downcase) %}\", error_mode: :lax)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_uses_error_mode\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_match_syntax_error\",{\"type\":\"str\",\"children\":[\"Expected dotdot but found pipe in \"]},{\"type\":\"str\",\"children\":[\"{% assign foo = ('X' | downcase) %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"strict\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% assign foo = ('X' | downcase) %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"error_mode\"]},{\"type\":\"sym\",\"children\":[\"lax\"]}]}]}]}]}]}","id":"0edba486-a696-49c8-be89-f4b182c0e9ea"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/shop_filter.rb","start_line":56,"raw_source":"def product_img_url(url, style = 'small')\n    unless url =~ %r{\\Aproducts/([\\w\\-\\_]+)\\.(\\w{2,4})}\n      raise ArgumentError, 'filter \"size\" can only be called on product images'\n    end\n\n    case style\n    when 'original'\n      '/files/shops/random_number/' + url\n    when 'grande', 'large', 'medium', 'compact', 'small', 'thumb', 'icon'\n      \"/files/shops/random_number/products/#{Regexp.last_match(1)}_#{style}.#{Regexp.last_match(2)}\"\n    else\n      raise ArgumentError, 'valid parameters for filter \"size\" are: original, grande, large, medium, compact, small, thumb and icon '\n    end\n  end","complexity_score":11.7,"ast_json":"{\"type\":\"def\",\"children\":[\"product_img_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]},{\"type\":\"optarg\",\"children\":[\"style\",{\"type\":\"str\",\"children\":[\"small\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\Aproducts/([\\\\w\\\\-\\\\_]+)\\\\.(\\\\w{2,4})\"]},{\"type\":\"regopt\",\"children\":[]}]}]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"filter \\\"size\\\" can only be called on product images\"]}]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"style\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"original\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"/files/shops/random_number/\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"grande\"]},{\"type\":\"str\",\"children\":[\"large\"]},{\"type\":\"str\",\"children\":[\"medium\"]},{\"type\":\"str\",\"children\":[\"compact\"]},{\"type\":\"str\",\"children\":[\"small\"]},{\"type\":\"str\",\"children\":[\"thumb\"]},{\"type\":\"str\",\"children\":[\"icon\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"/files/shops/random_number/products/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"str\",\"children\":[\"_\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"style\"]}]},{\"type\":\"str\",\"children\":[\".\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"ArgumentError\"]},{\"type\":\"str\",\"children\":[\"valid parameters for filter \\\"size\\\" are: original, grande, large, medium, compact, small, thumb and icon \"]}]}]}]}]}","id":"988f668f-0fa9-466a-8ec4-1c59db0ca240"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":119,"raw_source":"private def handle_invalid_tag_token(token, parse_context)\n      if token.end_with?('%}')\n        yield token, token\n      else\n        BlockBody.raise_missing_tag_terminator(token, parse_context)\n      end\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"handle_invalid_tag_token\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"%}\"]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_tag_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]}","id":"6d2daaae-41ca-4078-9293-76f8f3fc3c56"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":8,"raw_source":"def test_consume\n    p = new_parser(\"wat: 7\")\n    assert_equal('wat', p.consume(:id))\n    assert_equal(':', p.consume(:colon))\n    assert_equal('7', p.consume(:number))\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_consume\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"wat: 7\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"wat\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"id\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\":\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"colon\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"7\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"number\"]}]}]}]}]}","id":"184d2ea2-6e55-47f6-83b5-8e6003ef227d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tag/disableable_test.rb","start_line":41,"raw_source":"def test_block_tag_disabling_multiple_nested_tags\n    with_disableable_tags do\n      with_custom_tag('disable', DisableBoth) do\n        output = Template.parse('{% disable %}{% custom %};{% custom2 %}{% enddisable %}').render\n        assert_equal('Liquid error: custom usage is not allowed in this context;Liquid error: custom2 usage is not allowed in this context', output)\n      end\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_block_tag_disabling_multiple_nested_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_disableable_tags\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"disable\"]},{\"type\":\"const\",\"children\":[null,\"DisableBoth\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% disable %}{% custom %};{% custom2 %}{% enddisable %}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: custom usage is not allowed in this context;Liquid error: custom2 usage is not allowed in this context\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}]}]}","id":"731c4532-a8d4-47c4-8603-39a0cbb5cbf4"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":394,"raw_source":"def test_drop_with_key_called_only_once\n    @context['counter'] = CounterDrop.new\n\n    assert_equal(1, @context['counter[\"count\"]'])\n    assert_equal(2, @context['counter[\"count\"]'])\n    assert_equal(3, @context['counter[\"count\"]'])\n  end","complexity_score":9.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_drop_with_key_called_only_once\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"counter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CounterDrop\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"counter[\\\"count\\\"]\"]}]}]}]}]}","id":"b22ae70e-5816-483e-b4a3-49c2ff202cf2"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":132,"raw_source":"def method_missing(*args, &block)\n        to_str.send(*args, &block)\n      end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"method_missing\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_str\"]},\"send\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"edaa6e32-1df5-47da-a110-fbef0ab837ac"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":39,"raw_source":"def test_cache_state_is_stored_per_context\n    parse_context      = Liquid::ParseContext.new\n    shared_file_system = StubFileSystem.new(\n      'my_partial' => 'my shared value',\n    )\n    context_one = Liquid::Context.build(\n      registers: {\n        file_system: shared_file_system,\n      },\n    )\n    context_two = Liquid::Context.build(\n      registers: {\n        file_system: shared_file_system,\n      },\n    )\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context_one,\n        parse_context: parse_context,\n      )\n    end\n\n    Liquid::PartialCache.load(\n      'my_partial',\n      context: context_two,\n      parse_context: parse_context,\n    )\n\n    assert_equal(2, shared_file_system.file_read_count)\n  end","complexity_score":14.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_cache_state_is_stored_per_context\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"shared_file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my shared value\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_one\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context_two\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context_one\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context_two\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"shared_file_system\"]},\"file_read_count\"]}]}]}]}","id":"7871c2d8-2a53-4536-a2c9-e0bb7eec47ad"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":78,"raw_source":"def test_capture_detects_bad_syntax\n    assert_raises(SyntaxError) do\n      assert_template_result(\n        'content foo content foo ',\n        '{{ var2 }}{% capture %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}',\n        { 'var' => 'content' },\n      )\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_capture_detects_bad_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"content foo content foo \"]},{\"type\":\"str\",\"children\":[\"{{ var2 }}{% capture %}{{ var }} foo {% endcapture %}{{ var2 }}{{ var2 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"content\"]}]}]}]}]}]}","id":"9d307e5b-7f1d-4c5d-b40f-5d45eaa3973f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":61,"raw_source":"def cookie_paths(path)\n        path = '/' if path.to_s.empty?\n        paths = []\n        Pathname.new(path).descend { |p| paths << p.to_s }\n        paths\n      end","complexity_score":10.9,"ast_json":"{\"type\":\"def\",\"children\":[\"cookie_paths\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"path\"]},\"to_s\"]},\"empty?\"]},{\"type\":\"lvasgn\",\"children\":[\"path\",{\"type\":\"str\",\"children\":[\"/\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"paths\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Pathname\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"path\"]}]},\"descend\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"p\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"paths\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"to_s\"]}]}]},{\"type\":\"lvar\",\"children\":[\"paths\"]}]}]}","id":"55c3e107-8fc0-45cb-a0c2-61eb839c0f1f"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":104,"raw_source":"def strict_parse(markup)\n      p = @parse_context.new_parser(markup)\n      condition = parse_binary_comparisons(p)\n      p.consume(:end_of_string)\n      condition\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"strict_parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"markup\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@parse_context\"]},\"new_parser\",{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"condition\",{\"type\":\"send\",\"children\":[null,\"parse_binary_comparisons\",{\"type\":\"lvar\",\"children\":[\"p\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"consume\",{\"type\":\"sym\",\"children\":[\"end_of_string\"]}]},{\"type\":\"lvar\",\"children\":[\"condition\"]}]}]}","id":"20c9b9cc-711a-41d1-9364-5041f36f0101"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/streaming_test.rb","start_line":74,"raw_source":"def defer!(*)         @defer.pop.call    until @defer.empty?    end","complexity_score":4.5,"ast_json":"{\"type\":\"def\",\"children\":[\"defer!\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"until\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@defer\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@defer\"]},\"pop\"]},\"call\"]}]}]}","id":"a557278d-72a6-4044-a6e5-6ca23ada2083"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":206,"raw_source":"def slice(input, offset, length = nil)\n      offset = Utils.to_integer(offset)\n      length = length ? Utils.to_integer(length) : 1\n\n      begin\n        if input.is_a?(Array)\n          input.slice(offset, length) || []\n        else\n          Utils.to_s(input).slice(offset, length) || ''\n        end\n      rescue RangeError\n        if I64_RANGE.cover?(length) && I64_RANGE.cover?(offset)\n          raise # unexpected error\n        end\n        offset = offset.clamp(I64_RANGE)\n        length = length.clamp(I64_RANGE)\n        retry\n      end\n    end","complexity_score":26.28,"ast_json":"{\"type\":\"def\",\"children\":[\"slice\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"offset\"]},{\"type\":\"optarg\",\"children\":[\"length\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"offset\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"offset\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_integer\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Array\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"offset\"]},{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"array\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]},\"slice\",{\"type\":\"lvar\",\"children\":[\"offset\"]},{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RangeError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]},\"cover?\",{\"type\":\"lvar\",\"children\":[\"length\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]},\"cover?\",{\"type\":\"lvar\",\"children\":[\"offset\"]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]},null]},{\"type\":\"lvasgn\",\"children\":[\"offset\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"offset\"]},\"clamp\",{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"length\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"length\"]},\"clamp\",{\"type\":\"const\",\"children\":[null,\"I64_RANGE\"]}]}]},{\"type\":\"retry\",\"children\":[]}]}]},null]}]}]}]}","id":"858d98e0-f694-4d9b-91f6-2c71556836be"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":93,"raw_source":"def test_slice\n    assert_equal('oob', @filters.slice('foobar', 1, 3))\n    assert_equal('oobar', @filters.slice('foobar', 1, 1000))\n    assert_equal('', @filters.slice('foobar', 1, 0))\n    assert_equal('o', @filters.slice('foobar', 1, 1))\n    assert_equal('bar', @filters.slice('foobar', 3, 3))\n    assert_equal('ar', @filters.slice('foobar', -2, 2))\n    assert_equal('ar', @filters.slice('foobar', -2, 1000))\n    assert_equal('r', @filters.slice('foobar', -1))\n    assert_equal('', @filters.slice(nil, 0))\n    assert_equal('', @filters.slice('foobar', 100, 10))\n    assert_equal('', @filters.slice('foobar', -100, 10))\n    assert_equal('oob', @filters.slice('foobar', '1', '3'))\n    assert_raises(Liquid::ArgumentError) do\n      @filters.slice('foobar', nil)\n    end\n    assert_raises(Liquid::ArgumentError) do\n      @filters.slice('foobar', 0, \"\")\n    end\n    assert_equal(\"\", @filters.slice(\"foobar\", 0, -(1 << 64)))\n    assert_equal(\"foobar\", @filters.slice(\"foobar\", 0, 1 << 63))\n    assert_equal(\"\", @filters.slice(\"foobar\", 1 << 63, 6))\n    assert_equal(\"\", @filters.slice(\"foobar\", -(1 << 63), 6))\n  end","complexity_score":60.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_slice\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"o\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"ar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-2]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"r\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"nil\",\"children\":[]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[-100]},{\"type\":\"int\",\"children\":[10]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"oob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"3\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[64]}]}]},\"-@\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]},{\"type\":\"int\",\"children\":[6]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"slice\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[63]}]}]},\"-@\"]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}","id":"6f238105-4d15-47e1-8f8f-a7001c9890d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":260,"raw_source":"def test_truncatewords\n    assert_equal('one two three', @filters.truncatewords('one two three', 4))\n    assert_equal('one two...', @filters.truncatewords('one two three', 2))\n    assert_equal('one two three', @filters.truncatewords('one two three'))\n    assert_equal(\n      'Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221;...',\n      @filters.truncatewords('Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221; x 16&#8221; x 10.5&#8221; high) with cover.', 15),\n    )\n    assert_equal(\"测试测试测试测试\", @filters.truncatewords('测试测试测试测试', 5))\n    assert_equal('one two1', @filters.truncatewords(\"one two three\", 2, 1))\n    assert_equal('one two three...', @filters.truncatewords(\"one  two\\tthree\\nfour\", 3))\n    assert_equal('one two...', @filters.truncatewords(\"one two three four\", 2))\n    assert_equal('one...', @filters.truncatewords(\"one two three four\", 0))\n    assert_equal('one two three four', @filters.truncatewords(\"one two three four\", 1 << 31))\n    assert_equal('one...', @filters.truncatewords(\"one two three four\", -(1 << 32)))\n  end","complexity_score":33.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncatewords\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[4]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221;...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"Two small (13&#8221; x 5.5&#8221; x 10&#8221; high) baskets fit inside one large basket (13&#8221; x 16&#8221; x 10.5&#8221; high) with cover.\"]},{\"type\":\"int\",\"children\":[15]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"测试测试测试测试\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"测试测试测试测试\"]},{\"type\":\"int\",\"children\":[5]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two1\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three\"]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one  two\\tthree\\nfour\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[31]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"one...\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"truncatewords\",{\"type\":\"str\",\"children\":[\"one two three four\"]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[1]},\"<<\",{\"type\":\"int\",\"children\":[32]}]}]},\"-@\"]}]}]}]}]}","id":"d98f55dd-1daa-4a4a-b9f7-7fcd579bd5f9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/nokogiri_test.rb","start_line":7,"raw_source":"def nokogiri_app(&block)\n    mock_app do\n      set :views, __dir__ + '/views'\n      get('/', &block)\n    end\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"nokogiri_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"ba2a48da-6c67-4bd2-b288-d381a9e687fb"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":248,"raw_source":"def create_variable(token, parse_context)\n      if token.end_with?(\"}}\")\n        i = 2\n        i = 3 if token[i] == \"-\"\n        parse_end = token.length - 3\n        parse_end -= 1 if token[parse_end] == \"-\"\n        markup_end = parse_end - i + 1\n        markup = markup_end <= 0 ? \"\" : token.slice(i, markup_end)\n\n        return Variable.new(markup, parse_context)\n      end\n\n      BlockBody.raise_missing_variable_terminator(token, parse_context)\n    end","complexity_score":31.1,"ast_json":"{\"type\":\"def\",\"children\":[\"create_variable\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"token\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"end_with?\",{\"type\":\"str\",\"children\":[\"}}\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"int\",\"children\":[3]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"parse_end\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"length\"]},\"-\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"parse_end\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"-\"]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"parse_end\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"markup_end\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_end\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup_end\"]},\"<=\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"slice\",{\"type\":\"lvar\",\"children\":[\"i\"]},{\"type\":\"lvar\",\"children\":[\"markup_end\"]}]}]}]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Variable\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BlockBody\"]},\"raise_missing_variable_terminator\",{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]}","id":"fccf233a-563f-47b5-afcc-ea00b5891dcf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":526,"raw_source":"def test_map_over_proc\n    drop  = TestDrop.new(value: \"testfoo\")\n    p     = proc { drop }\n    output = Liquid::Template.parse('{{ procs | map: \"value\" }}').render!({ \"procs\" => [p] })\n    assert_equal(\"testfoo\", output)\n  end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_over_proc\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"testfoo\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"drop\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ procs | map: \\\"value\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"procs\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"testfoo\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"b69018a5-46af-43ee-b3b6-22b6b8fa075a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":229,"raw_source":"def test_strings\n    assert_template_result(\"hello!\", '{{ \"hello!\" }}')\n    assert_template_result(\"hello!\", \"{{ 'hello!' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hello!\"]},{\"type\":\"str\",\"children\":[\"{{ \\\"hello!\\\" }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"hello!\"]},{\"type\":\"str\",\"children\":[\"{{ 'hello!' }}\"]}]}]}]}","id":"c632546e-9d27-49e2-9495-b670f61adf05"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1821,"raw_source":"def setup_default_middleware(builder)\n        builder.use ExtendedRack\n        builder.use ShowExceptions       if show_exceptions?\n        builder.use Rack::MethodOverride if method_override?\n        builder.use Rack::Head\n        setup_logging    builder\n        setup_sessions   builder\n        setup_protection builder\n        setup_host_authorization builder\n      end","complexity_score":12.2,"ast_json":"{\"type\":\"def\",\"children\":[\"setup_default_middleware\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"builder\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[null,\"ExtendedRack\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"show_exceptions?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[null,\"ShowExceptions\"]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"method_override?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"MethodOverride\"]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"use\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Head\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_logging\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_sessions\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_protection\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_host_authorization\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]}]}","id":"7cd9d0a1-4baa-4ee3-b5d7-3fa9ba35784a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":83,"raw_source":"def test_nil_renders_as_empty_string\n    assert_template_result(\"\", \"{{ nil }}\")\n    assert_template_result(\"cat\", \"{{ nil | append: 'cat' }}\")\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_renders_as_empty_string\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{{ nil }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"cat\"]},{\"type\":\"str\",\"children\":[\"{{ nil | append: 'cat' }}\"]}]}]}]}","id":"a56e5205-6081-4379-8518-32fb01c7948d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/engine_tracking.rb","start_line":96,"raw_source":"def render(engine, *)\n      with_engine(engine) { super }\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"engine\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_engine\",{\"type\":\"lvar\",\"children\":[\"engine\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"0801a974-2b29-4946-9a5d-3b44ea0346e9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_start_test.rb","start_line":29,"raw_source":"def test_classic_app_start\n    app_file = File.join(__dir__, \"integration\", \"simple_app.rb\")\n    command = command_for(app_file)\n    with_process(command: command) do |process, read_io|\n      assert wait_for_output(read_io, /Sinatra \\(v.+\\) has taken the stage/)\n    end\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_classic_app_start\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"app_file\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"join\",{\"type\":\"send\",\"children\":[null,\"__dir__\"]},{\"type\":\"str\",\"children\":[\"integration\"]},{\"type\":\"str\",\"children\":[\"simple_app.rb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"command\",{\"type\":\"send\",\"children\":[null,\"command_for\",{\"type\":\"lvar\",\"children\":[\"app_file\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_process\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"command\"]},{\"type\":\"lvar\",\"children\":[\"command\"]}]}]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"process\"]},{\"type\":\"arg\",\"children\":[\"read_io\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[null,\"wait_for_output\",{\"type\":\"lvar\",\"children\":[\"read_io\"]},{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"Sinatra \\\\(v.+\\\\) has taken the stage\"]},{\"type\":\"regopt\",\"children\":[]}]}]}]}]}]}]}","id":"fe73aae5-e793-4f04-b8c4-170a7d5abca6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":611,"raw_source":"def replace_last(input, string, replacement)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      replacement = Utils.to_s(replacement)\n\n      start_index = input.rindex(string)\n\n      return input unless start_index\n\n      output = input.dup\n      output[start_index, string.length] = replacement\n      output\n    end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"replace_last\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]},{\"type\":\"arg\",\"children\":[\"replacement\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"replacement\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"replacement\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"start_index\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"rindex\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"start_index\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"input\"]},\"dup\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"start_index\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"length\"]},{\"type\":\"lvar\",\"children\":[\"replacement\"]}]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}","id":"c1dda49e-cde2-4022-a2fd-1a88eb8c6501"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":17,"raw_source":"def translate(name, vars = {})\n      interpolate(deep_fetch_translation(name), vars)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"translate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"optarg\",\"children\":[\"vars\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"interpolate\",{\"type\":\"send\",\"children\":[null,\"deep_fetch_translation\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvar\",\"children\":[\"vars\"]}]}]}","id":"496c88be-6f5b-40ff-972a-27594893ff7f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/rabl_test.rb","start_line":11,"raw_source":"def rabl_app(&block)\n    mock_app {\n      set :views, __dir__ + '/views'\n      get '/', &block\n    }\n    get '/'\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"rabl_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]},\"+\",{\"type\":\"str\",\"children\":[\"/views\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"get\",{\"type\":\"str\",\"children\":[\"/\"]}]}]}]}","id":"81a98e69-1228-4100-ada5-ccfcae72969e"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler.rb","start_line":119,"raw_source":"def profile_node(template_name, code: nil, line_number: nil)\n      timing = Timing.new(code: code, template_name: template_name, line_number: line_number)\n      parent_children = @current_children\n      start_time = monotonic_time\n      begin\n        @current_children = timing.children\n        yield\n      ensure\n        @current_children = parent_children\n        timing.total_time = monotonic_time - start_time\n        parent_children << timing\n      end\n    end","complexity_score":14.0,"ast_json":"{\"type\":\"def\",\"children\":[\"profile_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template_name\"]},{\"type\":\"kwoptarg\",\"children\":[\"code\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwoptarg\",\"children\":[\"line_number\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"timing\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Timing\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"lvar\",\"children\":[\"code\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_name\"]},{\"type\":\"lvar\",\"children\":[\"template_name\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]},{\"type\":\"lvar\",\"children\":[\"line_number\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parent_children\",{\"type\":\"ivar\",\"children\":[\"@current_children\"]}]},{\"type\":\"lvasgn\",\"children\":[\"start_time\",{\"type\":\"send\",\"children\":[null,\"monotonic_time\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"ensure\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"children\"]}]},{\"type\":\"yield\",\"children\":[]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@current_children\",{\"type\":\"lvar\",\"children\":[\"parent_children\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"timing\"]},\"total_time=\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"monotonic_time\"]},\"-\",{\"type\":\"lvar\",\"children\":[\"start_time\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parent_children\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"timing\"]}]}]}]}]}]}]}","id":"d86ceaab-a269-46c3-ac31-0ee626ace860"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":88,"raw_source":"def ==(other)\n      self.class == other.class && state == other.state\n    end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"==\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"class\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"state\"]},\"==\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"state\"]}]}]}]}","id":"a84dc37a-550f-430b-a5c8-765b62b04e32"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":64,"raw_source":"def test_variable_piping_with_input\n    text     = %( {{ car.gm | cite_funny }} )\n    expected = %( LOL: bad )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_input\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | cite_funny }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" LOL: bad \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"17602784-5d15-4547-9eb8-95060b7a1ec7"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":75,"raw_source":"def test_hash_constructor\n    assert_equal :a, @hash[?a]\n    assert_equal :b, @hash[?b]\n    assert_equal 3, @hash[3]\n    assert_equal({ ?a=>:a, ?b=>:b }, @hash['nested'][?a][0])\n    assert_equal :c, @hash['nested'][?a][1]\n    assert_equal 4, @hash['nested'][?a][2]\n    assert_equal :f, @hash['nested'][?f]\n    assert_equal 7, @hash['nested'][7]\n    assert_equal :a, @hash['simple_nested'][?a]\n    assert_equal :b, @hash['simple_nested'][?b]\n    assert_nil @hash[?d]\n  end","complexity_score":41.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hash_constructor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[3]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"sym\",\"children\":[\"a\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[4]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]},\"[]\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"f\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[7]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"nested\"]}]},\"[]\",{\"type\":\"int\",\"children\":[7]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"simple_nested\"]}]},\"[]\",{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"d\"]}]}]}]}]}","id":"6cf657e8-bda2-4153-8821-20fd2b74b6bf"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":222,"raw_source":"def namespace(pattern, conditions = {}, &block)\n        Sinatra::Namespace.new(self, pattern, conditions, &block)\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"namespace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]},{\"type\":\"optarg\",\"children\":[\"conditions\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Namespace\"]},\"new\",{\"type\":\"self\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"pattern\"]},{\"type\":\"lvar\",\"children\":[\"conditions\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"0188ef15-1f8e-47a9-bf7f-556d32efbcf8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":367,"raw_source":"def test_render_tag_renders_error_with_template_name_from_template_factory\n    assert_template_result(\n      'Liquid error (some/path/foo line 1): standard error',\n      \"{% include 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      template_factory: StubTemplateFactory.new,\n      render_errors: true,\n    )\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% include 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}","id":"e5ace99e-0fb4-4571-9b5a-76f1b1b45f04"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/environment.rb","start_line":124,"raw_source":"def create_strainer(context, filters = Const::EMPTY_ARRAY)\n      return @strainer_template.new(context) if filters.empty?\n\n      strainer_template = @strainer_template_class_cache[filters] ||= begin\n        klass = Class.new(@strainer_template)\n        filters.each { |f| klass.add_filter(f) }\n        klass\n      end\n\n      strainer_template.new(context)\n    end","complexity_score":11.7,"ast_json":"{\"type\":\"def\",\"children\":[\"create_strainer\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"optarg\",\"children\":[\"filters\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Const\"]},\"EMPTY_ARRAY\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"strainer_template\",{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@strainer_template_class_cache\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"filters\"]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"klass\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Class\"]},\"new\",{\"type\":\"ivar\",\"children\":[\"@strainer_template\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filters\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"f\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"klass\"]},\"add_filter\",{\"type\":\"lvar\",\"children\":[\"f\"]}]}]},{\"type\":\"lvar\",\"children\":[\"klass\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer_template\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}","id":"d4f75fcc-748d-4759-bd2c-572604cb2979"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":473,"raw_source":"def find(input, property, target_value = nil)\n      filter_array(input, property, target_value, nil) { |ary, &block| ary.find(&block) }\n    end","complexity_score":5.4,"ast_json":"{\"type\":\"def\",\"children\":[\"find\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"property\"]},{\"type\":\"optarg\",\"children\":[\"target_value\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filter_array\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"property\"]},{\"type\":\"lvar\",\"children\":[\"target_value\"]},{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ary\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"find\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"71fe3bdf-0d33-4668-90b6-5a9ef5df53e4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":248,"raw_source":"def register(*extensions, &block)\n        extensions << Module.new(&block) if block_given?\n        @extensions += extensions\n        extensions.each do |extension|\n          extend extension\n          extension.registered(self) if extension.respond_to?(:registered)\n        end\n      end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"register\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"extensions\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"<<\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]},null]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@extensions\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"extensions\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extensions\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"extension\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"extend\",{\"type\":\"lvar\",\"children\":[\"extension\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"registered\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"extension\"]},\"registered\",{\"type\":\"self\",\"children\":[]}]},null]}]}]}]}]}","id":"6f3e8922-424f-472a-84d1-97c7a6b1a6e5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":187,"raw_source":"def keep_if\n        return enum_for(__method__) unless block_given?\n\n        delete_if { |*a| !yield(*a) }\n      end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"keep_if\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[null,\"enum_for\",{\"type\":\"send\",\"children\":[null,\"__method__\"]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"delete_if\"]},{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"a\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]}]}]},\"!\"]}]}]}]}","id":"c61ca1a1-9dd4-4670-992e-e3cc7aee2de1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":205,"raw_source":"def test_setting_default_exception_renderer\n    exceptions = []\n    default_exception_renderer = ->(e) {\n      exceptions << e\n      ''\n    }\n\n    env = Liquid::Environment.build(exception_renderer: default_exception_renderer)\n    template = Liquid::Template.parse('This is a runtime error: {{ errors.argument_error }}', environment: env)\n\n    output = template.render('errors' => ErrorDrop.new)\n\n    assert_equal('This is a runtime error: ', output)\n    assert_equal([Liquid::ArgumentError], template.errors.map(&:class))\n  end","complexity_score":17.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_setting_default_exception_renderer\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"exceptions\",{\"type\":\"array\",\"children\":[]}]},{\"type\":\"lvasgn\",\"children\":[\"default_exception_renderer\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"exceptions\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"e\"]}]},{\"type\":\"str\",\"children\":[\"\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"env\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"exception_renderer\"]},{\"type\":\"lvar\",\"children\":[\"default_exception_renderer\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"This is a runtime error: {{ errors.argument_error }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"This is a runtime error: \"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"class\"]}]}]}]}]}]}","id":"b4add2f9-209e-44ac-b1aa-82472fc9f74d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":98,"raw_source":"def each\n    yield 1\n    yield 2\n    yield 3\n  end","complexity_score":3.75,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"int\",\"children\":[3]}]}]}]}","id":"a6cc588a-3de9-45a4-8e22-11e4d8f1d97a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":162,"raw_source":"def has_key?(key)\n        response_cookies.key? key.to_s or request_cookies.key? key.to_s\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"has_key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response_cookies\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_cookies\"]},\"key?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"to_s\"]}]}]}]}","id":"35e2f78f-63de-4465-a4d7-6c811d99c727"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":183,"raw_source":"def test_only_intended_filters_make_it_there\n    filter = Module.new do\n      def hi(output)\n        output + ' hi!'\n      end\n    end\n\n    context = Context.new\n    assert_equal(\"Wookie\", context.invoke(\"hi\", \"Wookie\"))\n\n    context.add_filters(filter)\n    assert_equal(\"Wookie hi!\", context.invoke(\"hi\", \"Wookie\"))\n  end","complexity_score":10.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_only_intended_filters_make_it_there\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filter\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"def\",\"children\":[\"hi\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"output\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"output\"]},\"+\",{\"type\":\"str\",\"children\":[\" hi!\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Wookie\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"Wookie\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"add_filters\",{\"type\":\"lvar\",\"children\":[\"filter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Wookie hi!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"hi\"]},{\"type\":\"str\",\"children\":[\"Wookie\"]}]}]}]}]}","id":"dd9587ed-141a-4a8e-9138-e2ae10bfc176"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/drop_test.rb","start_line":251,"raw_source":"def test_invokable_methods\n    assert_equal(%w(to_liquid catchall context texts).to_set, ProductDrop.invokable_methods)\n    assert_equal(%w(to_liquid scopes_as_array loop_pos scopes).to_set, ContextDrop.invokable_methods)\n    assert_equal(%w(to_liquid size max min first count).to_set, EnumerableDrop.invokable_methods)\n    assert_equal(%w(to_liquid max min sort count first).to_set, RealEnumerableDrop.invokable_methods)\n  end","complexity_score":13.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_invokable_methods\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"catchall\"]},{\"type\":\"str\",\"children\":[\"context\"]},{\"type\":\"str\",\"children\":[\"texts\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ProductDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"scopes_as_array\"]},{\"type\":\"str\",\"children\":[\"loop_pos\"]},{\"type\":\"str\",\"children\":[\"scopes\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ContextDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"size\"]},{\"type\":\"str\",\"children\":[\"max\"]},{\"type\":\"str\",\"children\":[\"min\"]},{\"type\":\"str\",\"children\":[\"first\"]},{\"type\":\"str\",\"children\":[\"count\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"EnumerableDrop\"]},\"invokable_methods\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"to_liquid\"]},{\"type\":\"str\",\"children\":[\"max\"]},{\"type\":\"str\",\"children\":[\"min\"]},{\"type\":\"str\",\"children\":[\"sort\"]},{\"type\":\"str\",\"children\":[\"count\"]},{\"type\":\"str\",\"children\":[\"first\"]}]},\"to_set\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"RealEnumerableDrop\"]},\"invokable_methods\"]}]}]}]}","id":"eaa276fc-375c-487a-8833-8a346d225d74"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/profiler_test.rb","start_line":39,"raw_source":"def test_template_allows_flagging_profiling\n    t = Template.parse(\"{{ 'a string' | upcase }}\")\n    t.render!\n\n    assert_nil(t.profiler)\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_template_allows_flagging_profiling\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ 'a string' | upcase }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"render!\"]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"profiler\"]}]}]}]}","id":"c8c912b4-aa38-4ec2-9cf8-b3030539ffa1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":55,"raw_source":"def close_body(body)\n        body.close if body.respond_to?(:close)\n      end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"close_body\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"close\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]},\"close\"]},null]}]}","id":"f82287f0-9f8f-4104-a5ee-56a66787c6ff"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":214,"raw_source":"def render(context)\n      render_to_output_buffer(context, +'')\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"send\",\"children\":[null,\"render_to_output_buffer\",{\"type\":\"lvar\",\"children\":[\"context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]},\"+@\"]}]}]}","id":"dc0d413c-b81e-4be3-9cc7-bfc96d4bfe68"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":223,"raw_source":"def test_post_trim_output\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {{ 'John' -}}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          John</p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {{ 'John' -}}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          John</p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"06f96aa0-9043-44cc-af8f-ef1ed692a4eb"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":6,"raw_source":"def test_uses_the_file_system_register_if_present\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n  end","complexity_score":8.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_the_file_system_register_if_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]}]}]}","id":"bb2ee164-7113-409e-a00d-ce2d64ccbed8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/integration_async_helper.rb","start_line":6,"raw_source":"def it(message, &block)\n    Server.all_async.each do |server|\n      next unless server.installed?\n      super(\"with #{server.name}: #{message}\") { server.run_test(self, &block) }\n    end\n  end","complexity_score":12.0,"ast_json":"{\"type\":\"def\",\"children\":[\"it\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Server\"]},\"all_async\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"server\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"installed?\"]},null,{\"type\":\"next\",\"children\":[]}]},{\"type\":\"block\",\"children\":[{\"type\":\"super\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"with \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"name\"]}]},{\"type\":\"str\",\"children\":[\": \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"server\"]},\"run_test\",{\"type\":\"self\",\"children\":[]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}]}","id":"11e52048-7f95-49c4-8a0d-b581d5718e81"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/registers_unit_test.rb","start_line":8,"raw_source":"def test_set\n    static_register = Registers.new(a: 1, b: 2)\n    static_register[:b] = 22\n    static_register[:c] = 33\n\n    assert_equal(1, static_register[:a])\n    assert_equal(22, static_register[:b])\n    assert_equal(33, static_register[:c])\n  end","complexity_score":12.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_set\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"static_register\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Registers\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[2]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"b\"]},{\"type\":\"int\",\"children\":[22]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"c\"]},{\"type\":\"int\",\"children\":[33]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[22]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"b\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[33]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"static_register\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"c\"]}]}]}]}]}","id":"fff2e735-3217-4760-af64-791e6fedc91a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":275,"raw_source":"def test_syntax_error_is_raised_with_template_name\n    file_system = StubFileSystem.new(\"snippet\" => \"1\\n2\\n{{ 1\")\n\n    context = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    template = Template.parse(\n      '{% render \"snippet\" %}',\n      line_numbers: true,\n    )\n    template.name = \"template/index\"\n\n    assert_equal(\n      \"Liquid syntax error (snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\",\n      template.render(context),\n    )\n  end","complexity_score":9.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax_error_is_raised_with_template_name\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"snippet\"]},{\"type\":\"str\",\"children\":[\"1\\n2\\n{{ 1\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% render \\\"snippet\\\" %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"name=\",{\"type\":\"str\",\"children\":[\"template/index\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid syntax error (snippet line 3): Variable '{{' was not properly terminated with regexp: /\\\\}\\\\}/\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"lvar\",\"children\":[\"context\"]}]}]}]}]}","id":"abde6137-a8db-4475-82a0-a53e192ea699"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/test_helper.rb","start_line":203,"raw_source":"def initialize(values)\n    @file_read_count = 0\n    @values          = values\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"values\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@file_read_count\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"ivasgn\",\"children\":[\"@values\",{\"type\":\"lvar\",\"children\":[\"values\"]}]}]}]}","id":"05c14a24-701d-4107-9778-6bf7b5e01a58"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1740,"raw_source":"def host_name(pattern)\n        condition { pattern === request.host }\n      end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"host_name\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"pattern\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"condition\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"pattern\"]},\"===\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request\"]},\"host\"]}]}]}]}","id":"11578a2c-2afd-43a2-b883-4b7de5d6c9c9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":133,"raw_source":"def test_disable_expression_cache\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    parse_context = Liquid::ParseContext.new(expression_cache: false)\n    Liquid::Template.parse(template, parse_context).render\n    assert(parse_context.instance_variable_get(:@expression_cache).nil?)\n  end","complexity_score":13.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_disable_expression_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},\"render\"]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"instance_variable_get\",{\"type\":\"sym\",\"children\":[\"@expression_cache\"]}]},\"nil?\"]}]}]}]}","id":"b018d4ef-0af8-4edb-8707-6e0f4325a3a0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":121,"raw_source":"def test_nil_offset_is_treated_as_zero\n    expect = \"<tr class=\\\"row1\\\">\\n\" \\\n      \"<td class=\\\"col1\\\">1:false</td>\" \\\n      \"<td class=\\\"col2\\\">2:true</td>\" \\\n      \"</tr>\\n\"\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) offset:nil %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\",\n    )\n\n    assert_template_result(\n      expect,\n      \"{% tablerow i in (1..2) offset:var %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\",\n      { \"var\" => nil },\n    )\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nil_offset_is_treated_as_zero\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"expect\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col1\\\">1:false</td>\"]},{\"type\":\"str\",\"children\":[\"<td class=\\\"col2\\\">2:true</td>\"]},{\"type\":\"str\",\"children\":[\"</tr>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) offset:nil %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expect\"]},{\"type\":\"str\",\"children\":[\"{% tablerow i in (1..2) offset:var %}{{ i }}:{{ tablerowloop.col_last }}{% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"8b396080-e79f-4b80-87a5-e799bd16d977"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":39,"raw_source":"private def parse_for_liquid_tag(tokenizer, parse_context)\n      while (token = tokenizer.shift)\n        unless token.empty? || token.match?(WhitespaceOrNothing)\n          unless token =~ LiquidTagToken\n            # line isn't empty but didn't match tag syntax, yield and let the\n            # caller raise a syntax error\n            return yield token, token\n          end\n          tag_name = Regexp.last_match(1)\n          markup   = Regexp.last_match(2)\n\n          if tag_name == 'liquid'\n            parse_context.line_number -= 1\n            next parse_liquid_tag(markup, parse_context)\n          end\n\n          unless (tag = parse_context.environment.tag_for_name(tag_name))\n            # end parsing if we reach an unknown tag and let the caller decide\n            # determine how to proceed\n            return yield tag_name, markup\n          end\n          new_tag = tag.parse(tag_name, markup, tokenizer, parse_context)\n          @blank &&= new_tag.blank?\n          @nodelist << new_tag\n        end\n        parse_context.line_number = tokenizer.line_number\n      end\n\n      yield nil, nil\n    end","complexity_score":47.55,"ast_json":"{\"type\":\"send\",\"children\":[null,\"private\",{\"type\":\"def\",\"children\":[\"parse_for_liquid_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"while\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"token\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"shift\"]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"empty?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"match?\",{\"type\":\"const\",\"children\":[null,\"WhitespaceOrNothing\"]}]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"LiquidTagToken\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"token\"]},{\"type\":\"lvar\",\"children\":[\"token\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"tag_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[2]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},\"==\",{\"type\":\"str\",\"children\":[\"liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number\"]},\"-\",{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"next\",\"children\":[{\"type\":\"send\",\"children\":[null,\"parse_liquid_tag\",{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"environment\"]},\"tag_for_name\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"new_tag\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"and_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@blank\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"new_tag\"]},\"blank?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"new_tag\"]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"line_number=\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tokenizer\"]},\"line_number\"]}]}]}]},{\"type\":\"yield\",\"children\":[{\"type\":\"nil\",\"children\":[]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"a91549a5-b49a-4681-a266-9a393365f382"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1033,"raw_source":"def test_where\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | where: 'ok' | map: 'handle' | join: ' ' }}\"\n    expected_output = \"alpha delta\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | where: 'ok' | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"alpha delta\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"f5749228-e9d4-43b1-b551-3945cdc9f46f"}
{"repo_name":"liquid","file_path":"./repos/liquid/example/server/liquid_servlet.rb","start_line":27,"raw_source":"def read_template(filename = @action)\n    File.read(\"#{__dir__}/templates/#{filename}.liquid\")\n  end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"read_template\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"filename\",{\"type\":\"ivar\",\"children\":[\"@action\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"read\",{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"__dir__\"]}]},{\"type\":\"str\",\"children\":[\"/templates/\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"filename\"]}]},{\"type\":\"str\",\"children\":[\".liquid\"]}]}]}]}","id":"2636b29c-b9e7-40ab-9991-11e188f2cefa"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/context.rb","start_line":182,"raw_source":"def [](expression)\n      evaluate(Expression.parse(expression, @string_scanner))\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"[]\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Expression\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"expression\"]},{\"type\":\"ivar\",\"children\":[\"@string_scanner\"]}]}]}]}","id":"654fdf0a-c89f-42c0-87f1-bd0c655d8371"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1126,"raw_source":"def test_where_indexable_but_non_map_value\n    assert_raises(Liquid::ArgumentError) { @filters.where(1, \"ok\", true) }\n    assert_raises(Liquid::ArgumentError) { @filters.where(1, \"ok\") }\n  end","complexity_score":6.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_where_indexable_but_non_map_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ArgumentError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"where\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]}]}","id":"0b727305-cf22-4aaf-8377-f48ba73d2682"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":110,"raw_source":"def command\n      \"bundle exec ruby #{app_file} -p #{port} -e production\"\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"command\",{\"type\":\"args\",\"children\":[]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"bundle exec ruby \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app_file\"]}]},{\"type\":\"str\",\"children\":[\" -p \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"port\"]}]},{\"type\":\"str\",\"children\":[\" -e production\"]}]}]}","id":"e4dc4723-fcff-4932-b799-28c6021af22e"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":122,"raw_source":"def respond_to?(method, *)\n        method.to_sym == :options or super\n      end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_to?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},\"to_sym\"]},\"==\",{\"type\":\"sym\",\"children\":[\"options\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"bdd70d70-577d-423f-98de-301f53bae9a6"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/forloop_drop.rb","start_line":85,"raw_source":"def increment!\n      @index += 1\n    end","complexity_score":2.3,"ast_json":"{\"type\":\"def\",\"children\":[\"increment!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@index\"]},\"+\",{\"type\":\"int\",\"children\":[1]}]}]}","id":"38efe58b-3f83-4d16-ab00-7b36ae7da479"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/respond_with.rb","start_line":99,"raw_source":"def on(type, &block)\n        @app.settings.mime_types(type).each do |mime|\n          case mime\n          when '*/*'            then @default     = block\n          when %r{^([^/]+)/\\*$} then @generic[$1] = block\n          else                       @map[mime]   = block\n          end\n        end\n      end","complexity_score":11.9,"ast_json":"{\"type\":\"def\",\"children\":[\"on\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@app\"]},\"settings\"]},\"mime_types\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"mime\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"lvar\",\"children\":[\"mime\"]},{\"type\":\"when\",\"children\":[{\"type\":\"str\",\"children\":[\"*/*\"]},{\"type\":\"ivasgn\",\"children\":[\"@default\",{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"^([^/]+)/\\\\*$\"]},{\"type\":\"regopt\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@generic\"]},\"[]=\",{\"type\":\"nth_ref\",\"children\":[1]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@map\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"mime\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"82485657-c055-4ff6-8427-0e9bffaa7bed"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":362,"raw_source":"def deactivate(element)\n        case element.type\n        when :route\n          verb      = element.representation[:verb]\n          signature = element.representation[:signature]\n          (routes[verb] ||= []).delete(signature)\n        when :middleware\n          @middleware.delete(element.representation)\n        when :before_filter\n          filters[:before].delete(element.representation)\n        when :after_filter\n          filters[:after].delete(element.representation)\n        when :error\n          code    = element.representation[:code]\n          handler = element.representation[:handler]\n          @errors.delete(code) if @errors[code] == handler\n        end\n      end","complexity_score":44.2,"ast_json":"{\"type\":\"def\",\"children\":[\"deactivate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"element\"]}]},{\"type\":\"case\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"type\"]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"route\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"verb\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"verb\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"signature\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"signature\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"or_asgn\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"routes\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"verb\"]}]},{\"type\":\"array\",\"children\":[]}]}]},\"delete\",{\"type\":\"lvar\",\"children\":[\"signature\"]}]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"middleware\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@middleware\"]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"before_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"before\"]}]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"after_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"after\"]}]},\"delete\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]}]}]},{\"type\":\"when\",\"children\":[{\"type\":\"sym\",\"children\":[\"error\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"code\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"code\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"handler\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"element\"]},\"representation\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"handler\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},\"==\",{\"type\":\"lvar\",\"children\":[\"handler\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@errors\"]},\"delete\",{\"type\":\"lvar\",\"children\":[\"code\"]}]},null]}]}]},null]}]}","id":"211f17db-6cb9-4d02-a934-774dc1fdd642"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":203,"raw_source":"def length\n        to_hash.length\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"length\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"to_hash\"]},\"length\"]}]}","id":"8868d1ef-8ffd-4e6a-bf7b-bbc1b0a811ae"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":267,"raw_source":"def test_bug_compatible_silencing_of_errors_in_blank_nodes\n    output = Liquid::Template.parse(\"{% assign x = 0 %}{% if 1 < '2' %}not blank{% assign x = 3 %}{% endif %}{{ x }}\").render\n    assert_equal(\"Liquid error: comparison of Integer with String failed0\", output)\n\n    output = Liquid::Template.parse(\"{% assign x = 0 %}{% if 1 < '2' %}{% assign x = 3 %}{% endif %}{{ x }}\").render\n    assert_equal(\"0\", output)\n  end","complexity_score":8.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_bug_compatible_silencing_of_errors_in_blank_nodes\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign x = 0 %}{% if 1 < '2' %}not blank{% assign x = 3 %}{% endif %}{{ x }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: comparison of Integer with String failed0\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% assign x = 0 %}{% if 1 < '2' %}{% assign x = 3 %}{% endif %}{{ x }}\"]}]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"0\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"4f18b5af-bb89-49f5-8606-bd3dc8acb211"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/include.rb","start_line":105,"raw_source":"def children\n        [\n          @node.template_name_expr,\n          @node.variable_name_expr,\n        ] + @node.attributes.values\n      end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"children\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"template_name_expr\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"variable_name_expr\"]}]},\"+\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@node\"]},\"attributes\"]},\"values\"]}]}]}","id":"a31b7431-e510-4ee1-8cce-35b400982119"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":71,"raw_source":"def record(method, *args, &block)\n      recorded_methods << [method, args, block]\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"record\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]},{\"type\":\"restarg\",\"children\":[\"args\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"recorded_methods\"]},\"<<\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"lvar\",\"children\":[\"args\"]},{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"cf1e4147-0ea3-4ce4-8435-6fa2fdafeb25"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/respond_with_spec.rb","start_line":7,"raw_source":"def respond_app(&block)\n    mock_app do\n      set :app_file, __FILE__\n      set :views, root + '/respond_with'\n      register Sinatra::RespondWith\n      class_eval(&block)\n    end\n  end","complexity_score":16.0,"ast_json":"{\"type\":\"def\",\"children\":[\"respond_app\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mock_app\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"app_file\"]},{\"type\":\"str\",\"children\":[\"(method)\"]}]},{\"type\":\"send\",\"children\":[null,\"set\",{\"type\":\"sym\",\"children\":[\"views\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"root\"]},\"+\",{\"type\":\"str\",\"children\":[\"/respond_with\"]}]}]},{\"type\":\"send\",\"children\":[null,\"register\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"RespondWith\"]}]},{\"type\":\"send\",\"children\":[null,\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}]}","id":"e8e3a973-3751-460d-8620-4b67f61a1c56"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":12,"raw_source":"def test_basic_condition\n    assert_equal(false, Condition.new(1, '==', 2).evaluate(Context.new))\n    assert_equal(true,  Condition.new(1, '==', 1).evaluate(Context.new))\n  end","complexity_score":11.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_basic_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"true\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[1]}]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]}]}]}]}","id":"c9da097e-690a-4903-a332-bb26216de3e6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/inline_comment_test.rb","start_line":8,"raw_source":"def test_inline_comment_returns_nothing\n    assert_template_result('', '{%- # this is an inline comment -%}')\n    assert_template_result('', '{%-# this is an inline comment -%}')\n    assert_template_result('', '{% # this is an inline comment %}')\n    assert_template_result('', '{%# this is an inline comment %}')\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_inline_comment_returns_nothing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%- # this is an inline comment -%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%-# this is an inline comment -%}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% # this is an inline comment %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{%# this is an inline comment %}\"]}]}]}]}","id":"b8016610-fa59-412a-8f66-617b58e8b387"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/template_unit_test.rb","start_line":14,"raw_source":"def test_sets_default_localization_in_context_with_quick_initialization\n    t = Template.new\n    t.parse('{%comment%}{%endcomment%}', locale: I18n.new(fixture(\"en_locale.yml\")))\n\n    locale = t.root.nodelist[0].options[:locale]\n    assert_instance_of(I18n, locale)\n    assert_equal(fixture(\"en_locale.yml\"), locale.path)\n  end","complexity_score":18.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sets_default_localization_in_context_with_quick_initialization\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"t\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{%comment%}{%endcomment%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"locale\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"I18n\"]},\"new\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"locale\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"t\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"locale\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_instance_of\",{\"type\":\"const\",\"children\":[null,\"I18n\"]},{\"type\":\"lvar\",\"children\":[\"locale\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[null,\"fixture\",{\"type\":\"str\",\"children\":[\"en_locale.yml\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"locale\"]},\"path\"]}]}]}]}","id":"59e06c32-0205-46d5-9327-ad9f7c7e67cc"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/hash_rendering_test.rb","start_line":26,"raw_source":"def test_render_recursive_hash\n    recursive_hash = { \"self\" => {} }\n    recursive_hash[\"self\"][\"self\"] = recursive_hash\n    assert_template_result(\"{\\\"self\\\"=>{\\\"self\\\"=>{...}}}\", \"{{ my_hash }}\", { \"my_hash\" => recursive_hash })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_recursive_hash\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"recursive_hash\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"self\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"self\"]}]},\"[]=\",{\"type\":\"str\",\"children\":[\"self\"]},{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"{\\\"self\\\"=>{\\\"self\\\"=>{...}}}\"]},{\"type\":\"str\",\"children\":[\"{{ my_hash }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_hash\"]},{\"type\":\"lvar\",\"children\":[\"recursive_hash\"]}]}]}]}]}]}","id":"5c176b58-f0b2-468a-ad7a-e844f6215f5f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":75,"raw_source":"def instrument(env)\n        return unless (i = options[:instrumenter])\n\n        env['rack.protection.attack'] = self.class.name.split('::').last.downcase\n        i.instrument('rack.protection', env)\n      end","complexity_score":13.2,"ast_json":"{\"type\":\"def\",\"children\":[\"instrument\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"i\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"instrumenter\"]}]}]}]},null,{\"type\":\"return\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"rack.protection.attack\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"class\"]},\"name\"]},\"split\",{\"type\":\"str\",\"children\":[\"::\"]}]},\"last\"]},\"downcase\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"i\"]},\"instrument\",{\"type\":\"str\",\"children\":[\"rack.protection\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]}]}]}","id":"a17f4353-a720-4802-b7e0-d9c1b6682c32"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/money_filter.rb","start_line":9,"raw_source":"def money(money)\n    return '' if money.nil?\n    format(\"$ %.2f\", money / 100.0)\n  end","complexity_score":4.55,"ast_json":"{\"type\":\"def\",\"children\":[\"money\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"money\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"nil?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]},null]},{\"type\":\"send\",\"children\":[null,\"format\",{\"type\":\"str\",\"children\":[\"$ %.2f\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"money\"]},\"/\",{\"type\":\"float\",\"children\":[100.0]}]}]}]}]}","id":"591dffdc-557c-4ff8-b37f-468272927255"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":115,"raw_source":"def test_extra_dots_in_ranges\n    with_error_mode(:lax) do\n      assert_template_result('12345', \"{% for i in (1...5) %}{{ i }}{% endfor %}\")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_extra_dots_in_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_error_mode\",{\"type\":\"sym\",\"children\":[\"lax\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"12345\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1...5) %}{{ i }}{% endfor %}\"]}]}]}]}","id":"b91d04f6-ef85-44bd-8b2d-930fe7ea4a9a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":48,"raw_source":"def to_liquid\n    if @context[\"forloop\"]\n      @products.first(@context[\"forloop\"].length)\n    else\n      @products\n    end\n  end","complexity_score":5.9,"ast_json":"{\"type\":\"def\",\"children\":[\"to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"forloop\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@products\"]},\"first\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"forloop\"]}]},\"length\"]}]},{\"type\":\"ivar\",\"children\":[\"@products\"]}]}]}","id":"a5eededc-bb49-4b3e-ad49-bdd719f3d5b5"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/drop.rb","start_line":66,"raw_source":"def self.invokable?(method_name)\n      invokable_methods.include?(method_name.to_s)\n    end","complexity_score":3.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"invokable?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method_name\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"invokable_methods\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"method_name\"]},\"to_s\"]}]}]}","id":"2893eaca-c6d5-4e4e-84e1-5e0236e9880f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/namespace.rb","start_line":261,"raw_source":"def not_found(&block)\n        error(Sinatra::NotFound, &block)\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"not_found\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"send\",\"children\":[null,\"error\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"NotFound\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}","id":"f57dc45c-bb1f-410a-af47-a93e43664b79"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/extension.rb","start_line":51,"raw_source":"def self.new(&block)\n      ext = Module.new.extend(self)\n      ext.class_eval(&block)\n      ext\n    end","complexity_score":10.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"new\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ext\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Module\"]},\"new\"]},\"extend\",{\"type\":\"self\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ext\"]},\"class_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},{\"type\":\"lvar\",\"children\":[\"ext\"]}]}]}","id":"d24c12c3-074e-46f9-ad69-578fc9522a46"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":83,"raw_source":"def propfind(path, opts = {}, &bk)  route 'PROPFIND',  path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"propfind\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"PROPFIND\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"59caeb8c-3c15-4fb0-8a46-48aebe4da7fa"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1275,"raw_source":"def dump_errors!(boom)\n      if boom.respond_to?(:detailed_message)\n        msg = boom.detailed_message(highlight: false)\n        if msg =~ /\\A(.*?)(?: \\(#{ Regexp.quote(boom.class.to_s) }\\))?\\n/\n          msg = $1\n          additional_msg = $'.lines(chomp: true)\n        else\n          additional_msg = []\n        end\n      else\n        msg = boom.message\n        additional_msg = []\n      end\n      msg = [\"#{Time.now.strftime('%Y-%m-%d %H:%M:%S')} - #{boom.class} - #{msg}:\", *additional_msg, *boom.backtrace].join(\"\\n\\t\")\n      @env['rack.errors'].puts(msg)\n    end","complexity_score":28.1,"ast_json":"{\"type\":\"def\",\"children\":[\"dump_errors!\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"boom\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"detailed_message\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"detailed_message\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"highlight\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"msg\"]},\"=~\",{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\\A(.*?)(?: \\\\(\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"quote\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]},\"to_s\"]}]}]},{\"type\":\"str\",\"children\":[\"\\\\))?\\\\n\"]},{\"type\":\"regopt\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"nth_ref\",\"children\":[1]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"send\",\"children\":[{\"type\":\"back_ref\",\"children\":[\"$'\"]},\"lines\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"chomp\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"message\"]}]},{\"type\":\"lvasgn\",\"children\":[\"additional_msg\",{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"msg\",{\"type\":\"send\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Time\"]},\"now\"]},\"strftime\",{\"type\":\"str\",\"children\":[\"%Y-%m-%d %H:%M:%S\"]}]}]},{\"type\":\"str\",\"children\":[\" - \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"class\"]}]},{\"type\":\"str\",\"children\":[\" - \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"msg\"]}]},{\"type\":\"str\",\"children\":[\":\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"additional_msg\"]}]},{\"type\":\"splat\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"boom\"]},\"backtrace\"]}]}]},\"join\",{\"type\":\"str\",\"children\":[\"\\n\\t\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"rack.errors\"]}]},\"puts\",{\"type\":\"lvar\",\"children\":[\"msg\"]}]}]}]}","id":"c05fa561-3776-4c9e-938c-604be268bce5"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":407,"raw_source":"def sort_natural(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      return [] if ary.empty?\n\n      if property.nil?\n        ary.sort do |a, b|\n          nil_safe_casecmp(a, b)\n        end\n      elsif ary.all? { |el| el.respond_to?(:[]) }\n        begin\n          ary.sort { |a, b| nil_safe_casecmp(a[property], b[property]) }\n        rescue TypeError\n          raise_property_error(property)\n        end\n      end\n    end","complexity_score":25.8,"ast_json":"{\"type\":\"def\",\"children\":[\"sort_natural\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"return\",\"children\":[{\"type\":\"array\",\"children\":[]}]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_casecmp\",{\"type\":\"lvar\",\"children\":[\"a\"]},{\"type\":\"lvar\",\"children\":[\"b\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"all?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"el\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"el\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]}]},{\"type\":\"kwbegin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"sort\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"a\"]},{\"type\":\"arg\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[null,\"nil_safe_casecmp\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"a\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"b\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},null]}]},null]}]}]}]}","id":"d52122fe-c292-4e61-952a-47e40867acef"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":183,"raw_source":"def updated?\n        !ignore? && !removed? && mtime != File.mtime(path)\n      end","complexity_score":12.7,"ast_json":"{\"type\":\"def\",\"children\":[\"updated?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"and\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"ignore?\"]},\"!\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"removed?\"]},\"!\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"mtime\"]},\"!=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"File\"]},\"mtime\",{\"type\":\"send\",\"children\":[null,\"path\"]}]}]}]}]}","id":"7efb40aa-a669-4fb4-8ef3-da598b63780b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":26,"raw_source":"def test_if_tag_calls_to_liquid_value\n    assert_template_result('one', '{% if foo == 1 %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if foo == eqv %}one{% endif %}', { 'foo' => IntegerDrop.new(1), 'eqv' => IntegerDrop.new(1) })\n    assert_template_result('one', '{% if 0 < foo %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if foo > 0 %}one{% endif %}', { 'foo' => IntegerDrop.new('1') })\n    assert_template_result('one', '{% if b > a %}one{% endif %}', { 'b' => IntegerDrop.new(1), 'a' => IntegerDrop.new(0) })\n    assert_template_result('true', '{% if foo == true %}true{% endif %}', { 'foo' => BooleanDrop.new(true) })\n    assert_template_result('true', '{% if foo %}true{% endif %}', { 'foo' => BooleanDrop.new(true) })\n\n    assert_template_result('', '{% if foo %}true{% endif %}', { 'foo' => BooleanDrop.new(false) })\n    assert_template_result('', '{% if foo == true %}True{% endif %}', { 'foo' => BooleanDrop.new(false) })\n    assert_template_result('', '{% if foo and true %}SHOULD NOT HAPPEN{% endif %}', { 'foo' => BooleanDrop.new(false) })\n\n    assert_template_result('one', '{% if a contains x %}one{% endif %}', { 'a' => [1], 'x' => IntegerDrop.new(1) })\n  end","complexity_score":28.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_tag_calls_to_liquid_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo == 1 %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo == eqv %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"eqv\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if 0 < foo %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if foo > 0 %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"str\",\"children\":[\"1\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if b > a %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"b\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[0]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if foo == true %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"str\",\"children\":[\"{% if foo %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo %}true{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo == true %}True{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo and true %}SHOULD NOT HAPPEN{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"BooleanDrop\"]},\"new\",{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"one\"]},{\"type\":\"str\",\"children\":[\"{% if a contains x %}one{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IntegerDrop\"]},\"new\",{\"type\":\"int\",\"children\":[1]}]}]}]}]}]}]}","id":"83d6e88f-4ad1-40eb-80c0-f5022d0457fa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/strainer_template_unit_test.rb","start_line":46,"raw_source":"def test_add_filter_raises_when_module_overrides_registered_public_method_as_protected\n    error = assert_raises(Liquid::MethodOverrideError) do\n      Liquid::Environment.build do |env|\n        env.register_filter(PublicMethodOverrideFilter)\n        env.register_filter(ProtectedMethodOverrideFilter)\n      end\n    end\n\n    assert_equal('Liquid error: Filter overrides registered public methods as non public: public_filter', error.message)\n  end","complexity_score":10.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_filter_raises_when_module_overrides_registered_public_method_as_protected\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"error\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"MethodOverrideError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"PublicMethodOverrideFilter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"ProtectedMethodOverrideFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Liquid error: Filter overrides registered public methods as non public: public_filter\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"error\"]},\"message\"]}]}]}]}","id":"820ae4d1-ab26-4301-859d-76424daa96d9"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/not_implemented_as_pending.rb","start_line":5,"raw_source":"def self.included(base)\n    base.class_eval do\n      alias_method :__finish__, :finish\n      remove_method :finish\n    end\n  end","complexity_score":10.8,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"included\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"base\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"base\"]},\"class_eval\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"alias_method\",{\"type\":\"sym\",\"children\":[\"__finish__\"]},{\"type\":\"sym\",\"children\":[\"finish\"]}]},{\"type\":\"send\",\"children\":[null,\"remove_method\",{\"type\":\"sym\",\"children\":[\"finish\"]}]}]}]}]}","id":"7d839941-0569-43dc-8b81-e7fdc2004998"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/error_handling_test.rb","start_line":49,"raw_source":"def test_syntax\n    template = Liquid::Template.parse(' {{ errors.syntax_error }} ')\n    assert_equal(' Liquid syntax error: syntax error ', template.render('errors' => ErrorDrop.new))\n\n    assert_equal(1, template.errors.size)\n    assert_equal(SyntaxError, template.errors.first.class)\n  end","complexity_score":14.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_syntax\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\" {{ errors.syntax_error }} \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\" Liquid syntax error: syntax error \"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"size\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"errors\"]},\"first\"]},\"class\"]}]}]}]}","id":"5e6dc713-5d0c-40e7-979c-3b5bc3d97696"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":136,"raw_source":"def test_find_on_empty_array\n    assert_nil(@filters.find([], 'foo', 'bar'))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_on_empty_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"find\",{\"type\":\"array\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}","id":"2b2cfc72-31ff-43ba-9300-9f58af76ad51"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":88,"raw_source":"def test_upcase\n    assert_equal('TESTING', @filters.upcase(\"Testing\"))\n    assert_equal('', @filters.upcase(nil))\n  end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_upcase\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"TESTING\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"upcase\",{\"type\":\"str\",\"children\":[\"Testing\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"upcase\",{\"type\":\"nil\",\"children\":[]}]}]}]}]}","id":"2417fe9f-d2fe-441c-98b9-2e5ac40bf7b8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/deprecations.rb","start_line":12,"raw_source":"def warn(name, alternative)\n        return if warned.include?(name)\n\n        warned << name\n\n        caller_location = caller_locations(2, 1).first\n        Warning.warn(\"[DEPRECATION] #{name} is deprecated. Use #{alternative} instead. Called from #{caller_location}\\n\")\n      end","complexity_score":10.3,"ast_json":"{\"type\":\"def\",\"children\":[\"warn\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"arg\",\"children\":[\"alternative\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warned\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"return\",\"children\":[]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"warned\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"lvasgn\",\"children\":[\"caller_location\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Warning\"]},\"warn\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"[DEPRECATION] \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"name\"]}]},{\"type\":\"str\",\"children\":[\" is deprecated. Use \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"alternative\"]}]},{\"type\":\"str\",\"children\":[\" instead. Called from \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"caller_location\"]}]},{\"type\":\"str\",\"children\":[\"\\n\"]}]}]}]}]}","id":"9869def3-a468-4575-a026-fdbf0b67dc1a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":88,"raw_source":"def test_expression_cache_with_true_boolean\n    skip(\"Liquid-C does not support Expression caching\") if defined?(Liquid::C) && Liquid::C.enabled\n\n    template = <<~LIQUID\n      {% assign x = 1 %}\n      {{ x }}\n      {% assign x = 2 %}\n      {{ x }}\n      {% assign y = 1 %}\n      {{ y }}\n    LIQUID\n\n    parse_context = ParseContext.new(expression_cache: true)\n\n    Liquid::Template.parse(template, parse_context).render\n\n    cache = parse_context.instance_variable_get(:@expression_cache)\n\n    assert_equal(\n      [\"1\", \"2\", \"x\", \"y\"],\n      cache.to_a.map { _1[0] }.sort,\n    )\n  end","complexity_score":21.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expression_cache_with_true_boolean\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"C\"]},\"enabled\"]}]},{\"type\":\"send\",\"children\":[null,\"skip\",{\"type\":\"str\",\"children\":[\"Liquid-C does not support Expression caching\"]}]},null]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% assign x = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign x = 2 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ x }}\\n\"]},{\"type\":\"str\",\"children\":[\"{% assign y = 1 %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ y }}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"parse_context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ParseContext\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"expression_cache\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]},\"render\"]},{\"type\":\"lvasgn\",\"children\":[\"cache\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"parse_context\"]},\"instance_variable_get\",{\"type\":\"sym\",\"children\":[\"@expression_cache\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"2\"]},{\"type\":\"str\",\"children\":[\"x\"]},{\"type\":\"str\",\"children\":[\"y\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"numblock\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cache\"]},\"to_a\"]},\"map\"]},1,{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"_1\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]},\"sort\"]}]}]}]}","id":"acb45b2d-82ec-4e9c-be36-4379ad4d9948"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":25,"raw_source":"def setup\n    @environment = Liquid::Environment.build do |env|\n      env.register_filter(AccessScopeFilters)\n    end\n\n    @context = Context.build(environment: @environment)\n  end","complexity_score":6.1,"ast_json":"{\"type\":\"def\",\"children\":[\"setup\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@environment\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Environment\"]},\"build\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"AccessScopeFilters\"]}]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"environment\"]},{\"type\":\"ivar\",\"children\":[\"@environment\"]}]}]}]}]}]}]}","id":"91fe3632-2d35-4686-8ea1-5b84b8757f6a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":320,"raw_source":"def add_filter(type, path = nil, **options, &block)\n        source_location = block.respond_to?(:source_location) ?\n          block.source_location.first : caller_files[1]\n        result = super\n        watch_element(source_location, :\"#{type}_filter\", filters[type].last)\n        result\n      end","complexity_score":15.33,"ast_json":"{\"type\":\"def\",\"children\":[\"add_filter\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"type\"]},{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"kwrestarg\",\"children\":[\"options\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source_location\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"source_location\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},\"source_location\"]},\"first\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_files\"]},\"[]\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"send\",\"children\":[null,\"watch_element\",{\"type\":\"lvar\",\"children\":[\"source_location\"]},{\"type\":\"dsym\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"type\"]}]},{\"type\":\"str\",\"children\":[\"_filter\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"filters\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"type\"]}]},\"last\"]}]},{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}","id":"7d324f31-72de-46e8-a2b5-e34c1ba00919"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/render_tag_test.rb","start_line":281,"raw_source":"def test_render_tag_renders_error_with_template_name_from_template_factory\n    assert_template_result(\n      'Liquid error (some/path/foo line 1): standard error',\n      \"{% render 'foo' with errors %}\",\n      { 'errors' => ErrorDrop.new },\n      partials: { 'foo' => '{{ foo.standard_error }}' },\n      template_factory: StubTemplateFactory.new,\n      render_errors: true,\n    )\n  end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_render_tag_renders_error_with_template_name_from_template_factory\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Liquid error (some/path/foo line 1): standard error\"]},{\"type\":\"str\",\"children\":[\"{% render 'foo' with errors %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"{{ foo.standard_error }}\"]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"render_errors\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}","id":"292481d3-8780-4d3e-b171-e4bb51a0f777"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":369,"raw_source":"def test_ranges\n    assert_template_result(\"1..5\", '{{ (1..5) }}')\n    assert_template_result(\"pass\", '{% if (1..5) == expect %}pass{% endif %}', { \"expect\" => (1..5) })\n\n    assigns = { \"test\" => '5' }\n    assert_template_result(\"1..5\", \"{{ (1..test) }}\", assigns)\n    assert_template_result(\"5..5\", \"{{ (test..test) }}\", assigns)\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_ranges\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1..5\"]},{\"type\":\"str\",\"children\":[\"{{ (1..5) }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"pass\"]},{\"type\":\"str\",\"children\":[\"{% if (1..5) == expect %}pass{% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"expect\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[5]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"5\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1..5\"]},{\"type\":\"str\",\"children\":[\"{{ (1..test) }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5..5\"]},{\"type\":\"str\",\"children\":[\"{{ (test..test) }}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"95949cf4-c641-409c-9edc-4c6883f45c11"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/parsing_quirks_test.rb","start_line":25,"raw_source":"def test_raise_on_label_and_no_close_bracets_percent\n    assert_raises(SyntaxError) do\n      Template.parse(\"TEST {% \")\n    end\n  end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_raise_on_label_and_no_close_bracets_percent\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"TEST {% \"]}]}]}]}","id":"1a840799-5ee3-4031-893d-58f329744b10"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":497,"raw_source":"def uniq(input, property = nil)\n      ary = InputIterator.new(input, context)\n\n      if property.nil?\n        ary.uniq\n      elsif ary.empty? # The next two cases assume a non-empty array.\n        []\n      else\n        ary.uniq do |item|\n          item[property]\n        rescue TypeError\n          raise_property_error(property)\n        rescue NoMethodError\n          return nil unless item.respond_to?(:[])\n          raise\n        end\n      end\n    end","complexity_score":20.2,"ast_json":"{\"type\":\"def\",\"children\":[\"uniq\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"optarg\",\"children\":[\"property\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"ary\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"InputIterator\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[null,\"context\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"property\"]},\"nil?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"uniq\"]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"empty?\"]},{\"type\":\"array\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ary\"]},\"uniq\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"item\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"property\"]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TypeError\"]}]},null,{\"type\":\"send\",\"children\":[null,\"raise_property_error\",{\"type\":\"lvar\",\"children\":[\"property\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NoMethodError\"]}]},null,{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"item\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\"]}]}]},null]}]}]}]}]}]}","id":"8f89ecd0-303a-4ad5-a7ab-30beb186ee84"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":490,"raw_source":"def numenc(x)\n    if x.nan? || x.infinite?\n      return 'null'\n    end rescue nil\n    \"#{x}\"\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"numenc\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"x\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"rescue\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"nan?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]},\"infinite?\"]}]},{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"null\"]}]},null]},{\"type\":\"resbody\",\"children\":[null,null,{\"type\":\"nil\",\"children\":[]}]},null]},{\"type\":\"dstr\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"x\"]}]}]}]}]}","id":"0dd5ee3a-7cdc-4618-b810-98bb4d130a57"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/profiler/hooks.rb","start_line":5,"raw_source":"def render_node(context, output, node)\n      if (profiler = context.profiler)\n        profiler.profile_node(context.template_name, code: node.raw, line_number: node.line_number) do\n          super\n        end\n      else\n        super\n      end\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"def\",\"children\":[\"render_node\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]},{\"type\":\"arg\",\"children\":[\"output\"]},{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"profiler\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"profiler\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"profiler\"]},\"profile_node\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"template_name\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"code\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"raw\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_number\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"line_number\"]}]}]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"zsuper\",\"children\":[]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"9b16ab9b-fe9b-4d61-984e-457edf3f784f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":98,"raw_source":"def test_for_else\n    assert_template_result('+++', '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => [1, 2, 3] })\n    assert_template_result('-',   '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => [] })\n    assert_template_result('-',   '{%for item in array%}+{%else%}-{%endfor%}', { 'array' => nil })\n  end","complexity_score":3.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_else\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"+++\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"-\"]},{\"type\":\"str\",\"children\":[\"{%for item in array%}+{%else%}-{%endfor%}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"nil\",\"children\":[]}]}]}]}]}]}","id":"8e9f9af0-8a0d-484c-8d4e-f1636d2c2e71"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":533,"raw_source":"def test_map_over_drops_returning_procs\n    drops = [\n      {\n        \"proc\" => -> { \"foo\" },\n      },\n      {\n        \"proc\" => -> { \"bar\" },\n      },\n    ]\n    output = Liquid::Template.parse('{{ drops | map: \"proc\" }}').render!({ \"drops\" => drops })\n    assert_equal(\"foobar\", output)\n  end","complexity_score":7.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_map_over_drops_returning_procs\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"drops\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"proc\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"foo\"]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"proc\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lambda\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"output\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ drops | map: \\\"proc\\\" }}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"drops\"]},{\"type\":\"lvar\",\"children\":[\"drops\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"lvar\",\"children\":[\"output\"]}]}]}]}","id":"62abab02-c808-4b1e-ada8-b9e9d5aa2c07"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":13,"raw_source":"def parse(tag_name, markup, tokenizer, parse_context)\n        tag = new(tag_name, markup, parse_context)\n        tag.parse(tokenizer)\n        tag\n      end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"parse\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokenizer\"]},{\"type\":\"arg\",\"children\":[\"parse_context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag\",{\"type\":\"send\",\"children\":[null,\"new\",{\"type\":\"lvar\",\"children\":[\"tag_name\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"parse_context\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"tag\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"tokenizer\"]}]},{\"type\":\"lvar\",\"children\":[\"tag\"]}]}]}","id":"29415fef-dac5-43fe-b5e5-57dd92168616"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/parse_tree_visitor.rb","start_line":5,"raw_source":"def self.for(node, callbacks = Hash.new(proc {}))\n      if defined?(node.class::ParseTreeVisitor)\n        node.class::ParseTreeVisitor\n      else\n        self\n      end.new(node, callbacks)\n    end","complexity_score":9.1,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"for\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]},{\"type\":\"optarg\",\"children\":[\"callbacks\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Hash\"]},\"new\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},null]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"defined?\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]},\"ParseTreeVisitor\"]}]},{\"type\":\"const\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"class\"]},\"ParseTreeVisitor\"]},{\"type\":\"self\",\"children\":[]}]},\"new\",{\"type\":\"lvar\",\"children\":[\"node\"]},{\"type\":\"lvar\",\"children\":[\"callbacks\"]}]}]}","id":"0193a774-caee-402f-8d67-704a746730de"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/runner.rb","start_line":148,"raw_source":"def get_url(url)\n      uri = URI.parse(url)\n\n      return uri.read unless protocol == 'https'\n\n      get_https_url(uri)\n    end","complexity_score":7.3,"ast_json":"{\"type\":\"def\",\"children\":[\"get_url\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"url\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"uri\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"URI\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"url\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"protocol\"]},\"==\",{\"type\":\"str\",\"children\":[\"https\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"uri\"]},\"read\"]}]}]},{\"type\":\"send\",\"children\":[null,\"get_https_url\",{\"type\":\"lvar\",\"children\":[\"uri\"]}]}]}]}","id":"5287fba8-5104-4354-9512-7f917b7dfcc8"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/delegator_test.rb","start_line":49,"raw_source":"def delegate(&block)\n    assert Sinatra::Delegator.target != Sinatra::Application\n    Object.new.extend(Sinatra::Delegator).instance_eval(&block) if block\n    Sinatra::Delegator.target\n  end","complexity_score":16.5,"ast_json":"{\"type\":\"def\",\"children\":[\"delegate\",{\"type\":\"args\",\"children\":[{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target\"]},\"!=\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Application\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Object\"]},\"new\"]},\"extend\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]}]},\"instance_eval\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]},null]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Sinatra\"]},\"Delegator\"]},\"target\"]}]}]}","id":"5c6509da-48b7-44a8-bb7c-282b43333c2f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/webdav.rb","start_line":86,"raw_source":"def copy(path, opts = {}, &bk)      route 'COPY',      path, opts, &bk end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"copy\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"path\"]},{\"type\":\"optarg\",\"children\":[\"opts\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"bk\"]}]},{\"type\":\"send\",\"children\":[null,\"route\",{\"type\":\"str\",\"children\":[\"COPY\"]},{\"type\":\"lvar\",\"children\":[\"path\"]},{\"type\":\"lvar\",\"children\":[\"opts\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"bk\"]}]}]}]}","id":"6c2f9934-2e2c-457e-8d3c-118da395ade1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/assign_test.rb","start_line":78,"raw_source":"def test_assign_score_of_int\n    assert_equal(1, assign_score_of(123))\n  end","complexity_score":2.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_assign_score_of_int\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[null,\"assign_score_of\",{\"type\":\"int\",\"children\":[123]}]}]}]}","id":"d5135f7e-0ac3-4d3d-a07c-5c7d01534aa0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":348,"raw_source":"def test_break_through_include\n    assert_template_result(\"1\", \"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\")\n    assert_template_result(\n      \"1\",\n      \"{% for i in (1..3) %}{{ i }}{% include 'break' %}{{ i }}{% endfor %}\",\n      partials: { 'break' => \"{% break %}\" },\n    )\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_break_through_include\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% break %}{{ i }}{% endfor %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"1\"]},{\"type\":\"str\",\"children\":[\"{% for i in (1..3) %}{{ i }}{% include 'break' %}{{ i }}{% endfor %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"partials\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"break\"]},{\"type\":\"str\",\"children\":[\"{% break %}\"]}]}]}]}]}]}]}]}","id":"9c3f16a6-6e19-40ef-9460-6e8f5c7a076d"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/reloader.rb","start_line":167,"raw_source":"def updated\n          watchers.find_all(&:updated?)\n        end","complexity_score":3.4,"ast_json":"{\"type\":\"def\",\"children\":[\"updated\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"watchers\"]},\"find_all\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"updated?\"]}]}]}]}","id":"0532fca8-a584-41ed-b924-10ee1903dddd"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":349,"raw_source":"def test_nested_cents_through_drop\n    @context.merge(\"vars\" => { \"cents\" => CentsDrop.new })\n    assert_equal(100, @context['vars.cents.amount'])\n  end","complexity_score":4.7,"ast_json":"{\"type\":\"def\",\"children\":[\"test_nested_cents_through_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"merge\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"vars\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"cents\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"CentsDrop\"]},\"new\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"vars.cents.amount\"]}]}]}]}]}","id":"731e8985-7df9-4419-8d14-b6598cd35af4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1907,"raw_source":"def warn_for_deprecation(message)\n        warn message + \"\\n\\tfrom #{cleaned_caller.first.join(':')}\"\n      end","complexity_score":7.0,"ast_json":"{\"type\":\"def\",\"children\":[\"warn_for_deprecation\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"message\"]}]},{\"type\":\"send\",\"children\":[null,\"warn\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"message\"]},\"+\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\\tfrom \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"cleaned_caller\"]},\"first\"]},\"join\",{\"type\":\"str\",\"children\":[\":\"]}]}]}]}]}]}]}","id":"5f20d155-63f8-433c-8837-a2c5bf7cd2a4"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1416,"raw_source":"def template(name, &block)\n        filename, line = caller_locations.first\n        templates[name] = [block, filename, line.to_i]\n      end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"template\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"name\"]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"filename\"]},{\"type\":\"lvasgn\",\"children\":[\"line\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"caller_locations\"]},\"first\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"templates\"]},\"[]=\",{\"type\":\"lvar\",\"children\":[\"name\"]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]},{\"type\":\"lvar\",\"children\":[\"filename\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"to_i\"]}]}]}]}]}","id":"4d617e0b-eed9-4939-b480-d8e349a066b7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/if_else_tag_test.rb","start_line":78,"raw_source":"def test_if_from_variable\n    assert_template_result('', '{% if var %} NO {% endif %}', { 'var' => false })\n    assert_template_result('', '{% if var %} NO {% endif %}', { 'var' => nil })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => { 'bar' => false } })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => {} })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => nil })\n    assert_template_result('', '{% if foo.bar %} NO {% endif %}', { 'foo' => true })\n\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => \"text\" })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => true })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => 1 })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => {} })\n    assert_template_result(' YES ', '{% if var %} YES {% endif %}', { 'var' => [] })\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% endif %}')\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => \"text\" } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => 1 } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => {} } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% endif %}', { 'foo' => { 'bar' => [] } })\n\n    assert_template_result(' YES ', '{% if var %} NO {% else %} YES {% endif %}', { 'var' => false })\n    assert_template_result(' YES ', '{% if var %} NO {% else %} YES {% endif %}', { 'var' => nil })\n    assert_template_result(' YES ', '{% if var %} YES {% else %} NO {% endif %}', { 'var' => true })\n    assert_template_result(' YES ', '{% if \"foo\" %} YES {% else %} NO {% endif %}', { 'var' => \"text\" })\n\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => { 'bar' => false } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% else %} NO {% endif %}', { 'foo' => { 'bar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} YES {% else %} NO {% endif %}', { 'foo' => { 'bar' => \"text\" } })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => { 'notbar' => true } })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'foo' => {} })\n    assert_template_result(' YES ', '{% if foo.bar %} NO {% else %} YES {% endif %}', { 'notfoo' => { 'bar' => true } })\n  end","complexity_score":27.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_if_from_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"array\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% endif %}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"hash\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"array\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"false\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"nil\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if var %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"true\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if \\\"foo\\\" %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} YES {% else %} NO {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"text\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"notbar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" YES \"]},{\"type\":\"str\",\"children\":[\"{% if foo.bar %} NO {% else %} YES {% endif %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"notfoo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]}]}]}]}","id":"b80f9c6d-8c78-418c-ad21-e514b048638c"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/block_body.rb","start_line":209,"raw_source":"def remove_blank_strings\n      raise \"remove_blank_strings only support being called on a blank block body\" unless @blank\n      @nodelist.reject! { |node| node.instance_of?(String) }\n    end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"remove_blank_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@blank\"]},null,{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"str\",\"children\":[\"remove_blank_strings only support being called on a blank block body\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@nodelist\"]},\"reject!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"node\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"node\"]},\"instance_of?\",{\"type\":\"const\",\"children\":[null,\"String\"]}]}]}]}]}","id":"99367a30-61d3-4f59-bbf4-6e1a7dda34db"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/for_tag_unit_test.rb","start_line":6,"raw_source":"def test_for_nodelist\n    template = Liquid::Template.parse('{% for item in items %}FOR{% endfor %}')\n    assert_equal(['FOR'], template.root.nodelist[0].nodelist.map(&:nodelist).flatten)\n  end","complexity_score":14.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_for_nodelist\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% for item in items %}FOR{% endfor %}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"FOR\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"root\"]},\"nodelist\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},\"nodelist\"]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"nodelist\"]}]}]},\"flatten\"]}]}]}]}","id":"497e333f-94ca-4f6e-9460-0d31c0602a64"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/expression_test.rb","start_line":20,"raw_source":"def test_int\n    assert_template_result(\"456\", \"{{ 456 }}\")\n    assert_expression_result(123, \"123\")\n    assert_expression_result(12, \"012\")\n  end","complexity_score":3.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_int\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"456\"]},{\"type\":\"str\",\"children\":[\"{{ 456 }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"int\",\"children\":[123]},{\"type\":\"str\",\"children\":[\"123\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_expression_result\",{\"type\":\"int\",\"children\":[12]},{\"type\":\"str\",\"children\":[\"012\"]}]}]}]}","id":"939bad7d-e5f2-42a9-90c4-8fa30aca871a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":153,"raw_source":"def test_override_object_method_in_filter\n    assert_equal(\"tap overridden\", Template.parse(\"{{var | tap}}\").render!({ 'var' => 1000 }, filters: [OverrideObjectMethodFilter]))\n\n    # tap still treated as a non-existent filter\n    assert_equal(\"1000\", Template.parse(\"{{var | tap}}\").render!('var' => 1000))\n  end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_override_object_method_in_filter\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"tap overridden\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | tap}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OverrideObjectMethodFilter\"]}]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1000\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{var | tap}}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"int\",\"children\":[1000]}]}]}]}]}]}]}","id":"bdc9a6fb-238d-4e17-8e1c-aeb70589f704"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":1087,"raw_source":"def each\n        @input.each do |e|\n          e = e.respond_to?(:to_liquid) ? e.to_liquid : e\n          e.context = @context if e.respond_to?(:context=)\n          yield(e)\n        end\n      end","complexity_score":11.8,"ast_json":"{\"type\":\"def\",\"children\":[\"each\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@input\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"e\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"e\",{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_liquid\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"to_liquid\"]},{\"type\":\"lvar\",\"children\":[\"e\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]},\"context=\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},null]},{\"type\":\"yield\",\"children\":[{\"type\":\"lvar\",\"children\":[\"e\"]}]}]}]}]}","id":"01f27203-60f0-4929-ab64-e1640ccab2a1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":240,"raw_source":"def test_post_trim_tags\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if true -%}\n          yes\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          yes\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n\n    text = <<-END_TEMPLATE\n      <div>\n        <p>\n          {% if false -%}\n          no\n          {% endif -%}\n        </p>\n      </div>\n    END_TEMPLATE\n    expected = <<-END_EXPECTED\n      <div>\n        <p>\n          </p>\n      </div>\n    END_EXPECTED\n    assert_template_result(expected, text)\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_post_trim_tags\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if true -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          yes\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]},{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          {% if false -%}\\n\"]},{\"type\":\"str\",\"children\":[\"          no\\n\"]},{\"type\":\"str\",\"children\":[\"          {% endif -%}\\n\"]},{\"type\":\"str\",\"children\":[\"        </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      <div>\\n\"]},{\"type\":\"str\",\"children\":[\"        <p>\\n\"]},{\"type\":\"str\",\"children\":[\"          </p>\\n\"]},{\"type\":\"str\",\"children\":[\"      </div>\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"fcb51648-5203-4f47-80d4-68cecebb9fcf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/context_test.rb","start_line":402,"raw_source":"def test_proc_as_variable\n    @context['dynamic'] = proc { 'Hello' }\n\n    assert_equal('Hello', @context['dynamic'])\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_proc_as_variable\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"dynamic\"]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"proc\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"str\",\"children\":[\"Hello\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"Hello\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]\",{\"type\":\"str\",\"children\":[\"dynamic\"]}]}]}]}]}","id":"ff0d5679-f130-4bd3-8ecb-a35f8afcc00b"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/cookies.rb","start_line":239,"raw_source":"def replace(other)\n        select! { |k, _v| other.include?(k) or other.include?(k.to_s) }\n        merge! other\n      end","complexity_score":7.9,"ast_json":"{\"type\":\"def\",\"children\":[\"replace\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"other\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"select!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"_v\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"other\"]},\"include?\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_s\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"merge!\",{\"type\":\"lvar\",\"children\":[\"other\"]}]}]}]}","id":"bd4df23b-4467-4d02-b211-da0fe2adfa6a"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/test/indifferent_hash_test.rb","start_line":227,"raw_source":"def test_transform_keys!\n    @hash.transform_keys! { |k| k.respond_to?(:to_sym) ? k.to_sym : k }\n\n    assert_equal :a, @hash[:a]\n    assert_equal :a, @hash[?a]\n  end","complexity_score":9.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_transform_keys!\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"transform_keys!\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"to_sym\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"to_sym\"]},{\"type\":\"lvar\",\"children\":[\"k\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"a\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"sym\",\"children\":[\"a\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@hash\"]},\"[]\",{\"type\":\"str\",\"children\":[\"a\"]}]}]}]}]}","id":"335bbb06-3a8d-4fd3-8b65-a3673b598c27"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":59,"raw_source":"def test_hyphenated_assign\n    assigns = { 'a-b' => '1' }\n    assert_template_result('a-b:1 a-b:2', 'a-b:{{a-b}} {%assign a-b = 2 %}a-b:{{a-b}}', assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_hyphenated_assign\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a-b\"]},{\"type\":\"str\",\"children\":[\"1\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"a-b:1 a-b:2\"]},{\"type\":\"str\",\"children\":[\"a-b:{{a-b}} {%assign a-b = 2 %}a-b:{{a-b}}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"9869dde3-9da2-42cc-a068-c675af80a6cc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/json_csrf.rb","start_line":47,"raw_source":"def react_and_close(env, body)\n        reaction = react(env)\n\n        close_body(body) if reaction\n\n        reaction\n      end","complexity_score":4.1,"ast_json":"{\"type\":\"def\",\"children\":[\"react_and_close\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]},{\"type\":\"arg\",\"children\":[\"body\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"reaction\",{\"type\":\"send\",\"children\":[null,\"react\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"lvar\",\"children\":[\"reaction\"]},{\"type\":\"send\",\"children\":[null,\"close_body\",{\"type\":\"lvar\",\"children\":[\"body\"]}]},null]},{\"type\":\"lvar\",\"children\":[\"reaction\"]}]}]}","id":"a0f734d7-f248-4773-ba82-31e1292f7667"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/include_tag_test.rb","start_line":52,"raw_source":"def test_include_tag_looks_for_file_system_in_registers_first\n    assert_equal(\n      'from OtherFileSystem',\n      Template.parse(\"{% include 'pick_a_source' %}\").render!({}, registers: { file_system: OtherFileSystem.new }),\n    )\n  end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_include_tag_looks_for_file_system_in_registers_first\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"from OtherFileSystem\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{% include 'pick_a_source' %}\"]}]},\"render!\",{\"type\":\"hash\",\"children\":[]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"OtherFileSystem\"]},\"new\"]}]}]}]}]}]}]}]}","id":"9af722a1-f4dd-435b-89c5-40f321d7f0dc"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/link_header.rb","start_line":118,"raw_source":"def link_headers\n      yield if block_given?\n      return '' unless response.include? 'Link'\n\n      response['Link'].split(\",\").map do |line|\n        url, *opts = line.split(';').map(&:strip)\n        \"<link href=\\\"#{url[1..-2]}\\\" #{opts.join ' '} />\"\n      end.join\n    end","complexity_score":26.1,"ast_json":"{\"type\":\"def\",\"children\":[\"link_headers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[null,\"block_given?\"]},{\"type\":\"yield\",\"children\":[]},null]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"include?\",{\"type\":\"str\",\"children\":[\"Link\"]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"str\",\"children\":[\"\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"response\"]},\"[]\",{\"type\":\"str\",\"children\":[\"Link\"]}]},\"split\",{\"type\":\"str\",\"children\":[\",\"]}]},\"map\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"line\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"masgn\",\"children\":[{\"type\":\"mlhs\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"url\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"opts\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"line\"]},\"split\",{\"type\":\"str\",\"children\":[\";\"]}]},\"map\",{\"type\":\"block_pass\",\"children\":[{\"type\":\"sym\",\"children\":[\"strip\"]}]}]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"<link href=\\\"\"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"url\"]},\"[]\",{\"type\":\"irange\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[-2]}]}]}]},{\"type\":\"str\",\"children\":[\"\\\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"opts\"]},\"join\",{\"type\":\"str\",\"children\":[\" \"]}]}]},{\"type\":\"str\",\"children\":[\" />\"]}]}]}]},\"join\"]}]}]}","id":"09e8daf2-e8d8-4d06-aee1-17d4aa83b99f"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/indifferent_hash.rb","start_line":80,"raw_source":"def key(value)\n      super(convert_value(value))\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"key\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"value\"]}]},{\"type\":\"super\",\"children\":[{\"type\":\"send\",\"children\":[null,\"convert_value\",{\"type\":\"lvar\",\"children\":[\"value\"]}]}]}]}","id":"d1ca7752-8dc1-42fe-bfe6-5efe94632b46"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/variable_test.rb","start_line":88,"raw_source":"def test_preset_assigns\n    template                 = Template.parse(%({{ test }}))\n    template.assigns['test'] = 'worked'\n    assert_equal('worked', template.render!)\n  end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_preset_assigns\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{ test }}\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"assigns\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"str\",\"children\":[\"worked\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"worked\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render!\"]}]}]}]}","id":"eb474658-a320-4a56-8c19-046400438f0b"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parser_unit_test.rb","start_line":48,"raw_source":"def test_expressions\n    p = new_parser(\"hi.there hi?[5].there? hi.there.bob\")\n    assert_equal('hi.there', p.expression)\n    assert_equal('hi?[5].there?', p.expression)\n    assert_equal('hi.there.bob', p.expression)\n\n    p = new_parser(\"567 6.0 'lol' \\\"wut\\\"\")\n    assert_equal('567', p.expression)\n    assert_equal('6.0', p.expression)\n    assert_equal(\"'lol'\", p.expression)\n    assert_equal('\"wut\"', p.expression)\n  end","complexity_score":19.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_expressions\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"hi.there hi?[5].there? hi.there.bob\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi?[5].there?\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"hi.there.bob\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"lvasgn\",\"children\":[\"p\",{\"type\":\"send\",\"children\":[null,\"new_parser\",{\"type\":\"str\",\"children\":[\"567 6.0 'lol' \\\"wut\\\"\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"567\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"6.0\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"'lol'\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\\\"wut\\\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"p\"]},\"expression\"]}]}]}]}","id":"ff05aaff-f258-4d33-81f3-0141d7a4fc86"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/blank_test.rb","start_line":28,"raw_source":"def test_new_tags_are_not_blank_by_default\n    with_custom_tag('foobar', FoobarTag) do\n      assert_equal(\" \" * N, Liquid::Template.parse(wrap_in_for(\"{% foobar %}\")).render!)\n    end\n  end","complexity_score":8.9,"ast_json":"{\"type\":\"def\",\"children\":[\"test_new_tags_are_not_blank_by_default\",{\"type\":\"args\",\"children\":[]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"with_custom_tag\",{\"type\":\"str\",\"children\":[\"foobar\"]},{\"type\":\"const\",\"children\":[null,\"FoobarTag\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\" \"]},\"*\",{\"type\":\"const\",\"children\":[null,\"N\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[null,\"wrap_in_for\",{\"type\":\"str\",\"children\":[\"{% foobar %}\"]}]}]},\"render!\"]}]}]}]}","id":"1556dfd8-a2cd-44b5-9af8-82314f38eedf"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":88,"raw_source":"def test_case\n    assigns = { 'condition' => 2 }\n    assert_template_result(\n      ' its 2 ',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 1 }\n    assert_template_result(\n      ' its 1 ',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => 3 }\n    assert_template_result(\n      '',\n      '{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => \"string here\" }\n    assert_template_result(\n      ' hit ',\n      '{% case condition %}{% when \"string here\" %} hit {% endcase %}',\n      assigns,\n    )\n\n    assigns = { 'condition' => \"bad string here\" }\n    assert_template_result(\n      '',\n      '{% case condition %}{% when \"string here\" %} hit {% endcase %}',\\\n      assigns,\n    )\n  end","complexity_score":10.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_case\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 2 \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" its 1 \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"int\",\"children\":[3]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when 1 %} its 1 {% when 2 %} its 2 {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"string here\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" hit \"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when \\\"string here\\\" %} hit {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]},{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"condition\"]},{\"type\":\"str\",\"children\":[\"bad string here\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"{% case condition %}{% when \\\"string here\\\" %} hit {% endcase %}\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"5991a07d-27d1-49de-8435-2981dc862839"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":34,"raw_source":"def test_default_operators_evalute_false\n    assert_evaluates_false(1, '==', 2)\n    assert_evaluates_false(1, '!=', 1)\n    assert_evaluates_false(1, '<>', 1)\n    assert_evaluates_false(1, '<', 0)\n    assert_evaluates_false(2, '>', 4)\n    assert_evaluates_false(1, '>=', 3)\n    assert_evaluates_false(2, '>=', 4)\n    assert_evaluates_false(1, '<=', 0)\n    assert_evaluates_false(1, '<=', 0)\n  end","complexity_score":13.5,"ast_json":"{\"type\":\"def\",\"children\":[\"test_default_operators_evalute_false\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"==\"]},{\"type\":\"int\",\"children\":[2]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"!=\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<>\"]},{\"type\":\"int\",\"children\":[1]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[3]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[2]},{\"type\":\"str\",\"children\":[\">=\"]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"assert_evaluates_false\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"<=\"]},{\"type\":\"int\",\"children\":[0]}]}]}]}","id":"8f195c19-1abd-4dfc-9ab6-c0fbf12b9e7e"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":101,"raw_source":"def test_add_global_filter_clears_cache\n    assert_equal('input', @environment.create_strainer(@context).invoke('late_added_filter', 'input'))\n\n    @environment.register_filter(LateAddedFilter)\n\n    assert_equal('filtered', @environment.create_strainer(nil).invoke('late_added_filter', 'input'))\n  end","complexity_score":8.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_add_global_filter_clears_cache\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},\"invoke\",{\"type\":\"str\",\"children\":[\"late_added_filter\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"register_filter\",{\"type\":\"const\",\"children\":[null,\"LateAddedFilter\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"filtered\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"nil\",\"children\":[]}]},\"invoke\",{\"type\":\"str\",\"children\":[\"late_added_filter\"]},{\"type\":\"str\",\"children\":[\"input\"]}]}]}]}]}","id":"274ca13d-10e7-48c5-bd07-43d1fc101ab2"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":594,"raw_source":"def test_truncate_calls_to_liquid\n    assert_template_result(\"wo...\", '{{ foo | truncate: 5 }}', { \"foo\" => TestThing.new })\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_truncate_calls_to_liquid\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"wo...\"]},{\"type\":\"str\",\"children\":[\"{{ foo | truncate: 5 }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]}]}]}]}]}","id":"5e8fa07d-64b8-471a-8652-84e618f572e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":277,"raw_source":"def test_strip_html\n    assert_equal('test', @filters.strip_html(\"<div>test</div>\"))\n    assert_equal('test', @filters.strip_html(\"<div id='test'>test</div>\"))\n    assert_equal('', @filters.strip_html(\"<script type='text/javascript'>document.write('some stuff');</script>\"))\n    assert_equal('', @filters.strip_html(\"<style type='text/css'>foo bar</style>\"))\n    assert_equal('test', @filters.strip_html(\"<div\\nclass='multiline'>test</div>\"))\n    assert_equal('test', @filters.strip_html(\"<!-- foo bar \\n test -->test\"))\n    assert_equal('', @filters.strip_html(nil))\n\n    # Quirk of the existing implementation\n    assert_equal('foo;', @filters.strip_html(\"<<<script </script>script>foo;</script>\"))\n  end","complexity_score":17.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strip_html\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div id='test'>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<script type='text/javascript'>document.write('some stuff');</script>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<style type='text/css'>foo bar</style>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<div\\nclass='multiline'>test</div>\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"test\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<!-- foo bar \\n test -->test\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"foo;\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"strip_html\",{\"type\":\"str\",\"children\":[\"<<<script </script>script>foo;</script>\"]}]}]}]}]}","id":"9309c986-41c1-4f4e-8aaa-8807035e98c7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1003,"raw_source":"def test_find_index_with_value\n    products = [\n      { \"title\" => \"Pro goggles\",    \"price\" => 1299 },\n      { \"title\" => \"Thermal gloves\", \"price\" => 1499 },\n      { \"title\" => \"Alpine jacket\",  \"price\" => 3999 },\n      { \"title\" => \"Mountain boots\", \"price\" => 3899 },\n      { \"title\" => \"Safety helmet\",  \"price\" => 1999 }\n    ]\n\n    template = <<~LIQUID\n      {%- assign index = products | find_index: 'price', 3999 -%}\n      {{- index -}}\n    LIQUID\n    expected_output = \"2\"\n\n    assert_template_result(expected_output, template, { \"products\" => products })\n  end","complexity_score":5.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_find_index_with_value\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"products\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Pro goggles\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1299]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Thermal gloves\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1499]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Alpine jacket\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3999]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Mountain boots\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[3899]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"title\"]},{\"type\":\"str\",\"children\":[\"Safety helmet\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"int\",\"children\":[1999]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{%- assign index = products | find_index: 'price', 3999 -%}\\n\"]},{\"type\":\"str\",\"children\":[\"{{- index -}}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"2\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"products\"]},{\"type\":\"lvar\",\"children\":[\"products\"]}]}]}]}]}]}","id":"ccfca952-938e-47ae-9cfc-1e1af3974462"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/variable_lookup.rb","start_line":47,"raw_source":"def evaluate(context)\n      name   = context.evaluate(@name)\n      object = context.find_variable(name)\n\n      @lookups.each_index do |i|\n        key = context.evaluate(@lookups[i])\n\n        # Cast \"key\" to its liquid value to enable it to act as a primitive value\n        key = Liquid::Utils.to_liquid_value(key)\n\n        # If object is a hash- or array-like object we look for the\n        # presence of the key and if its available we return it\n        if object.respond_to?(:[]) &&\n            ((object.respond_to?(:key?) && object.key?(key)) ||\n             (object.respond_to?(:fetch) && key.is_a?(Integer)))\n\n          # if its a proc we will replace the entry with the proc\n          res    = context.lookup_and_evaluate(object, key)\n          object = res.to_liquid\n\n          # Some special cases. If the part wasn't in square brackets and\n          # no key with the same name was found we interpret following calls\n          # as commands and call them on the current object\n        elsif lookup_command?(i) && object.respond_to?(key)\n          object = object.send(key).to_liquid\n\n          # No key was present with the desired value and it wasn't one of the directly supported\n          # keywords either. The only thing we got left is to return nil or\n          # raise an exception if `strict_variables` option is set to true\n        else\n          return nil unless context.strict_variables\n          raise Liquid::UndefinedVariable, \"undefined variable #{key}\"\n        end\n\n        # If we are dealing with a drop here we have to\n        object.context = context if object.respond_to?(:context=)\n      end\n\n      object\n    end","complexity_score":52.8,"ast_json":"{\"type\":\"def\",\"children\":[\"evaluate\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"context\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"name\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@name\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"find_variable\",{\"type\":\"lvar\",\"children\":[\"name\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"each_index\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"i\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"evaluate\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@lookups\"]},\"[]\",{\"type\":\"lvar\",\"children\":[\"i\"]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"key\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Utils\"]},\"to_liquid_value\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"[]\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"key?\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"fetch\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]},\"is_a?\",{\"type\":\"const\",\"children\":[null,\"Integer\"]}]}]}]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"res\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"lookup_and_evaluate\",{\"type\":\"lvar\",\"children\":[\"object\"]},{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"res\"]},\"to_liquid\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[null,\"lookup_command?\",{\"type\":\"lvar\",\"children\":[\"i\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"object\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},\"to_liquid\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"context\"]},\"strict_variables\"]},null,{\"type\":\"return\",\"children\":[{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"UndefinedVariable\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"undefined variable \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"respond_to?\",{\"type\":\"sym\",\"children\":[\"context=\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"object\"]},\"context=\",{\"type\":\"lvar\",\"children\":[\"context\"]}]},null]}]}]},{\"type\":\"lvar\",\"children\":[\"object\"]}]}]}","id":"dbca230c-ae92-4355-80e9-0489a68712ed"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":1672,"raw_source":"def build(app)\n        builder = Rack::Builder.new\n        setup_default_middleware builder\n        setup_middleware builder\n        builder.run app\n        builder\n      end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"build\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"app\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"builder\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Builder\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_default_middleware\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[null,\"setup_middleware\",{\"type\":\"lvar\",\"children\":[\"builder\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"builder\"]},\"run\",{\"type\":\"lvar\",\"children\":[\"app\"]}]},{\"type\":\"lvar\",\"children\":[\"builder\"]}]}]}","id":"eea29ab9-a594-4789-896b-911d51e894aa"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/tags/doc_tag_unit_test.rb","start_line":148,"raw_source":"def test_doc_tag_preserves_error_line_numbers\n    template = Liquid::Template.parse(<<~LIQUID.chomp, line_numbers: true)\n      {% doc %}\n        {% if true %}\n      {% enddoc %}\n      {{ errors.standard_error }}\n    LIQUID\n\n    expected = <<~TEXT.chomp\n\n      Liquid error (line 4): standard error\n    TEXT\n\n    assert_equal(expected, template.render('errors' => ErrorDrop.new))\n  end","complexity_score":8.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_doc_tag_preserves_error_line_numbers\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Template\"]},\"parse\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"{% doc %}\\n\"]},{\"type\":\"str\",\"children\":[\"  {% if true %}\\n\"]},{\"type\":\"str\",\"children\":[\"{% enddoc %}\\n\"]},{\"type\":\"str\",\"children\":[\"{{ errors.standard_error }}\\n\"]}]},\"chomp\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"line_numbers\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"send\",\"children\":[{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"\\n\"]},{\"type\":\"str\",\"children\":[\"Liquid error (line 4): standard error\\n\"]}]},\"chomp\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template\"]},\"render\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"errors\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ErrorDrop\"]},\"new\"]}]}]}]}]}]}]}","id":"124ad261-0823-4b1f-aef4-ff1fb5cd24ee"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":71,"raw_source":"def test_variable_piping_with_args\n    text     = %! {{ car.gm | add_smiley : ':-(' }} !\n    expected = %| bad :-( |\n\n    assert_equal(expected, Template.parse(text).render!(@assigns, filters: [FunnyFilter]))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_piping_with_args\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ car.gm | add_smiley : ':-(' }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" bad :-( \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"filters\"]},{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[null,\"FunnyFilter\"]}]}]}]}]}]}]}]}","id":"68833a3f-508a-4a61-ac14-6dbf21e6bbd0"}
{"repo_name":"liquid","file_path":"./repos/liquid/performance/shopify/comment_form.rb","start_line":6,"raw_source":"def initialize(tag_name, markup, options)\n    super\n\n    if markup =~ Syntax\n      @variable_name = Regexp.last_match(1)\n      @attributes    = {}\n    else\n      raise SyntaxError, \"Syntax Error in 'comment_form' - Valid syntax: comment_form [article]\"\n    end\n  end","complexity_score":7.05,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag_name\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"zsuper\",\"children\":[]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"markup\"]},\"=~\",{\"type\":\"const\",\"children\":[null,\"Syntax\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"ivasgn\",\"children\":[\"@variable_name\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Regexp\"]},\"last_match\",{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@attributes\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"SyntaxError\"]},{\"type\":\"str\",\"children\":[\"Syntax Error in 'comment_form' - Valid syntax: comment_form [article]\"]}]}]}]}]}","id":"663b31a3-e275-44f2-ab32-bfb727bb9cae"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":226,"raw_source":"def call(env)\n      result = app.call(env)\n      callback = env['async.callback']\n      return result unless callback && async?(*result)\n\n      after_response { callback.call result }\n      setup_close(env, *result)\n      throw :async\n    end","complexity_score":13.4,"ast_json":"{\"type\":\"def\",\"children\":[\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"result\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"app\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"env\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"callback\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"async.callback\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"lvar\",\"children\":[\"callback\"]},{\"type\":\"send\",\"children\":[null,\"async?\",{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]}]},null,{\"type\":\"return\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"after_response\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"callback\"]},\"call\",{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"send\",\"children\":[null,\"setup_close\",{\"type\":\"lvar\",\"children\":[\"env\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"result\"]}]}]},{\"type\":\"send\",\"children\":[null,\"throw\",{\"type\":\"sym\",\"children\":[\"async\"]}]}]}]}","id":"d4fe4089-98aa-40ff-93ad-d322612d261f"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":22,"raw_source":"def test_reads_from_the_file_system_only_once_per_file\n    file_system = StubFileSystem.new('my_partial' => 'some partial body')\n    context     = Liquid::Context.build(\n      registers: { file_system: file_system },\n    )\n\n    2.times do\n      Liquid::PartialCache.load(\n        'my_partial',\n        context: context,\n        parse_context: Liquid::ParseContext.new,\n      )\n    end\n\n    assert_equal(1, file_system.file_read_count)\n  end","complexity_score":11.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reads_from_the_file_system_only_once_per_file\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"file_system\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"some partial body\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"lvar\",\"children\":[\"file_system\"]}]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"int\",\"children\":[2]},\"times\"]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"file_system\"]},\"file_read_count\"]}]}]}]}","id":"89f18f32-159a-41f6-952d-a710fd4e637a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/for_tag_test.rb","start_line":159,"raw_source":"def test_pause_resume\n    assigns  = { 'array' => { 'items' => [1, 2, 3, 4, 5, 6, 7, 8, 9, 0] } }\n    markup   = <<-MKUP\n      {%for i in array.items limit: 3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\n      next\n      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\n      MKUP\n    expected = <<-XPCTD\n      123\n      next\n      456\n      next\n      789\n      XPCTD\n    assert_template_result(expected, markup, assigns)\n  end","complexity_score":6.25,"ast_json":"{\"type\":\"def\",\"children\":[\"test_pause_resume\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"items\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]},{\"type\":\"int\",\"children\":[7]},{\"type\":\"int\",\"children\":[8]},{\"type\":\"int\",\"children\":[9]},{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"markup\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      {%for i in array.items limit: 3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      {%for i in array.items offset:continue limit: 3 %}{{i}}{%endfor%}\\n\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"      123\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      456\\n\"]},{\"type\":\"str\",\"children\":[\"      next\\n\"]},{\"type\":\"str\",\"children\":[\"      789\\n\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"322e4a5b-43d8-4b8b-a9c9-866ed36772b1"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":239,"raw_source":"def strtok(s)\n    m = /\"([^\"\\\\]|\\\\[\"\\/\\\\bfnrt]|\\\\u[0-9a-fA-F]{4})*\"/.match(s)\n    if ! m\n      raise Error, \"invalid string literal at #{abbrev(s)}\"\n    end\n    [:str, m[0], unquote(m[0])]\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"strtok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"m\",{\"type\":\"send\",\"children\":[{\"type\":\"regexp\",\"children\":[{\"type\":\"str\",\"children\":[\"\\\"([^\\\"\\\\\\\\]|\\\\\\\\[\\\"/\\\\\\\\bfnrt]|\\\\\\\\u[0-9a-fA-F]{4})*\\\"\"]},{\"type\":\"regopt\",\"children\":[]}]},\"match\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"!\"]},{\"type\":\"send\",\"children\":[null,\"raise\",{\"type\":\"const\",\"children\":[null,\"Error\"]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"invalid string literal at \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"abbrev\",{\"type\":\"lvar\",\"children\":[\"s\"]}]}]}]}]},null]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"str\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"send\",\"children\":[null,\"unquote\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"m\"]},\"[]\",{\"type\":\"int\",\"children\":[0]}]}]}]}]}]}","id":"93ab5bb0-ea6d-4d73-b9e4-49fa058e2c2d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":44,"raw_source":"def test_variable_traversing_with_two_brackets\n    source = \"{{ site.data.menu[include.menu][include.locale] }}\"\n    assert_template_result(\"it works!\", source, {\n      \"site\" => { \"data\" => { \"menu\" => { \"foo\" => { \"bar\" => \"it works!\" } } } },\n      \"include\" => { \"menu\" => \"foo\", \"locale\" => \"bar\" },\n    })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_traversing_with_two_brackets\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\"{{ site.data.menu[include.menu][include.locale] }}\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"it works!\"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"site\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"data\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"menu\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"bar\"]},{\"type\":\"str\",\"children\":[\"it works!\"]}]}]}]}]}]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"include\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"menu\"]},{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"locale\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]}]}]}","id":"d68c16fc-04fe-42be-a60e-dfc8de11c7f9"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/filter_test.rb","start_line":85,"raw_source":"def test_sort_natural\n    # Test strings\n    assert_template_result(\n      \"Assert case Insensitive\",\n      \"{{words | sort_natural | join}}\",\n      { \"words\" => [\"case\", \"Assert\", \"Insensitive\"] },\n    )\n\n    # Test hashes\n    assert_template_result(\n      \"A b C\",\n      \"{{hashes | sort_natural: 'a' | map: 'a' | join}}\",\n      { \"hashes\" => [{ \"a\" => \"A\" }, { \"a\" => \"b\" }, { \"a\" => \"C\" }] },\n    )\n\n    # Test objects\n    @context['objects'] = [TestObject.new('A'), TestObject.new('b'), TestObject.new('C')]\n    assert_equal('A b C', Template.parse(\"{{objects | sort_natural: 'a' | map: 'a' | join}}\").render(@context))\n  end","complexity_score":9.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sort_natural\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"Assert case Insensitive\"]},{\"type\":\"str\",\"children\":[\"{{words | sort_natural | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"words\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"case\"]},{\"type\":\"str\",\"children\":[\"Assert\"]},{\"type\":\"str\",\"children\":[\"Insensitive\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"A b C\"]},{\"type\":\"str\",\"children\":[\"{{hashes | sort_natural: 'a' | map: 'a' | join}}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"hashes\"]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"A\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"b\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"str\",\"children\":[\"C\"]}]}]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@context\"]},\"[]=\",{\"type\":\"str\",\"children\":[\"objects\"]},{\"type\":\"array\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"A\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"b\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestObject\"]},\"new\",{\"type\":\"str\",\"children\":[\"C\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"A b C\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"str\",\"children\":[\"{{objects | sort_natural: 'a' | map: 'a' | join}}\"]}]},\"render\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]}]}]}","id":"6f3f75d8-ff46-409b-90f5-8a56520b1f4d"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":290,"raw_source":"def test_join\n    assert_equal('1 2 3 4', @filters.join([1, 2, 3, 4]))\n    assert_equal('1 - 2 - 3 - 4', @filters.join([1, 2, 3, 4], ' - '))\n    assert_equal('1121314', @filters.join([1, 2, 3, 4], 1))\n  end","complexity_score":11.15,"ast_json":"{\"type\":\"def\",\"children\":[\"test_join\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 2 3 4\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1 - 2 - 3 - 4\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"str\",\"children\":[\" - \"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"1121314\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"join\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"int\",\"children\":[1]}]}]}]}]}","id":"965e14f0-2f89-47f9-837e-f468129c21f3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/condition_unit_test.rb","start_line":171,"raw_source":"def assert_evaluates_true(left, op, right)\n    assert(\n      Condition.new(left, op, right).evaluate(@context),\n      \"Evaluated false: #{left.inspect} #{op} #{right.inspect}\",\n    )\n  end","complexity_score":6.0,"ast_json":"{\"type\":\"def\",\"children\":[\"assert_evaluates_true\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"left\"]},{\"type\":\"arg\",\"children\":[\"op\"]},{\"type\":\"arg\",\"children\":[\"right\"]}]},{\"type\":\"send\",\"children\":[null,\"assert\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Condition\"]},\"new\",{\"type\":\"lvar\",\"children\":[\"left\"]},{\"type\":\"lvar\",\"children\":[\"op\"]},{\"type\":\"lvar\",\"children\":[\"right\"]}]},\"evaluate\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]},{\"type\":\"dstr\",\"children\":[{\"type\":\"str\",\"children\":[\"Evaluated false: \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"left\"]},\"inspect\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvar\",\"children\":[\"op\"]}]},{\"type\":\"str\",\"children\":[\" \"]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"right\"]},\"inspect\"]}]}]}]}]}","id":"9d776b02-51c2-4c39-acf9-b6f75bc7069c"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/json.rb","start_line":104,"raw_source":"def resolve_content_type(options = {})\n      options[:content_type] || settings.json_content_type\n    end","complexity_score":5.5,"ast_json":"{\"type\":\"def\",\"children\":[\"resolve_content_type\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]\",{\"type\":\"sym\",\"children\":[\"content_type\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"settings\"]},\"json_content_type\"]}]}]}","id":"85b815d9-8e33-4030-8591-56a25e1756b5"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":803,"raw_source":"def nokogiri(template = nil, options = {}, locals = {}, &block)\n      options[:default_content_type] = :xml\n      render_ruby(:nokogiri, template, options, locals, &block)\n    end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"nokogiri\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"template\",{\"type\":\"nil\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"options\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"optarg\",\"children\":[\"locals\",{\"type\":\"hash\",\"children\":[]}]},{\"type\":\"blockarg\",\"children\":[\"block\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"options\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"default_content_type\"]},{\"type\":\"sym\",\"children\":[\"xml\"]}]},{\"type\":\"send\",\"children\":[null,\"render_ruby\",{\"type\":\"sym\",\"children\":[\"nokogiri\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"lvar\",\"children\":[\"options\"]},{\"type\":\"lvar\",\"children\":[\"locals\"]},{\"type\":\"block_pass\",\"children\":[{\"type\":\"lvar\",\"children\":[\"block\"]}]}]}]}]}","id":"48e1c7da-ed99-4314-95ed-d53942be7f19"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/environment_filter_test.rb","start_line":71,"raw_source":"def test_strainer_returns_nil_if_no_filter_method_found\n    strainer = @environment.create_strainer(@context)\n    assert_nil(strainer.invoke(\"private_filter\"))\n    assert_nil(strainer.invoke(\"undef_the_filter\"))\n  end","complexity_score":6.4,"ast_json":"{\"type\":\"def\",\"children\":[\"test_strainer_returns_nil_if_no_filter_method_found\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"strainer\",{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@environment\"]},\"create_strainer\",{\"type\":\"ivar\",\"children\":[\"@context\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"private_filter\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_nil\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"strainer\"]},\"invoke\",{\"type\":\"str\",\"children\":[\"undef_the_filter\"]}]}]}]}]}","id":"b5dbd83e-5ee9-498a-bcc6-0c56981e5807"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":78,"raw_source":"def link?\n      request_method == 'LINK'\n    end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"link?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"request_method\"]},\"==\",{\"type\":\"str\",\"children\":[\"LINK\"]}]}]}","id":"a620d2ad-9aa2-4b60-af98-a1bfd84c865a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/block_test.rb","start_line":39,"raw_source":"def render(*)\n        'foo' + super + 'bar'\n      end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"render\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},\"+\",{\"type\":\"zsuper\",\"children\":[]}]},\"+\",{\"type\":\"str\",\"children\":[\"bar\"]}]}]}","id":"79a3e5bf-ae76-4c31-a512-ce25a48f3505"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/host_authorization.rb","start_line":103,"raw_source":"def ip_match?(host)\n        @ip_hosts.any? { |ip_host| ip_host.include?(host) }\n      rescue IPAddr::InvalidAddressError\n        false\n      end","complexity_score":4.4,"ast_json":"{\"type\":\"def\",\"children\":[\"ip_match?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"host\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@ip_hosts\"]},\"any?\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"ip_host\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"ip_host\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"host\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"IPAddr\"]},\"InvalidAddressError\"]}]},null,{\"type\":\"false\",\"children\":[]}]},null]}]}","id":"796693fb-0104-465d-8cce-b8332ab15936"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":428,"raw_source":"def test_uniq\n    assert_equal([\"foo\"], @filters.uniq(\"foo\"))\n    assert_equal([1, 3, 2, 4], @filters.uniq([1, 1, 3, 2, 3, 1, 4, 3, 2, 1]))\n    assert_equal([{ \"a\" => 1 }, { \"a\" => 3 }, { \"a\" => 2 }], @filters.uniq([{ \"a\" => 1 }, { \"a\" => 3 }, { \"a\" => 1 }, { \"a\" => 2 }], \"a\"))\n    test_drop = TestDrop.new(value: \"test\")\n    test_drop_alternate = TestDrop.new(value: \"test\")\n    assert_equal([test_drop], @filters.uniq([test_drop, test_drop_alternate], 'value'))\n  end","complexity_score":19.8,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uniq\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"str\",\"children\":[\"foo\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[4]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[3]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[1]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"a\"]},{\"type\":\"int\",\"children\":[2]}]}]}]},{\"type\":\"str\",\"children\":[\"a\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"test_drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"test_drop_alternate\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"uniq\",{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]},{\"type\":\"lvar\",\"children\":[\"test_drop_alternate\"]}]},{\"type\":\"str\",\"children\":[\"value\"]}]}]}]}]}","id":"415908bb-d993-4bbf-a6cf-0c74971a42c7"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1148,"raw_source":"def test_all_filters_never_raise_non_liquid_exception\n    test_drop = TestDrop.new(value: \"test\")\n    test_drop.context = Context.new\n    test_enum = TestEnumerable.new\n    test_enum.context = Context.new\n    test_types = [\n      \"foo\",\n      123,\n      0,\n      0.0,\n      -1234.003030303,\n      -99999999,\n      1234.38383000383830003838300,\n      nil,\n      true,\n      false,\n      TestThing.new,\n      test_drop,\n      test_enum,\n      [\"foo\", \"bar\"],\n      { \"foo\" => \"bar\" },\n      { foo: \"bar\" },\n      [{ \"foo\" => \"bar\" }, { \"foo\" => 123 }, { \"foo\" => nil }, { \"foo\" => true }, { \"foo\" => [\"foo\", \"bar\"] }],\n      { 1 => \"bar\" },\n      [\"foo\", 123, nil, true, false, Drop, [\"foo\"], { foo: \"bar\" }],\n    ]\n    StandardFilters.public_instance_methods(false).each do |method|\n      arg_count = @filters.method(method).arity\n      arg_count *= -1 if arg_count < 0\n\n      test_types.repeated_permutation(arg_count) do |args|\n        @filters.send(method, *args)\n      rescue Liquid::Error\n        nil\n      end\n    end\n  end","complexity_score":32.85,"ast_json":"{\"type\":\"def\",\"children\":[\"test_all_filters_never_raise_non_liquid_exception\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"test_drop\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestDrop\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"value\"]},{\"type\":\"str\",\"children\":[\"test\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_drop\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"test_enum\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestEnumerable\"]},\"new\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_enum\"]},\"context=\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Context\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"test_types\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]},{\"type\":\"int\",\"children\":[0]},{\"type\":\"float\",\"children\":[0.0]},{\"type\":\"float\",\"children\":[-1234.003030303]},{\"type\":\"int\",\"children\":[-99999999]},{\"type\":\"float\",\"children\":[1234.3838300038383]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"TestThing\"]},\"new\"]},{\"type\":\"lvar\",\"children\":[\"test_drop\"]},{\"type\":\"lvar\",\"children\":[\"test_enum\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"nil\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]},{\"type\":\"int\",\"children\":[123]},{\"type\":\"nil\",\"children\":[]},{\"type\":\"true\",\"children\":[]},{\"type\":\"false\",\"children\":[]},{\"type\":\"const\",\"children\":[null,\"Drop\"]},{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"foo\"]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"foo\"]},{\"type\":\"str\",\"children\":[\"bar\"]}]}]}]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StandardFilters\"]},\"public_instance_methods\",{\"type\":\"false\",\"children\":[]}]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"method\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"arg_count\",{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"method\",{\"type\":\"lvar\",\"children\":[\"method\"]}]},\"arity\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"arg_count\"]},\"<\",{\"type\":\"int\",\"children\":[0]}]},{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"arg_count\"]},\"*\",{\"type\":\"int\",\"children\":[-1]}]},null]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"test_types\"]},\"repeated_permutation\",{\"type\":\"lvar\",\"children\":[\"arg_count\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"args\"]}]},{\"type\":\"rescue\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"send\",{\"type\":\"lvar\",\"children\":[\"method\"]},{\"type\":\"splat\",\"children\":[{\"type\":\"lvar\",\"children\":[\"args\"]}]}]},{\"type\":\"resbody\",\"children\":[{\"type\":\"array\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Error\"]}]},null,{\"type\":\"nil\",\"children\":[]}]},null]}]}]}]}]}]}","id":"8d101026-af39-4153-8b6a-b609b6d113e1"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/trim_mode_test.rb","start_line":112,"raw_source":"def test_no_trim_output\n    text     = '<p>{{- \\'John\\' -}}</p>'\n    expected = '<p>John</p>'\n    assert_template_result(expected, text)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_trim_output\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\"<p>{{- 'John' -}}</p>\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\"<p>John</p>\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"lvar\",\"children\":[\"text\"]}]}]}]}","id":"2d29d56a-3179-4293-a8d8-656242ffbdb8"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":1275,"raw_source":"def test_sum_with_float_strings\n    input = [0.1, \"0.2\", \"0.3\"]\n    assert_equal(0.6, @filters.sum(input))\n    assert_template_result(\"0.6\", \"{{ input | sum }}\", { \"input\" => input })\n  end","complexity_score":4.75,"ast_json":"{\"type\":\"def\",\"children\":[\"test_sum_with_float_strings\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"array\",\"children\":[{\"type\":\"float\",\"children\":[0.1]},{\"type\":\"str\",\"children\":[\"0.2\"]},{\"type\":\"str\",\"children\":[\"0.3\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"float\",\"children\":[0.6]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@filters\"]},\"sum\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"0.6\"]},{\"type\":\"str\",\"children\":[\"{{ input | sum }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}]}]}","id":"34017144-7426-4ec8-a28e-223b37947a46"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/spec/okjson.rb","start_line":221,"raw_source":"def truetok(s);  s[0,4] == 'true'  && [:val, 'true',  true]  end","complexity_score":3.78,"ast_json":"{\"type\":\"def\",\"children\":[\"truetok\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"s\"]},\"[]\",{\"type\":\"int\",\"children\":[0]},{\"type\":\"int\",\"children\":[4]}]},\"==\",{\"type\":\"str\",\"children\":[\"true\"]}]},{\"type\":\"array\",\"children\":[{\"type\":\"sym\",\"children\":[\"val\"]},{\"type\":\"str\",\"children\":[\"true\"]},{\"type\":\"true\",\"children\":[]}]}]}]}","id":"27293f6a-6dc4-45c0-9c8c-09186555bd75"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":776,"raw_source":"def test_floor\n    assert_template_result(\"4\", \"{{ input | floor }}\", { 'input' => 4.6 })\n    assert_template_result(\"4\", \"{{ '4.3' | floor }}\")\n    assert_raises(Liquid::FloatDomainError) do\n      assert_template_result(\"4\", \"{{ 1.0 | divided_by: 0.0 | floor }}\")\n    end\n\n    assert_template_result(\"5\", \"{{ price | floor }}\", { 'price' => NumberLikeThing.new(5.4) })\n  end","complexity_score":7.95,"ast_json":"{\"type\":\"def\",\"children\":[\"test_floor\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ input | floor }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"input\"]},{\"type\":\"float\",\"children\":[4.6]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ '4.3' | floor }}\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"assert_raises\",{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"FloatDomainError\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"4\"]},{\"type\":\"str\",\"children\":[\"{{ 1.0 | divided_by: 0.0 | floor }}\"]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"5\"]},{\"type\":\"str\",\"children\":[\"{{ price | floor }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"price\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"NumberLikeThing\"]},\"new\",{\"type\":\"float\",\"children\":[5.4]}]}]}]}]}]}]}","id":"27a31ec0-9eaa-4a25-8538-c8fe71011823"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tag.rb","start_line":19,"raw_source":"def disable_tags(*tag_names)\n        tag_names += disabled_tags\n        define_singleton_method(:disabled_tags) { tag_names }\n        prepend(Disabler)\n      end","complexity_score":6.2,"ast_json":"{\"type\":\"def\",\"children\":[\"disable_tags\",{\"type\":\"args\",\"children\":[{\"type\":\"restarg\",\"children\":[\"tag_names\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"op_asgn\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"tag_names\"]},\"+\",{\"type\":\"send\",\"children\":[null,\"disabled_tags\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_singleton_method\",{\"type\":\"sym\",\"children\":[\"disabled_tags\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"lvar\",\"children\":[\"tag_names\"]}]},{\"type\":\"send\",\"children\":[null,\"prepend\",{\"type\":\"const\",\"children\":[null,\"Disabler\"]}]}]}]}","id":"67c91ffd-af8b-4218-ab97-16cc8023a2d8"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/i18n.rb","start_line":13,"raw_source":"def initialize(path = DEFAULT_LOCALE)\n      @path = path\n    end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"initialize\",{\"type\":\"args\",\"children\":[{\"type\":\"optarg\",\"children\":[\"path\",{\"type\":\"const\",\"children\":[null,\"DEFAULT_LOCALE\"]}]}]},{\"type\":\"ivasgn\",\"children\":[\"@path\",{\"type\":\"lvar\",\"children\":[\"path\"]}]}]}","id":"fdcba0af-4f53-4aef-8bf6-80ccad0045d6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/table_row_test.rb","start_line":63,"raw_source":"def test_enumerable_drop\n    assert_template_result(\n      \"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\",\n      '{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}',\n      { 'numbers' => ArrayDrop.new([1, 2, 3, 4, 5, 6]) },\n    )\n  end","complexity_score":4.3,"ast_json":"{\"type\":\"def\",\"children\":[\"test_enumerable_drop\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"<tr class=\\\"row1\\\">\\n<td class=\\\"col1\\\"> 1 </td><td class=\\\"col2\\\"> 2 </td><td class=\\\"col3\\\"> 3 </td></tr>\\n<tr class=\\\"row2\\\"><td class=\\\"col1\\\"> 4 </td><td class=\\\"col2\\\"> 5 </td><td class=\\\"col3\\\"> 6 </td></tr>\\n\"]},{\"type\":\"str\",\"children\":[\"{% tablerow n in numbers cols:3%} {{n}} {% endtablerow %}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"numbers\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ArrayDrop\"]},\"new\",{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]},{\"type\":\"int\",\"children\":[5]},{\"type\":\"int\",\"children\":[6]}]}]}]}]}]}]}","id":"5df8eab3-6082-47b0-b5b5-83908fa350d3"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":272,"raw_source":"def visit(template)\n    traversal(template).visit.flatten.compact\n  end","complexity_score":5.2,"ast_json":"{\"type\":\"def\",\"children\":[\"visit\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"template\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"traversal\",{\"type\":\"lvar\",\"children\":[\"template\"]}]},\"visit\"]},\"flatten\"]},\"compact\"]}]}","id":"c454ec52-80e4-4389-aadf-28bc36ad8607"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/lib/sinatra/base.rb","start_line":658,"raw_source":"def informational?\n      status.between? 100, 199\n    end","complexity_score":2.8,"ast_json":"{\"type\":\"def\",\"children\":[\"informational?\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"status\"]},\"between?\",{\"type\":\"int\",\"children\":[100]},{\"type\":\"int\",\"children\":[199]}]}]}","id":"15f59177-d8ec-4766-899d-1b0dfbff0be9"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/registers.rb","start_line":44,"raw_source":"def key?(key)\n      @changes.key?(key) || @static.key?(key)\n    end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"key?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"key\"]}]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@changes\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@static\"]},\"key?\",{\"type\":\"lvar\",\"children\":[\"key\"]}]}]}]}","id":"cac92de6-349d-49c7-b90d-77de71d95f51"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/parse_tree_visitor_test.rb","start_line":57,"raw_source":"def test_unless_condition\n    assert_equal(\n      [\"test\"],\n      visit(%({% unless test %}{% endunless %})),\n    )\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_unless_condition\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"array\",\"children\":[{\"type\":\"str\",\"children\":[\"test\"]}]},{\"type\":\"send\",\"children\":[null,\"visit\",{\"type\":\"str\",\"children\":[\"{% unless test %}{% endunless %}\"]}]}]}]}","id":"081a6199-c546-4ca0-8d45-1f049ee17571"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/standard_tag_test.rb","start_line":329,"raw_source":"def test_size_of_array\n    assigns = { \"array\" => [1, 2, 3, 4] }\n    assert_template_result('array has 4 elements', \"array has {{ array.size }} elements\", assigns)\n  end","complexity_score":3.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_size_of_array\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"assigns\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[1]},{\"type\":\"int\",\"children\":[2]},{\"type\":\"int\",\"children\":[3]},{\"type\":\"int\",\"children\":[4]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"array has 4 elements\"]},{\"type\":\"str\",\"children\":[\"array has {{ array.size }} elements\"]},{\"type\":\"lvar\",\"children\":[\"assigns\"]}]}]}]}","id":"3c613716-295b-4da1-b5bd-d6dc3fc63a29"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/partial_cache_unit_test.rb","start_line":110,"raw_source":"def test_uses_template_factory_register_if_present\n    template_factory = StubTemplateFactory.new\n    context = Liquid::Context.build(\n      registers: {\n        file_system: StubFileSystem.new('my_partial' => 'my partial body'),\n        template_factory: template_factory,\n      },\n    )\n\n    partial = Liquid::PartialCache.load(\n      'my_partial',\n      context: context,\n      parse_context: Liquid::ParseContext.new,\n    )\n\n    assert_equal('my partial body', partial.render)\n    assert_equal(1, template_factory.count)\n  end","complexity_score":13.1,"ast_json":"{\"type\":\"def\",\"children\":[\"test_uses_template_factory_register_if_present\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"template_factory\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubTemplateFactory\"]},\"new\"]}]},{\"type\":\"lvasgn\",\"children\":[\"context\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"Context\"]},\"build\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"registers\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"file_system\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"StubFileSystem\"]},\"new\",{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"str\",\"children\":[\"my partial body\"]}]}]}]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"template_factory\"]},{\"type\":\"lvar\",\"children\":[\"template_factory\"]}]}]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"partial\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"PartialCache\"]},\"load\",{\"type\":\"str\",\"children\":[\"my_partial\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"context\"]},{\"type\":\"lvar\",\"children\":[\"context\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"parse_context\"]},{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Liquid\"]},\"ParseContext\"]},\"new\"]}]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"my partial body\"]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"partial\"]},\"render\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"int\",\"children\":[1]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"template_factory\"]},\"count\"]}]}]}]}","id":"7a101e80-1dc9-4714-b47b-ce9efa357d95"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":863,"raw_source":"def test_reject\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => true },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => true },\n    ]\n\n    template = \"{{ array | reject: 'ok' | map: 'handle' | join: ' ' }}\"\n    expected_output = \"beta gamma\"\n\n    assert_template_result(expected_output, template, { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_reject\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"true\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"template\",{\"type\":\"str\",\"children\":[\"{{ array | reject: 'ok' | map: 'handle' | join: ' ' }}\"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"beta gamma\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"lvar\",\"children\":[\"template\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"e2052401-4f30-48bb-b934-68ff117b45e0"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/tags/statements_test.rb","start_line":71,"raw_source":"def test_var_and_long_string_are_equal\n    text = \" {% if var == 'hello there!' %} true {% else %} false {% endif %} \"\n    assert_template_result('  true  ', text, { 'var' => 'hello there!' })\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_var_and_long_string_are_equal\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {% if var == 'hello there!' %} true {% else %} false {% endif %} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\"  true  \"]},{\"type\":\"lvar\",\"children\":[\"text\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"var\"]},{\"type\":\"str\",\"children\":[\"hello there!\"]}]}]}]}]}]}","id":"ed0caa3d-8808-462e-80a4-75ea27cf2952"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/sinatra-contrib/lib/sinatra/streaming.rb","start_line":134,"raw_source":"def write(data)\n        self << data\n        data.to_s.bytesize\n      end","complexity_score":3.2,"ast_json":"{\"type\":\"def\",\"children\":[\"write\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"data\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"self\",\"children\":[]},\"<<\",{\"type\":\"lvar\",\"children\":[\"data\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"data\"]},\"to_s\"]},\"bytesize\"]}]}]}","id":"e20a961a-e65e-43a3-84b5-beeee9e42716"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/standardfilters.rb","start_line":696,"raw_source":"def prepend(input, string)\n      input = Utils.to_s(input)\n      string = Utils.to_s(string)\n      string + input\n    end","complexity_score":5.0,"ast_json":"{\"type\":\"def\",\"children\":[\"prepend\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"input\"]},{\"type\":\"arg\",\"children\":[\"string\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"input\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"string\",{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Utils\"]},\"to_s\",{\"type\":\"lvar\",\"children\":[\"string\"]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"string\"]},\"+\",{\"type\":\"lvar\",\"children\":[\"input\"]}]}]}]}","id":"7ddebafd-268f-4ada-bda4-7d10b0c503c4"}
{"repo_name":"liquid","file_path":"./repos/liquid/lib/liquid/tags/if.rb","start_line":45,"raw_source":"def unknown_tag(tag, markup, tokens)\n      if ELSE_TAG_NAMES.include?(tag)\n        push_block(tag, markup)\n      else\n        super\n      end\n    end","complexity_score":3.1,"ast_json":"{\"type\":\"def\",\"children\":[\"unknown_tag\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"tag\"]},{\"type\":\"arg\",\"children\":[\"markup\"]},{\"type\":\"arg\",\"children\":[\"tokens\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"ELSE_TAG_NAMES\"]},\"include?\",{\"type\":\"lvar\",\"children\":[\"tag\"]}]},{\"type\":\"send\",\"children\":[null,\"push_block\",{\"type\":\"lvar\",\"children\":[\"tag\"]},{\"type\":\"lvar\",\"children\":[\"markup\"]}]},{\"type\":\"zsuper\",\"children\":[]}]}]}","id":"bb42e028-551f-4d7b-ab1c-106f9a2e8ac6"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/base.rb","start_line":23,"raw_source":"def self.default_options(options)\n        define_method(:default_options) { super().merge(options) }\n      end","complexity_score":8.4,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"default_options\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"options\"]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[null,\"define_method\",{\"type\":\"sym\",\"children\":[\"default_options\"]}]},{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[{\"type\":\"super\",\"children\":[]},\"merge\",{\"type\":\"lvar\",\"children\":[\"options\"]}]}]}]}","id":"cdbf5f85-a1a4-4693-8baa-ae095cf7e877"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/spec/support/dummy_app.rb","start_line":4,"raw_source":"def self.call(env)\n    Thread.current[:last_env] = env\n    body = (env['REQUEST_METHOD'] == 'HEAD' ? '' : 'ok')\n    [200, { 'content-type' => env['wants'] || 'text/plain' }, [body]]\n  end","complexity_score":8.55,"ast_json":"{\"type\":\"defs\",\"children\":[{\"type\":\"self\",\"children\":[]},\"call\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Thread\"]},\"current\"]},\"[]=\",{\"type\":\"sym\",\"children\":[\"last_env\"]},{\"type\":\"lvar\",\"children\":[\"env\"]}]},{\"type\":\"lvasgn\",\"children\":[\"body\",{\"type\":\"begin\",\"children\":[{\"type\":\"if\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"REQUEST_METHOD\"]}]},\"==\",{\"type\":\"str\",\"children\":[\"HEAD\"]}]},{\"type\":\"str\",\"children\":[\"\"]},{\"type\":\"str\",\"children\":[\"ok\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"int\",\"children\":[200]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"content-type\"]},{\"type\":\"or\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"wants\"]}]},{\"type\":\"str\",\"children\":[\"text/plain\"]}]}]}]},{\"type\":\"array\",\"children\":[{\"type\":\"lvar\",\"children\":[\"body\"]}]}]}]}]}","id":"372a05aa-01cf-466d-910b-d168f859f3f6"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/standard_filter_test.rb","start_line":919,"raw_source":"def test_has_when_does_not_have_it\n    array = [\n      { \"handle\" => \"alpha\", \"ok\" => false },\n      { \"handle\" => \"beta\", \"ok\" => false },\n      { \"handle\" => \"gamma\", \"ok\" => false },\n      { \"handle\" => \"delta\", \"ok\" => false },\n    ]\n\n    expected_output = \"false\"\n\n    assert_template_result(expected_output, \"{{ array | has: 'ok' }}\", { \"array\" => array })\n    assert_template_result(expected_output, \"{{ array | has: 'ok', true }}\", { \"array\" => array })\n  end","complexity_score":4.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_has_when_does_not_have_it\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"array\",{\"type\":\"array\",\"children\":[{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"alpha\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"beta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"gamma\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"handle\"]},{\"type\":\"str\",\"children\":[\"delta\"]}]},{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"ok\"]},{\"type\":\"false\",\"children\":[]}]}]}]}]},{\"type\":\"lvasgn\",\"children\":[\"expected_output\",{\"type\":\"str\",\"children\":[\"false\"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok' }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"lvar\",\"children\":[\"expected_output\"]},{\"type\":\"str\",\"children\":[\"{{ array | has: 'ok', true }}\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"str\",\"children\":[\"array\"]},{\"type\":\"lvar\",\"children\":[\"array\"]}]}]}]}]}]}","id":"2e4fb6e4-c634-4eeb-9051-e65e456d5128"}
{"repo_name":"sinatra","file_path":"./repos/sinatra/rack-protection/lib/rack/protection/cookie_tossing.rb","start_line":30,"raw_source":"def accepts?(env)\n        cookie_header = env['HTTP_COOKIE']\n        cookies = Rack::Utils.parse_query(cookie_header, ';,') { |s| s }\n        cookies.each do |k, v|\n          if (k == session_key && Array(v).size > 1) ||\n             (k != session_key && Rack::Utils.unescape(k) == session_key)\n            bad_cookies << k\n          end\n        end\n        bad_cookies.empty?\n      end","complexity_score":31.18,"ast_json":"{\"type\":\"def\",\"children\":[\"accepts?\",{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"env\"]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"cookie_header\",{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"env\"]},\"[]\",{\"type\":\"str\",\"children\":[\"HTTP_COOKIE\"]}]}]},{\"type\":\"lvasgn\",\"children\":[\"cookies\",{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"parse_query\",{\"type\":\"lvar\",\"children\":[\"cookie_header\"]},{\"type\":\"str\",\"children\":[\";,\"]}]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"s\"]}]},{\"type\":\"lvar\",\"children\":[\"s\"]}]}]},{\"type\":\"block\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"cookies\"]},\"each\"]},{\"type\":\"args\",\"children\":[{\"type\":\"arg\",\"children\":[\"k\"]},{\"type\":\"arg\",\"children\":[\"v\"]}]},{\"type\":\"if\",\"children\":[{\"type\":\"or\",\"children\":[{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"==\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"Array\",{\"type\":\"lvar\",\"children\":[\"v\"]}]},\"size\"]},\">\",{\"type\":\"int\",\"children\":[1]}]}]}]},{\"type\":\"begin\",\"children\":[{\"type\":\"and\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"lvar\",\"children\":[\"k\"]},\"!=\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Rack\"]},\"Utils\"]},\"unescape\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},\"==\",{\"type\":\"send\",\"children\":[null,\"session_key\"]}]}]}]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"<<\",{\"type\":\"lvar\",\"children\":[\"k\"]}]},null]}]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[null,\"bad_cookies\"]},\"empty?\"]}]}]}","id":"98781b64-d6f3-4610-a084-60d261151966"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/output_test.rb","start_line":52,"raw_source":"def test_variable_traversing\n    source = \" {{car.bmw}} {{car.gm}} {{car.bmw}} \"\n    assert_template_result(\" good bad good \", source, @assigns)\n  end","complexity_score":2.0,"ast_json":"{\"type\":\"def\",\"children\":[\"test_variable_traversing\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"source\",{\"type\":\"str\",\"children\":[\" {{car.bmw}} {{car.gm}} {{car.bmw}} \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_template_result\",{\"type\":\"str\",\"children\":[\" good bad good \"]},{\"type\":\"lvar\",\"children\":[\"source\"]},{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}","id":"52f0dbcf-c8ce-4458-9807-0d288d5f3b0a"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/unit/i18n_unit_test.rb","start_line":20,"raw_source":"def test_single_string_interpolation\n    assert_equal(\"something different\", @i18n.translate(\"whatever\", something: \"different\"))\n  end","complexity_score":2.2,"ast_json":"{\"type\":\"def\",\"children\":[\"test_single_string_interpolation\",{\"type\":\"args\",\"children\":[]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"str\",\"children\":[\"something different\"]},{\"type\":\"send\",\"children\":[{\"type\":\"ivar\",\"children\":[\"@i18n\"]},\"translate\",{\"type\":\"str\",\"children\":[\"whatever\"]},{\"type\":\"hash\",\"children\":[{\"type\":\"pair\",\"children\":[{\"type\":\"sym\",\"children\":[\"something\"]},{\"type\":\"str\",\"children\":[\"different\"]}]}]}]}]}]}","id":"bfcefcfa-f312-4521-a2f6-dbce9ceea1ab"}
{"repo_name":"liquid","file_path":"./repos/liquid/test/integration/security_test.rb","start_line":25,"raw_source":"def test_no_existing_instance_eval\n    text     = %( {{ '1+1' | __instance_eval__ }} )\n    expected = %( 1+1 )\n\n    assert_equal(expected, Template.parse(text).render!(@assigns))\n  end","complexity_score":5.6,"ast_json":"{\"type\":\"def\",\"children\":[\"test_no_existing_instance_eval\",{\"type\":\"args\",\"children\":[]},{\"type\":\"begin\",\"children\":[{\"type\":\"lvasgn\",\"children\":[\"text\",{\"type\":\"str\",\"children\":[\" {{ '1+1' | __instance_eval__ }} \"]}]},{\"type\":\"lvasgn\",\"children\":[\"expected\",{\"type\":\"str\",\"children\":[\" 1+1 \"]}]},{\"type\":\"send\",\"children\":[null,\"assert_equal\",{\"type\":\"lvar\",\"children\":[\"expected\"]},{\"type\":\"send\",\"children\":[{\"type\":\"send\",\"children\":[{\"type\":\"const\",\"children\":[null,\"Template\"]},\"parse\",{\"type\":\"lvar\",\"children\":[\"text\"]}]},\"render!\",{\"type\":\"ivar\",\"children\":[\"@assigns\"]}]}]}]}]}","id":"71024f89-1da2-44c1-b272-1a3221b3989c"}
